<!DOCTYPE html>
<html lang="de-DE" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.135.0">
    <meta name="generator" content="Relearn 6.4.1">
    <meta name="description" content="Lambda-Ausdrücke und funktionale Interfaces Methoden-Referenzen Stream-API Record-Klassen Optional Interfaces: Default-Methoden">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Modern Java: Funktionaler Stil und Stream-API">
    <meta name="twitter:description" content="Lambda-Ausdrücke und funktionale Interfaces Methoden-Referenzen Stream-API Record-Klassen Optional Interfaces: Default-Methoden">
    <meta property="og:url" content="https://www.hsbi.de/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java.html">
    <meta property="og:title" content="Modern Java: Funktionaler Stil und Stream-API">
    <meta property="og:description" content="Lambda-Ausdrücke und funktionale Interfaces Methoden-Referenzen Stream-API Record-Klassen Optional Interfaces: Default-Methoden">
    <meta property="og:locale" content="de_DE">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="Modern Java: Funktionaler Stil und Stream-API">
    <meta itemprop="description" content="Lambda-Ausdrücke und funktionale Interfaces Methoden-Referenzen Stream-API Record-Klassen Optional Interfaces: Default-Methoden">
    <meta itemprop="wordCount" content="10">
    <title>Modern Java: Funktionaler Stil und Stream-API</title>
    <link href="https://www.hsbi.de/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java.html" rel="canonical" type="text/html" title="Modern Java: Funktionaler Stil und Stream-API">

    

    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/images/logo.png?1729954976" rel="icon" type="image/png">

    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fontawesome-all.min.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fontawesome-all.min.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/nucleus.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/auto-complete.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/auto-complete.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/perfect-scrollbar.min.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fonts.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fonts.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/theme.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/theme-auto.css?1729954976" rel="stylesheet" id="R-variant-style">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/chroma-auto.css?1729954976" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/variant.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/print.css?1729954976" rel="stylesheet" media="print">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/format-print.css?1729954976" rel="stylesheet">
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/variant.js?1729954976"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='.';
      window.relearn.relBaseUri='..\/..\/..\/..\/..';
      window.relearn.absBaseUri='https:\/\/www.hsbi.de\/elearning\/data\/FH-Bielefeld\/lm_data\/lm_1661234';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.index_js_url="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/index.search.js?1729954976";
      // variant stuff
      window.variants && variants.init( [ 'auto', 'zen-light', 'zen-dark', 'relearn-bright', 'relearn-light', 'relearn-dark' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script><style type="text/css">

 
.center {
    align-content: center;
    text-align: center;
    margin: auto;
}
.alert {
    color: #ff3333;
}
.bsp {
    padding: 0.05cm;
    border-width: 0.05cm;
    border-style: solid;
    border-color: #ddd;
    background-color: #ddd;
    border-radius: 25px;
    float: right;
}
.cbox {
    padding: 0.2cm;
    border-width: 0.1cm;
    border-style: solid;
    border-color: #4070a0;
    background-color: #f2f2f2;
    margin: auto;
    width: 60%;
    text-align: center;
    overflow: auto;
}
.blueArrow {
    color: #4070a0;
    font-family: "Courier New", "Courier", monospace;
    font-weight: bold;
}
.origin {
    background-color: #ededed;
    font-size: 0.8em;
}
.showme {
    background-color: #ededed;
    font-size: 0.8em;
}


 
.tldr {
    background: #dbe4ed;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.recap {
    
    
   margin: 4px 0px 26px 0px;
}
.bib {
    background: #dbe4ed;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.outcomes {
    background: #d9e9d5;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.quizzes {
    background: #d9e9d5;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.challenges {
    background: #ebe4d6;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.assignments {
    background: #ebe4d6;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
h1.tldr, h1.recap, h1.bib, h1.outcomes, h1.quizzes, h1.challenges, h1.assignments {
    padding: 0px;
}


 
.noJsAlert {
    padding: 20px;
    background-color: #f44336;  
    color: white;
    margin-bottom: 15px;
}


 
.embed-video-player {
    position: relative;
    padding-bottom: 56%;
    height: 0;
    overflow: hidden;
}
.youtube-player {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border:0;
}


 
#header-wrapper {
    padding:0.6rem;
}


 
#shortcuts {
    padding-top: 2.0rem;
}


 
#chapter p {
    text-align: left;
}


 
figcaption h4 {
    margin-top:-2.5rem;
}
.border1 {
    border:1px solid black;
}

 
td ul, td ol {
    margin: 0 0 1rem 0.5rem;
    padding: 0 0 0 0.5rem;
}

 
h1 { font-size:2.8rem !important;}
h2 { font-size:2.2rem; margin:1.2rem 0}
h3 { font-size:1.9rem; text-align:left !important; font-weight:400 !important;}
h4 { font-size:1.6rem}
h5 { font-size:1.3rem}
h6 { font-size:1rem}

h2 {
    width:100% !important;
    border-bottom:1px solid #5e5e5e !important;
    padding-bottom: 2px;
}
.tldr h2, .recap h2, .bib h2, .outcomes h2, .quizzes h2, .challenges h2, .assignments h2 {
    margin:0.5rem 0
}

.btn-crossreference, .btn-crossreference:hover {
    cursor: initial;
}

</style>

  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <span class="topbar-breadcrumbs highlightable">
            Modern Java: Funktionaler Stil und Stream-API
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="modern-java-funktionaler-stil-und-stream-api">Modern Java: Funktionaler Stil und Stream-API</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/lambdas.html">Lambda-Ausdrücke und funktionale Interfaces</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/methodreferences.html">Methoden-Referenzen</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/stream-api.html">Stream-API</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/records.html">Record-Klassen</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional.html">Optional</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/defaultmethods.html">Interfaces: Default-Methoden</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Modern Java: Funktionaler Stil und Stream-API</h1>
<article class="default">
<h1>Lambda-Ausdrücke und funktionale Interfaces</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Mit einer anonymen inneren Klasse erstellt man gewissermaßen ein Objekt einer &quot;Wegwerf&quot;-Klasse:
Man leitet <em>on-the-fly</em> von einem Interface ab oder erweitert eine Klasse und implementiert die
benötigten Methoden und erzeugt von dieser Klasse sofort eine Instanz (Objekt). Diese neue Klasse
ist im restlichen Code nicht sichtbar.</p>
<p>Anonyme innere Klassen sind beispielsweise in Swing recht nützlich, wenn man einer Komponente einen
Listener mitgeben will: Hier erzeugt man eine anonyme innere Klasse basierend auf dem passenden
Listener-Interface, implementiert die entsprechenden Methoden und übergibt das mit dieser Klasse
erzeugte Objekt als neuen Listener der Swing-Komponente.</p>
<p>Mit Java 8 können unter gewissen Bedingungen diese anonymen inneren Klassen zu Lambda-Ausdrücken
(und Methoden-Referenzen) vereinfacht werden. Dazu muss die anonyme innere Klasse ein sogenanntes
<strong>funktionales Interface</strong> implementieren.</p>
<p>Funktionale Interfaces sind Interfaces mit <em>genau einer abstrakten Methode</em>. Es können beliebig
viele Default-Methoden im Interface enthalten sein, und es können <code>public</code> sichtbare abstrakte
Methoden von <code>java.lang.Object</code> geerbt/überschrieben werden.</p>
<p>Die Lambda-Ausdrücke entsprechen einer anonymen Methode: Die Parameter werden aufgelistet (in
Klammern), und hinter einem Pfeil kommt entweder <em>ein</em> Ausdruck (Wert - gleichzeitig Rückgabewert
des Lambda-Ausdrucks) oder beliebig viele Anweisungen (in geschweiften Klammern, mit Semikolon):</p>
<ul>
<li>Form 1: <code>(parameters)  -&gt;  expression</code></li>
<li>Form 2: <code>(parameters)  -&gt;  { statements; }</code></li>
</ul>
<p>Der Lambda-Ausdruck muss von der Signatur her genau der einen abstrakten Methode im unterliegenden
funktionalen Interface entsprechen.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/Wd8KG7xtp4c' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Lambda-Ausdrücke und funktionale Interfaces</a></li> <li><a href='https://youtu.be/QEXpQwRYoYc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Anonyme innere Klasse</a></li> <li><a href='https://youtu.be/2LJIxsVw4pM' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Lambda-Ausdruck</a></li> <li><a href='https://youtu.be/93O1oDL5_5c' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Funktionale Interfaces selbst definiert</a></li> <li><a href='https://youtu.be/jzEw8IH8Mfc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Vordefinierte funktionale Interfaces im JDK</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/d2398cc8e1279e6b6bf1df06bd30b731e714d04d10e15b87a5f89aa07cbaf97978bb12f82ea0c7eff8a3133eb65134521933218fb94856fb6e8a6dc187dded28' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Lambda-Ausdrücke und funktionale Interfaces</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Funktionales Interfaces (Definition)</li> <li>(K3) Einsatz innerer und anonymer Klassen</li> <li>(K3) Erstellen eigener funktionaler Interfaces</li> <li>(K3) Einsatz von Lambda-Ausdrücken</li></ul>
  </div>
</div>




    <h2 id="problem-sortieren-einer-studi-liste">Problem: Sortieren einer Studi-Liste</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Liste sortieren?</span>
</span></span><span style="display:flex;"><span>sl.<span style="color:#a6e22e">sort</span>(<span style="color:#f92672">???</span>);  <span style="color:#f92672">//</span> Parameter: java.<span style="color:#a6e22e">util</span>.<span style="color:#a6e22e">Comparator</span><span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span></span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyCompare</span> <span style="color:#66d9ef">implements</span> Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span>(Studi o1, Studi o2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Liste sortieren?</span>
</span></span><span style="display:flex;"><span>MyCompare mc <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> MyCompare();
</span></span><span style="display:flex;"><span>sl.<span style="color:#a6e22e">sort</span>(mc);</span></span></code></pre></div>
<p>Da <code>Comparator&lt;T&gt;</code> ein Interface ist, muss man eine extra Klasse anlegen, die die
abstrakte Methode aus dem Interface implementiert und ein Objekt von dieser Klasse
erzeugen und dieses dann der <code>sort()</code>-Methode übergeben.</p>
<p>Die Klasse bekommt wie in Java üblich eine eigene Datei und ist damit in der
Package-Struktur offen sichtbar und &quot;verstopft&quot; mir damit die Strukturen: Diese
Klasse ist doch nur eine Hilfsklasse ... Noch schlimmer: Ich brauche einen Namen
für diese Klasse!</p>
<p>Den ersten Punkt könnte man über verschachtelte Klassen lösen: Die Hilfsklasse
wird innerhalb der Klasse definiert, die das Objekt benötigt. Für den zweiten
Punkt brauchen wir mehr Anlauf ...</p>
<h2 id="erinnerung-verschachtelte-klassen-nested-classes">Erinnerung: Verschachtelte Klassen (&quot;<em>Nested Classes</em>&quot;)</h2>
<p>Man kann Klassen innerhalb von Klassen definieren: Verschachtelte Klassen.</p>
<ul>
<li>Implizite Referenz auf Instanz der äußeren Klasse, Zugriff auf <strong>alle</strong> Elemente</li>
<li><strong>Begriffe</strong>:
<ul>
<li>&quot;normale&quot; innere Klassen: &quot;<em>inner classes</em>&quot;</li>
<li>statische innere Klassen: &quot;<em>static nested classes</em>&quot;</li>
</ul>
</li>
<li>Einsatzzweck:
<ul>
<li>Hilfsklassen: Zusätzliche Funktionalität kapseln; Nutzung <strong>nur</strong> in äußerer Klasse</li>
<li>Kapselung von Rückgabewerten</li>
</ul>
</li>
</ul>
<p>Sichtbarkeit: Wird u.U. von äußerer Klasse &quot;überstimmt&quot;</p>
<h3 id="innere-klassen-inner-classes">Innere Klassen (&quot;<em>Inner Classes</em>&quot;)</h3>
<ul>
<li>Objekt der äußeren Klasse muss existieren</li>
<li>Innere Klasse ist normales Member der äußeren Klasse</li>
<li>Implizite Referenz auf Instanz äußerer Klasse</li>
<li>Zugriff auf <strong>alle</strong> Elemente der äußeren Klasse</li>
<li>Sonderfall: Definition innerhalb von Methoden (&quot;local classes&quot;)
<ul>
<li>Nur innerhalb der Methode sichtbar</li>
<li>Kennt zusätzlich <code>final</code> Attribute der Methode</li>
</ul>
</li>
</ul>
<p>Beispiel:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Outer</span> {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Inner</span> {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Outer.<span style="color:#a6e22e">Inner</span> inner <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Outer().<span style="color:#a6e22e">new</span> Inner();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/nested/StudiListNested.java" target="_blank"><span class="title">Beispiel mit Iterator als innere Klasse: nested.StudiListNested</span></a></span></div>
<h3 id="statische-innere-klassen-static-nested-classes">Statische innere Klassen (&quot;<em>Static Nested Classes</em>&quot;)</h3>
<ul>
<li>Keine implizite Referenz auf Objekt</li>
<li>Nur Zugriff auf Klassenmethoden und -attribute</li>
</ul>
<p>Beispiel:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Outer</span> {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StaticNested</span> {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Outer.<span style="color:#a6e22e">StaticNested</span> nested <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Outer.<span style="color:#a6e22e">StaticNested</span>();</span></span></code></pre></div>
<h2 id="lösung-comparator-als-anonyme-innere-klasse">Lösung: Comparator als anonyme innere Klasse</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Parametrisierung mit anonymer Klasse</span>
</span></span><span style="display:flex;"><span>sl.<span style="color:#a6e22e">sort</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span>(Studi o1, Studi o2) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        });  <span style="color:#f92672">//</span> Semikolon nicht vergessen<span style="color:#f92672">!!!</span></span></span></code></pre></div>
<p>=&gt; Instanz einer anonymen inneren Klasse, die das Interface <code>Comparator&lt;Studi&gt;</code> implementiert</p>
<ul>
<li>Für spezielle, einmalige Aufgabe: nur eine Instanz möglich</li>
<li>Kein Name, kein Konstruktor, oft nur eine Methode</li>
<li>Müssen Interface implementieren oder andere Klasse erweitern
<ul>
<li>Achtung Schreibweise: ohne <code>implements</code> oder <code>extends</code>!</li>
</ul>
</li>
<li>Konstruktor kann auch Parameter aufweisen</li>
<li>Zugriff auf alle Attribute der äußeren Klasse plus alle <code>final</code> lokalen
Variablen</li>
<li>Nutzung typischerweise bei GUIs: Event-Handler etc.</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/nested/DemoAnonymousInnerClass.java" target="_blank"><span class="title">Demo: nested.DemoAnonymousInnerClass</span></a></span></div>
<h2 id="vereinfachung-mit-lambda-ausdruck">Vereinfachung mit Lambda-Ausdruck</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Parametrisierung mit anonymer Klasse</span>
</span></span><span style="display:flex;"><span>sl.<span style="color:#a6e22e">sort</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span>(Studi o1, Studi o2) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        });  <span style="color:#75715e">// Semikolon nicht vergessen!!!</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Parametrisierung mit Lambda-Ausdruck</span>
</span></span><span style="display:flex;"><span>sl.<span style="color:#a6e22e">sort</span>( (Studi o1, Studi o2) <span style="color:#f92672">-&gt;</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>() );</span></span></code></pre></div>
<p><strong>Anmerkung</strong>: Damit für den Parameter alternativ auch ein Lambda-Ausdruck verwendet
werden kann, muss der erwartete Parameter vom Typ her ein &quot;<strong>funktionales Interface</strong>&quot;
(s.u.) sein!</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/nested/DemoLambda.java" target="_blank"><span class="title">Demo: nested.DemoLambda</span></a></span></div>
<h2 id="syntax-für-lambdas">Syntax für Lambdas</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>(Studi o1, Studi o2)  <span style="color:#f92672">-&gt;</span>  o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>()</span></span></code></pre></div>
<p>Ein Lambda-Ausdruck ist eine Funktion ohne Namen und besteht aus drei Teilen:</p>
<ol>
<li>Parameterliste (in runden Klammern),</li>
<li>Pfeil</li>
<li>Funktionskörper (rechte Seite)</li>
</ol>
<p>Falls es <em>genau einen</em> Parameter gibt, <em>können</em> die runden Klammern um den Parameter
entfallen.</p>
<p>Dabei kann der Funktionskörper aus <em>einem Ausdruck</em> (&quot;<em>expression</em>&quot;) bestehen oder
einer <em>Menge von Anweisungen</em> (&quot;<em>statements&quot;</em>), die dann in geschweifte Klammern
eingeschlossen werden müssen (Block mit Anweisungen).</p>
<p>Der Wert des Ausdrucks ist zugleich der Rückgabewert des Lambda-Ausdrucks.</p>
<p>Varianten:</p>
<ul>
<li>
<p><strong><code>(parameters)  -&gt;  expression</code></strong></p>
</li>
<li>
<p><strong><code>(parameters)  -&gt;  { statements; }</code></strong></p>
</li>
</ul>
<h2 id="quiz-welches-sind-keine-gültigen-lambda-ausdrücke">Quiz: Welches sind keine gültigen Lambda-Ausdrücke?</h2>
<ol>
<li><code>() -&gt; {}</code></li>
<li><code>() -&gt; &quot;wuppie&quot;</code></li>
<li><code>() -&gt; { return &quot;fluppie&quot;; }</code></li>
<li><code>(Integer i) -&gt; return i + 42;</code></li>
<li><code>(String s) -&gt; { &quot;foo&quot;; }</code></li>
<li><code>(String s) -&gt; s.length()</code></li>
<li><code>(Studi s) -&gt; s.getCredits() &gt; 300</code></li>
<li><code>(List&lt;Studi&gt; sl) -&gt; sl.isEmpty()</code></li>
<li><code>(int x, int y) -&gt; { System.out.println(&quot;Erg: &quot;); System.out.println(x+y); }</code></li>
<li><code>() -&gt; new Studi()</code></li>
<li><code>s -&gt; s.getCps() &gt; 100 &amp;&amp; s.getCps() &lt; 300</code></li>
<li><code>s -&gt; { return s.getCps() &gt; 100 &amp;&amp; s.getCps() &lt; 300; }</code></li>
</ol>
<div class="expand">
  <input type="checkbox" id="R-expand-81e988a5bf9aaf03691f734e61952968" aria-controls="R-expandcontent-81e988a5bf9aaf03691f734e61952968">
  <label class="expand-label" for="R-expand-81e988a5bf9aaf03691f734e61952968">
    <i class="expander-icon fa-fw fas fa-chevron-down"></i>
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> Show Me
  </label>
  <div id="R-expandcontent-81e988a5bf9aaf03691f734e61952968" class="expand-content">
<p>Auflösung:</p>
<p>(4) und (5): <code>return</code> ist eine Anweisung, d.h. bei (4) fehlen die geschweiften
Klammern. <code>&quot;foo&quot;</code> ist ein String und als solcher ein Ausdruck, d.h. hier sind
die geschweiften Klammern zu viel (oder man ergänze den String mit einem <code>return</code>,
also <code>return &quot;foo&quot;;</code> ...).</p>
  </div>
</div>
<h2 id="definition-funktionales-interface-functional-interfaces">Definition &quot;Funktionales Interface&quot; (&quot;<em>functional interfaces</em>&quot;)</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@FunctionalInterface</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Wuppie</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">wuppie</span>(T obj);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">equals</span>(Object obj);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">fluppie</span>() { <span style="color:#66d9ef">return</span> 42; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><code>Wuppie&lt;T&gt;</code> ist ein <span class='alert'><strong>funktionales Interface</strong></span>
(&quot;<em>functional interface</em>&quot;) (seit Java 8)</p>
<ul>
<li>Hat <strong>genau <em>eine</em> abstrakte Methode</strong></li>
<li>Hat evtl. weitere Default-Methoden</li>
<li>Hat evtl. weitere abstrakte Methoden, die <code>public</code> Methoden von
<code>java.lang.Object</code> überschreiben</li>
</ul>
<p>Die Annotation <code>@FunctionalInterface</code> selbst ist nur für den Compiler: Falls
das Interface <em>kein</em> funktionales Interface ist, würde er beim Vorhandensein
dieser Annotation einen Fehler werfen. Oder anders herum: Allein durch das
Annotieren mit <code>@FunctionalInterface</code> wird aus einem Interface noch kein
funktionales Interface! Vergleichbar mit <code>@Override</code> ...</p>
<p><span class='alert'><strong>Während man für eine anonyme Klasse lediglich ein &quot;normales&quot; Interface
(oder eine Klasse) benötigt, braucht man für Lambda-Ausdrücke zwingend ein
passendes funktionales Interface!</strong></span></p>
<p><em>Anmerkung</em>: Es scheint keine einheitliche deutsche Übersetzung für den Begriff
<em>functional interface</em> zu geben. Es wird häufig mit &quot;funktionales Interface&quot;,
manchmal aber auch mit &quot;Funktionsinterface&quot; übersetzt.</p>
<p>Das in den obigen Beispielen eingesetzte Interface <code>java.util.Comparator&lt;T&gt;</code>
ist also ein funktionales Interface: Es hat nur <em>eine</em> eigene abstrakte Methode
<code>int compare(T o1, T o2);</code>.</p>
<p>Im Package <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/package-summary.html" rel="external" target="_blank">java.util.function</a>
sind einige wichtige funktionale Interfaces bereits vordefiniert, beispielsweise
<code>Predicate</code> (Test, ob eine Bedingung erfüllt ist) und <code>Function</code> (verarbeite
einen Wert und liefere einen passenden Ergebniswert). Diese kann man auch in
eigenen Projekten nutzen!</p>
<h2 id="quiz-welches-ist-kein-funktionales-interface">Quiz: Welches ist kein funktionales Interface?</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Wuppie</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">wuppie</span>(<span style="color:#66d9ef">int</span> a);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Fluppie</span> <span style="color:#66d9ef">extends</span> Wuppie {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">wuppie</span>(<span style="color:#66d9ef">double</span> a);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Foo</span> {
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Bar</span> <span style="color:#66d9ef">extends</span> Wuppie {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">bar</span>() { <span style="color:#66d9ef">return</span> 42; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="expand">
  <input type="checkbox" id="R-expand-ced9f57588af42179887368cae0207c2" aria-controls="R-expandcontent-ced9f57588af42179887368cae0207c2">
  <label class="expand-label" for="R-expand-ced9f57588af42179887368cae0207c2">
    <i class="expander-icon fa-fw fas fa-chevron-down"></i>
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> Show Me
  </label>
  <div id="R-expandcontent-ced9f57588af42179887368cae0207c2" class="expand-content">
<p>Auflösung:</p>
<ul>
<li><code>Wuppie</code> hat <em>genau eine</em> abstrakte Methode =&gt; funktionales Interface</li>
<li><code>Fluppie</code> hat zwei abstrakte Methoden =&gt; <strong>kein</strong> funktionales Interface</li>
<li><code>Foo</code> hat gar keine abstrakte Methode =&gt; <strong>kein</strong> funktionales Interface</li>
<li><code>Bar</code> hat <em>genau eine</em> abstrakte Methode (und eine Default-Methode) =&gt; funktionales Interface</li>
</ul>
  </div>
</div>
<h2 id="lambdas-und-funktionale-interfaces-typprüfung">Lambdas und funktionale Interfaces: Typprüfung</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">java</span>.<span style="color:#a6e22e">util</span>.<span style="color:#a6e22e">Comparator</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span>(T o1, T o2);    <span style="color:#75715e">// abstrakte Methode</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Verwendung ohne weitere Typinferenz</span>
</span></span><span style="display:flex;"><span>Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> c1 <span style="color:#f92672">=</span> (Studi o1, Studi o2) <span style="color:#f92672">-&gt;</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Verwendung mit Typinferenz</span>
</span></span><span style="display:flex;"><span>Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> c2 <span style="color:#f92672">=</span> (o1, o2) <span style="color:#f92672">-&gt;</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>();</span></span></code></pre></div>
<p>Der Compiler prüft in etwa folgende Schritte, wenn er über einen Lambda-Ausdruck stolpert:</p>
<ol>
<li>In welchem Kontext habe ich den Lambda-Ausdruck gesehen?</li>
<li>OK, der Zieltyp ist hier <code>Comparator&lt;Studi&gt;</code>.</li>
<li>Wie lautet die <strong>eine</strong> abstrakte Methode im <code>Comparator&lt;T&gt;</code>-Interface?</li>
<li>OK, das ist <code>int compare(T o1, T o2);</code></li>
<li>Da <code>T</code> hier an <code>Studi</code> gebunden ist, muss der Lambda-Ausdruck
der Methode <code>int compare(Studi o1, Studi o2);</code> entsprechen:
2x <code>Studi</code> als Parameter und als Ergebnis ein <code>int</code></li>
<li>Ergebnis:
a)  Cool, passt zum Lambda-Ausdruck <code>c1</code>. Fertig.
b)  D.h. in <code>c2</code> müssen <code>o1</code> und <code>o2</code> vom Typ <code>Studi</code> sein.
Cool, passt zum Lambda-Ausdruck <code>c2</code>. Fertig.</li>
</ol>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Anonyme Klassen: &quot;Wegwerf&quot;-Innere Klassen</p>
<ul>
<li>Müssen Interface implementieren oder Klasse erweitern</li>
</ul>
</li>
<li>
<p>Java8: <strong>Lambda-Ausdrücke</strong> statt anonymer Klassen (<strong>funktionales Interface nötig</strong>)</p>
<ul>
<li>Zwei mögliche Formen:
<ul>
<li>Form 1: <code>(parameters)  -&gt;  expression</code></li>
<li>Form 2: <code>(parameters)  -&gt;  { statements; }</code></li>
</ul>
</li>
<li>Im jeweiligen Kontext muss ein <strong>funktionales Interface</strong> verwendet werden,
d.h. ein Interface mit <strong>genau</strong> einer abstrakten Methode</li>
<li>Der Lambda-Ausdruck muss von der Signatur her dieser einen abstrakten Methode
entsprechen</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106523&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Lambda-Ausdrücke und funktionale Interfaces (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Beispiel aus einem Code-Review im <a href="https://github.com/Dungeon-CampusMinden/Dungeon" rel="external" target="_blank">Dungeon-CampusMinden/Dungeon</a></strong></p>
<p>Erklären Sie folgenden Code:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IFightAI</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fight</span>(Entity entity);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AIComponent</span> <span style="color:#66d9ef">extends</span> Component {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> IFightAI fightAI;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    fightAI <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>                entity1 <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;TIME TO FIGHT!&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// todo replace with melee skill</span>
</span></span><span style="display:flex;"><span>                };
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><strong>Sortieren mit Lambdas und funktionalen Interfaces</strong></p>
<p>Betrachten Sie die Klasse <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/challenges/lambda/Student.java" rel="external" target="_blank">Student</a>.</p>
<ol>
<li>Definieren Sie eine Methode, die das Sortieren einer <code>Student</code>-Liste erlaubt. Übergeben Sie die Liste als Parameter.</li>
<li>Schaffen Sie es, das Sortierkriterium ebenfalls als Parameter zu übergeben (als Lambda-Ausdruck)?</li>
<li>Definieren Sie eine weitere Methode, die wieder eine <code>Student</code>-Liste als Parameter bekommt und liefern sie das erste
<code>Student</code>-Objekt zurück, welches einer als Lambda-Ausdruck übergebenen Bedingung genügt.</li>
<li>Definieren Sie noch eine Methode, die wieder eine <code>Student</code>-Liste als Parameter bekommt sowie einen Lambda-Ausdruck,
welcher aus einem <code>Student</code>-Objekt ein Objekt eines anderen Typen <code>T</code> berechnet. Wenden Sie in der Methode den
Lambda-Ausdruck auf jedes Objekt der Liste an und geben sie die resultierende neue Liste als Ergebnis zurück.</li>
</ol>
<p>Verwenden Sie in dieser Aufgabe jeweils Lambda-Ausdrücke. Rufen Sie alle drei/vier Methoden an einem kleinen Beispiel auf.</p>
  </div>
</div>



    




    




    
    
        
        

        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kapitel 12: Lambda-Ausdrücke und funktionale Programmierung</em></li> <li id='id_Urma2014'>[Urma2014] <strong>Java 8 in Action: Lambdas, Streams, and Functional-Style Programming</strong><br>Urma, R.-G. und Fusco, M. und Mycroft, A., Manning Publications, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9199-9' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9199-9</a>.<br><em>Kapitel 3: Lambda Expressions, Kapitel 5: Working with streams</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Methoden-Referenzen</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Seit Java8 können <strong>Referenzen auf Methoden</strong> statt anonymer Klassen eingesetzt werden
(<strong>funktionales Interface nötig</strong>).</p>
<p>Dabei gibt es drei mögliche Formen:</p>
<ul>
<li>Form 1: Referenz auf eine statische Methode: <code>ClassName::staticMethodName</code>
(wird verwendet wie <code>(args) -&gt; ClassName.staticMethodName(args)</code>)</li>
<li>Form 2: Referenz auf eine Instanz-Methode eines Objekts: <code>objectref::instanceMethodName</code>
(wird verwendet wie <code>(args) -&gt; objectref.instanceMethodName(args)</code>)</li>
<li>Form 3: Referenz auf eine Instanz-Methode eines Typs: <code>ClassName::instanceMethodName</code>
(wird verwendet wie <code>(o1, args) -&gt; o1.instanceMethodName(args)</code>)</li>
</ul>
<p>Im jeweiligen Kontext muss ein passendes funktionales Interface verwendet werden, d.h. ein
Interface mit <strong>genau</strong> einer abstrakten Methode. Die Methoden-Referenz muss von der
Syntax her dieser einen abstrakten Methode entsprechen (bei der dritten Form wird die
Methode auf dem ersten Parameter aufgerufen).</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/z0mfvvrsRzc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Methoden-Referenzen</a></li> <li><a href='https://youtu.be/YFdPcxE_1Eo' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Referenz auf statische Methode</a></li> <li><a href='https://youtu.be/ImJTywhXrJo' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Referenz auf Instanz-Methode (Objekt)</a></li> <li><a href='https://youtu.be/DVz2x27WHU8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Referenz auf Instanz-Methode (Typ)</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/662003c5cb2cdef08b5d35cefd49b05f561fa26471cf3da22c4ff4310596909d0e21300133fc2fac353dfc4a391c8bb9af0dd47293efabfa8c3464429534d719' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Methoden-Referenzen</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Funktionales Interfaces (Definition)</li> <li>(K3) Einsatz von Methoden-Referenzen</li></ul>
  </div>
</div>




    <h2 id="beispiel-sortierung-einer-liste">Beispiel: Sortierung einer Liste</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Anonyme innere Klasse</span>
</span></span><span style="display:flex;"><span>Collections.<span style="color:#a6e22e">sort</span>(sl, <span style="color:#66d9ef">new</span> Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span>(Studi o1, Studi o2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Studi.<span style="color:#a6e22e">cmpCpsClass</span>(o1, o2);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Lambda-Ausdruck</span>
</span></span><span style="display:flex;"><span>Collections.<span style="color:#a6e22e">sort</span>(sl, (o1, o2) <span style="color:#f92672">-&gt;</span> Studi.<span style="color:#a6e22e">cmpCpsClass</span>(o1, o2));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Methoden-Referenz</span>
</span></span><span style="display:flex;"><span>Collections.<span style="color:#a6e22e">sort</span>(sl, Studi::cmpCpsClass);</span></span></code></pre></div>
<h3 id="anmerkung">Anmerkung</h3>
<p>Für das obige Beispiel wird davon ausgegangen, dass in der Klasse <code>Studi</code> eine
statische Methode <code>cmpCpsClass()</code> existiert:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">cmpCpsClass</span>(Studi s1, Studi s2) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> s1.<span style="color:#a6e22e">getCps</span>() <span style="color:#f92672">-</span> s2.<span style="color:#a6e22e">getCps</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Wenn man im Lambda-Ausdruck nur Methoden der eigenen Klasse aufruft, kann man das
auch direkt per <em>Methoden-Referenz</em> abkürzen!</p>
<ul>
<li>Erinnerung: <code>Comparator&lt;T&gt;</code> ist ein funktionales Interface</li>
<li>Instanzen können wie üblich durch Ableiten bzw. anonyme Klassen erzeugt werden</li>
<li>Alternativ kann seit Java8 auch ein passender Lambda-Ausdruck verwendet werden</li>
<li>Ab Java8: Referenzen auf passende Methoden (Signatur!) können ein funktionales
Interface &quot;implementieren&quot;
<ul>
<li>Die statische Methode <code>static int cmpCpsClass(Studi s1, Studi s2)</code> hat die
selbe Signatur wie <code>int compare(Studi s1, Studi s2)</code> aus <code>Comparator&lt;Studi&gt;</code></li>
<li>Kann deshalb wie eine Instanz von <code>Comparator&lt;Studi&gt;</code> genutzt werden</li>
<li>Name der Methode spielt dabei keine Rolle</li>
</ul>
</li>
</ul>
<h2 id="überblick-arten-von-methoden-referenzen">Überblick: Arten von Methoden-Referenzen</h2>
<ol>
<li>
<p>Referenz auf eine statische Methode</p>
<ul>
<li>Form: <code>ClassName::staticMethodName</code></li>
<li>Wirkung: Aufruf mit <code>(args) -&gt; ClassName.staticMethodName(args)</code></li>
</ul>
</li>
<li>
<p>Referenz auf Instanz-Methode eines bestimmten Objekts</p>
<ul>
<li>Form: <code>objectref::instanceMethodName</code></li>
<li>Wirkung: Aufruf mit <code>(args) -&gt; objectref.instanceMethodName(args)</code></li>
</ul>
</li>
<li>
<p>Referenz auf Instanz-Methode eines bestimmten Typs</p>
<ul>
<li>Form: <code>ClassName::instanceMethodName</code></li>
<li>Wirkung: Aufruf mit <code>(arg0, rest) -&gt; arg0.instanceMethodName(rest)</code>
(<code>arg0</code> ist vom Typ <code>ClassName</code>)</li>
</ul>
</li>
</ol>
<p><em>Anmerkung</em>: Analog zur Referenz auf eine statische Methode gibt es noch die
Form der Referenz auf einen Konstruktor: <code>ClassName::new</code>. Für Referenzen auf
Konstruktoren mit mehr als 2 Parametern muss ein eigenes passendes funktionales
Interface mit entsprechend vielen Parametern definiert werden ...</p>
<h2 id="methoden-referenz-1-referenz-auf-statische-methode">Methoden-Referenz 1: Referenz auf statische Methode</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">cmpCpsClass</span>(Studi s1, Studi s2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> s1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> s2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Referenz auf statische Methode</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, Studi::cmpCpsClass);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Entsprechender Lambda-Ausdruck</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, (o1, o2) <span style="color:#f92672">-&gt;</span> Studi.<span style="color:#a6e22e">cmpCpsClass</span>(o1, o2));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/methodreferences/DemoStaticMethodReference.java" target="_blank"><span class="title">Demo: methodreferences.DemoStaticMethodReference</span></a></span></div>
<p><code>Collections.sort()</code> erwartet in diesem Szenario als zweiten Parameter eine Instanz von
<code>Comparator&lt;Studi&gt;</code> mit einer Methode <code>int compare(Studi o1, Studi o2)</code>.</p>
<p>Die übergebene Referenz auf die <strong>statische Methode <code>cmpCpsClass</code> der Klasse <code>Studi</code></strong>
hat die <strong>selbe Signatur</strong> und wird deshalb von <code>Collections.sort()</code> genauso genutzt wie
die eigentlich erwartete Methode <code>Comparator&lt;Studi&gt;#compare(Studi o1, Studi o2)</code>, d.h.
statt <code>compare(o1, o2)</code> wird nun für jeden Vergleich <strong><code>Studi.cmpCpsClass(o1, o2)</code></strong>
aufgerufen.</p>
<h2 id="methoden-referenz-2-referenz-auf-instanz-methode-objekt">Methoden-Referenz 2: Referenz auf Instanz-Methode (Objekt)</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">cmpCpsInstance</span>(Studi s1, Studi s2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> s1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> s2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>        Studi holger <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Holger&#34;</span>, 42);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Referenz auf Instanz-Methode eines Objekts</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, holger::cmpCpsInstance);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Entsprechender Lambda-Ausdruck</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, (o1, o2) <span style="color:#f92672">-&gt;</span> holger.<span style="color:#a6e22e">cmpCpsInstance</span>(o1, o2));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/methodreferences/DemoInstanceMethodReferenceObject.java" target="_blank"><span class="title">Demo: methodreferences.DemoInstanceMethodReferenceObject</span></a></span></div>
<p><code>Collections.sort()</code> erwartet in diesem Szenario als zweites Argument wieder eine Instanz
von <code>Comparator&lt;Studi&gt;</code> mit einer Methode <code>int compare(Studi o1, Studi o2)</code>.</p>
<p>Die übergebene Referenz auf die <strong>Instanz-Methode <code>cmpCpsInstance</code> des Objekts <code>holger</code></strong>
hat die selbe Signatur und wird entsprechend von <code>Collections.sort()</code> genauso genutzt wie
die eigentlich erwartete Methode <code>Comparator&lt;Studi&gt;#compare(Studi o1, Studi o2)</code>, d.h.
statt <code>compare(o1, o2)</code> wird nun für jeden Vergleich <strong><code>holger.cmpCpsInstance(o1, o2)</code></strong>
aufgerufen.</p>
<h2 id="methoden-referenz-3-referenz-auf-instanz-methode-typ">Methoden-Referenz 3: Referenz auf Instanz-Methode (Typ)</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">cmpCpsInstance</span>(Studi studi) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> studi.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Referenz auf Instanz-Methode eines Typs</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, Studi::cmpCpsInstance);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Entsprechender Lambda-Ausdruck</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, (o1, o2) <span style="color:#f92672">-&gt;</span> o1.<span style="color:#a6e22e">cmpCpsInstance</span>(o2));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/methodreferences/DemoInstanceMethodReferenceType.java" target="_blank"><span class="title">Demo: methodreferences.DemoInstanceMethodReferenceType</span></a></span></div>
<p><code>Collections.sort()</code> erwartet in diesem Szenario als zweites Argument wieder eine Instanz
von <code>Comparator&lt;Studi&gt;</code> mit einer Methode <code>int compare(Studi o1, Studi o2)</code>.</p>
<p>Die übergebene Referenz auf die <strong>Instanz-Methode <code>cmpCpsInstance</code> des Typs <code>Studi</code></strong> hat
die Signatur <code>int cmpCpsInstance(Studi studi)</code> und wird von <code>Collections.sort()</code> so genutzt:
Statt <code>compare(o1, o2)</code> wird nun für jeden Vergleich <strong><code>o1.cmpCpsInstance(o2)</code></strong>
aufgerufen.</p>
<h2 id="ausblick-threads">Ausblick: Threads</h2>
<p>Erinnerung an bzw. Vorgriff auf <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-intro.html">&ldquo;Threads: Intro&rdquo;</a>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Runnable</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Damit lassen sich Threads auf verschiedene Arten erzeugen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ThreadStarter</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">wuppie</span>() { System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;wuppie(): wuppie&#34;</span>); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thread t1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Thread(<span style="color:#66d9ef">new</span> Runnable() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;t1: wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thread t2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Thread(() <span style="color:#f92672">-&gt;</span> System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;t2: wuppie&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thread t3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Thread(ThreadStarter::wuppie);</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/methodreferences/ThreadStarter.java" target="_blank"><span class="title">Beispiel: methodreferences.ThreadStarter</span></a></span></div>
<h2 id="ausblick-datenstrukturen-als-streams">Ausblick: Datenstrukturen als Streams</h2>
<p>Erinnerung an bzw. Vorgriff auf <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/stream-api.html">&ldquo;Stream-API&rdquo;</a>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">X</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">gtFour</span>(<span style="color:#66d9ef">int</span> x) { <span style="color:#66d9ef">return</span> (x <span style="color:#f92672">&gt;</span> 4) <span style="color:#f92672">?</span> <span style="color:#66d9ef">true</span> : <span style="color:#66d9ef">false</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> words <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#e6db74">&#34;Java8&#34;</span>, <span style="color:#e6db74">&#34;Lambdas&#34;</span>, <span style="color:#e6db74">&#34;PM&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Dungeon&#34;</span>, <span style="color:#e6db74">&#34;libGDX&#34;</span>, <span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#e6db74">&#34;World&#34;</span>, <span style="color:#e6db74">&#34;Wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> wordLengths <span style="color:#f92672">=</span> words.<span style="color:#a6e22e">stream</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">map</span>(String::length)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">filter</span>(X::gtFour)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">sorted</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">collect</span>(toList());</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/methodreferences/CollectionStreams.java" target="_blank"><span class="title">Beispiel: methodreferences.CollectionStreams</span></a></span></div>
<ul>
<li>Collections können als Datenstrom betrachtet werden: <code>stream()</code>
<ul>
<li>Iteration über die Collection, analog zu externer Iteration mit <code>foreach</code></li>
</ul>
</li>
<li>Daten aus dem Strom filtern: <code>filter</code>, braucht Prädikat</li>
<li>Auf alle Daten eine Funktion anwenden: <code>map</code></li>
<li>Daten im Strom sortieren: <code>sort</code> (auch mit Comparator)</li>
<li>Daten wieder einsammeln mit <code>collect</code></li>
</ul>
<p>=&gt; Typische Elemente <strong>funktionaler Programmierung</strong></p>
<p>=&gt; Verweis auf Wahlfach &quot;Spezielle Methoden der Programmierung&quot;</p>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Seit Java8: <strong>Methoden-Referenzen</strong> statt anonymer Klassen (<strong>funktionales Interface nötig</strong>)</p>
<ul>
<li>
<p>Drei mögliche Formen:</p>
<ul>
<li>Form 1: Referenz auf statische Methode: <code>ClassName::staticMethodName</code>
(verwendet wie <code>(args) -&gt; ClassName.staticMethodName(args)</code>)</li>
<li>Form 2: Referenz auf Instanz-Methode eines Objekts: <code>objectref::instanceMethodName</code>
(verwendet wie <code>(args) -&gt; objectref.instanceMethodName(args)</code>)</li>
<li>Form 3: Referenz auf Instanz-Methode eines Typs: <code>ClassName::instanceMethodName</code>
(verwendet wie <code>(o1, args) -&gt; o1.instanceMethodName(args)</code>)</li>
</ul>
</li>
<li>
<p>Im jeweiligen Kontext muss ein passendes funktionales Interface verwendet werden
(d.h. ein Interface mit <strong>genau</strong> einer abstrakten Methode)</p>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106524&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Methoden-Referenzen (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachten Sie den folgenden Java-Code:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Cat</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> gewicht;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Cat</span>(<span style="color:#66d9ef">int</span> gewicht) { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">gewicht</span> <span style="color:#f92672">=</span> gewicht; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Cat<span style="color:#f92672">&gt;</span> clouder <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(100));  clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(1));  clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(10));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        clouder.<span style="color:#a6e22e">sort</span>(...);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ol>
<li>Ergänzen Sie den Methodenaufruf <code>clouder.sort(...);</code> mit einer geeigneten
anonymen Klasse, daß der <code>clouder</code> aufsteigend nach Gewicht sortiert wird.</li>
<li>Statt einer anonymen Klasse kann man auch Lambda-Ausdrücke einsetzen. Geben
Sie eine konkrete Form an.</li>
<li>Statt einer anonymen Klasse kann man auch Methodenreferenzen einsetzen. Dafür
gibt es mehrere Formen. Geben Sie für zwei Formen der Methodenreferenz sowohl
den Aufruf als auch die Implementierung der entsprechenden Methoden in der
Klasse <code>Cat</code> an.</li>
</ol>
  </div>
</div>



    




    




    
    
        
        

        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Urma2014'>[Urma2014] <strong>Java 8 in Action: Lambdas, Streams, and Functional-Style Programming</strong><br>Urma, R.-G. und Fusco, M. und Mycroft, A., Manning Publications, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9199-9' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9199-9</a>.<br><em>Kapitel 3: Lambda Expressions, Kapitel 5: Working with streams</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Stream-API</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Mit der Collection-API existiert in Java die Möglichkeit, Daten auf verschiedenste Weisen zu
speichern (<code>Collection&lt;T&gt;</code>). Mit der Stream-API gibt es die Möglichkeit, diese Daten in einer
Art Pipeline zu verarbeiten. Ein <code>Stream&lt;T&gt;</code> ist eine Folge von Objekten vom Typ <code>T</code>. Die
Verarbeitung der Daten ist &quot;lazy&quot;, d.h. sie erfolgt erst auf Anforderung (durch die terminale
Operation).</p>
<p>Ein Stream hat eine Datenquelle und kann beispielsweise über <code>Collection#stream()</code> oder
<code>Stream.of()</code> angelegt werden. Streams speichern keine Daten. Die Daten werden aus der
verbundenen Datenquelle geholt.</p>
<p>Auf einem Stream kann man eine Folge von intermediären Operationen wie <code>peek()</code>, <code>map()</code>,
<code>flatMap()</code>, <code>filter()</code>, <code>sorted()</code> ... durchführen. Alle diese Operationen arbeiten auf
dem Stream und erzeugen einen neuen Stream als Ergebnis. Dadurch kann die typische
Pipeline-artige Verkettung der Operationen ermöglicht werden. Die intermediären Operationen
werden erst ausgeführt, wenn der Stream durch eine terminale Operation geschlossen wird.</p>
<p>Terminale Operationen wie <code>count()</code>, <code>forEach()</code>, <code>allMatch()</code> oder <code>collect()</code></p>
<ul>
<li><code>collect(Collectors.toList())</code> (bzw. direkt mit <code>stream.toList()</code> (ab Java16))</li>
<li><code>collect(Collectors.toSet())</code></li>
<li><code>collect(Collectors.toCollection(LinkedList::new))</code> (als <code>Supplier&lt;T&gt;</code>)</li>
</ul>
<p>stoßen die Verarbeitung des Streams an und schließen den Stream damit ab.</p>
<p>Wir können hier nur die absoluten Grundlagen betrachten. Die Stream-API ist sehr groß und
mächtig und lohnt die weitere selbstständige Auseinandersetzung :-)</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/zZMyk0u5hJk' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Stream-API</a></li> <li><a href='https://youtu.be/KBP72tCkBt8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Stream-API</a></li> <li><a href='https://youtu.be/jzEw8IH8Mfc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Vordefinierte funktionale Interfaces im JDK</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/429bb37eaea02582785bfb46a92d68a3ed76cb18bdc98ec0f04ae438cecf82a595e1e46947d2ffcc2fd868d67ca1ed3beba73f216ae4886f2a9492167c006784' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Stream-API</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Streams speichern keine Daten</li> <li>(K2) Streams verarbeiten die Daten lazy</li> <li>(K2) <code>map()</code> ändert den Typ (und Inhalt) von Objekten im Stream, aber nicht die Anzahl</li> <li>(K2) <code>filter()</code> ändert die Anzahl der Objekte im Stream, aber nicht deren Typ (und Inhalt)</li> <li>(K2) Streams machen ausführlich Gebrauch von den funktionalen Interfaces in <code>java.util.function</code></li> <li>(K2) Streams sollten nicht in Attributen gehalten oder als Argument von Methoden herumgereicht werden</li> <li>(K3) Anlegen eines Streams</li> <li>(K3) Verkettung von intermediären Operationen</li> <li>(K3) Durchführung der Berechnung und Abschluss des Streams mit einer terminalen Operation</li> <li>(K3) Einsatz von <code>flatMap()</code></li></ul>
  </div>
</div>




    <h2 id="motivation">Motivation</h2>
<p>Es wurden Studis, Studiengänge und Fachbereiche modelliert (aus Gründen der Übersichtlichkeit
einfach als Record-Klassen).</p>
<p>Nun soll pro Fachbereich die Anzahl der Studis ermittelt werden, die bereits 100 ECTS
oder mehr haben. Dazu könnte man über alle Studiengänge im Fachbereich iterieren, und
in der inneren Schleife über alle Studis im Studiengang. Dann filtert man alle Studis,
deren ECTS größer 100 sind und erhöht jeweils den Zähler:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">Studi</span>(String name, <span style="color:#66d9ef">int</span> credits) {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">Studiengang</span>(String name, List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> studis) {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">Fachbereich</span>(String name, List<span style="color:#f92672">&lt;</span>Studiengang<span style="color:#f92672">&gt;</span> studiengaenge) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountFB</span>(Fachbereich fb) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span> count <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (Studiengang sg : fb.<span style="color:#a6e22e">studiengaenge</span>()) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Studi s : sg.<span style="color:#a6e22e">studis</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (s.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&gt;</span> 100) count <span style="color:#f92672">+=</span> 1;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> count;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Dies ist ein Beispiel, welches klassisch in OO-Manier als Iteration über Klassen
realisiert ist. (Inhaltlich ist es vermutlich nicht sooo sinnvoll.)</p>
<h2 id="innere-schleife-mit-streams-umgeschrieben">Innere Schleife mit Streams umgeschrieben</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountSG</span>(Studiengang sg) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> sg.<span style="color:#a6e22e">studis</span>().<span style="color:#a6e22e">stream</span>()
</span></span><span style="display:flex;"><span>                      .<span style="color:#a6e22e">map</span>(Studi::credits)
</span></span><span style="display:flex;"><span>                      .<span style="color:#a6e22e">filter</span>(c <span style="color:#f92672">-&gt;</span> c <span style="color:#f92672">&gt;</span> 100)
</span></span><span style="display:flex;"><span>                      .<span style="color:#a6e22e">count</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountFB2</span>(Fachbereich fb) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span> count <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (Studiengang sg : fb.<span style="color:#a6e22e">studiengaenge</span>()) {
</span></span><span style="display:flex;"><span>        count <span style="color:#f92672">+=</span> getCountSG(sg);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> count;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="erklärung-des-beispiels">Erklärung des Beispiels</h3>
<p>Im Beispiel wurde die innere Schleife in einen Stream ausgelagert.</p>
<p>Mit der Methode <code>Collection#stream()</code> wird aus der Collection ein
neuer Stream erzeugt. Auf diesem wird für jedes Element durch die
Methode <code>map()</code> die Methode <code>Studi#credits()</code> angewendet, was aus
einem Strom von <code>Studi</code> einen Strom von <code>Integer</code> macht. Mit <code>filter()</code>
wird auf jedes Element das Prädikat <code>c -&gt; c &gt; 100</code> angewendet und
alle Elemente aus dem Strom entfernt, die der Bedingung nicht
entsprechen. Am Ende wird mit <code>count()</code> gezählt, wie viele Elemente
im Strom enthalten sind.</p>
<h3 id="was-ist-ein-stream">Was ist ein Stream?</h3>
<p>Ein &quot;Stream&quot; ist ein Strom (Folge) von Daten oder Objekten. In Java wird
die Collections-API für die Speicherung von Daten (Objekten) verwendet.
Die Stream-API dient zur Iteration über diese Daten und entsprechend
zur Verarbeitung der Daten. In Java speichert ein Stream keine Daten.</p>
<p>Das Konzept kommt aus der funktionalen Programmierung und wurde in Java
nachträglich eingebaut (wobei dieser Prozess noch lange nicht abgeschlossen
zu sein scheint).</p>
<p>In der funktionalen Programmierung kennt man die Konzepte &quot;map&quot;, &quot;filter&quot;
und &quot;reduce&quot;: Die Funktion &quot;map()&quot; erhält als Parameter eine Funktion und
wendet diese auf alle Elemente eines Streams an. Die Funktion &quot;filter()&quot;
bekommt ein Prädikat als Parameter und prüft jedes Element im Stream, ob
es dem Prädikat genügt (also ob das Prädikat mit dem jeweiligen Element
zu <code>true</code> evaluiert - die anderen Objekte werden entfernt). Mit &quot;reduce()&quot;
kann man Streams zu einem einzigen Wert zusammenfassen (denken Sie etwa
an das Aufsummieren aller Elemente eines Integer-Streams). Zusätzlich kann
man in der funktionalen Programmierung ohne Probleme unendliche Ströme
darstellen: Die Auswertung erfolgt nur bei Bedarf und auch dann auch nur
so weit wie nötig. Dies nennt man auch &quot;<em>lazy evaluation</em>&quot;.</p>
<p>Die Streams in Java versuchen, diese Konzepte aus der funktionalen Programmierung
in die objektorientierte Programmierung zu übertragen. Ein Stream in Java
hat eine Datenquelle, von wo die Daten gezogen werden - ein Stream speichert
selbst keine Daten. Es gibt &quot;intermediäre Operationen&quot; auf einem Stream,
die die Elemente verarbeiten und das Ergebnis als Stream zurückliefern. Daraus
ergibt sich typische Pipeline-artige Verkettung der Operationen. Allerdings
werden diese Operationen erst durchgeführt, wenn eine &quot;terminale Operation&quot; den
Stream &quot;abschließt&quot;. Ein Stream ohne eine terminale Operation macht also
tatsächlich <em>nichts</em>.</p>
<p>Die Operationen auf dem Stream sind üblicherweise zustandslos, können aber
durchaus auch einen Zustand haben. Dies verhindert üblicherweise die parallele
Verarbeitung der Streams. Operationen sollten aber nach Möglichkeit keine
<em>Seiteneffekte</em> haben, d.h. keine Daten außerhalb des Streams modifizieren.
Operationen dürfen auf keinen Fall die Datenquelle des Streams modifizieren!</p>
<h2 id="erzeugen-von-streams">Erzeugen von Streams</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> l1 <span style="color:#f92672">=</span> List.<span style="color:#a6e22e">of</span>(<span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#e6db74">&#34;World&#34;</span>, <span style="color:#e6db74">&#34;foo&#34;</span>, <span style="color:#e6db74">&#34;bar&#34;</span>, <span style="color:#e6db74">&#34;wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>Stream<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s1 <span style="color:#f92672">=</span> l1.<span style="color:#a6e22e">stream</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Stream<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s2 <span style="color:#f92672">=</span> Stream.<span style="color:#a6e22e">of</span>(<span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#e6db74">&#34;World&#34;</span>, <span style="color:#e6db74">&#34;foo&#34;</span>, <span style="color:#e6db74">&#34;bar&#34;</span>, <span style="color:#e6db74">&#34;wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Random random <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Random();
</span></span><span style="display:flex;"><span>Stream<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> s3 <span style="color:#f92672">=</span> Stream.<span style="color:#a6e22e">generate</span>(random::nextInt);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Pattern pattern <span style="color:#f92672">=</span> Pattern.<span style="color:#a6e22e">compile</span>(<span style="color:#e6db74">&#34; &#34;</span>);
</span></span><span style="display:flex;"><span>Stream<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s4 <span style="color:#f92672">=</span> pattern.<span style="color:#a6e22e">splitAsStream</span>(<span style="color:#e6db74">&#34;Hello world! foo bar wuppie!&#34;</span>);</span></span></code></pre></div>
<p>Dies sind möglicherweise die wichtigsten Möglichkeiten, in Java einen Stream
zu erzeugen.</p>
<p>Ausgehend von einer Klasse aus der Collection-API kann man die Methode
<code>Collection#stream()</code> aufrufen und bekommt einen seriellen Stream.</p>
<p>Alternativ bietet das Interface <code>Stream</code> verschiedene statische Methoden wie
<code>Stream.of()</code> an, mit deren Hilfe Streams angelegt werden können. Dies funktioniert
auch mit Arrays ...</p>
<p>Und schließlich kann man per <code>Stream.generate()</code> einen Stream anlegen, wobei
als Argument ein &quot;Supplier&quot; (Interface <code>java.util.function.Supplier&lt;T&gt;</code>) übergeben
werden muss. Dieses Argument wird dann benutzt, um die Daten für den Stream zu
generieren.</p>
<p>Wenn man aufmerksam hinschaut, findet man an verschiedensten Stellen die
Möglichkeit, die Daten per Stream zu verarbeiten, u.a. bei regulären Ausdrücken.</p>
<p>Man kann per <code>Collection#parallelStream()</code> auch parallele Streams erzeugen, die
intern das &quot;Fork&amp;Join-Framework&quot; nutzen. Allerdings sollte man nur dann parallele
Streams anlegen, wenn dadurch tatsächlich Vorteile durch die Parallelisierung zu
erwarten sind (Overhead!).</p>
<h2 id="intermediäre-operationen-auf-streams">Intermediäre Operationen auf Streams</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">dummy</span>(Studiengang sg) {
</span></span><span style="display:flex;"><span>    sg.<span style="color:#a6e22e">studis</span>().<span style="color:#a6e22e">stream</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">peek</span>(s <span style="color:#f92672">-&gt;</span> System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Looking at: &#34;</span> <span style="color:#f92672">+</span> s.<span style="color:#a6e22e">name</span>()))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">map</span>(Studi::credits)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">peek</span>(c <span style="color:#f92672">-&gt;</span> System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;This one has: &#34;</span> <span style="color:#f92672">+</span> c <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; ECTS&#34;</span>))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">filter</span>(c <span style="color:#f92672">-&gt;</span> c <span style="color:#f92672">&gt;</span> 5)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">peek</span>(c <span style="color:#f92672">-&gt;</span> System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Filtered: &#34;</span> <span style="color:#f92672">+</span> c))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">sorted</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">forEach</span>(System.<span style="color:#a6e22e">out</span>::println);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>An diesem (weitestgehend sinnfreien) Beispiel werden einige intermediäre Operationen
demonstriert.</p>
<p>Die Methode <code>peek()</code> liefert einen Stream zurück, die aus den Elementen des Eingabestroms
bestehen. Auf jedes Element wird die Methode <code>void accept(T)</code> des <code>Consumer&lt;T&gt;</code> angewendet
(Argument der Methode), was aber nicht zu einer Änderung der Daten führt.
<strong>Hinweis</strong>: Diese Methode dient vor allem zu Debug-Zwecken! Durch den Seiteneffekt kann
die Methode eine schlechtere Laufzeit zur Folge haben oder sogar eine sonst mögliche
parallele Verarbeitung verhindern oder durch eine parallele Verarbeitung verwirrende
Ergebnisse zeigen!</p>
<p>Die Methode <code>map()</code> liefert ebenfalls einen Stream zurück, der durch die Anwendung der Methode
<code>R apply(T)</code> der als Argument übergebenen <code>Function&lt;T,R&gt;</code> auf jedes Element des Eingabestroms
entsteht. Damit lassen sich die Elemente des ursprünglichen Streams verändern; für jedes Element
gibt es im Ergebnis-Stream ebenfalls ein Element (der Typ ändert sich, aber nicht die Anzahl
der Elemente).</p>
<p>Mit der Methode <code>filter()</code> wird ein Stream erzeugt, der alle Objekte des Eingabe-Streams
enthält, auf denen die Anwendung der Methode <code>boolean test(T)</code> des Arguments <code>Predicate&lt;T&gt;</code>
zu <code>true</code> evaluiert (der Typ und Inhalt der Elemente ändert sich nicht, aber die Anzahl der
Elemente).</p>
<p>Mit <code>sorted()</code> wird ein Stream erzeugt, der die Elemente des Eingabe-Streams sortiert
(existiert auch mit einem <code>Comparator&lt;T&gt;</code> als Parameter).</p>
<p>Diese Methoden sind alles <strong>intermediäre</strong> Operationen. Diese arbeiten auf einem Stream und
erzeugen einen neuen Stream und werden erst dann ausgeführt, wenn eine terminale Operation den
Stream abschließt.</p>
<p>Dabei sind die gezeigten intermediären Methoden bis auf <code>sorted()</code> ohne inneren Zustand.
<code>sorted()</code> ist eine Operation mit innerem Zustand (wird für das Sortieren benötigt). Dies
kann ordentlich in Speicher und Zeit zuschlagen und u.U. nicht/nur schlecht parallelisierbar
sein. Betrachten Sie den fiktiven parallelen Stream <code>stream.parallel().sorted().skip(42)</code>:
Hier müssen erst <em>alle</em> Elemente sortiert werden, bevor mit <code>skip(42)</code> die ersten 42 Elemente
entfernt werden. Dies kann auch nicht mehr parallel durchgeführt werden.</p>
<p>Die Methode <code>forEach()</code> schließlich ist eine <strong>terminale</strong> Operation, die auf jedes Element des
Eingabe-Streams die Methode <code>void accept(T)</code> des übergebenen <code>Consumer&lt;T&gt;</code> anwendet. Diese
Methode ist eine <strong>terminale Operation</strong>, d.h. sie führt zur Auswertung der anderen <em>intermediären</em>
Operationen und schließt den Stream ab.</p>
<h2 id="was-tun-wenn-eine-methode-streams-zurückliefert">Was tun, wenn eine Methode Streams zurückliefert</h2>
<p>Wir konnten vorhin nur die innere Schleife in eine Stream-basierte Verarbeitung
umbauen. Das Problem ist: Die äußere Schleife würde einen Stream liefern (Stream
von Studiengängen), auf dem wir die <code>map</code>-Funktion anwenden müssten und darin dann
für jeden Studiengang einen (inneren) Stream mit den Studis eines Studiengangs
verarbeiten müssten.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountSG</span>(Studiengang sg) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> sg.<span style="color:#a6e22e">studis</span>().<span style="color:#a6e22e">stream</span>().<span style="color:#a6e22e">map</span>(Studi::credits).<span style="color:#a6e22e">filter</span>(c <span style="color:#f92672">-&gt;</span> c <span style="color:#f92672">&gt;</span> 100).<span style="color:#a6e22e">count</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountFB2</span>(Fachbereich fb) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span> count <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (Studiengang sg : fb.<span style="color:#a6e22e">studiengaenge</span>()) {
</span></span><span style="display:flex;"><span>        count <span style="color:#f92672">+=</span> getCountSG(sg);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> count;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Dafür ist die Methode <code>flatMap()</code> die Lösung. Diese Methode bekommt als Argument
ein Objekt vom Typ <code>Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt;</code> mit einer
Methode <code>Stream&lt;? extends R&gt; apply(T)</code>. Die Methode <code>flatMap()</code> verarbeitet den
Stream in zwei Schritten:</p>
<ol>
<li>
<p>Mappe über alle Elemente des Eingabe-Streams mit der Funktion. Im Beispiel würde
also aus einem <code>Stream&lt;Studiengang&gt;</code> jeweils ein <code>Stream&lt;Stream&lt;Studi&gt;&gt;</code>, also
alle <code>Studiengang</code>-Objekte werden durch je ein <code>Stream&lt;Studi&gt;</code>-Objekt ersetzt.
Wir haben jetzt also einen Stream von <code>Stream&lt;Studi&gt;</code>-Objekten.</p>
</li>
<li>
<p>&quot;Klopfe den Stream wieder flach&quot;, d.h. nimm die einzelnen <code>Studi</code>-Objekte aus
den <code>Stream&lt;Studi&gt;</code>-Objekten und setze diese stattdessen in den Stream. Das
Ergebnis ist dann wie gewünscht ein <code>Stream&lt;Studi&gt;</code> (Stream mit <code>Studi</code>-Objekten).</p>
</li>
</ol>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountFB3</span>(Fachbereich fb) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> fb.<span style="color:#a6e22e">studiengaenge</span>().<span style="color:#a6e22e">stream</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">flatMap</span>(sg <span style="color:#f92672">-&gt;</span> sg.<span style="color:#a6e22e">studis</span>().<span style="color:#a6e22e">stream</span>())
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">map</span>(Studi::credits)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">filter</span>(c <span style="color:#f92672">-&gt;</span> c <span style="color:#f92672">&gt;</span> 100)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">count</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Zum direkten Vergleich hier noch einmal der ursprüngliche Code mit zwei
verschachtelten Schleifen und entsprechenden Hilfsvariablen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountFB</span>(Fachbereich fb) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span> count <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (Studiengang sg : fb.<span style="color:#a6e22e">studiengaenge</span>()) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Studi s : sg.<span style="color:#a6e22e">studis</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (s.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&gt;</span> 100) count <span style="color:#f92672">+=</span> 1;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> count;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="streams-abschließen-terminale-operationen">Streams abschließen: Terminale Operationen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Stream<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s <span style="color:#f92672">=</span> Stream.<span style="color:#a6e22e">of</span>(<span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#e6db74">&#34;World&#34;</span>, <span style="color:#e6db74">&#34;foo&#34;</span>, <span style="color:#e6db74">&#34;bar&#34;</span>, <span style="color:#e6db74">&#34;wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">long</span> count <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">count</span>();
</span></span><span style="display:flex;"><span>s.<span style="color:#a6e22e">forEach</span>(System.<span style="color:#a6e22e">out</span>::println);
</span></span><span style="display:flex;"><span>String first <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">findFirst</span>().<span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>Boolean b <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">anyMatch</span>(e <span style="color:#f92672">-&gt;</span> e.<span style="color:#a6e22e">length</span>() <span style="color:#f92672">&gt;</span> 3);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s1 <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">collect</span>(Collectors.<span style="color:#a6e22e">toList</span>());
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s2 <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">toList</span>();   <span style="color:#75715e">// ab Java16</span>
</span></span><span style="display:flex;"><span>Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s3 <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">collect</span>(Collectors.<span style="color:#a6e22e">toSet</span>());
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s4 <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">collect</span>(Collectors.<span style="color:#a6e22e">toCollection</span>(LinkedList::<span style="color:#66d9ef">new</span>));</span></span></code></pre></div>
<p>Streams müssen mit <strong><em>einer</em> terminalen Operation</strong> abgeschlossen werden, damit die Verarbeitung
tatsächlich angestoßen wird (<em>lazy evaluation</em>).</p>
<p>Es gibt viele verschiedene terminale Operationen. Wir haben bereits <code>count()</code> und <code>forEach()</code>
gesehen. In der Sitzung zu <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional.html">&ldquo;Optionals&rdquo;</a>
werden wir noch <code>findFirst()</code> näher kennenlernen.</p>
<p>Daneben gibt es beispielsweise noch <code>allMatch()</code>, <code>anyMatch()</code> und <code>noneMatch()</code>, die jeweils
ein Prädikat testen und einen Boolean zurückliefern (matchen alle, mind. eines oder keines der
Objekte im Stream).</p>
<p>Mit <code>min()</code> und <code>max()</code> kann man sich das kleinste und das größte Element des Streams liefern
lassen. Beide Methoden benötigen dazu einen <code>Comparator&lt;T&gt;</code> als Parameter.</p>
<p>Mit der Methode <code>collect()</code> kann man eine der drei Methoden aus <code>Collectors</code> über den Stream
laufen lassen und eine <code>Collection</code> erzeugen lassen:</p>
<ol>
<li><code>toList()</code> sammelt die Elemente in ein <code>List</code>-Objekt (bzw. direkt mit <code>stream.toList()</code> (ab Java16))</li>
<li><code>toSet()</code> sammelt die Elemente in ein <code>Set</code>-Objekt</li>
<li><code>toCollection()</code> sammelt die Elemente durch Anwendung der Methode <code>T get()</code> des übergebenen
<code>Supplier&lt;T&gt;</code>-Objekts auf</li>
</ol>
<p>Die ist nur die sprichwörtliche &quot;Spitze des Eisbergs&quot;! Es gibt viele weitere Möglichkeiten, sowohl
bei den intermediären als auch den terminalen Operationen. Schauen Sie in die Dokumentation!</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/streams/Demo.java" target="_blank"><span class="title">Demo: streams.Demo</span></a></span></div>
<h2 id="spielregeln">Spielregeln</h2>
<ul>
<li>
<p>Operationen dürfen nicht die Stream-Quelle modifizieren</p>
</li>
<li>
<p>Operationen können die Werte im Stream ändern (<code>map</code>) oder die Anzahl (<code>filter</code>)</p>
</li>
<li>
<p>Keine Streams in Attributen/Variablen speichern oder als Argumente übergeben: Sie könnten bereits &quot;gebraucht&quot; sein!</p>
<p>=&gt; Ein Stream sollte immer sofort nach der Erzeugung benutzt werden</p>
</li>
<li>
<p>Operationen auf einem Stream sollten keine Seiteneffekte (Veränderungen von Variablen/Attributen außerhalb des Streams) haben
(dies verhindert u.U. die parallele Verarbeitung)</p>
</li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<p><code>Stream&lt;T&gt;</code>: Folge von Objekten vom Typ <code>T</code>, Verarbeitung &quot;lazy&quot;
(Gegenstück zu <code>Collection&lt;T&gt;</code>: Dort werden Daten <strong>gespeichert</strong>, hier werden Daten <strong>verarbeitet</strong>)</p>
<ul>
<li>
<p>Neuen Stream anlegen: <code>Collection#stream()</code> oder <code>Stream.of()</code> ...</p>
</li>
<li>
<p>Intermediäre Operationen: <code>peek()</code>, <code>map()</code>, <code>flatMap()</code>, <code>filter()</code>, <code>sorted()</code> ...</p>
</li>
<li>
<p>Terminale Operationen: <code>count()</code>, <code>forEach()</code>, <code>allMatch()</code>, <code>collect()</code> ...</p>
<ul>
<li><code>collect(Collectors.toList())</code></li>
<li><code>collect(Collectors.toSet())</code></li>
<li><code>collect(Collectors.toCollection())</code> (mit <code>Supplier&lt;T&gt;</code>)</li>
</ul>
</li>
<li>
<p>Streams speichern keine Daten</p>
</li>
<li>
<p>Intermediäre Operationen laufen erst bei Abschluss des Streams los</p>
</li>
<li>
<p>Terminale Operation führt zur Verarbeitung und Abschluss des Streams</p>
</li>
</ul>
<p>Schöne Doku: <a href="https://dev.java/learn/api/streams/" rel="external" target="_blank">&quot;The Stream API&quot;</a>, und auch
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/stream/package-summary.html" rel="external" target="_blank">&quot;Package java.util.stream&quot;</a>.</p>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106528&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Stream-API (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachten Sie den folgenden Java-Code:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">record</span> <span style="color:#a6e22e">Cat</span>(<span style="color:#66d9ef">int</span> weight){};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Cat<span style="color:#f92672">&gt;</span> clouder <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(100));  clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(1));  clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(10));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        sumOverWeight(8, clouder);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sumOverWeight</span>(<span style="color:#66d9ef">int</span> threshold, List<span style="color:#f92672">&lt;</span>Cat<span style="color:#f92672">&gt;</span> cats) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> result <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Cat c : cats) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> weight <span style="color:#f92672">=</span> c.<span style="color:#a6e22e">weight</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (weight <span style="color:#f92672">&gt;</span> threshold) {
</span></span><span style="display:flex;"><span>                result <span style="color:#f92672">+=</span> weight;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Schreiben Sie die Methode <code>sumOverWeight</code> unter Beibehaltung der Funktionalität so
um, dass statt der <code>for</code>-Schleife und der <code>if</code>-Abfrage Streams und Stream-Operationen
eingesetzt werden. Nutzen Sie passende Lambda-Ausdrücke und nach Möglichkeit
Methodenreferenzen.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_LernJava'>[LernJava] <a href='https://dev.java/learn/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Learn Java</strong></a><br>Oracle Corporation, 2022.<br><em>Tutorials \> The Stream API</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kap. 17.3 - 17.6: Java Stream-API</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Record-Klassen</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Häufig schreibt man relativ viel <em>Boiler Plate Code</em>, um einfach ein paar Daten plus den
Konstruktor und die Zugriffsmethoden zu kapseln. Und selbst wenn die IDE dies zum Teil
abnehmen kann - lesen muss man diesen Overhead trotzdem noch.</p>
<p>Für den Fall von Klassen mit <code>final</code> Attributen wurden in Java14 die <strong>Record-Klassen</strong>
eingeführt. Statt dem Schlüsselwort <code>class</code> wird das neue Schlüsselwort <code>record</code> verwendet.
Nach dem Klassennamen kommen in runden Klammern die &quot;Komponenten&quot; - eine Auflistung der
Parameter für den Standardkonstruktor (Typ, Name). Daraus wird automatisch ein &quot;kanonischer
Konstruktor&quot; mit exakt diesen Parametern generiert. Es werden zusätzlich <code>private final</code>
Attribute generiert für jede Komponente, und diese werden durch den kanonischen Konstruktor
gesetzt. Außerdem wird für jedes Attribut automatisch ein Getter mit dem Namen des Attributs
generiert (also ohne den Präfix &quot;get&quot;).</p>
<p>Beispiel:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiR</span>(String name, <span style="color:#66d9ef">int</span> credits) {}</span></span></code></pre></div>
<p>Der Konstruktor und die Getter können überschrieben werden, es können auch eigene Methoden
definiert werden (eigene Konstruktoren <em>müssen</em> den kanonischen Konstruktor aufrufen). Es
gibt außer den über die Komponenten definierten Attribute keine weiteren Attribute. Da eine
Record-Klasse intern von <code>java.lang.Record</code> ableitet, kann eine Record-Klasse nicht von
weiteren Klassen ableiten (erben). Man kann aber beliebig viele Interfaces implementieren.
Record-Klassen sind implizit final, d.h. man nicht von Record-Klassen erben.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/5RMhdCsZL6Y' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Record-Klassen</a></li> <li><a href='https://youtu.be/jWBAXWH0MUc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Record-Klassen</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/461caa1e97e1655109ce66647c169cf01b35d4b268bfaa64a6289c505f247a5ebfde054a98b08a1b5235195ff21b1fffa4d12e3968c7a68a0f001b0dabe6b695' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Record-Klassen</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Record-Klassen sind final</li> <li>(K2) Record-Klassen haben einen kanonischen Konstruktor</li> <li>(K2) Die Attribute von Record-Klassen sind final und werden automatisch angelegt und über den Konstruktor gesetzt</li> <li>(K2) Die Getter in Record-Klassen haben die Namen und Typen der Komponenten, also keinen Präfix 'get'</li> <li>(K2) Der kanonische Konstruktor kann ergänzt werden</li> <li>(K2) Es können weitere Methoden definiert werden</li> <li>(K2) Record-Klassen können nicht von anderen Klassen erben, können aber Interfaces implementieren</li> <li>(K3) Einsatz von Record-Klassen</li></ul>
  </div>
</div>




    <h2 id="motivation-klasse-studi">Motivation; Klasse Studi</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> String name;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> credits;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Studi</span>(String name, <span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">=</span> credits;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getName</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getCredits</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> credits;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="klasse-studi-als-record">Klasse Studi als Record</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiR</span>(String name, <span style="color:#66d9ef">int</span> credits) {}</span></span></code></pre></div>
<ul>
<li>
<p>Immutable Klasse mit Feldern <code>String name</code> und <code>int credits</code>
=&gt; &quot;<code>(String name, int credits)</code>&quot; werden &quot;Komponenten&quot; des Records genannt</p>
</li>
<li>
<p>Standardkonstruktor setzt diese Felder (&quot;Kanonischer Konstruktor&quot;)</p>
</li>
<li>
<p>Getter für beide Felder:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">name</span>() { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span>; }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">credits</span>() { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span>; }</span></span></code></pre></div>
</li>
</ul>
<p>Record-Klassen wurden in Java14 eingeführt und werden immer wieder in
neuen Releases erweitert/ergänzt.</p>
<p>Der kanonische Konstruktor hat das Aussehen wie die Record-Deklaration, im
Beispiel also <code>public StudiR(String name, int credits)</code>. Dabei werden die
Komponenten über eine Kopie der Werte initialisiert.</p>
<p>Für die Komponenten werden automatisch private Attribute mit dem selben
Namen angelegt.</p>
<p>Für die Komponenten werden automatisch Getter angelegt. Achtung: Die Namen
entsprechen denen der Komponenten, es fehlt also der übliche &quot;get&quot;-Präfix!</p>
<h2 id="eigenschaften-und-einschränkungen-von-record-klassen">Eigenschaften und Einschränkungen von Record-Klassen</h2>
<ul>
<li>
<p>Records erweitern implizit die Klasse <code>java.lang.Record</code>:
Keine andere Klassen mehr erweiterbar! (Interfaces kein Problem)</p>
</li>
<li>
<p>Record-Klassen sind implizit final</p>
</li>
<li>
<p>Keine weiteren (Instanz-) Attribute definierbar (nur die Komponenten)</p>
</li>
<li>
<p>Keine Setter definierbar für die Komponenten: Attribute sind final</p>
</li>
<li>
<p>Statische Attribute mit Initialisierung erlaubt</p>
</li>
</ul>
<h2 id="records-prüfungen-im-konstruktor">Records: Prüfungen im Konstruktor</h2>
<p>Der Konstruktor ist erweiterbar:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiS</span>(String name, <span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">StudiS</span>(String name, <span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (name <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) { <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException(<span style="color:#e6db74">&#34;Name cannot be null!&#34;</span>); }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (credits <span style="color:#f92672">&lt;</span> 0) { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">=</span> 0; }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">=</span> credits; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>In dieser Form muss man die Attribute selbst setzen.</p>
<p>Alternativ kann man die &quot;kompakte&quot; Form nutzen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiT</span>(String name, <span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> StudiT {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (name <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) { <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException(<span style="color:#e6db74">&#34;Name cannot be null!&#34;</span>); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (credits <span style="color:#f92672">&lt;</span> 0) { credits <span style="color:#f92672">=</span> 0; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>In der kompakten Form kann man nur die Werte der Parameter des Konstruktors ändern.
Das Setzen der Attribute ergänzt der Compiler nach dem eigenen Code.</p>
<p>Es sind weitere Konstruktoren definierbar, diese <em>müssen</em> den kanonischen Konstruktor
aufrufen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#a6e22e">StudiT</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>(<span style="color:#e6db74">&#34;&#34;</span>, 42);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="getter-und-methoden">Getter und Methoden</h2>
<p>Getter werden vom Compiler automatisch generiert. Dabei entsprechen die Methoden-Namen
den Namen der Attribute:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiR</span>(String name, <span style="color:#66d9ef">int</span> credits) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>    StudiR r <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StudiR(<span style="color:#e6db74">&#34;Sabine&#34;</span>, 75);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> r.<span style="color:#a6e22e">credits</span>();
</span></span><span style="display:flex;"><span>    String y <span style="color:#f92672">=</span> r.<span style="color:#a6e22e">name</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Getter überschreibbar und man kann weitere Methoden definieren:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiT</span>(String name, <span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">credits</span>() { <span style="color:#66d9ef">return</span> credits <span style="color:#f92672">+</span> 42; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">wuppie</span>() { System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;WUPPIE&#34;</span>); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Die Komponenten/Attribute sind aber <code>final</code> und können nicht über Methoden
geändert werden!</p>
<h2 id="beispiel-aus-den-challenges">Beispiel aus den Challenges</h2>
<p>In den Challenges zum Thema Optional gibt es die Klasse <code>Katze</code> in den
<a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/challenges/optional/Katze.java" rel="external" target="_blank">Vorgaben</a>.</p>
<p>Die Katze wurde zunächst &quot;klassisch&quot; modelliert: Es gibt drei Eigenschaften <code>name</code>,
<code>gewicht</code>und <code>lieblingsBox</code>. Ein Konstruktor setzt diese Felder und es gibt drei
Getter für die einzelnen Eigenschaften. Das braucht 18 Zeilen Code (ohne Kommentare
Leerzeilen). Zudem erzeugt der Boilerplate-Code relativ viel &quot;visual noise&quot;, so dass
der eigentliche Kern der Klasse schwerer zu erkennen ist.</p>
<p>In einem Refactoring wurde diese Klasse durch eine äquivalente Record-Klasse ersetzt,
die nur noch 2 Zeilen Code (je nach Code-Style auch nur 1 Zeile) benötigt. Gleichzeitig
wurde die Les- und Wartbarkeit deutlich verbessert.</p>
<p><a href="#R-image-36b5cdd9166cc337a2e7724bf5f2bd71" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/records/screenshot_katze.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-36b5cdd9166cc337a2e7724bf5f2bd71"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/records/screenshot_katze.png?width=auto&height=auto"></a></p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>Records sind immutable Klassen:
<ul>
<li><code>final</code> Attribute (entsprechend den Komponenten)</li>
<li>Kanonischer Konstruktor</li>
<li>Automatische Getter (Namen wie Komponenten)</li>
</ul>
</li>
<li>Konstruktoren und Methoden können ergänzt/überschrieben werden</li>
<li>Keine Vererbung von Klassen möglich (kein <code>extends</code>)</li>
</ul>
<p>Schöne Doku: <a href="https://dev.java/learn/using-record-to-model-immutable-data/" rel="external" target="_blank">&quot;Using Record to Model Immutable Data&quot;</a>.</p>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106527&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Record-Klassen (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachen Sie den folgenden Code:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Person</span> {
</span></span><span style="display:flex;"><span>    String <span style="color:#a6e22e">getName</span>();
</span></span><span style="display:flex;"><span>    Date <span style="color:#a6e22e">getBirthday</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span> <span style="color:#66d9ef">implements</span> Person {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> SimpleDateFormat DATE_FORMAT <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SimpleDateFormat(<span style="color:#e6db74">&#34;dd.MM.yyyy&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> String name;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Date birthday;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Student</span>(String name, String birthday) <span style="color:#66d9ef">throws</span> ParseException {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">birthday</span> <span style="color:#f92672">=</span> DATE_FORMAT.<span style="color:#a6e22e">parse</span>(birthday);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getName</span>() { <span style="color:#66d9ef">return</span> name; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Date <span style="color:#a6e22e">getBirthday</span>() { <span style="color:#66d9ef">return</span> birthday; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Schreiben Sie die Klasse <code>Student</code> in eine Record-Klasse um. Was müssen Sie zusätzlich noch tun,
damit die aktuelle API erhalten bleibt?</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_LernJava'>[LernJava] <a href='https://dev.java/learn/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Learn Java</strong></a><br>Oracle Corporation, 2022.<br><em>Tutorials \> Using Record to Model Immutable Data</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Optional</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Häufig hat man in Methoden den Fall, dass es keinen Wert gibt, und man liefert dann
<code>null</code> als &quot;kein Wert vorhanden&quot; zurück. Dies führt dazu, dass die Aufrufer eine
entsprechende <code>null</code>-Prüfung für die Rückgabewerte durchführen müssen, bevor sie
das Ergebnis nutzen können.</p>
<p><code>Optional</code> schließt elegant den Fall &quot;kein Wert vorhanden&quot; ein: Es kann mit der Methode
<code>Optional.ofNullable()</code> das Argument in ein Optional verpacken (Argument != <code>null</code>)
oder ein <code>Optional.empty()</code> zurückliefern (&quot;leeres&quot; Optional, wenn Argument == <code>null</code>).</p>
<p>Man kann Optionals prüfen mit <code>isEmpty()</code> und <code>ifPresent()</code> und dann direkt mit
<code>ifPresent()</code>, <code>orElse()</code> und <code>orElseThrow()</code> auf den verpackten Wert zugreifen.
Besser ist aber der Zugriff über die Stream-API von <code>Optional</code>: <code>map()</code>, <code>filter</code>,
<code>flatMap()</code>, ...</p>
<p><code>Optional</code> ist vor allem für Rückgabewerte gedacht, die den Fall &quot;kein Wert vorhanden&quot;
einschließen sollen. Attribute, Parameter und Sammlungen sollten nicht <code>Optional</code>-Referenzen
speichern, sondern &quot;richtige&quot; (unverpackte) Werte (und eben zur Not <code>null</code>). <code>Optional</code>
ist kein Ersatz für <code>null</code>-Prüfung von Methoden-Parametern (nutzen Sie hier beispielsweise
passende Annotationen). <code>Optional</code> ist auch kein Ersatz für vernünftiges Exception-Handling
im Fall, dass etwas Unerwartetes passiert ist. Liefern Sie <strong>niemals</strong> <code>null</code> zurück, wenn
der Rückgabetyp der Methode ein <code>Optional</code> ist!</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/JDG_hUSBfSA' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Optional</a></li> <li><a href='https://youtu.be/vL2c0iB4uSk' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Optional</a></li> <li><a href='https://youtu.be/vyN-vOV9_CU' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Optional: Beispiel aus der Praxis im PM-Dungeon</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/b62e544bff3a9a25982052bd761b9971f7e67caca90e3ed66c2b794b95d35c2c479f8d72189159345ac018e34ec55866c5558a256ce63b5e9c43a30fc8787d1b' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Optional</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Optionals sind kein Ersatz für <code>null</code>-Prüfung!</li> <li>(K2) Optionals sollen nicht für Attribute oder Parameter genutzt werden</li> <li>(K2) Es darf kein <code>null</code> zurückgeliefert werden, wenn der Rückgabetyp ein Optional ist</li> <li>(K2) Optionals und <code>null</code> sind kein Ersatz für Exception-Handling</li> <li>(K3) Einsatz von <code>Optional</code> in Rückgabewerten</li> <li>(K3) Erzeugen von Optionals mit <code>Optional.ofNullable()</code></li> <li>(K3) Zugriff auf Optionals entweder direkt oder per Stream-API</li></ul>
  </div>
</div>




    <h2 id="motivation">Motivation</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSF</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Set<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Studi <span style="color:#a6e22e">getBestStudi</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sl <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;  <span style="color:#75715e">// Fehler: Es gibt noch keine Sammlung</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Studi best <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Studi s : sl) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (best <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) best <span style="color:#f92672">=</span> s;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (best.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&lt;</span> s.<span style="color:#a6e22e">credits</span>()) best <span style="color:#f92672">=</span> s;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> best;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>    LSF lsf <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> LSF();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Studi best <span style="color:#f92672">=</span> lsf.<span style="color:#a6e22e">getBestStudi</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (best <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>        String name <span style="color:#f92672">=</span> best.<span style="color:#a6e22e">name</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (name <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// mach was mit dem Namen ...</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="problem-null-wird-an-zu-vielen-stellen-genutzt">Problem: <code>null</code> wird an (zu) vielen Stellen genutzt</h3>
<ul>
<li>Es gibt keinen Wert (&quot;not found&quot;)</li>
<li>Felder wurden (noch) nicht initialisiert</li>
<li>Es ist ein Problem oder etwas Unerwartetes aufgetreten</li>
</ul>
<p>=&gt; Parameter und Rückgabewerte müssen stets auf <code>null</code> geprüft werden
(oder Annotationen wie <code>@NotNull</code> eingesetzt werden ...)</p>
<h3 id="lösung">Lösung</h3>
<ul>
<li><code>Optional&lt;T&gt;</code> für Rückgabewerte, die &quot;kein Wert vorhanden&quot; mit einschließen
(statt <code>null</code> bei Abwesenheit von Werten)</li>
<li><code>@NotNull</code>/<code>@Nullable</code> für Parameter einsetzen (oder separate Prüfung)</li>
<li>Exceptions werfen in Fällen, wo ein Problem aufgetreten ist</li>
</ul>
<h3 id="anmerkungen">Anmerkungen</h3>
<ul>
<li>Verwendung von <code>null</code> auf Attribut-Ebene (Klassen-interne Verwendung) ist okay!</li>
<li><code>Optional&lt;T&gt;</code> ist <strong>kein</strong> Ersatz für <code>null</code>-Checks!</li>
<li><code>null</code> ist <strong>kein</strong> Ersatz für vernünftiges Error-Handling!
Das häufig zu beobachtende &quot;Irgendwas Unerwartetes ist passiert, hier ist <code>null</code>&quot;
ist ein <strong>Anti-Pattern</strong>!</li>
</ul>
<h3 id="beispiel-aus-der-praxis-im-pm-dungeon">Beispiel aus der Praxis im PM-Dungeon</h3>
<p>Schauen Sie sich einmal das Review zu den <code>ecs.components.ai.AITools</code> in
<a href="https://github.com/Dungeon-CampusMinden/Dungeon/pull/128#pullrequestreview-1254025874" rel="external" target="_blank">https://github.com/Dungeon-CampusMinden/Dungeon/pull/128#pullrequestreview-1254025874</a>
an.</p>
<p><a href="#R-image-f190821d0cb4b2093c7aacded1962940" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review1.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f190821d0cb4b2093c7aacded1962940"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review1.png?width=auto&height=auto"></a></p>
<p>Die Methode <code>AITools#calculateNewPath</code> soll in der Umgebung einer als Parameter
übergebenen Entität nach einem Feld (<code>Tile</code>) suchen, welches für die Entität
betretbar ist und einen Pfad von der Position der Entität zu diesem Feld an den
Aufrufer zurückliefern.</p>
<p>Zunächst wird in der Entität nach einer <code>PositionComponent</code> und einer <code>VelocityComponent</code>
gesucht. Wenn es (eine) diese(r) Components nicht in der Entität gibt, wird der Wert
<code>null</code> an den Aufrufer von <code>AITools#calculateNewPath</code> zurückgeliefert.
(<em>Anmerkung</em>: Interessanterweise wird in der Methode nicht mit der <code>VelocityComponent</code>
gearbeitet.)</p>
<p>Dann wird in der <code>PositionComponent</code> die Position der Entität im aktuellen Level
abgerufen. In einer Schleife werden alle Felder im gegebenen Radius in eine Liste
gespeichert.
(<em>Anmerkung</em>: Da dies über die <code>float</code>-Werte passiert und nicht über die Feld-Indizes
wird ein <code>Tile</code> u.U. recht oft in der Liste abgelegt. Können Sie sich hier einfache
Verbesserungen überlegen?)</p>
<p>Da <code>level.getTileAt()</code> offenbar als Antwort auch <code>null</code> zurückliefern kann, werden
nun zunächst per <code>tiles.removeIf(Objects::isNull);</code> all diese <code>null</code>-Werte wieder aus
der Liste entfernt. Danach erfolgt die Prüfung, ob die verbleibenden Felder betretbar
sind und nicht-betretbare Felder werden entfernt.</p>
<p>Aus den verbleibenden (betretbaren) Feldern in der Liste wird nun eines zufällig
ausgewählt und per <code>level.findPath()</code> ein Pfad von der Position der Entität zu diesem
Feld berechnet und zurückgeliefert.
(<em>Anmerkung</em>: Hier wird ein zufälliges Tile in der Liste der umgebenden Felder gewählt,
von diesem die Koordinaten bestimmt, und dann noch einmal aus dem Level das dazugehörige
Feld geholt - dabei hatte man die Referenz auf das Feld bereits in der Liste. Können
Sie sich hier eine einfache Verbesserung überlegen?)</p>
<p>Zusammengefasst:</p>
<ul>
<li>Die als Parameter <code>entity</code> übergebene Referenz darf offenbar <em>nicht</em> <code>null</code> sein.
Die ersten beiden Statements in der Methode rufen auf dieser Referenz Methoden
auf, was bei einer <code>null</code>-Referenz zu einer <code>NullPointer</code>-Exception führen
würde. Hier wäre <code>null</code> ein Fehlerzustand.</li>
<li><code>entity.getComponent()</code> kann offenbar <code>null</code> zurückliefern, wenn die gesuchte
Component nicht vorhanden ist. Hier wird <code>null</code> als &quot;kein Wert vorhanden&quot;
genutzt, was dann nachfolgende <code>null</code>-Checks notwendig macht.</li>
<li>Wenn es die gewünschten Components nicht gibt, wird dem Aufrufer der Methode
<code>null</code> zurückgeliefert. Hier ist nicht ganz klar, ob das einfach nur &quot;kein
Wert vorhanden&quot; ist oder eigentlich ein Fehlerzustand?</li>
<li><code>level.getTileAt()</code> kann offenbar <code>null</code> zurückliefern, wenn kein Feld an der
Position vorhanden ist. Hier wird <code>null</code> wieder als &quot;kein Wert vorhanden&quot;
genutzt, was dann nachfolgende <code>null</code>-Checks notwendig macht (Entfernen aller
<code>null</code>-Referenzen aus der Liste).</li>
<li><code>level.findPath()</code> kann auch wieder <code>null</code> zurückliefern, wenn kein Pfad berechnet
werden konnte. Hier ist wieder nicht ganz klar, ob das einfach nur &quot;kein Wert
vorhanden&quot; ist oder eigentlich ein Fehlerzustand? Man könnte beispielsweise in
diesem Fall ein anderes Feld probieren?</li>
</ul>
<p>Der Aufrufer bekommt also eine <code>NullPointer</code>-Exception, wenn der übergebene Parameter
<code>entity</code> nicht vorhanden ist oder den Wert <code>null</code>, wenn in der Methode etwas schief
lief oder schlicht kein Pfad berechnet werden konnte oder tatsächlich einen Pfad.
Damit wird der Aufrufer gezwungen, den Rückgabewert vor der Verwendung zu untersuchen.</p>
<p><strong>Allein in dieser einen kurzen Methode macht <code>null</code> so viele extra Prüfungen notwendig
und den Code dadurch schwerer lesbar und fehleranfälliger! <code>null</code> wird als (unvollständige)
Initialisierung und als Rückgabewert und für den Fehlerfall genutzt, zusätzlich ist
die Semantik von <code>null</code> nicht immer klar.</strong>
(<em>Anmerkung</em>: Der Gebrauch von <code>null</code> hat nicht wirklich etwas mit &quot;der Natur eines ECS&quot;
zu tun. Die Methode wurde mittlerweile komplett überarbeitet und ist in der hier gezeigten
Form glücklicherweise nicht mehr zu finden.)</p>
<p>Entsprechend hat sich in diesem <a href="https://github.com/Dungeon-CampusMinden/Dungeon/pull/128#pullrequestreview-1254025874" rel="external" target="_blank">Review</a>
die nachfolgende Diskussion ergeben:</p>
<p><a href="#R-image-200ea855f32b3ec7d0a6c637a8015581" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review2.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-200ea855f32b3ec7d0a6c637a8015581"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review2.png?width=auto&height=auto"></a></p>
<p><a href="#R-image-57f4e292d4919ebd55499eb849ed58fa" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review3.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-57f4e292d4919ebd55499eb849ed58fa"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review3.png?width=auto&height=auto"></a></p>
<h2 id="erzeugen-von-optional-objekten">Erzeugen von <em>Optional</em>-Objekten</h2>
<p>Konstruktor ist <code>private</code> ...</p>
<ul>
<li>
<p>&quot;Kein Wert&quot;: <code>Optional.empty()</code></p>
</li>
<li>
<p>Verpacken eines non-<code>null</code> Elements: <code>Optional.of()</code>
(<code>NullPointerException</code> wenn Argument <code>null</code>!)</p>
</li>
<li>
<p>Verpacken eines &quot;unsicheren&quot;/beliebigen Elements: <code>Optional.ofNullable()</code></p>
<ul>
<li>Liefert verpacktes Element, oder</li>
<li><code>Optional.empty()</code>, falls Element <code>null</code> war</li>
</ul>
</li>
</ul>
<p>Es sollte in der Praxis eigentlich nur wenige Fälle geben, wo ein Aufruf von
<code>Optional.of()</code> sinnvoll ist. Ebenso ist <code>Optional.empty()</code> nur selten sinnvoll.</p>
<p>Stattdessen sollte stets <code>Optional.ofNullable()</code> verwendet werden.</p>
<p><strong><code>null</code> kann nicht nicht in <code>Optional&lt;T&gt;</code> verpackt werden!</strong>
(Das wäre dann eben <code>Optional.empty()</code>.)</p>
<h2 id="lsf-liefert-jetzt-optional-zurück">LSF liefert jetzt <em>Optional</em> zurück</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSF</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Set<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Optional<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getBestStudi</span>() <span style="color:#66d9ef">throws</span> NullPointerException {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Fehler: Es gibt noch keine Sammlung</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sl <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> NullPointerException(<span style="color:#e6db74">&#34;There ain&#39;t any collection&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Studi best <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Studi s : sl) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (best <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) best <span style="color:#f92672">=</span> s;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (best.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&lt;</span> s.<span style="color:#a6e22e">credits</span>()) best <span style="color:#f92672">=</span> s;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Entweder Optional.empty() (wenn best==null) oder Optional.of(best) sonst</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Optional.<span style="color:#a6e22e">ofNullable</span>(best);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Das Beispiel soll verdeutlichen, dass man im Fehlerfall nicht einfach <code>null</code> oder
<code>Optional.empty()</code> zurückliefern soll, sondern eine passende Exception werfen soll.</p>
<p>Wenn die Liste aber leer ist, stellt dies keinen Fehler dar! Es handelt sich um den
Fall &quot;kein Wert vorhanden&quot;. In diesem Fall wird statt <code>null</code> nun ein <code>Optional.empty()</code>
zurückgeliefert, also ein Objekt, auf dem der Aufrufer die üblichen Methoden aufrufen
kann.</p>
<h2 id="zugriff-auf-optional-objekte">Zugriff auf <em>Optional</em>-Objekte</h2>
<p>In der funktionalen Programmierung gibt es schon lange das Konzept von <code>Optional</code>,
in Haskell ist dies beispielsweise die Monade <code>Maybe</code>. Allerdings ist die Einbettung
in die Sprache von vornherein mit berücksichtigt worden, insbesondere kann man hier
sehr gut mit <em>Pattern Matching</em> in der Funktionsdefinition auf den verpackten Inhalt
reagieren.</p>
<p>In Java gibt es die Methode <code>Optional#isEmpty()</code>, die einen Boolean zurückliefert und
prüft, ob es sich um ein leeres <code>Optional</code> handelt oder ob hier ein Wert &quot;verpackt&quot; ist.</p>
<p>Für den direkten Zugriff auf die Werte gibt es die Methoden <code>Optional#orElseThrow()</code>
und <code>Optional#orElse()</code>. Damit kann man auf den verpackten Wert zugreifen, oder es
wird eine Exception geworfen bzw. ein Ersatzwert geliefert.</p>
<p>Zusätzlich gibt es <code>Optional#isPresent()</code>, die als Parameter ein <code>java.util.function.Consumer</code>
erwartet, also ein funktionales Interface mit einer Methode <code>void accept(T)</code>, die das
Objekt verarbeitet.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Studi best;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Testen und dann verwenden</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>lsf.<span style="color:#a6e22e">getBestStudi</span>().<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>    best <span style="color:#f92672">=</span> lsf.<span style="color:#a6e22e">getBestStudi</span>().<span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// mach was mit dem Studi ...</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Arbeite mit Consumer</span>
</span></span><span style="display:flex;"><span>lsf.<span style="color:#a6e22e">getBestStudi</span>().<span style="color:#a6e22e">ifPresent</span>(studi <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// mach was mit dem Studi ...</span>
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Studi oder Alternative (wenn Optional.empty())</span>
</span></span><span style="display:flex;"><span>best <span style="color:#f92672">=</span> lsf.<span style="color:#a6e22e">getBestStudi</span>().<span style="color:#a6e22e">orElse</span>(anne);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Studi oder NoSuchElementException (wenn Optional.empty())</span>
</span></span><span style="display:flex;"><span>best <span style="color:#f92672">=</span> lsf.<span style="color:#a6e22e">getBestStudi</span>().<span style="color:#a6e22e">orElseThrow</span>();</span></span></code></pre></div>
<p>Es gibt noch eine Methode <code>get()</code>, die so verhält wie <code>orElseThrow()</code>. Da man diese
Methode vom Namen her schnell mit einem Getter verwechselt, ist sie mittlerweile
<em>deprecated</em>.</p>
<p><em>Anmerkung</em>: Da <code>getBestStudi()</code> eine <code>NullPointerException</code> werfen kann, sollte der
Aufruf möglicherweise in ein <code>try/catch</code> verpackt werden. Dito für <code>orElseThrow()</code>.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/optional/traditional/Demo.java" target="_blank"><span class="title">Beispiel: optional.traditional.Demo</span></a></span></div>
<h2 id="einsatz-mit-stream-api">Einsatz mit Stream-API</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSF</span> {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Optional<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getBestStudi</span>() <span style="color:#66d9ef">throws</span> NullPointerException {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sl <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> NullPointerException(<span style="color:#e6db74">&#34;There ain&#39;t any collection&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sl.<span style="color:#a6e22e">stream</span>()
</span></span><span style="display:flex;"><span>                 .<span style="color:#a6e22e">sorted</span>((s1, s2) <span style="color:#f92672">-&gt;</span> s2.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">-</span> s1.<span style="color:#a6e22e">credits</span>())
</span></span><span style="display:flex;"><span>                 .<span style="color:#a6e22e">findFirst</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    String name <span style="color:#f92672">=</span> lsf.<span style="color:#a6e22e">getBestStudi</span>()
</span></span><span style="display:flex;"><span>                     .<span style="color:#a6e22e">map</span>(Studi::name)
</span></span><span style="display:flex;"><span>                     .<span style="color:#a6e22e">orElseThrow</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/optional/streams/Demo.java" target="_blank"><span class="title">Beispiel: optional.streams.Demo</span></a></span></div>
<p>Im Beispiel wird in <code>getBestStudi()</code> die Sammlung als Stream betrachtet, über die
Methode <code>sorted()</code> und den Lamda-Ausdruck für den <code>Comparator</code> sortiert (&quot;falsch&quot;
herum: absteigend in den Credits der Studis in der Sammlung), und <code>findFirst()</code>
ist die terminale Operation auf dem Stream, die ein <code>Optional&lt;Studi&gt;</code> zurückliefert:
entweder den Studi mit den meisten Credits (verpackt in <code>Optional&lt;Studi&gt;</code>) oder
<code>Optional.empty()</code>, wenn es überhaupt keine Studis in der Sammlung gab.</p>
<p>In <code>main()</code> wird dieses <code>Optional&lt;Studi&gt;</code> mit den Stream-Methoden von <code>Optional&lt;T&gt;</code>
bearbeitet, zunächst mit <code>Optional#map()</code>. Man braucht nicht selbst prüfen, ob das
von <code>getBestStudi()</code> erhaltene Objekt leer ist oder nicht, da dies von <code>Optional#map()</code>
erledigt wird: Es wendet die Methodenreferenz auf den verpackten Wert an (sofern
dieser vorhanden ist) und liefert damit den Namen des Studis als <code>Optional&lt;String&gt;</code>
verpackt zurück. Wenn es keinen Wert, also nur <code>Optional.empty()</code> von <code>getBestStudi()</code>
gab, dann ist der Rückgabewert von <code>Optional#map()</code> ein <code>Optional.empty()</code>. Wenn
der Name, also der Rückgabewert von <code>Studi::name</code>, <code>null</code> war, dann wird ebenfalls
ein <code>Optional.empty()</code> zurückgeliefert. Dadurch wirft <code>orElseThrow()</code> dann eine
<code>NoSuchElementException</code>. Man kann also direkt mit dem String <code>name</code> weiterarbeiten
ohne extra <code>null</code>-Prüfung - allerdings will man noch ein Exception-Handling einbauen
(dies fehlt im obigen Beispiel aus Gründen der Übersicht) ...</p>
<h2 id="weitere-optionals">Weitere <em>Optionals</em></h2>
<p>Für die drei primitiven Datentypen <code>int</code>, <code>long</code> und <code>double</code> gibt es passende
Wrapper-Klassen von <code>Optional&lt;T&gt;</code>: <code>OptionalInt</code>, <code>OptionalLong</code> und <code>OptionalDouble</code>.</p>
<p>Diese verhalten sich analog zu <code>Optional&lt;T&gt;</code>, haben aber keine Methode <code>ofNullable()</code>,
da dies hier keinen Sinn ergeben würde: Die drei primitiven Datentypen repräsentieren
Werte - diese können nicht <code>null</code> sein.</p>
<h2 id="regeln-für-optional">Regeln für <em>Optional</em></h2>
<ol>
<li>
<p>Nutze <code>Optional</code> nur als Rückgabe für &quot;kein Wert vorhanden&quot;</p>
<p><code>Optional</code> ist nicht als Ersatz für eine <code>null</code>-Prüfung o.ä.
gedacht, sondern als Repräsentation, um auch ein &quot;kein Wert
vorhanden&quot; zurückliefern zu können.</p>
</li>
<li>
<p>Nutze nie <code>null</code> für eine <code>Optional</code>-Variable oder einen <code>Optional</code>-Rückgabewert</p>
<p>Wenn man ein <code>Optional</code> als Rückgabe bekommt, sollte das
niemals selbst eine <code>null</code>-Referenz sein. Das macht das
gesamte Konzept kaputt!</p>
<p>Nutzen Sie stattdessen <code>Optional.empty()</code>.</p>
</li>
<li>
<p>Nutze <code>Optional.ofNullable()</code> zum Erzeugen eines <code>Optional</code></p>
<p>Diese Methode verhält sich &quot;freundlich&quot; und erzeugt automatisch
ein <code>Optional.empty()</code>, wenn das Argument <code>null</code> ist. Es gibt
also keinen Grund, dies mit einer Fallunterscheidung selbst
erledigen zu wollen.</p>
<p>Bevorzugen Sie <code>Optional.ofNullable()</code> vor einer manuellen
Fallunterscheidung und dem entsprechenden Einsatz von
<code>Optional.of()</code> und <code>Optional.empty()</code>.</p>
</li>
<li>
<p>Erzeuge keine <code>Optional</code> als Ersatz für die Prüfung auf <code>null</code></p>
<p>Wenn Sie auf <code>null</code> prüfen müssen, müssen Sie auf <code>null</code> prüfen.
Der ersatzweise Einsatz von <code>Optional</code> macht es nur komplexer -
prüfen müssen Sie hinterher ja immer noch.</p>
</li>
<li>
<p>Nutze <code>Optional</code> nicht in Attributen, Methoden-Parametern und Sammlungen</p>
<p>Nutzen Sie <code>Optional</code> vor allem für Rückgabewerte.</p>
<p>Attribute sollten immer direkt einen Wert haben oder <code>null</code>,
analog Parameter von Methoden o.ä. ... Hier hilft <code>Optional</code>
nicht, Sie müssten ja trotzdem eine <code>null</code>-Prüfung machen,
nur eben dann über den <code>Optional</code>, wodurch dies komplexer und
schlechter lesbar wird.</p>
<p>Aus einem ähnlichen Grund sollten Sie auch in Sammlungen
keine <code>Optional</code> speichern!</p>
</li>
<li>
<p>Vermeide den direkten Zugriff (<code>ifPresent()</code>, <code>orElseThrow()</code> ...)</p>
<p>Der direkte Zugriff auf ein <code>Optional</code> entspricht dem
Prüfen auf <code>null</code> und dann dem Auspacken. Dies ist nicht
nur Overhead, sondern auch schlechter lesbar.</p>
<p>Vermeiden Sie den direkten Zugriff und nutzen Sie <code>Optional</code>
mit den Stream-Methoden. So ist dies von den Designern
gedacht.</p>
</li>
</ol>
<h2 id="interessante-links">Interessante Links</h2>
<ul>
<li><a href="https://dev.java/learn/api/streams/optionals/" rel="external" target="_blank">&quot;Using Optionals&quot;</a></li>
<li><a href="https://medium.com/javarevisited/what-you-might-not-know-about-optional-7238e3c05f63" rel="external" target="_blank">&quot;What You Might Not Know About Optional&quot;</a></li>
<li><a href="https://medium.com/javarevisited/experienced-developers-use-these-7-java-optional-tips-to-remove-code-clutter-6e8b1a639861" rel="external" target="_blank">&quot;Experienced Developers Use These 7 Java Optional Tips to Remove Code Clutter&quot;</a></li>
<li><a href="https://blog.jetbrains.com/idea/2017/08/code-smells-null/" rel="external" target="_blank">&quot;Code Smells: Null&quot;</a></li>
<li><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" rel="external" target="_blank">&quot;Class Optional&quot;</a></li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<p><code>Optional</code> als Rückgabe für &quot;kein Wert vorhanden&quot;</p>
<ul>
<li>
<p><code>Optional.ofNullable()</code>: Erzeugen eines <code>Optional</code></p>
<ul>
<li>Entweder Objekt &quot;verpackt&quot; (Argument != <code>null</code>)</li>
<li>Oder <code>Optional.empty()</code> (Argument == <code>null</code>)</li>
</ul>
</li>
<li>
<p>Prüfen mit <code>isEmpty()</code> und <code>ifPresent()</code></p>
</li>
<li>
<p>Direkter Zugriff mit <code>ifPresent()</code>, <code>orElse()</code> und <code>orElseThrow()</code></p>
</li>
<li>
<p>Stream-API: <code>map()</code>, <code>filter()</code>, <code>flatMap()</code>, ...</p>
</li>
<li>
<p>Attribute, Parameter und Sammlungen: nicht <code>Optional</code> nutzen</p>
</li>
<li>
<p>Kein Ersatz für <code>null</code>-Prüfung!</p>
</li>
</ul>
<p>Schöne Doku: <a href="https://dev.java/learn/api/streams/optionals/" rel="external" target="_blank">&quot;Using Optionals&quot;</a>.</p>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106526&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Optional (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>String-Handling</strong></p>
<p>Können Sie den folgenden Code so umschreiben, dass Sie statt der <code>if</code>-Abfragen und der einzelnen direkten Methodenaufrufe
die Stream-API und <code>Optional&lt;T&gt;</code> nutzen?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>String <span style="color:#a6e22e">format</span>(<span style="color:#66d9ef">final</span> String text, String replacement) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (text.<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> String trimmed <span style="color:#f92672">=</span> text.<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> String withSpacesReplaced <span style="color:#f92672">=</span> trimmed.<span style="color:#a6e22e">replaceAll</span>(<span style="color:#e6db74">&#34; +&#34;</span>, replacement);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> replacement <span style="color:#f92672">+</span> withSpacesReplaced <span style="color:#f92672">+</span> replacement;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Ein Aufruf <code>format(&quot; Hello World ... &quot;, &quot;_&quot;);</code> liefert den String &quot;<code>_Hello_World_..._</code>&quot;.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_LernJava'>[LernJava] <a href='https://dev.java/learn/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Learn Java</strong></a><br>Oracle Corporation, 2022.<br><em>Tutorials \> The Stream API \> Using Optionals</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kap. 12.6: Optional ist keine Nullnummer</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Interfaces: Default-Methoden</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Seit Java8 können Methoden in Interfaces auch fertig implementiert sein: Sogenannte
<strong>Default-Methoden</strong>.</p>
<p>Dazu werden die Methoden mit dem neuen Schlüsselwort <code>default</code> gekennzeichnet. Die
Implementierung wird an die das Interface implementierenden Klassen (oder Interfaces)
vererbt und kann bei Bedarf überschrieben werden.</p>
<p>Da eine Klasse von einer anderen Klasse erben darf, aber mehrere Interfaces implementieren
kann, könnte es zu einer Mehrfachvererbung einer Methode kommen: Eine Methode könnte
beispielsweise in verschiedenen Interfaces als Default-Methode angeboten werden, und wenn
eine Klasse diese Interfaces implementiert, steht eine Methode mit der selben Signatur
auf einmal mehrfach zur Verfügung. Dies muss (u.U. manuell) aufgelöst werden.</p>
<p>Auflösung von Mehrfachvererbung:</p>
<ul>
<li>Regel 1: Klassen gewinnen</li>
<li>Regel 2: Sub-Interfaces gewinnen</li>
<li>Regel 3: Methode explizit auswählen</li>
</ul>
<p>Aktuell ist der Unterschied zu abstrakten Klassen: Interfaces können <strong>keinen Zustand</strong>
haben, d.h. keine Attribute/Felder.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/qQ8BPkL9X5o' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Default-Methoden</a></li> <li><a href='https://youtu.be/gm6ttKlAEJc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Regel 1</a></li> <li><a href='https://youtu.be/3j9i7iMVmMM' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Regel 2</a></li> <li><a href='https://youtu.be/J3gJnwz8Rf0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Regel 3</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/a86bc2fc9d692f6ca307cfabd09c7860c06b8fd53b60e281586c8b51414b7139d061328b2160a988045952f92fc13a921b6148c0dd2f790ea7324634c491006e' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Default-Methoden</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Interfaces mit Default-Methoden, Unterschied zu abstrakten Klassen</li> <li>(K2) Problem der Mehrfachvererbung</li> <li>(K3) Erstellen von Interfaces mit Default-Methoden</li> <li>(K3) Regeln zum Auflösen der Mehrfachvererbung</li></ul>
  </div>
</div>




    <h2 id="problem-etablierte-api-interfaces-erweitern">Problem: Etablierte API (Interfaces) erweitern</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Klausur</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">anmelden</span>(Studi s);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">abmelden</span>(Studi s);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>=&gt; Nachträglich noch <code>void schreiben(Studi s);</code> ergänzen?</p>
<p>Wenn ein Interface nachträglich erweitert wird, müssen alle Kunden (also
alle Klassen, die das Interface implementieren) auf die neuen Signaturen
angepasst werden. Dies kann viel Aufwand verursachen und API-Änderungen
damit unmöglich machen.</p>
<h2 id="default-methoden-interfaces-mit-implementierung">Default-Methoden: Interfaces mit Implementierung</h2>
<p>Seit Java8 können Interfaces auch Methoden implementieren.
Es gibt zwei Varianten: Default-Methoden und statische Methoden.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Klausur</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">anmelden</span>(Studi s);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">abmelden</span>(Studi s);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">schreiben</span>(Studi s) {
</span></span><span style="display:flex;"><span>        ...     <span style="color:#75715e">// Default-Implementierung</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">wuppie</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> java.<span style="color:#a6e22e">lang</span>.<span style="color:#a6e22e">UnsupportedOperationException</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Methoden können in Interfaces seit Java8 implementiert werden. Für Default-Methoden
muss das Schlüsselwort <code>default</code> vor die Signatur gesetzt werden. Klassen, die das
Interface implementieren, können diese Default-Implementierung erben oder selbst
neu implementieren (überschreiben). Alternativ kann die Klasse eine Default-Methode
neu <em>deklarieren</em> und wird damit zur abstrakten Klasse.</p>
<p>Dies ähnelt abstrakten Klassen. Allerdings kann in abstrakten Klassen neben dem
Verhalten (implementierten Methoden) auch Zustand über die Attribute gespeichert werden.</p>
<h2 id="problem-mehrfachvererbung">Problem: Mehrfachvererbung</h2>
<p>Drei Regeln zum Auflösen bei Konflikten:</p>
<ol>
<li><strong>Klassen gewinnen</strong>:
Methoden aus Klasse oder Superklasse haben höhere Priorität als Default-Methoden</li>
<li><strong>Sub-Interfaces gewinnen</strong>:
Methode aus am meisten spezialisiertem Interface mit Default-Methode wird gewählt
Beispiel: Wenn <code>B extends A</code> dann ist <code>B</code> spezialisierter als <code>A</code></li>
<li>Sonst: Klasse muss <strong>Methode explizit auswählen</strong>:
Methode überschreiben und gewünschte (geerbte) Variante aufrufen:
<code>X.super.m(...)</code> (<code>X</code> ist das gewünschte Interface)</li>
</ol>
<p>Auf den folgenden Folien wird dies anhand kleiner Beispiele verdeutlicht.</p>
<h2 id="auflösung-mehrfachvererbung-1-klassen-gewinnen">Auflösung Mehrfachvererbung: 1. Klassen gewinnen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">A</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;A&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">C</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;C&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">E</span> <span style="color:#66d9ef">extends</span> C <span style="color:#66d9ef">implements</span> A {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/** Mehrfachvererbung: 1. Klassen gewinnen */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DefaultTest1</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        String e <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> E().<span style="color:#a6e22e">hello</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/defaultmethods/rule1/DefaultTest1.java" target="_blank"><span class="title">Demo: defaultmethods.rule1.DefaultTest1</span></a></span></div>
<p>Die Klasse <code>E</code> erbt sowohl von Klasse <code>C</code> als auch vom Interface <code>A</code> die Methode <code>hello()</code>
(Mehrfachvererbung). In diesem Fall &quot;gewinnt&quot; die Implementierung aus Klasse <code>C</code>.</p>
<p><strong>1. Regel</strong>: Klassen gewinnen immer. Deklarationen einer Methode in einer Klasse oder
einer Oberklasse haben Vorrang von allen Default-Methoden.</p>
<h2 id="auflösung-mehrfachvererbung-2-sub-interfaces-gewinnen">Auflösung Mehrfachvererbung: 2. Sub-Interfaces gewinnen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">A</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;A&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">B</span> <span style="color:#66d9ef">extends</span> A {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;B&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">D</span> <span style="color:#66d9ef">implements</span> A, B {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/** Mehrfachvererbung: 2. Sub-Interfaces gewinnen */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DefaultTest2</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        String e <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> D().<span style="color:#a6e22e">hello</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/defaultmethods/rule2/DefaultTest2.java" target="_blank"><span class="title">Demo: defaultmethods.rule2.DefaultTest2</span></a></span></div>
<p>Die Klasse <code>D</code> erbt sowohl vom Interface <code>A</code> als auch vom Interface <code>B</code> die Methode <code>hello()</code>
(Mehrfachvererbung). In diesem Fall &quot;gewinnt&quot; die Implementierung aus Klasse <code>B</code>: Interface
<code>B</code> ist spezialisierter als <code>A</code>.</p>
<p><strong>2. Regel</strong>: Falls Regel 1 nicht zutrifft, gewinnt die Default-Methode, die am meisten
spezialisiert ist.</p>
<h2 id="auflösung-mehrfachvererbung-3-methode-explizit-auswählen">Auflösung Mehrfachvererbung: 3. Methode explizit auswählen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">A</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;A&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">B</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;B&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">D</span> <span style="color:#66d9ef">implements</span> A, B {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> A.<span style="color:#a6e22e">super</span>.<span style="color:#a6e22e">hello</span>(); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/** Mehrfachvererbung: 3. Methode explizit auswählen */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DefaultTest3</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        String e <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> D().<span style="color:#a6e22e">hello</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/defaultmethods/rule3/DefaultTest3.java" target="_blank"><span class="title">Demo: defaultmethods.rule3.DefaultTest3</span></a></span></div>
<p>Die Klasse <code>D</code> erbt sowohl vom Interface <code>A</code> als auch vom Interface <code>B</code> die Methode <code>hello()</code>
(Mehrfachvererbung). In diesem Fall <em>muss</em> zur Auflösung die Methode in <code>D</code> neu implementiert
werden und die gewünschte geerbte Methode explizit aufgerufen werden. (Wenn dies unterlassen
wird, führt das selbst bei Nicht-Nutzung der Methode <code>hello()</code> zu einem Compiler-Fehler!)</p>
<p><em>Achtung</em>: Der Aufruf der Default-Methode aus Interface <code>A</code> erfolgt mit <code>A.super.hello();</code>
(nicht einfach durch <code>A.hello();</code>)!</p>
<p><strong>3. Regel</strong>: Falls weder Regel 1 noch 2 zutreffen bzw. die Auflösung noch uneindeutig ist,
muss man manuell durch die explizite Angabe der gewünschten Methode auflösen.</p>
<h2 id="quiz-was-kommt-hier-raus">Quiz: Was kommt hier raus?</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">A</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;A&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">B</span> <span style="color:#66d9ef">extends</span> A {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;B&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">C</span> <span style="color:#66d9ef">implements</span> B {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;C&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">D</span> <span style="color:#66d9ef">extends</span> C <span style="color:#66d9ef">implements</span> A, B {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/** Quiz Mehrfachvererbung */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DefaultTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        String e <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> D().<span style="color:#a6e22e">hello</span>(); <span style="color:#75715e">// ???</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Die Klasse <code>D</code> erbt sowohl von Klasse <code>C</code> als auch von den Interfaces <code>A</code> und <code>B</code> die Methode
<code>hello()</code> (Mehrfachvererbung). In diesem Fall &quot;gewinnt&quot; die Implementierung aus Klasse <code>C</code>: Klassen
gewinnen immer (Regel 1).</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/defaultmethods/quiz/DefaultTest.java" target="_blank"><span class="title">Beispiel: defaultmethods.quiz.DefaultTest</span></a></span></div>
<h2 id="statische-methoden-in-interfaces">Statische Methoden in Interfaces</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Collection</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> Iterable<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">add</span>(E e);
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Collections</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">Collections</span>() { }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">addAll</span>(Collection<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">super</span> T<span style="color:#f92672">&gt;</span> c, T... elements) {...}
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Typisches Pattern in Java: Interface plus Utility-Klasse (Companion-Klasse) mit statischen Hilfsmethoden
zum einfacheren Umgang mit Instanzen des Interfaces (mit Objekten, deren Klasse das Interface implementiert).
Beispiel: <code>Collections</code> ist eine Hilfs-Klasse zum Umgang mit <code>Collection</code>-Objekten.</p>
<p>Seit Java8 können in Interfaces neben Default-Methoden auch statische Methoden implementiert werden.</p>
<p>Die Hilfsmethoden können jetzt ins Interface wandern =&gt; Utility-Klassen werden obsolet ... Aus
Kompatibilitätsgründen würde man die bisherige Companion-Klasse weiterhin anbieten, wobei die Implementierungen
auf die statischen Methoden im Interface verweisen (<em>SKIZZE, nicht real!</em>):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">CollectionX</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> Iterable<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">add</span>(E e);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">addAll</span>(CollectionX<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">super</span> T<span style="color:#f92672">&gt;</span> c, T... elements) { ... }
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CollectionsX</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">addAll</span>(CollectionX<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">super</span> T<span style="color:#f92672">&gt;</span> c, T... elements) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> CollectionX.<span style="color:#a6e22e">addAll</span>(c, elements);  <span style="color:#75715e">// Verweis auf Interface</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="interfaces-vs-abstrakte-klassen">Interfaces vs. Abstrakte Klassen</h2>
<ul>
<li>
<p><strong>Abstrakte Klassen</strong>: Schnittstelle und Verhalten und Zustand</p>
</li>
<li>
<p><strong>Interfaces</strong>:</p>
<ul>
<li>vor Java 8 nur Schnittstelle</li>
<li>ab Java 8 Schnittstelle und Verhalten</li>
</ul>
<p>Unterschied zu abstrakten Klassen: Kein Zustand, d.h. keine Attribute</p>
</li>
<li>
<p>Design:</p>
<ul>
<li>Interfaces sind beinahe wie abstrakte Klassen, nur ohne Zustand</li>
<li>Klassen können nur von <strong>einer</strong> (abstrakten) Klasse erben, aber
<strong>viele</strong> Interfaces implementieren</li>
</ul>
</li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Seit Java8: Interfaces mit Implementierung: <strong>Default-Methoden</strong></p>
<ul>
<li>Methoden mit dem Schlüsselwort <code>default</code> können Implementierung im Interface haben</li>
<li>Die Implementierung wird vererbt und kann bei Bedarf überschrieben werden</li>
<li>Auflösung von Mehrfachvererbung:
<ul>
<li>Regel 1: Klassen gewinnen</li>
<li>Regel 2: Sub-Interfaces gewinnen</li>
<li>Regel 3: Methode explizit auswählen</li>
</ul>
</li>
<li>Unterschied zu abstrakten Klassen: <strong>Kein Zustand</strong></li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106522&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Default-Methoden (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>
Erklären Sie die Code-Schnipsel in der
<a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/modern-java/src/challenges/defaults" rel="external" target="_blank">Vorgabe</a>
und die jeweils entstehenden Ausgaben.
  </div>
</div>



    




    




    
    
        
        

        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Urma2014'>[Urma2014] <strong>Java 8 in Action: Lambdas, Streams, and Functional-Style Programming</strong><br>Urma, R.-G. und Fusco, M. und Mycroft, A., Manning Publications, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9199-9' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9199-9</a>.<br><em>Kapitel 9: Default Methods</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
        </div>
      </main>
    </div>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/clipboard.min.js?1729954976" defer></script>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/perfect-scrollbar.min.js?1729954976" defer></script>
    <script>
      function useMathJax( config ){
        window.MathJax = Object.assign( window.MathJax || {}, {
          tex: {
            inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
            displayMath: [['\\[', '\\]'], ['$$', '$$']], 
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/mathjax/tex-mml-chtml.js?1729954976"></script>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/theme.js?1729954976" defer></script>
  </body>
</html>
