<!DOCTYPE html>
<html lang="de-DE" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.135.0">
    <meta name="generator" content="Relearn 6.4.1">
    <meta name="description" content="Motivation: Entwicklung einer Studi-/Prüfungsverwaltung Szenario Zwei Teams entwickeln eine neue Studi-/Prüfungsverwaltung für die Hochschule. Ein Team modelliert dabei die Studierenden, ein anderes Team modelliert die Prüfungsverwaltung LSF.
Team A:
public class Studi { String name; LSF lsf; public Studi(String name, LSF lsf) { this.name = name; this.lsf = lsf; } public boolean anmelden(String modul) { return lsf.anmelden(name, modul); } public boolean einsicht(String modul) { return lsf.ergebnis(name, modul) &gt; 50; } } Team B:
public class LSF { public boolean anmelden(String name, String modul) { throw new UnsupportedOperationException(); } public int ergebnis(String name, String modul) { throw new UnsupportedOperationException(); } } Team B kommt nicht so recht vorwärts, Team A ist fertig und will schon testen.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Mocking mit Mockito">
    <meta name="twitter:description" content="Motivation: Entwicklung einer Studi-/Prüfungsverwaltung Szenario Zwei Teams entwickeln eine neue Studi-/Prüfungsverwaltung für die Hochschule. Ein Team modelliert dabei die Studierenden, ein anderes Team modelliert die Prüfungsverwaltung LSF.
Team A:
public class Studi { String name; LSF lsf; public Studi(String name, LSF lsf) { this.name = name; this.lsf = lsf; } public boolean anmelden(String modul) { return lsf.anmelden(name, modul); } public boolean einsicht(String modul) { return lsf.ergebnis(name, modul) &gt; 50; } } Team B:
public class LSF { public boolean anmelden(String name, String modul) { throw new UnsupportedOperationException(); } public int ergebnis(String name, String modul) { throw new UnsupportedOperationException(); } } Team B kommt nicht so recht vorwärts, Team A ist fertig und will schon testen.">
    <meta property="og:url" content="https://www.hsbi.de/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/mockito.html">
    <meta property="og:title" content="Mocking mit Mockito">
    <meta property="og:description" content="Motivation: Entwicklung einer Studi-/Prüfungsverwaltung Szenario Zwei Teams entwickeln eine neue Studi-/Prüfungsverwaltung für die Hochschule. Ein Team modelliert dabei die Studierenden, ein anderes Team modelliert die Prüfungsverwaltung LSF.
Team A:
public class Studi { String name; LSF lsf; public Studi(String name, LSF lsf) { this.name = name; this.lsf = lsf; } public boolean anmelden(String modul) { return lsf.anmelden(name, modul); } public boolean einsicht(String modul) { return lsf.ergebnis(name, modul) &gt; 50; } } Team B:
public class LSF { public boolean anmelden(String name, String modul) { throw new UnsupportedOperationException(); } public int ergebnis(String name, String modul) { throw new UnsupportedOperationException(); } } Team B kommt nicht so recht vorwärts, Team A ist fertig und will schon testen.">
    <meta property="og:locale" content="de_DE">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="Mocking mit Mockito">
    <meta itemprop="description" content="Motivation: Entwicklung einer Studi-/Prüfungsverwaltung Szenario Zwei Teams entwickeln eine neue Studi-/Prüfungsverwaltung für die Hochschule. Ein Team modelliert dabei die Studierenden, ein anderes Team modelliert die Prüfungsverwaltung LSF.
Team A:
public class Studi { String name; LSF lsf; public Studi(String name, LSF lsf) { this.name = name; this.lsf = lsf; } public boolean anmelden(String modul) { return lsf.anmelden(name, modul); } public boolean einsicht(String modul) { return lsf.ergebnis(name, modul) &gt; 50; } } Team B:
public class LSF { public boolean anmelden(String name, String modul) { throw new UnsupportedOperationException(); } public int ergebnis(String name, String modul) { throw new UnsupportedOperationException(); } } Team B kommt nicht so recht vorwärts, Team A ist fertig und will schon testen.">
    <meta itemprop="wordCount" content="2594">
    <title>Mocking mit Mockito</title>
    <link href="https://www.hsbi.de/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/mockito.html" rel="canonical" type="text/html" title="Mocking mit Mockito">

    

    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/images/logo.png?1729954976" rel="icon" type="image/png">

    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fontawesome-all.min.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fontawesome-all.min.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/nucleus.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/auto-complete.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/auto-complete.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/perfect-scrollbar.min.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fonts.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fonts.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/theme.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/theme-auto.css?1729954976" rel="stylesheet" id="R-variant-style">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/chroma-auto.css?1729954976" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/variant.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/print.css?1729954976" rel="stylesheet" media="print">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/format-print.css?1729954976" rel="stylesheet">
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/variant.js?1729954976"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='..';
      window.relearn.relBaseUri='..\/..\/..\/..\/..\/..';
      window.relearn.absBaseUri='https:\/\/www.hsbi.de\/elearning\/data\/FH-Bielefeld\/lm_data\/lm_1661234';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.index_js_url="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/index.search.js?1729954976";
      // variant stuff
      window.variants && variants.init( [ 'auto', 'zen-light', 'zen-dark', 'relearn-bright', 'relearn-light', 'relearn-dark' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script><style type="text/css">

 
.center {
    align-content: center;
    text-align: center;
    margin: auto;
}
.alert {
    color: #ff3333;
}
.bsp {
    padding: 0.05cm;
    border-width: 0.05cm;
    border-style: solid;
    border-color: #ddd;
    background-color: #ddd;
    border-radius: 25px;
    float: right;
}
.cbox {
    padding: 0.2cm;
    border-width: 0.1cm;
    border-style: solid;
    border-color: #4070a0;
    background-color: #f2f2f2;
    margin: auto;
    width: 60%;
    text-align: center;
    overflow: auto;
}
.blueArrow {
    color: #4070a0;
    font-family: "Courier New", "Courier", monospace;
    font-weight: bold;
}
.origin {
    background-color: #ededed;
    font-size: 0.8em;
}
.showme {
    background-color: #ededed;
    font-size: 0.8em;
}


 
.tldr {
    background: #dbe4ed;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.recap {
    
    
   margin: 4px 0px 26px 0px;
}
.bib {
    background: #dbe4ed;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.outcomes {
    background: #d9e9d5;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.quizzes {
    background: #d9e9d5;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.challenges {
    background: #ebe4d6;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.assignments {
    background: #ebe4d6;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
h1.tldr, h1.recap, h1.bib, h1.outcomes, h1.quizzes, h1.challenges, h1.assignments {
    padding: 0px;
}


 
.noJsAlert {
    padding: 20px;
    background-color: #f44336;  
    color: white;
    margin-bottom: 15px;
}


 
.embed-video-player {
    position: relative;
    padding-bottom: 56%;
    height: 0;
    overflow: hidden;
}
.youtube-player {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border:0;
}


 
#header-wrapper {
    padding:0.6rem;
}


 
#shortcuts {
    padding-top: 2.0rem;
}


 
#chapter p {
    text-align: left;
}


 
figcaption h4 {
    margin-top:-2.5rem;
}
.border1 {
    border:1px solid black;
}

 
td ul, td ol {
    margin: 0 0 1rem 0.5rem;
    padding: 0 0 0 0.5rem;
}

 
h1 { font-size:2.8rem !important;}
h2 { font-size:2.2rem; margin:1.2rem 0}
h3 { font-size:1.9rem; text-align:left !important; font-weight:400 !important;}
h4 { font-size:1.6rem}
h5 { font-size:1.3rem}
h6 { font-size:1rem}

h2 {
    width:100% !important;
    border-bottom:1px solid #5e5e5e !important;
    padding-bottom: 2px;
}
.tldr h2, .recap h2, .bib h2, .outcomes h2, .quizzes h2, .challenges h2, .assignments h2 {
    margin:0.5rem 0
}

.btn-crossreference, .btn-crossreference:hover {
    cursor: initial;
}

</style>

  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/mockito.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <span class="topbar-breadcrumbs highlightable">
            Mocking mit Mockito
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable " tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
<h1>Mocking mit Mockito</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Häufig hat man es in Softwaretests mit dem Problem zu tun, dass die zu testenden Klassen von
anderen, noch nicht implementierten Klassen oder von zufälligen oder langsamen Operationen
abhängen.</p>
<p>In solchen Situationen kann man auf &quot;Platzhalter&quot; für diese Abhängigkeiten zurückgreifen. Dies
können einfache Stubs sein, also Objekte, die einfach einen festen Wert bei einem Methodenaufruf
zurückliefern oder Mocks, wo man auf die Argumente eines Methodenaufrufs reagieren kann und
passende unterschiedliche Rückgabewerte zurückgeben kann.</p>
<p>Mockito ist eine Java-Bibliothek, die zusammen mit JUnit das Mocking von Klassen in Java
erlaubt. Man kann hier zusätzlich auch die Interaktion mit dem gemockten Objekt überprüfen und
testen, ob eine bestimmte Methode mit bestimmten Argumenten aufgerufen wurde und wie oft.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/8deFZKtjXSk' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Mocking</a></li> <li><a href='https://youtu.be/WNEedC7PrVQ' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Stubs</a></li> <li><a href='https://youtu.be/avUyYVePFCI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Mocks</a></li> <li><a href='https://youtu.be/dj3pmOZfS_A' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Spy</a></li> <li><a href='https://youtu.be/CPGqhyC8BjU' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: verify()</a></li> <li><a href='https://youtu.be/JNouzOd0s-w' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Matcher</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/9531e04dd11458ea45915269aca452ba6b9978ef7b1b3a777a424d673573f75724a3fbedd0a2bec5e4d14de4025ea92ae4a966f95ee312e9f6ecca4fde4c98ef' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Mocking</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Begriffe: Mocking, Mock, Stub, Spy</li> <li>(K3) Erzeugen eines Mocks in Mockito</li> <li>(K3) Erzeugen eines Spies in Mockito</li> <li>(K3) Prüfen von Interaktion mit <em>verify()</em></li> <li>(K3) Einsatz von <em>ArgumentMatcher</em></li></ul>
  </div>
</div>




    <h2 id="motivation-entwicklung-einer-studi-prüfungsverwaltung">Motivation: Entwicklung einer Studi-/Prüfungsverwaltung</h2>
<h3 id="szenario">Szenario</h3>
<p>Zwei Teams entwickeln eine neue Studi-/Prüfungsverwaltung für die Hochschule. Ein Team modelliert dabei
die Studierenden, ein anderes Team modelliert die Prüfungsverwaltung LSF.</p>
<ul>
<li>
<p>Team A:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    String name;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Studi</span>(String name, LSF lsf) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name;  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">lsf</span> <span style="color:#f92672">=</span> lsf;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">anmelden</span>(String modul) { <span style="color:#66d9ef">return</span> lsf.<span style="color:#a6e22e">anmelden</span>(name, modul); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">einsicht</span>(String modul) { <span style="color:#66d9ef">return</span> lsf.<span style="color:#a6e22e">ergebnis</span>(name, modul) <span style="color:#f92672">&gt;</span> 50; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
<li>
<p>Team B:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSF</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">anmelden</span>(String name, String modul) { <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> UnsupportedOperationException(); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">ergebnis</span>(String name, String modul) { <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> UnsupportedOperationException(); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
</ul>
<p>Team B kommt nicht so recht vorwärts, Team A ist fertig und will schon testen.</p>
<p>Wie kann Team A seinen Code testen?</p>
<p><strong>Optionen</strong>:</p>
<ul>
<li>Gar nicht testen?!</li>
<li>Das LSF selbst implementieren? Wer pflegt das dann? =&gt; manuell implementierte Stubs</li>
<li>Das LSF durch einen Mock ersetzen =&gt; Einsatz der Bibliothek &quot;mockito&quot;</li>
</ul>
<h3 id="motivation-mocking-und-mockito">Motivation Mocking und Mockito</h3>
<p><a href="https://github.com/mockito/mockito" rel="external" target="_blank">Mockito</a> ist ein Mocking-Framework für JUnit. Es
simuliert das Verhalten eines realen Objektes oder einer realen Methode.</p>
<p>Wofür brauchen wir denn jetzt so ein Mocking-Framework überhaupt?</p>
<p>Wir wollen die Funktionalität einer Klasse isoliert vom Rest testen können.
Dabei stören uns aber bisher so ein paar Dinge:</p>
<ul>
<li>Arbeiten mit den echten Objekten ist langsam (zum Beispiel aufgrund von
Datenbankenzugriffen)</li>
<li>Objekte beinhalten oft komplexe Abhängigkeiten, die in Tests schwer abzudecken
sind</li>
<li>Manchmal existiert der zu testende Teil einer Applikation auch noch gar nicht,
sondern es gibt nur die Interfaces.</li>
<li>Oder es gibt unschöne Seiteneffekte beim Arbeiten mit den realen Objekten. Zum
Beispiel könnte es sein, das immer eine E-Mail versendet wird, wenn wir mit
einem Objekt interagieren.</li>
</ul>
<p>In solchen Situationen wollen wir eine Möglichkeit haben, das Verhalten eines
realen Objektes bzw. der Methoden zu simulieren, ohne dabei die originalen
Methoden aufrufen zu müssen. (Manchmal möchte man das dennoch, aber dazu später
mehr...)</p>
<p>Und genau hier kommt Mockito ins Spiel. Mockito hilft uns dabei, uns von den
externen Abhängigkeiten zu lösen, indem es sogenannte Mocks, Stubs oder Spies
anbietet, mit denen sich das Verhalten der realen Objekte simulieren/überwachen
und testen lässt.</p>
<h3 id="aber-was-genau-ist-denn-jetzt-eigentlich-mocking">Aber was genau ist denn jetzt eigentlich Mocking?</h3>
<p>Ein Mock-Objekt (&quot;etwas vortäuschen&quot;) ist im Software-Test ein Objekt, das als Platzhalter
(Attrappe) für das echte Objekt verwendet wird.</p>
<p>Mocks sind in JUnit-Tests immer dann nützlich, wenn man externe Abhängigkeiten
hat, auf die der eigene Code zugreift. Das können zum Beispiel externe APIs sein
oder Datenbanken etc. ... Mocks helfen einem beim Testen nun dabei, sich von diesen
externen Abhängigkeiten zu lösen und seine Softwarefunktionalität dennoch
schnell und effizient testen zu können ohne evtl. auftretende Verbindungsfehler
oder andere mögliche Seiteneffekte der externen Abhängigkeiten auszulösen.</p>
<p>Dabei simulieren Mocks die Funktionalität der externen APIs oder Datenbankzugriffe.
Auf diese Weise ist es möglich Softwaretests zu schreiben, die scheinbar die gleichen
Methoden aufrufen, die sie auch im regulären Softwarebetrieb nutzen würden, allerdings
werden diese wie oben erwähnt allerdings für die Tests nur simuliert.</p>
<p>Mocking ist also eine Technik, die in Softwaretests verwendet wird, in denen die
gemockten Objekte anstatt der realen Objekte zu Testzwecken genutzt werden. Die
gemockten Objekte liefern dabei bei einem vom Programmierer bestimmten (Dummy-) Input,
einen dazu passenden gelieferten (Dummy-) Output, der durch seine vorhersagbare
Funktionalität dann in den eigentlichen Testobjekten gut für den Test nutzbar ist.</p>
<p>Dabei ist es von Vorteil die drei Grundbegriffe &quot;Mock&quot;, &quot;Stub&quot; oder &quot;Spy&quot;, auf die wir
in der Vorlesung noch häufiger treffen werden, voneinander abgrenzen und
unterscheiden zu können.</p>
<h3 id="dabei-bezeichnet-ein">Dabei bezeichnet ein</h3>
<ul>
<li><strong>Stub</strong>: Ein Stub ist ein Objekt, dessen Methoden nur mit einer minimalen Logik
für den Test implementiert wurden. Häufig werden dabei einfach feste (konstante)
Werte zurückgeliefert, d.h. beim Aufruf einer Methode wird unabhängig von der konkreten
Eingabe immer die selbe Ausgabe zurückgeliefert.</li>
<li><strong>Mock</strong>: Ein Mock ist ein Objekt, welches im Gegensatz zum Stub bei vorher definierten
Funktionsaufrufen mit vorher definierten Argumente eine definierte Rückgabe liefert.</li>
<li><strong>Spy</strong>: Ein Spy ist ein Objekt, welches Aufrufe und übergebene Werte protokolliert und
abfragbar macht. Es ist also eine Art Wrapper um einen Stub oder einen Mock.</li>
</ul>
<h3 id="mockito-setup">Mockito Setup</h3>
<ul>
<li>
<p>Gradle: <code>build.gradle</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-groovy" data-lang="groovy"><span style="display:flex;"><span>dependencies <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    implementation <span style="color:#e6db74">&#39;junit:junit:4.13.2&#39;</span>
</span></span><span style="display:flex;"><span>    implementation <span style="color:#e6db74">&#39;org.mockito:mockito-core:4.5.1&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div>
</li>
<li>
<p>Maven: <code>pom.xml</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;groupId&gt;</span>junit<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;artifactId&gt;</span>junit<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;version&gt;</span>4.13.2<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;groupId&gt;</span>org.mockito<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;artifactId&gt;</span>mockito-core<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;version&gt;</span>4.5.1<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependencies&gt;</span></span></span></code></pre></div>
</li>
</ul>
<h2 id="manuell-stubs-implementieren">Manuell Stubs implementieren</h2>
<p>Team A könnte manuell das LSF rudimentär implementieren (nur für die Tests, einfach mit
festen Rückgabewerten): <strong>Stubs</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StudiStubTest</span> {
</span></span><span style="display:flex;"><span>    Studi studi;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() { lsf <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> LsfStub();  studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() { assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)); }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsicht</span>() { assertTrue(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Stub für das noch nicht fertige LSF</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LsfStub</span> <span style="color:#66d9ef">extends</span> LSF {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">anmelden</span>(String name, String modul) { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>; }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">ergebnis</span>(String name, String modul) { <span style="color:#66d9ef">return</span> 80; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><strong>Problem</strong>: Wartung der Tests (wenn das richtige LSF fertig ist) und Wartung der Stubs (wenn sich die Schnittstelle
des LSF ändert, muss auch der Stub nachgezogen werden).</p>
<p><strong>Problem</strong>: Der Stub hat nur eine Art minimale Default-Logik (sonst könnte man ja das LSF gleich selbst implementieren).
Wenn man im Test andere Antworten braucht, müsste man einen weiteren Stub anlegen ...</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/StudiStubTest.java" target="_blank"><span class="title">Demo hsbi.StudiStubTest</span></a></span></div>
<h2 id="mockito-mocking-von-ganzen-klassen">Mockito: Mocking von ganzen Klassen</h2>
<p><strong>Lösung</strong>: Mocking der Klasse <code>LSF</code> mit Mockito für den Test von <code>Studi</code>: <code>mock()</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StudiMockTest</span> {
</span></span><span style="display:flex;"><span>    Studi studi;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() { lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);  studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() {
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(anyString(), anyString())).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtI</span>() {
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(80);
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtII</span>() {
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(40);
</span></span><span style="display:flex;"><span>        assertFalse(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Der Aufruf <code>mock(LSF.class)</code> erzeugt einen Mock der Klasse (oder des Interfaces) <code>LSF</code>. Dabei wird ein Objekt
vom Typ <code>LSF</code> erzeugt, mit dem man dann wie mit einem normalen Objekt weiter arbeiten kann. Die Methoden sind
allerdings nicht implementiert ...</p>
<p>Mit Hilfe von <code>when().thenReturn()</code> kann man definieren, was genau beim Aufruf einer bestimmten Methode auf dem
Mock passieren soll, d.h. welcher Rückgabewert entsprechend zurückgegeben werden soll. Hier kann man dann für
bestimmte Argumentwerte andere Rückgabewerte definieren. <code>when(lsf.ergebnis(&quot;Harald&quot;, &quot;PM-Dungeon&quot;)).thenReturn(80)</code>
gibt also für den Aufruf von <code>ergebnis</code> mit den Argumenten <code>&quot;Harald&quot;</code> und <code>&quot;PM-Dungeon&quot;</code> auf dem Mock <code>lsf</code>
den Wert 80 zurück.</p>
<p>Dies kann man in weiten Grenzen flexibel anpassen.</p>
<p>Mit Hilfe der Argument-Matcher <code>anyString()</code> wird jedes String-Argument akzeptiert.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/StudiMockTest.java" target="_blank"><span class="title">Demo hsbi.StudiMockTest</span></a></span></div>
<h2 id="mockito-spy--wrapper-um-ein-objekt">Mockito: Spy = Wrapper um ein Objekt</h2>
<p>Team B hat das <code>LSF</code> nun implementiert und Team A kann es endlich für die Tests benutzen. Aber
das <code>LSF</code> hat eine Zufallskomponente (<code>ergebnis()</code>). Wie kann man nun die Reaktion des Studis
testen (<code>einsicht()</code>)?</p>
<p><strong>Lösung</strong>: Mockito-Spy als partieller Mock einer Klasse (Wrapper um ein Objekt): <code>spy()</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StudiSpyTest</span> {
</span></span><span style="display:flex;"><span>    Studi studi;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() { lsf <span style="color:#f92672">=</span> spy(LSF.<span style="color:#a6e22e">class</span>);  studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() { assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtI</span>() {
</span></span><span style="display:flex;"><span>        doReturn(80).<span style="color:#a6e22e">when</span>(lsf).<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtII</span>() {
</span></span><span style="display:flex;"><span>        doReturn(40).<span style="color:#a6e22e">when</span>(lsf).<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        assertFalse(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Der Aufruf <code>spy(LSF.class)</code> erzeugt einen Spy um ein Objekt der Klasse <code>LSF</code>. Dabei bleiben zunächst die Methoden
in <code>LSF</code> erhalten und können aufgerufen werden, sie können aber auch mit einem (partiellen) Mock überlagert werden.
Der Spy zeichnet wie der Mock die Interaktion mit dem Objekt auf.</p>
<p>Mit Hilfe von <code>doReturn().when()</code> kann man definieren, was genau beim Aufruf einer bestimmten Methode auf dem
Spy passieren soll, d.h. welcher Rückgabewert entsprechend zurückgegeben werden soll. Hier kann man analog zum Mock
für bestimmte Argumentwerte andere Rückgabewerte definieren. <code>doReturn(40).when(lsf).ergebnis(&quot;Harald&quot;, &quot;PM-Dungeon&quot;)</code>
gibt also für den Aufruf von <code>ergebnis</code> mit den Argumenten <code>&quot;Harald&quot;</code> und <code>&quot;PM-Dungeon&quot;</code> auf dem Spy <code>lsf</code> den Wert
40 zurück.</p>
<p>Wenn man die Methoden nicht mit einem partiellen Mock überschreibt, dann wird einfach die originale Methode aufgerufen
(Beispiel: In <code>studi.anmelden(&quot;PM-Dungeon&quot;)</code> wird <code>lsf.anmelden(&quot;Harald&quot;, &quot;PM-Dungeon&quot;)</code> aufgerufen.).</p>
<p>Auch hier können Argument-Matcher wie <code>anyString()</code> eingesetzt werden.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/StudiSpyTest.java" target="_blank"><span class="title">Demo hsbi.StudiSpyTest</span></a></span></div>
<h2 id="wurde-eine-methode-aufgerufen">Wurde eine Methode aufgerufen?</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VerifyTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() {
</span></span><span style="display:flex;"><span>        LSF lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);  Studi studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, atLeast(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        verify(lsf, atMost(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, never()).<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verifyNoMoreInteractions(lsf);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Mit der Methode <code>verify()</code> kann auf einem Mock oder Spy überprüft werden, ob und wie oft und in welcher Reihenfolge
Methoden aufgerufen wurden und mit welchen Argumenten. Auch hier lassen sich wieder Argument-Matcher wie <code>anyString()</code>
einsetzen.</p>
<p>Ein einfaches <code>verify(mock)</code> prüft dabei, ob die entsprechende Methode exakt einmal vorher aufgerufen wurde. Dies
ist äquivalent zu <code>verify(mock, times(1))</code>. Analog kann man mit den Parametern <code>atLeast()</code> oder <code>atMost</code> bestimmte
Unter- oder Obergrenzen für die Aufrufe angeben und mit <code>never()</code> prüfen, ob es gar keinen Aufruf vorher gab.</p>
<p><code>verifyNoMoreInteractions(lsf)</code> ist interessant: Es ist genau dann <code>true</code>, wenn es außer den vorher abgefragten
Interaktionen keinerlei sonstigen Interaktionen mit dem Mock oder Spy gab.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>LSF lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>Studi studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>when(lsf.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>InOrder inOrder <span style="color:#f92672">=</span> inOrder(lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>inOrder.<span style="color:#a6e22e">verify</span>(lsf).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;Wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>inOrder.<span style="color:#a6e22e">verify</span>(lsf).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);</span></span></code></pre></div>
<p>Mit <code>InOrder</code> lassen sich Aufrufe auf einem Mock/Spy oder auch auf verschiedenen Mocks/Spies in eine zeitliche
Reihenfolge bringen und so überprüfen.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/VerifyTest.java" target="_blank"><span class="title">Demo hsbi.VerifyTest</span></a></span></div>
<h2 id="fangen-von-argumenten">Fangen von Argumenten</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MatcherTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() {
</span></span><span style="display:flex;"><span>        LSF lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);  Studi studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(anyString(), anyString())).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>        assertFalse(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Wuppie?&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;Wuppie?&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, times(2)).<span style="color:#a6e22e">anmelden</span>(anyString(), anyString());
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(eq(<span style="color:#e6db74">&#34;Harald&#34;</span>), eq(<span style="color:#e6db74">&#34;Wuppie?&#34;</span>));
</span></span><span style="display:flex;"><span>        verify(lsf, times(2)).<span style="color:#a6e22e">anmelden</span>(argThat(<span style="color:#66d9ef">new</span> MyHaraldMatcher()), anyString());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyHaraldMatcher</span> <span style="color:#66d9ef">implements</span> ArgumentMatcher<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span>(String s) { <span style="color:#66d9ef">return</span> s.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>); }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Sie können die konkreten Argumente angeben, für die der Aufruf gelten soll. Alternativ
können Sie mit vordefinierten <code>ArgumentMatchers</code> wie <code>anyString()</code> beispielsweise auf
beliebige Strings reagieren oder selbst einen eigenen <code>ArgumentMatcher&lt;T&gt;</code> für Ihren
Typ <code>T</code> erstellen und nutzen.</p>
<p><strong>Wichtig</strong>: Wenn Sie für einen Parameter einen <code>ArgumentMatcher</code> einsetzen, müssen Sie
für die restlichen Parameter der Methode dies ebenfalls tun. Sie können keine konkreten
Argumente mit <code>ArgumentMatcher</code> mischen.</p>
<p>Sie finden viele weitere vordefinierte Matcher in der Klasse <code>ArgumentMatchers</code>.
Mit der Klasse <code>ArgumentCaptor&lt;T&gt;</code> finden Sie eine alternative Möglichkeit, auf
Argumente in gemockten Methoden zu reagieren. Schauen Sie sich dazu die Javadoc
von <a href="https://javadoc.io/doc/org.mockito/mockito-core/" rel="external" target="_blank">Mockito</a> an.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/MatcherTest.java" target="_blank"><span class="title">Demo hsbi.MatcherTest</span></a></span></div>
<h2 id="ausblick-powermock">Ausblick: PowerMock</h2>
<p>Mockito sehr mächtig, aber unterstützt (u.a.) keine</p>
<ul>
<li>Konstruktoren</li>
<li>private Methoden</li>
<li>final Methoden</li>
<li>static Methoden
(ab Version 3.4.0 scheint auch <a href="https://www.baeldung.com/mockito-mock-static-methods" rel="external" target="_blank">Mockito statische Methoden</a> zu unterstützen)</li>
</ul>
<p>=&gt; Lösung: <a href="https://github.com/powermock/powermock" rel="external" target="_blank">PowerMock</a></p>
<h2 id="ausführlicheres-beispiel-wuppiwarenlager">Ausführlicheres Beispiel: WuppiWarenlager</h2>
<p><strong>Credits</strong>: Der Dank für die Erstellung des nachfolgenden Beispiels und Textes geht an
<a href="https://github.com/jedi101" rel="external" target="_blank">@jedi101</a>.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/stub/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.stub)</span></a></span></div>
<p>Bei dem gezeigten Beispiel unseres <code>WuppiStores</code> sieht man, dass dieser
normalerweise von einem fertigen Warenlager die Wuppis beziehen möchte. Da
dieses Lager aber noch nicht existiert, haben wir uns kurzerhand einfach einen
Stub von unserem <code>IWuppiWarenlager</code>-Interface erstellt, in dem wir zu
Testzwecken händisch ein Paar Wuppis ins Lager geräumt haben.</p>
<p>Das funktioniert in diesem Mini-Testbeispiel ganz gut aber, wenn unsere Stores
erst einmal so richtig Fahrt aufnehmen und wir irgendwann weltweit Wuppis
verkaufen, wird der Code des <code>IWuppiWarenlagers</code> wahrscheinlich sehr schnell viel
komplexer werden, was unweigerlich dann zu Maintenance-Problemen unserer
händisch angelegten Tests führt. Wenn wir zum Beispiel einmal eine Methode
hinzufügen wollen, die es uns ermöglicht, nicht immer alle Wuppis aus dem Lager
zu ordern oder vielleicht noch andere Methoden, die Fluppis orderbar machen,
hinzufügen, müssen wir immer dafür sorgen, dass wir die getätigten Änderungen
händisch in den Stub des Warenlagers einpflegen.</p>
<p>Das will eigentlich niemand...</p>
<h3 id="einsatz-von-mockito">Einsatz von Mockito</h3>
<p>Aber es gibt da einen Ausweg. Wenn es komplexer wird, verwenden wir Mocks.</p>
<p>Bislang haben wir noch keinen Gebrauch von Mockito gemacht. Das ändern wir nun.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/mock/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.mock)</span></a></span></div>
<p>Wie in diesem Beispiel gezeigt, müssen wir nun keinen Stub mehr von Hand
erstellen, sondern überlassen dies Mockito.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>IWuppiWarenlager lager <span style="color:#f92672">=</span> mock(IWuppiWarenlager.<span style="color:#a6e22e">class</span>);</span></span></code></pre></div>
<p>Anschließend können wir, ohne die Methode <code>getAllWuppis()</code> implementiert zu haben,
dennoch so tun als, ob die Methode eine Funktionalität hätte.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Erstellen eines imaginären Lagerbestands.</span>
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> wuppisImLager <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#e6db74">&#34;GruenerWuppi&#34;</span>,<span style="color:#e6db74">&#34;RoterWuppi&#34;</span>);
</span></span><span style="display:flex;"><span>when(lager.<span style="color:#a6e22e">getAlleWuppis</span>()).<span style="color:#a6e22e">thenReturn</span>(wuppisImLager);</span></span></code></pre></div>
<p>Wann immer nun die Methode <code>getAlleWuppis()</code> des gemockten Lagers aufgerufen
wird, wird dieser Aufruf von Mockito abgefangen und wie oben definiert
verändert. Das Ergebnis können wir abschließend einfach in unserem Test testen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Erzeugen des WuppiStores.</span>
</span></span><span style="display:flex;"><span>WuppiStore wuppiStore <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> WuppiStore(lager);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Bestelle alle Wuppis aus dem gemockten Lager List&lt;String&gt;</span>
</span></span><span style="display:flex;"><span>bestellteWuppis <span style="color:#f92672">=</span> wuppiStore.<span style="color:#a6e22e">bestelleAlleWuppis</span>(lager);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Hat die Bestellung geklappt?</span>
</span></span><span style="display:flex;"><span>assertEquals(2,bestellteWuppis.<span style="color:#a6e22e">size</span>());</span></span></code></pre></div>
<h3 id="mockito-spies">Mockito Spies</h3>
<p>Manchmal möchten wir allerdings nicht immer gleich ein ganzes Objekt mocken,
aber dennoch Einfluss auf die aufgerufenen Methoden eines Objekts haben, um
diese testen zu können. Vielleicht gibt es dabei ja sogar eine Möglichkeit unsere
JUnit-Tests, mit denen wir normalerweise nur Rückgabewerte von Methoden testen
können, zusätzlich auch das Verhalten also die Interaktionen mit einem Objekt
beobachtbar zu machen. Somit wären diese Interaktionen auch testbar.</p>
<p>Und genau dafür bietet Mockito eine Funktion: der sogenannte &quot;Spy&quot;.</p>
<p>Dieser Spion erlaubt es uns nun zusätzlich das Verhalten zu testen. Das geht in
die Richtung von <a href="https://de.wikipedia.org/wiki/Behavior_Driven_Development" rel="external" target="_blank">BDD - Behavior Driven Development</a>.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/spy/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.spy)</span></a></span></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Spion erstellen, der unser wuppiWarenlager überwacht.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">wuppiWarenlager</span> <span style="color:#f92672">=</span> spy(WuppiWarenlager.<span style="color:#a6e22e">class</span>);</span></span></code></pre></div>
<p>Hier hatten wir uns einen Spion erzeugt, mit dem sich anschließend das Verhalten
verändern lässt:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>when(wuppiWarenlager.<span style="color:#a6e22e">getAlleWuppis</span>()).<span style="color:#a6e22e">thenReturn</span>(Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#66d9ef">new</span> Wuppi(<span style="color:#e6db74">&#34;Wuppi007&#34;</span>)));</span></span></code></pre></div>
<p>Aber auch der Zugriff lässt sich kontrollieren/testen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>verify(wuppiWarenlager).<span style="color:#a6e22e">addWuppi</span>(normalerWuppi);
</span></span><span style="display:flex;"><span>verifyNoMoreInteractions(wuppiWarenlager);</span></span></code></pre></div>
<p>Die normalen Testmöglichkeiten von JUnit runden unseren Test zudem ab.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>assertEquals(1,wuppiWarenlager.<span style="color:#a6e22e">lager</span>.<span style="color:#a6e22e">size</span>());</span></span></code></pre></div>
<h2 id="mockito-und-annotationen">Mockito und Annotationen</h2>
<p>In Mockito können Sie wie oben gezeigt mit <code>mock()</code> und <code>spy()</code> neue
Mocks bzw. Spies erzeugen und mit <code>verify()</code> die Interaktion überprüfen
und mit <code>ArgumentMatcher&lt;T&gt;</code> bzw. den vordefinierten <code>ArgumentMatchers</code>
auf Argumente zuzugreifen bzw. darauf zu reagieren.</p>
<p>Zusätzlich/alternativ gibt es in Mockito zahlreiche Annotationen, die
<strong>ersatzweise</strong> statt der genannten Methoden genutzt werden können. Hier
ein kleiner Überblick über die wichtigsten in Mockito verwendeten Annotation:</p>
<ul>
<li>
<p><code>@Mock</code> wird zum Markieren des zu mockenden Objekts verwendet.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Mock</span>
</span></span><span style="display:flex;"><span>WuppiWarenlager lager;</span></span></code></pre></div>
</li>
<li>
<p><code>@RunWith(MockitoJUnitRunner.class)</code> ist der entsprechende JUnit-Runner,
wenn Sie Mocks mit <code>@Mock</code> anlegen.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span>(MockitoJUnitRunner.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ToDoBusinessMock</span> {...}</span></span></code></pre></div>
</li>
<li>
<p><code>@Spy</code> erlaubt das Erstellen von partiell gemockten Objekten. Dabei wird eine
Art Wrapper um das zu mockende Objekt gewickelt, der dafür sorgt, dass alle
Methodenaufrufe des Objekts an den Spy delegiert werden. Diese können über den
Spion dann abgefangen/verändert oder ausgewertet werden.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Spy</span>
</span></span><span style="display:flex;"><span>ArrayList<span style="color:#f92672">&lt;</span>Wuppi<span style="color:#f92672">&gt;</span> arrayListenSpion;</span></span></code></pre></div>
</li>
<li>
<p><code>@InjectMocks</code> erlaubt es, Parameter zu markieren, in denen Mocks und/oder
Spies injiziert werden. Mockito versucht dann (in dieser Reihenfolge) per
Konstruktorinjektion, Setterinjektion oder Propertyinjektion die Mocks zu
injizieren. Weitere Informationen darüber findet man hier:
<a href="https://javadoc.io/static/org.mockito/mockito-core/4.5.1/org/mockito/InjectMocks.html" rel="external" target="_blank">Mockito Dokumentation</a></p>
<p><strong>Anmerkung</strong>: Es ist aber nicht ratsam &quot;Field- oder Setterinjection&quot; zu nutzen,
da man nur bei der Verwendung von &quot;Constructorinjection&quot; sicherstellen kann, das
eine Klasse nicht ohne die eigentlich notwendigen Parameter instanziiert wurde.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@InjectMocks</span>
</span></span><span style="display:flex;"><span>Wuppi fluppi;</span></span></code></pre></div>
</li>
<li>
<p><code>@Captor</code> erlaubt es, die Argumente einer Methode abzufangen/auszuwerten. Im
Zusammenspiel mit Mockitos <code>verify()</code>-Methode kann man somit auch die einer
Methode übergebenen Argumente verifizieren.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Captor</span>
</span></span><span style="display:flex;"><span>ArgumentCaptor<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> argumentCaptor;</span></span></code></pre></div>
</li>
<li>
<p><code>@ExtendWith(MockitoExtension.class)</code> wird in JUnit5 verwendet, um die
Initialisierung von Mocks zu vereinfachen. Damit entfällt zum Beispiel die
noch unter JUnit4 nötige Initialisierung der Mocks durch einen Aufruf der
Methode <code>MockitoAnnotations.openMocks()</code> im Setup des Tests (<code>@Before</code> bzw.
<code>@BeforeEach</code>).</p>
</li>
</ul>
<h3 id="prüfen-der-interaktion-mit-verify">Prüfen der Interaktion mit <em>verify()</em></h3>
<p>Mit Hilfe der umfangreichen <code>verify()</code>-Methoden, die uns Mockito mitliefert, können
wir unseren Code unter anderem auf unerwünschte Seiteneffekte testen. So ist es mit
<code>verify</code> zum Beispiel möglich abzufragen, ob mit einem gemockten Objekt interagiert
wurde, wie damit interagiert wurde, welche Argumente dabei übergeben worden sind und
in welcher Reihenfolge die Interaktionen damit erfolgt sind.</p>
<p>Hier nur eine kurze Übersicht über das Testen des Codes mit Hilfe von Mockitos
<code>verify()</code>-Methoden.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_DasKeineInteraktionMitDerListeStattgefundenHat</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, ob die spezifizierte Interaktion mit der Liste nie stattgefunden hat.</span>
</span></span><span style="display:flex;"><span>    verify(fluppisListe, never()).<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_ReihenfolgeDerInteraktionenMitDerFluppisListe</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, ob die Reihenfolge der spezifizierten Interaktionen mit der Liste eingehalten wurde.</span>
</span></span><span style="display:flex;"><span>    fluppisListe.<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>    InOrder reihenfolge <span style="color:#f92672">=</span> inOrder(fluppisListe);
</span></span><span style="display:flex;"><span>    reihenfolge.<span style="color:#a6e22e">verify</span>(fluppisListe).<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#34;Fluppi001&#34;</span>);
</span></span><span style="display:flex;"><span>    reihenfolge.<span style="color:#a6e22e">verify</span>(fluppisListe).<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_FlexibleArgumenteBeimZugriffAufFluppisListe</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, ob schon jemals etwas zu der Liste hinzugefügt wurde.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Dabei ist es egal welcher String eingegeben wurde.</span>
</span></span><span style="display:flex;"><span>    verify(fluppisListe).<span style="color:#a6e22e">add</span>(anyString());
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_InteraktionenMitHilfeDesArgumentCaptor</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, welches Argument beim Methodenaufruf übergeben wurde.</span>
</span></span><span style="display:flex;"><span>    fluppisListe.<span style="color:#a6e22e">addAll</span>(Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#e6db74">&#34;BobDerBaumeister&#34;</span>));
</span></span><span style="display:flex;"><span>    ArgumentCaptor<span style="color:#f92672">&lt;</span>List<span style="color:#f92672">&gt;</span> argumentMagnet <span style="color:#f92672">=</span> ArgumentCaptor.<span style="color:#a6e22e">forClass</span>(FluppisListe.<span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>    verify(fluppisListe).<span style="color:#a6e22e">addAll</span>(argumentMagnet.<span style="color:#a6e22e">capture</span>());
</span></span><span style="display:flex;"><span>    List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> argumente <span style="color:#f92672">=</span> argumentMagnet.<span style="color:#a6e22e">getValue</span>();
</span></span><span style="display:flex;"><span>    assertEquals(<span style="color:#e6db74">&#34;BobDerBaumeister&#34;</span>, argumente.<span style="color:#a6e22e">get</span>(0));
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/verify/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.verify)</span></a></span></div>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Gründliches Testen ist ebenso viel Aufwand wie Coden!</p>
</li>
<li>
<p>Mockito ergänzt JUnit:</p>
<ul>
<li>Mocken ganzer Klassen (<code>mock()</code>, <code>when().thenReturn()</code>)</li>
<li>Wrappen von Objekten (<code>spy()</code>, <code>doReturn().when()</code>)</li>
<li>Auswerten, wie häufig Methoden aufgerufen wurden (<code>verify()</code>)</li>
<li>Auswerten, mit welchen Argumenten Methoden aufgerufen wurden (<code>anyString</code>)</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106547&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Mocking (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachten Sie die drei Klassen <code>Utility.java</code>, <code>Evil.java</code>
und <code>UtilityTest.java</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Utility</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> intResult <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Evil evilClass;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Utility</span>(Evil evilClass) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">evilClass</span> <span style="color:#f92672">=</span> evilClass;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">evilMethod</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 2 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">nonEvilAdd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">evilAdd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>        evilClass.<span style="color:#a6e22e">evilMethod</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">veryEvilAdd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>        evilMethod();
</span></span><span style="display:flex;"><span>        evilClass.<span style="color:#a6e22e">evilMethod</span>();
</span></span><span style="display:flex;"><span>        intResult <span style="color:#f92672">=</span> a <span style="color:#f92672">+</span> b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getIntResult</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> intResult;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Evil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">evilMethod</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 3 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UtilityTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Utility utilityClass;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Initialisieren Sie die Attribute entsprechend vor jedem Test.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test_nonEvilAdd</span>() {
</span></span><span style="display:flex;"><span>        Assertions.<span style="color:#a6e22e">assertEquals</span>(10, utilityClass.<span style="color:#a6e22e">nonEvilAdd</span>(9, 1));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test_evilAdd</span>() {
</span></span><span style="display:flex;"><span>        Assertions.<span style="color:#a6e22e">assertEquals</span>(10, utilityClass.<span style="color:#a6e22e">evilAdd</span>(9, 1));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test_veryEvilAdd</span>() {
</span></span><span style="display:flex;"><span>        utilityClass.<span style="color:#a6e22e">veryEvilAdd</span>(9, 1);
</span></span><span style="display:flex;"><span>        Assertions.<span style="color:#a6e22e">assertEquals</span>(10, utilityClass.<span style="color:#a6e22e">getIntResult</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Testen Sie die Methoden <code>nonEvilAdd</code>, <code>evilAdd</code> und <code>veryEvilAdd</code> der
Klasse <code>Utility.java</code> mit dem <a href="https://junit.org/" rel="external" target="_blank">JUnit-</a> und dem
<a href="https://github.com/mockito/mockito" rel="external" target="_blank">Mockito-Framework</a>.</p>
<p>Vervollständigen Sie dazu die Klasse <code>UtilityTest.java</code> und nutzen Sie
Mocking mit <a href="https://github.com/mockito/mockito" rel="external" target="_blank">Mockito</a>, um die Tests
zum Laufen zu bringen. Die Tests dürfen Sie entsprechend verändern, aber
die Aufrufe aus der Vorgabe müssen erhalten bleiben. Die Klassen <code>Evil.java</code>
und <code>Utility.java</code> dürfen Sie nicht ändern.</p>
<p><em>Hinweis:</em> Die Klasse <code>Evil.java</code> und die Methode <code>evilMethod()</code> aus
<code>Utility.java</code> lösen eine ungewollte bzw. &quot;zufällige&quot; Exception aus,
auf deren Auftreten jedoch <em>nicht</em> getestet werden soll. Stattdessen
sollen diese Klassen bzw. Methoden mit Mockito &quot;weggemockt&quot; werden, so
dass die vorgegebenen Testmethoden (wieder) funktionieren.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Mockito'>[Mockito] <a href='https://github.com/mockito/mockito' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Mockito</strong></a><br>S. Faber and B. Dutheil and R. Winterhalter and T.v.d. Lippe, 2022.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

        </div>
      </main>
    </div>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/clipboard.min.js?1729954976" defer></script>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/perfect-scrollbar.min.js?1729954976" defer></script>
    <script>
      function useMathJax( config ){
        window.MathJax = Object.assign( window.MathJax || {}, {
          tex: {
            inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
            displayMath: [['\\[', '\\]'], ['$$', '$$']], 
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/mathjax/tex-mml-chtml.js?1729954976"></script>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/theme.js?1729954976" defer></script>
  </body>
</html>
