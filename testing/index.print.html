<!DOCTYPE html>
<html lang="de-DE" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.135.0">
    <meta name="generator" content="Relearn 6.4.1">
    <meta name="description" content="Einführung Softwaretest Testen mit JUnit (JUnit-Basics) Testfallermittlung: Wie viel und was muss man testen? Mocking mit Mockito">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Testen mit JUnit und Mockito">
    <meta name="twitter:description" content="Einführung Softwaretest Testen mit JUnit (JUnit-Basics) Testfallermittlung: Wie viel und was muss man testen? Mocking mit Mockito">
    <meta property="og:url" content="https://www.hsbi.de/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing.html">
    <meta property="og:title" content="Testen mit JUnit und Mockito">
    <meta property="og:description" content="Einführung Softwaretest Testen mit JUnit (JUnit-Basics) Testfallermittlung: Wie viel und was muss man testen? Mocking mit Mockito">
    <meta property="og:locale" content="de_DE">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="Testen mit JUnit und Mockito">
    <meta itemprop="description" content="Einführung Softwaretest Testen mit JUnit (JUnit-Basics) Testfallermittlung: Wie viel und was muss man testen? Mocking mit Mockito">
    <meta itemprop="wordCount" content="17">
    <title>Testen mit JUnit und Mockito</title>
    <link href="https://www.hsbi.de/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing.html" rel="canonical" type="text/html" title="Testen mit JUnit und Mockito">

    

    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/images/logo.png?1729954976" rel="icon" type="image/png">

    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fontawesome-all.min.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fontawesome-all.min.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/nucleus.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/auto-complete.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/auto-complete.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/perfect-scrollbar.min.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fonts.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fonts.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/theme.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/theme-auto.css?1729954976" rel="stylesheet" id="R-variant-style">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/chroma-auto.css?1729954976" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/variant.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/print.css?1729954976" rel="stylesheet" media="print">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/format-print.css?1729954976" rel="stylesheet">
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/variant.js?1729954976"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='.';
      window.relearn.relBaseUri='..\/..\/..\/..\/..';
      window.relearn.absBaseUri='https:\/\/www.hsbi.de\/elearning\/data\/FH-Bielefeld\/lm_data\/lm_1661234';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.index_js_url="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/index.search.js?1729954976";
      // variant stuff
      window.variants && variants.init( [ 'auto', 'zen-light', 'zen-dark', 'relearn-bright', 'relearn-light', 'relearn-dark' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script><style type="text/css">

 
.center {
    align-content: center;
    text-align: center;
    margin: auto;
}
.alert {
    color: #ff3333;
}
.bsp {
    padding: 0.05cm;
    border-width: 0.05cm;
    border-style: solid;
    border-color: #ddd;
    background-color: #ddd;
    border-radius: 25px;
    float: right;
}
.cbox {
    padding: 0.2cm;
    border-width: 0.1cm;
    border-style: solid;
    border-color: #4070a0;
    background-color: #f2f2f2;
    margin: auto;
    width: 60%;
    text-align: center;
    overflow: auto;
}
.blueArrow {
    color: #4070a0;
    font-family: "Courier New", "Courier", monospace;
    font-weight: bold;
}
.origin {
    background-color: #ededed;
    font-size: 0.8em;
}
.showme {
    background-color: #ededed;
    font-size: 0.8em;
}


 
.tldr {
    background: #dbe4ed;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.recap {
    
    
   margin: 4px 0px 26px 0px;
}
.bib {
    background: #dbe4ed;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.outcomes {
    background: #d9e9d5;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.quizzes {
    background: #d9e9d5;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.challenges {
    background: #ebe4d6;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.assignments {
    background: #ebe4d6;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
h1.tldr, h1.recap, h1.bib, h1.outcomes, h1.quizzes, h1.challenges, h1.assignments {
    padding: 0px;
}


 
.noJsAlert {
    padding: 20px;
    background-color: #f44336;  
    color: white;
    margin-bottom: 15px;
}


 
.embed-video-player {
    position: relative;
    padding-bottom: 56%;
    height: 0;
    overflow: hidden;
}
.youtube-player {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border:0;
}


 
#header-wrapper {
    padding:0.6rem;
}


 
#shortcuts {
    padding-top: 2.0rem;
}


 
#chapter p {
    text-align: left;
}


 
figcaption h4 {
    margin-top:-2.5rem;
}
.border1 {
    border:1px solid black;
}

 
td ul, td ol {
    margin: 0 0 1rem 0.5rem;
    padding: 0 0 0 0.5rem;
}

 
h1 { font-size:2.8rem !important;}
h2 { font-size:2.2rem; margin:1.2rem 0}
h3 { font-size:1.9rem; text-align:left !important; font-weight:400 !important;}
h4 { font-size:1.6rem}
h5 { font-size:1.3rem}
h6 { font-size:1rem}

h2 {
    width:100% !important;
    border-bottom:1px solid #5e5e5e !important;
    padding-bottom: 2px;
}
.tldr h2, .recap h2, .bib h2, .outcomes h2, .quizzes h2, .challenges h2, .assignments h2 {
    margin:0.5rem 0
}

.btn-crossreference, .btn-crossreference:hover {
    cursor: initial;
}

</style>

  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <span class="topbar-breadcrumbs highlightable">
            Testen mit JUnit und Mockito
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable default" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="default">
            <header class="headline">
            </header>

<h1 id="testen-mit-junit-und-mockito">Testen mit JUnit und Mockito</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro.html">Einführung Softwaretest</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics.html">Testen mit JUnit (JUnit-Basics)</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases.html">Testfallermittlung: Wie viel und was muss man testen?</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/mockito.html">Mocking mit Mockito</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Testen mit JUnit und Mockito</h1>
<article class="default">
<h1>Einführung Softwaretest</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Fehler schleichen sich durch Zeitdruck und hohe Komplexität schnell in ein Softwareprodukt ein. Die
Folgen können von &quot;ärgerlich&quot; über &quot;teuer&quot; bis hin zu (potentiell) &quot;tödlich&quot; reichen. Richtiges
Testen ist also ein wichtiger Aspekt bei der Softwareentwicklung!</p>
<p>JUnit ist ein Java-Framework, mit dem Unit-Tests (aber auch andere Teststufen) implementiert werden
können. In JUnit 4 und 5 zeichnet man eine Testmethode mit Hilfe der Annotation <code>@Test</code> an der
entsprechenden Methode aus. Dadurch kann man Produktiv- und Test-Code prinzipiell mischen; Best
Practice ist aber das Anlegen eines weiteren Ordners <code>test/</code> und das Spiegeln der Package-Strukturen.
Für die zu testende Klasse wird eine korrespondierende Testklasse mit dem Suffix &quot;Test&quot; (Konvention)
angelegt und dort die Testmethoden implementiert. Der IDE muss der neue <code>test/</code>-Ordner noch als
Ordner für Sourcen bzw. Tests bekannt gemacht werden. In den Testmethoden baut man den Test auf,
führt schließlich den Testschritt durch (beispielsweise konkreter Aufruf der zu testenden Methode)
und prüft anschließend mit einem <code>assert*()</code>, ob das erzielte Ergebnis dem erwarteten Ergebnis
entspricht. Ist alles OK, ist der Test &quot;grün&quot;, sonst &quot;rot&quot;.</p>
<p>Da ein fehlschlagendes <code>assert*()</code> den Test abbricht, werden eventuell danach folgende Prüfungen
<strong>nicht</strong> mehr durchgeführt und damit ggf. weitere Fehler maskiert. Deshalb ist es gute Praxis, in
einer Testmethode nur einen Testfall zu implementieren und i.d.R. auch nur ein (oder wenige) Aufrufe
von <code>assert*()</code> pro Testmethode zu haben.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/WGd83crqu4I' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Einführung Softwaretest</a></li> <li><a href='https://youtu.be/xcogVwHUo5o' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Anlegen von Testfällen mit JUnit</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/87e2aa545269a6d4c0502a18a3e800c82bc767de66612f488f17e0ff60c3a66097884212745aff556c2b76eee7a0fd8a8225d912c3a39c274020fd5b8055bb10' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Einführung Softwaretest</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Ursachen von Softwarefehlern</li> <li>(K3) Aufbauen von Tests mit JUnit 4 und 5 unter Nutzung der Annotation <code>@Test</code></li></ul>
  </div>
</div>




    <h2 id="software-fehler-und-ihre-folgen">Software-Fehler und ihre Folgen</h2>
<p><a href="#R-image-4fb12ca9ecdc22d878ed69a2b869cb73" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/swfehler.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-4fb12ca9ecdc22d878ed69a2b869cb73"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/swfehler.png?width=80%25&height=auto"></a></p>
<h2 id="einige-ursachen-für-fehler">(Einige) Ursachen für Fehler</h2>
<ul>
<li>Zeit- und Kostendruck</li>
<li>Mangelhafte Anforderungsanalyse</li>
<li>Hohe Komplexität</li>
<li>Mangelhafte Kommunikation</li>
<li>Keine/schlechte Teststrategie</li>
<li>Mangelhafte Beherrschung der Technologie</li>
<li>...</li>
</ul>
<h2 id="irgendjemand-muss-mit-deinen-bugs-leben">Irgendjemand muss mit Deinen Bugs leben!</h2>
<p>Leider gibt es im Allgemeinen keinen Weg zu zeigen, dass eine Software korrekt ist.
Man kann (neben formalen Beweisansätzen) eine Software nur unter möglichst vielen
Bedingungen ausprobieren, um zu schauen, wie sie sich verhält, und um die dabei zu
Tage tretenden Bugs zu fixen.</p>
<p>Mal abgesehen von der verbesserten <em>User-Experience</em> führt weniger fehlerbehaftete
Software auch dazu, dass man seltener mitten in der Nacht geweckt wird, weil irgendwo
wieder ein Server gecrasht ist ... Weniger fehlerbehaftete Software ist auch leichter
zu ändern und zu pflegen! In realen Projekten macht Maintenance den größten Teil an der
Softwareentwicklung aus ... Während Ihre Praktikumsprojekte vermutlich nach der Abgabe
nie wieder angeschaut werden, können echte Projekte viele Jahre bis Jahrzehnte leben!
D.h. irgendwer muss sich dann mit Ihren Bugs herumärgern - vermutlich sogar Sie selbst ;)</p>
<blockquote>
<p>Always code as if the guy who ends up maintaining your code will be a
violent psychopath who knows where you live. Code for readability.</p>
<p>-- <a href="https://groups.google.com/g/comp.lang.c++/c/rYCO5yn4lXw/m/oITtSkZOtoUJ" rel="external" target="_blank">John F. Woods</a></p>
</blockquote>
<p>Dieses Zitat taucht immer mal wieder auf, beispielsweise auf der <a href="https://twitter.com/andypiper/status/490952891058757632" rel="external" target="_blank">OSCON 2014</a> ...
Es scheint aber tatsächlich, dass <a href="https://groups.google.com/g/comp.lang.c++/c/rYCO5yn4lXw/m/oITtSkZOtoUJ" rel="external" target="_blank">John F. Woods</a>
die ursprüngliche Quelle war (vgl. <a href="https://stackoverflow.com/questions/876089/who-wrote-this-programing-saying-always-code-as-if-the-guy-who-ends-up-maintai#878436" rel="external" target="_blank">Stackoverflow: 876089</a>).</p>
<p>Da wir nur wenig Zeit haben und zudem vergesslich sind und obendrein die Komplexität
eines Projekts mit der Anzahl der Code-Zeilen i.d.R. nicht-linear ansteigt, müssen wir
das Testen automatisieren. Und hier kommt JUnit ins Spiel :)</p>
<h2 id="was-wann-testen-wichtigste-teststufen">Was wann testen? Wichtigste Teststufen</h2>
<ul>
<li>
<p><strong>Modultest</strong></p>
<ul>
<li>Testen einer Klasse und ihrer Methoden</li>
<li>Test auf gewünschtes Verhalten (Parameter, Schleifen, ...)</li>
</ul>
</li>
<li>
<p><strong>Integrationstest</strong></p>
<ul>
<li>Test des korrekten Zusammenspiels mehrerer Komponenten</li>
<li>Konzentration auf Schnittstellentests</li>
</ul>
</li>
<li>
<p><strong>Systemtest</strong></p>
<ul>
<li>Test des kompletten Systems unter produktiven Bedingungen</li>
<li>Orientiert sich an den aufgestellten Use Cases</li>
<li>Funktionale und nichtfunktionale Anforderungen testen</li>
</ul>
</li>
</ul>
<p>=&gt; Verweis auf Wahlfach &quot;Softwarequalität&quot;</p>
<h2 id="junit-test-framework-für-java">JUnit: Test-Framework für Java</h2>
<p><strong>JUnit</strong> --- Open Source Java Test-Framework zur Erstellung und
Durchführung wiederholbarer Tests</p>
<ul>
<li>
<p>JUnit 3</p>
<ul>
<li>Tests müssen in eigenen Testklassen stehen</li>
<li>Testklassen müssen von Klasse <code>TestCase</code> erben</li>
<li>Testmethoden müssen mit dem Präfix &quot;<code>test</code>&quot; beginnen</li>
</ul>
</li>
<li>
<p><strong>JUnit 4</strong></p>
<ul>
<li>Annotation <code>@Test</code> für Testmethoden</li>
<li>Kein Zwang zu spezialisierten Testklassen (insbesondere kein Zwang mehr zur Ableitung von <code>TestCase</code>)</li>
<li>Freie Namenswahl für Testmethoden (benötigen nicht mehr Präfix &quot;<code>test</code>&quot;)</li>
</ul>
<p>Damit können prinzipiell auch direkt im Source-Code Methoden als
JUnit-Testmethoden ausgezeichnet werden ... (das empfiehlt sich in der
Regel aber nicht)</p>
</li>
<li>
<p><em>JUnit 5 = JUnit Platform + JUnit Jupiter + JUnit Vintage</em></p>
<ul>
<li>Erweiterung um mächtigere Annotationen</li>
<li>Aufteilung in spezialisierte Teilprojekte</li>
</ul>
<p>Das Teilprojekt &quot;JUnit Platform&quot; ist die Grundlage für das JUnit-Framework. Es bietet
u.a. einen Console-Launcher, um Testsuiten manuell in der Konsole zu starten oder über
Builder wie Ant oder Gradle.</p>
<p>Das Teilprojekt &quot;JUnit Jupiter&quot; ist das neue Programmiermodell zum Schreiben von Tests
in JUnit 5. Es beinhaltet eine TestEngine zum Ausführen der in Jupiter geschriebenen
Tests.</p>
<p>Das Teilprojekt &quot;JUnit Vintage&quot; beinhaltet eine TestEngine zum Ausführen von Tests,
die in JUnit 3 oder JUnit 4 geschrieben sind.</p>
</li>
</ul>
<p><em>Anmerkung</em>: Wie der Name schon sagt, ist das Framework für Modultests
(&quot;Unit-Tests&quot;) gedacht. Man kann damit aber auch auf anderen Teststufen
arbeiten!</p>
<p><em>Anmerkung</em>: Im Folgenden besprechen wir JUnit am Beispiel <strong>JUnit 4</strong>, da diese Version
des Frameworks besonders stark verbreitet ist und JUnit 5 (trotz offiziellem Release) immer
noch stellenweise unfertig wirkt. Auf Unterschiede zu JUnit 5 wird an geeigneter Stelle
hingewiesen (abgesehen von Import-Statements). Mit JUnit 3 sollte nicht mehr aktiv
gearbeitet werden, d.h. insbesondere keine neuen Tests mehr erstellt werden, da diese
Version nicht mehr weiterentwickelt wird.</p>
<h2 id="anlegen-und-organisation-der-tests-mit-junit">Anlegen und Organisation der Tests mit JUnit</h2>
<div class='columns'>
<div class='column'>
<ul>
<li>
<p>Anlegen neuer Tests: Klasse auswählen, Kontextmenü <code>New &gt; JUnit Test Case</code></p>
</li>
<li>
<p><strong>Best Practice</strong>:  <span class='alert'>Spiegeln der Paket-Hierarchie</span></p>
<ul>
<li>Toplevel-Ordner <code>test</code> (statt <code>src</code>)</li>
<li>Package-Strukturen spiegeln</li>
<li>Testklassen mit Suffix &quot;<code>Test</code>&quot;</li>
</ul>
</li>
</ul>
</div>
<div class='column'>
<p><a href="#R-image-402c82c382002aa25690298d89803a6b" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/newJUnit.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-402c82c382002aa25690298d89803a6b"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/newJUnit.png?width=40%25&height=auto"></a></p>
</div>
</div>
<p>Vorteile dieses Vorgehens:</p>
<ul>
<li>Die Testklassen sind aus Java-Sicht im selben Package wie die Source-Klassen,
d.h. Zugriff auf Package-sichtbare Methoden etc. ist gewährleistet</li>
<li>Durch die Spiegelung der Packages in einem separaten Testordner erhält man
eine gute getrennte Übersicht über jeweils die Tests und die Sourcen</li>
<li>Die Wiederverwendung des Klassennamens mit dem Anhang &quot;Test&quot; erlaubt die
schnelle Erkennung, welche Tests hier vorliegen</li>
</ul>
<p>In der Paketansicht liegen dann die Source- und die Testklassen immer direkt
hintereinander (da sie im selben Paket sind und mit dem selben Namen anfangen)
=&gt; besserer Überblick!</p>
<h2 id="anmerkung-die-richtige-junit-bibliothek-muss-im-classpath-liegen">Anmerkung: Die (richtige) JUnit-Bibliothek muss im Classpath liegen!</h2>
<p>Eclipse bringt für JUnit 4 und JUnit 5 die nötigen Jar-Dateien mit und fragt beim
erstmaligen Anlegen einer neuen Testklasse, ob die für die ausgewählte Version
<strong>passenden JUnit-Jars zum Build-Path hinzugefügt</strong> werden sollen.</p>
<p>IntelliJ bringt ebenfalls eine JUnit 4 Bibliothek mit, die zum Projekt als Abhängigkeit
hinzugefügt werden muss. Für JUnit 5 bietet IntelliJ an, die Jar-Dateien herunterzuladen
und in einem passenden Ordner abzulegen.</p>
<p>Alternativ lädt man die Bibliotheken entsprechend der Anleitung unter <a href="https://junit.org/" rel="external" target="_blank">junit.org</a>
herunter und bindet sie in das Projekt ein.</p>
<h2 id="junit-45-definition-von-tests">JUnit 4+5: Definition von Tests</h2>
<p>Annotation <code>@Test</code> vor Testmethode schreiben</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.junit.Test;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import static</span> org.junit.Assert.*;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FactoryBeispielTest4</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testGetTicket</span>() {
</span></span><span style="display:flex;"><span>        fail(<span style="color:#e6db74">&#34;not implemented&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Für JUnit 5 muss statt <code>org.junit.Test</code> entsprechend <code>org.junit.jupiter.api.Test</code> importiert werden.</p>
<p>Während in JUnit 4 die Testmethoden mit der Sichtbarkeit <code>public</code> versehen sein müssen und keine
Parameter haben (dürfen), spielt die Sichtbarkeit in JUnit 5 keine Rolle (und die Testmethoden dürfen Parameter
aufweisen =&gt; vgl. Abschnitt &quot;Dependency Injection for Constructors and Methods&quot; in der JUnit-Doku).</p>
<h2 id="junit-4-ergebnis-prüfen">JUnit 4: Ergebnis prüfen</h2>
<p>Klasse <strong><code>org.junit.Assert</code></strong> enthält diverse <strong>statische</strong> Methoden zum Prüfen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Argument muss true bzw. false sein</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertTrue</span>(<span style="color:#66d9ef">boolean</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertFalse</span>(<span style="color:#66d9ef">boolean</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Gleichheit im Sinne von equals()</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertEquals</span>(Object, Object);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Test sofort fehlschlagen lassen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fail</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<p>Für JUnit 5 finden sich die Assert-Methoden im Package <code>org.junit.jupiter.api.Assertions</code>.</p>
<h2 id="anmerkung-zum-statischen-import">Anmerkung zum statischen Import</h2>
<p>Bei normalem Import der Klasse <code>Assert</code> muss man jeweils den voll qualifizierten Namen
einer statischen Methode nutzen: <code>Assert.fail()</code>.</p>
<p>Alternative statischer Import: <code>import static org.junit.Assert.fail;</code>
=&gt; <em>Statische Member</em> der importierten Klasse (oder Interface)
werden über ihre <em>unqualifizierten Namen</em> zugreifbar.
<span class='alert'>Achtung:</span> Namenskollisionen möglich!</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// nur bestimmtes Member importieren</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import static</span> packageName.className.staticMemberName;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// alle statischen Member importieren</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import static</span> packageName.className.*;</span></span></code></pre></div>
<ul>
<li>
<p>Beispiel normaler Import:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.junit.Assert;
</span></span><span style="display:flex;"><span>Assert.<span style="color:#a6e22e">fail</span>(<span style="color:#e6db74">&#34;message&#34;</span>);</span></span></code></pre></div>
</li>
<li>
<p>Beispiel statischer Import:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import static</span> org.junit.Assert.fail;
</span></span><span style="display:flex;"><span>fail(<span style="color:#e6db74">&#34;message&#34;</span>);</span></span></code></pre></div>
</li>
</ul>
<h2 id="mögliche-testausgänge-bei-junit">Mögliche Testausgänge bei JUnit</h2>
<div class='columns'>
<div class='column'>
<p><a href="#R-image-5eb1f89bcbc1e747b16f3ae3e76bdde2" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/junitErgebnis.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-5eb1f89bcbc1e747b16f3ae3e76bdde2"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/junitErgebnis.png?width=40%25&height=auto"></a></p>
</div>
<div class='column'>
<ol>
<li>
<p><strong>Error</strong>: Fehler im Programm (Test)</p>
<ul>
<li>Unbehandelte Exception</li>
<li>Abbruch (Timeout)</li>
</ul>
</li>
<li>
<p><strong>Failure</strong>: Testausgang negativ</p>
<ul>
<li>Assert fehlgeschlagen</li>
<li><code>Assert.fail()</code> aufgerufen</li>
</ul>
</li>
<li>
<p><strong>OK</strong></p>
</li>
</ol>
</div>
</div>
<h2 id="anmerkungen-zu-assert">Anmerkungen zu Assert</h2>
<ul>
<li>Pro Testmethode möglichst nur <strong>ein</strong> Assert verwenden!</li>
<li>Anderenfalls: Schlägt ein Assert fehl, wird der Rest nicht mehr überprüft ...</li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Testen ist genauso wichtig wie Coden</p>
</li>
<li>
<p>Richtiges Testen spart Geld, Zeit, ...</p>
</li>
<li>
<p>Tests auf verschiedenen Abstraktionsstufen</p>
</li>
<li>
<p>JUnit als Framework für (Unit-) Tests; hier JUnit 4 (mit Ausblick auf JUnit 5)</p>
<ul>
<li>Testmethoden mit Annotation <code>@Test</code></li>
<li>Testergebnis mit <code>assert*</code> prüfen</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106545&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz JUnit-Basics - nur erster Teil (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Einfache JUnit-Tests</strong></p>
<p>Betrachten Sie die folgende einfache (und nicht besonders sinnvolle)
Klasse <code>MyList&lt;T&gt;</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyList</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">final</span> List<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">add</span>(T element) { <span style="color:#66d9ef">return</span> list.<span style="color:#a6e22e">add</span>(element); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">size</span>() { <span style="color:#66d9ef">return</span> list.<span style="color:#a6e22e">size</span>(); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Schreiben Sie mit Hilfe von JUnit (4.x oder 5.x) einige Unit-Tests für
die beiden Methoden <code>MyList&lt;T&gt;#add</code> und <code>MyList&lt;T&gt;#size</code>.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
                    
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_fernunihagenJunit'>[fernunihagenJunit] <a href='https://wiki.fernuni-hagen.de/eclipse/index.php/Einführung_in_JUnit' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Einführung in JUnit</strong></a><br>Thies, A. und Noelke, C. und Ungerc, Fernuniversität in Hagen.</li> <li id='id_junit4'>[junit4] <a href='https://junit.org/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5</strong></a><br>The JUnit Team, 2022.</li> <li id='id_Kleuker2019'>[Kleuker2019] <strong>Qualitätssicherung durch Softwaretests</strong><br>Kleuker, S., Springer Vieweg, 2019. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-658-24886-4</a>. DOI <a href='https://doi.org/10.1007/978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>10.1007/978-3-658-24886-4</a>.</li> <li id='id_Osherove2014'>[Osherove2014] <strong>The Art of Unit Testing</strong><br>Osherove, R., Manning, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9089-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9089-3</a>.</li> <li id='id_Spillner2012'>[Spillner2012] <strong>Basiswissen Softwaretest</strong><br>Spillner, A. und Linz, T., dpunkt, 2012. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-86490-024-2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-86490-024-2</a>.</li> <li id='id_vogellaJUnit'>[vogellaJUnit] <a href='https://www.vogella.com/tutorials/JUnit/article.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5 tutorial - Learn how to write unit tests</strong></a><br>vogella GmbH, 2021.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Testen mit JUnit (JUnit-Basics)</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>In JUnit 4 und 5 werden Testmethoden mit Hilfe der Annotation <code>@Test</code> ausgezeichnet. Über die
verschiedenen <code>assert*()</code>-Methoden kann das Testergebnis mit dem erwarteten Ergebnis verglichen
werden und entsprechend ist der Test &quot;grün&quot; oder &quot;rot&quot;. Mit den verschiedenen <code>assume*()</code>-Methoden
kann dagegen geprüft werden, ob eventuelle Vorbedingungen für das Ausführen eines Testfalls
erfüllt sind - anderenfalls wird der Testfall dann übersprungen.</p>
<p>Mit Hilfe von <code>@Before</code> und <code>@After</code> können Methoden gekennzeichnet werden, die jeweils vor jeder
Testmethode und nach jeder Testmethode aufgerufen werden. Damit kann man seine Testumgebung auf-
und auch wieder abbauen (JUnit 4).</p>
<p>Erwartete Exceptions lassen sich in JUnit 4 mit einem Parameter <code>expected</code> in der Annotation <code>@Test</code>
automatisch prüfen: <code>@Test(expected=package.Exception.class)</code>. In JUnit 4 besteht die Möglichkeit,
Testklassen zu Testsuiten zusammenzufassen und gemeinsam laufen zu lassen.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/2SC40rO0ZOE' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL JUnit Basics</a></li> <li><a href='https://youtu.be/j3FK9iTHuDk' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo assume() vs. assert()</a></li> <li><a href='https://youtu.be/KsFydUSBDTc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Parametrisierte Tests mit JUnit4</a></li> <li><a href='https://youtu.be/0H-OCICktS0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Parametrisierte Tests mit JUnit5</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/e10dd378f9b18ba4a42ffbb2c13bfb83685b60fd39a221dba8658b8edcb0df032c2dcf9a1dcd44cf59aa6b483a00a19195cb5a8d117a6fbda52cfcfcf9efe5da' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL JUnit Basics</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Steuern von Tests (ignorieren, zeitliche Begrenzung)</li> <li>(K3) Prüfung von Exceptions</li> <li>(K3) Aufbau von Testsuiten mit JUnit</li></ul>
  </div>
</div>




    <h2 id="junit-ergebnis-prüfen">JUnit: Ergebnis prüfen</h2>
<p>Klasse <strong><code>org.junit.Assert</code></strong> enthält diverse <strong>statische</strong> Methoden zum Prüfen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Argument muss true bzw. false sein</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertTrue</span>(<span style="color:#66d9ef">boolean</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertFalse</span>(<span style="color:#66d9ef">boolean</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Gleichheit im Sinne von equals()</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertEquals</span>(Object, Object);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Test sofort fehlschlagen lassen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fail</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<h2 id="to-assert-or-to-assume">To &quot;assert&quot; or to &quot;assume&quot;?</h2>
<ul>
<li>
<p>Mit <code>assert*</code> werden Testergebnisse geprüft</p>
<ul>
<li>Test wird ausgeführt</li>
<li>Ergebnis: OK, Failure, Error</li>
</ul>
</li>
<li>
<p>Mit <code>assume*</code> werden Annahmen über den Zustand geprüft</p>
<ul>
<li>Test wird abgebrochen, wenn Annahme nicht erfüllt</li>
<li>Prüfen von Vorbedingungen: Ist der Test hier ausführbar/anwendbar?</li>
</ul>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/junit4/TestAssume.java" target="_blank"><span class="title">Beispiel: junit4.TestAssume</span></a></span></div>
<h2 id="setup-und-teardown-testübergreifende-konfiguration">Setup und Teardown: Testübergreifende Konfiguration</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> Studi x;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() { x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testToString</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Studi x = new Studi();</span>
</span></span><span style="display:flex;"><span>    assertEquals(x.<span style="color:#a6e22e">toString</span>(), <span style="color:#e6db74">&#34;Heinz (15cps)&#34;</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<dl>
<dt><strong><code>@Before</code></strong></dt>
<dd>wird <strong>vor jeder</strong> Testmethode aufgerufen</dd>
<dt><strong><code>@BeforeClass</code></strong></dt>
<dd>wird <strong>einmalig</strong> vor allen Tests aufgerufen (<code>static</code>!)</dd>
<dt><strong><code>@After</code></strong></dt>
<dd>wird <strong>nach jeder</strong> Testmethode aufgerufen</dd>
<dt><strong><code>@AfterClass</code></strong></dt>
<dd>wird <strong>einmalig</strong> nach allen Tests aufgerufen (<code>static</code>!)</dd>
</dl>
<p>In JUnit 5 wurden die Namen dieser Annotationen leicht geändert:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">JUnit 4</th>
          <th style="text-align: left">JUnit 5</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>@Before</code></td>
          <td style="text-align: left"><code>@BeforeEach</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>@After</code></td>
          <td style="text-align: left"><code>@AfterEach</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>@BeforeClass</code></td>
          <td style="text-align: left"><code>@BeforeAll</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>@AfterClass</code></td>
          <td style="text-align: left"><code>@AfterAll</code></td>
      </tr>
  </tbody>
</table>
<h2 id="beispiel-für-den-einsatz-von-before">Beispiel für den Einsatz von <code>@Before</code></h2>
<p>Annahme: <strong>alle/viele</strong> Testmethoden brauchen <strong>neues</strong> Objekt <code>x</code> vom Typ <code>Studi</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> Studi x;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() {
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Heinz&#34;</span>, 15);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testToString</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Studi x = new Studi(&#34;Heinz&#34;, 15);</span>
</span></span><span style="display:flex;"><span>    assertEquals(x.<span style="color:#a6e22e">toString</span>(), <span style="color:#e6db74">&#34;Name: Heinz, credits: 15&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testGetName</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Studi x = new Studi(&#34;Heinz&#34;, 15);</span>
</span></span><span style="display:flex;"><span>    assertEquals(x.<span style="color:#a6e22e">getName</span>(), <span style="color:#e6db74">&#34;Heinz&#34;</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="ignorieren-von-tests">Ignorieren von Tests</h2>
<ul>
<li>Hinzufügen der Annotation <code>@Ignore</code></li>
<li>Alternativ mit Kommentar: <code>@Ignore(&quot;Erst im nächsten Release&quot;)</code></li>
</ul>
<div class='columns'>
<div class='column'>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Ignore</span>(<span style="color:#e6db74">&#34;Warum ignoriert&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testBsp</span>() {
</span></span><span style="display:flex;"><span>    Bsp x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Bsp();
</span></span><span style="display:flex;"><span>    assertTrue(x.<span style="color:#a6e22e">isTrue</span>());
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
<div class='column'>
<p><a href="#R-image-a05749b322c6a6ae64001db33715d478" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics/junitIgnore.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-a05749b322c6a6ae64001db33715d478"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics/junitIgnore.png?width=40%25&height=auto"></a></p>
</div>
</div>
<p>In JUnit 5 wird statt der Annotation <code>@Ignore</code> die Annotation <code>@Disabled</code> mit
der selben Bedeutung verwendet. Auch hier lässt sich als Parameter ein String
mit dem Grund für das Ignorieren des Tests hinterlegen.</p>
<h2 id="vermeidung-von-endlosschleifen-timeout">Vermeidung von Endlosschleifen: Timeout</h2>
<ul>
<li>Testfälle werden nacheinander ausgeführt</li>
<li>Test mit Endlosschleife würde restliche Tests blockieren</li>
<li>Erweitern der <code>@Test</code>-Annotation mit Parameter &quot;<code>timeout</code>&quot;:
=&gt; <code>@Test(timeout=2000)</code> (Zeitangabe in Millisekunden)</li>
</ul>
<div class='columns'>
<div class='column'>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>(timeout <span style="color:#f92672">=</span> 2000)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testTestDauerlaeufer</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) { ; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
<div class='column'>
<p><a href="#R-image-fe75f3ad59af9ff80f27cf21ff4d288a" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics/junitIgnore.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-fe75f3ad59af9ff80f27cf21ff4d288a"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics/junitIgnore.png?width=40%25&height=auto"></a></p>
</div>
</div>
<p>In JUnit 5 hat die Annotation <code>@Test</code> keinen <code>timeout</code>-Parameter mehr.
Als Alternative bietet sich der Einsatz von <code>org.junit.jupiter.api.Assertions.assertTimeout</code>
an. Dabei benötigt man allerdings <em>Lambda-Ausdrücke</em> (Verweis auf spätere VL):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testTestDauerlaeufer</span>() {
</span></span><span style="display:flex;"><span>    assertTimeout(ofMillis(2000), () <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) { ; }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>(Beispiel von oben mit Hilfe von JUnit 5 formuliert)</p>
<h2 id="test-von-exceptions-expected">Test von Exceptions: Expected</h2>
<p>Traditionelles Testen von Exceptions mit <code>try</code> und <code>catch</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testExceptTradit</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>        fail(<span style="color:#e6db74">&#34;keine ArithmeticException ausgeloest&#34;</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (ArithmeticException aex) {
</span></span><span style="display:flex;"><span>        assertNotNull(aex.<span style="color:#a6e22e">getMessage</span>());
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>        fail(<span style="color:#e6db74">&#34;falsche Exception geworfen&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Der <code>expected</code>-Parameter für die <code>@Test</code>-Annotation in JUnit 4 macht
dies deutlich einfacher: <code>@Test(expected = MyException.class)</code>
=&gt; Test scheitert, wenn diese Exception <strong>nicht</strong> geworfen wird</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>(expected <span style="color:#f92672">=</span> java.<span style="color:#a6e22e">lang</span>.<span style="color:#a6e22e">ArithmeticException</span>.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testExceptAnnot</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>In JUnit 5 hat die Annotation <code>@Test</code> keinen <code>expected</code>-Parameter mehr.
Als Alternative bietet sich der Einsatz von <code>org.junit.jupiter.api.Assertions.assertThrows</code>
an. Dabei benötigt man allerdings <em>Lambda-Ausdrücke</em> (Verweis auf spätere VL):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testExceptAnnot</span>() {
</span></span><span style="display:flex;"><span>    assertThrows(java.<span style="color:#a6e22e">lang</span>.<span style="color:#a6e22e">ArithmeticException</span>.<span style="color:#a6e22e">class</span>, () <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>(Beispiel von oben mit Hilfe von JUnit 5 formuliert)</p>
<h2 id="parametrisierte-tests">Parametrisierte Tests</h2>
<p>Manchmal möchte man den selben Testfall mehrfach mit anderen Werten (Parametern)
durchführen.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Sum</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sum</span>(<span style="color:#66d9ef">int</span> i, <span style="color:#66d9ef">int</span> j) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> i <span style="color:#f92672">+</span> j;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SumTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSum</span>() {
</span></span><span style="display:flex;"><span>        Sum s <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Sum();
</span></span><span style="display:flex;"><span>        assertEquals(s.<span style="color:#a6e22e">sum</span>(1, 1), 2);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// und mit (2,2, 4), (2,2, 5), ...????</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Prinzipiell könnte man dafür entweder in einem Testfall eine Schleife schreiben,
die über die verschiedenen Parameter iteriert. In der Schleife würde dann
jeweils der Aufruf der zu testenden Methode und das gewünschte Assert passieren.
Alternativ könnte man den Testfall entsprechend oft duplizieren mit jeweils den
gewünschten Werten.</p>
<p>Beide Vorgehensweisen haben Probleme: Im ersten Fall würde die Schleife bei
einem Fehler oder unerwarteten Ergebnis abbrechen, ohne dass die restlichen
Tests (Werte) noch durchgeführt würden. Im zweiten Fall bekommt man eine
unnötig große Anzahl an Testmethoden, die bis auf die jeweiligen Werte identisch
sind (Code-Duplizierung).</p>
<h3 id="parametrisierte-tests-mit-junit-4">Parametrisierte Tests mit JUnit 4</h3>
<p>JUnit 4 bietet für dieses Problem sogenannte &quot;parametrisierte Tests&quot; an. Dafür
muss eine Testklasse in JUnit 4 folgende Bedingungen erfüllen:</p>
<ol>
<li>Die Testklasse wird mit der Annotation <code>@RunWith(Parameterized.class)</code>
ausgezeichnet.</li>
<li>Es muss eine öffentliche statische Methode geben mit der Annotation
<code>@Parameters</code>. Diese Methode liefert eine Collection zurück, wobei jedes
Element dieser Collection ein Array mit den Parametern für einen
Durchlauf der Testmethoden ist.</li>
<li>Die Parameter müssen gesetzt werden. Dafür gibt es zwei Varianten:
<ul>
<li>(A) Für jeden Parameter gibt es ein öffentliches Attribut. Diese Attribute
müssen mit der Annotation <code>@Parameter</code> markiert sein und können in den
Testmethoden normal genutzt werden. JUnit sorgt dafür, dass für jeden
Eintrag in der Collection aus der statischen <code>@Parameters</code>-Methode
diese Felder gesetzt werden und die Testmethoden aufgerufen werden.</li>
<li>(B) Alternativ gibt es einen Konstruktor, der diese Werte setzt. Die Anzahl
der Parameter im Konstruktor muss dabei exakt der Anzahl (und
Reihenfolge) der Werte in jedem Array in der von der statischen
<code>@Parameters</code>-Methode gelieferten Collection entsprechen. Der
Konstruktor wird für jeden Parametersatz einmal aufgerufen und die
Testmethoden einmal durchgeführt.</li>
</ul>
</li>
</ol>
<p>Letztlich wird damit das Kreuzprodukt aus Testmethoden und Testdaten durchgeführt.</p>
<h4 id="a-parametrisierte-tests-konstruktor-junit-4">(A) Parametrisierte Tests: Konstruktor (JUnit 4)</h4>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span>(Parameterized.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SumTestConstructor</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> s1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> s2;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> erg;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">SumTestConstructor</span>(<span style="color:#66d9ef">int</span> p1, <span style="color:#66d9ef">int</span> p2, <span style="color:#66d9ef">int</span> p3) { s1 <span style="color:#f92672">=</span> p1;  s2 <span style="color:#f92672">=</span> p2;  erg <span style="color:#f92672">=</span> p3; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Parameters</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Collection<span style="color:#f92672">&lt;</span>Object<span style="color:#f92672">[]&gt;</span> <span style="color:#a6e22e">values</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#66d9ef">new</span> Object<span style="color:#f92672">[][]</span> { { 1, 1, 2 }, { 2, 2, 4 }, { 2, 2, 5 } });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSum</span>() {
</span></span><span style="display:flex;"><span>        assertEquals(Sum.<span style="color:#a6e22e">sum</span>(s1, s2), erg);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h4 id="b-parametrisierte-tests-parameter-junit-4">(B) Parametrisierte Tests: Parameter (JUnit 4)</h4>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span>(Parameterized.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SumTestParameters</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Parameter</span>(0)  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> s1;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Parameter</span>(1)  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> s2;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Parameter</span>(2)  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> erg;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Parameters</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Collection<span style="color:#f92672">&lt;</span>Object<span style="color:#f92672">[]&gt;</span> <span style="color:#a6e22e">values</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#66d9ef">new</span> Object<span style="color:#f92672">[][]</span> { { 1, 1, 2 }, { 2, 2, 4 }, { 2, 2, 5 } });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSum</span>() {
</span></span><span style="display:flex;"><span>        assertEquals(Sum.<span style="color:#a6e22e">sum</span>(s1, s2), erg);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/junit4/" target="_blank"><span class="title">Beispiel: junit4.SumTestConstructor, junit4.SumTestParameters</span></a></span></div>
<h3 id="parametrisierte-tests-mit-junit-5">Parametrisierte Tests mit JUnit 5</h3>
<p>In JUnit 5 werden <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests" rel="external" target="_blank">parametrisierte Tests</a> mit der Annotation <a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.params/org/junit/jupiter/params/ParameterizedTest.html" rel="external" target="_blank"><code>@ParameterizedTest</code></a>
gekennzeichnet (statt mit <code>@Test</code>).</p>
<p>Mit Hilfe von <a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.params/org/junit/jupiter/params/provider/ValueSource.html" rel="external" target="_blank"><code>@ValueSource</code></a> kann man ein einfaches Array von Werten (Strings oder primitive
Datentypen) angeben, mit denen der Test ausgeführt wird. Dazu bekommt die Testmethode einen
entsprechenden passenden Parameter:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@ParameterizedTest</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@ValueSource</span>(strings <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;wuppie&#34;</span>, <span style="color:#e6db74">&#34;fluppie&#34;</span>, <span style="color:#e6db74">&#34;foo&#34;</span>})
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testWuppie</span>(String candidate) {
</span></span><span style="display:flex;"><span>    assertTrue(candidate.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;wuppie&#34;</span>));
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Alternativ lassen sich als Parameterquelle u.a. Aufzählungen (<a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.params/org/junit/jupiter/params/provider/EnumSource.html" rel="external" target="_blank"><code>@EnumSource</code></a>) oder Methoden
(<a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.params/org/junit/jupiter/params/provider/MethodSource.html" rel="external" target="_blank"><code>@MethodSource</code></a>) oder auch Komma-separierte Daten (<a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.params/org/junit/jupiter/params/provider/CsvSource.html" rel="external" target="_blank"><code>@CsvSource</code></a>) angeben.</p>
<p>Das obige Beispiel aus JUnit 4.x könnte mit Hilfe von <code>@CsvSource</code> so in JUnit 5.x umgesetzt
werden:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SumTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@ParameterizedTest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@CsvSource</span>(textBlock <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            # s1,  s2,  s1+s2
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            0,     0,   0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            10,    0,   10
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            0,     11,  11
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            -2,    10,  8
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSum</span>(<span style="color:#66d9ef">int</span> s1, <span style="color:#66d9ef">int</span> s2, <span style="color:#66d9ef">int</span> erg) {
</span></span><span style="display:flex;"><span>        assertEquals(Sum.<span style="color:#a6e22e">sum</span>(s1, s2), erg);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/junit5/" target="_blank"><span class="title">Beispiel: junit5.TestValueSource, junit5.TestMethodSource</span></a></span></div>
<h2 id="testsuiten-tests-gemeinsam-ausführen-junit-4">Testsuiten: Tests gemeinsam ausführen (JUnit 4)</h2>
<p>Eclipse: <code>New &gt; Other &gt; Java &gt; JUnit &gt; JUnit Test Suite</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.junit.runner.RunWith;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.junit.runners.Suite;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.junit.runners.Suite.SuiteClasses;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span>(Suite.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@SuiteClasses</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Hier kommen alle Testklassen rein</span>
</span></span><span style="display:flex;"><span>    PersonTest.<span style="color:#a6e22e">class</span>,
</span></span><span style="display:flex;"><span>    StudiTest.<span style="color:#a6e22e">class</span>
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyTestSuite</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// bleibt leer!!!</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="testsuiten-mit-junit-5">Testsuiten mit JUnit 5</h2>
<p>In JUnit 5 gibt es zwei Möglichkeiten, Testsuiten zu erstellen:</p>
<ul>
<li><code>@SelectPackages</code>: Angabe der Packages, die für die Testsuite zusammengefasst werden sollen</li>
<li><code>@SelectClasses</code>: Angabe der Klassen, die für die Testsuite zusammengefasst werden sollen</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span>(JUnitPlatform.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@SelectClasses</span>({StudiTest5.<span style="color:#a6e22e">class</span>, WuppieTest5.<span style="color:#a6e22e">class</span>})
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyTestSuite5</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// bleibt leer!!!</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Zusätzlich kann man beispielsweise mit <code>@IncludeTags</code> oder <code>@ExcludeTags</code> Testmethoden mit bestimmten Tags
einbinden oder ausschließen. Beispiel: Schließe alle Tests mit Tag &quot;develop&quot; aus: <code>@ExcludeTags(&quot;develop&quot;)</code>.
Dabei wird an den Testmethoden zusätzlich das Tag <code>@Tag</code> verwendet, etwas <code>@Tag(&quot;develop&quot;)</code>.</p>
<p><strong>Achtung</strong>: Laut der offiziellen Dokumentation
<a href="https://junit.org/junit5/docs/current/user-guide/#running-tests-junit-platform-runner-test-suite" rel="external" target="_blank">(Abschnitt &quot;4.4.4. Test Suite&quot;)</a>
gilt zumindest bei der Selection über <code>@SelectPackages</code> der Zwang zu einer Namenskonvention:
Es werden dabei nur Klassen gefunden, deren Name mit <code>Test</code> beginnt oder endet!
Weiterhin werden Testsuites mit der Annotation <code>@RunWith(JUnitPlatform.class)</code> <strong>nicht</strong>
auf der &quot;JUnit 5&quot;-Plattform ausgeführt, sondern mit der JUnit 4-Infrastuktur!</p>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li>
<p>Ein Testfall behandelt exakt eine Idee/ein Szenario. Das bedeutet auch, dass man in der
Regel nur ein bis wenige <code>assert*</code> pro Testmethode benutzt.</p>
<p>(Wenn man verschiedene Ideen in eine Testmethode kombiniert, wird der Testfall
unübersichtlicher und auch auch schwerer zu warten.</p>
<p>Außerdem können so leichter versteckte Fehler auftreten: Das erste oder zweite oder dritte
<code>assert*</code> schlägt fehl - und alle dahinter kommenden <code>assert*</code> werden nicht mehr
ausgewertet!)</p>
</li>
<li>
<p>Wenn die selbe Testidee mehrfach wiederholt wird, sollte man diese Tests zu einem
parametrisierten Test zusammenfassen.</p>
<p>(Das erhöht die Lesbarkeit drastisch - und man läuft auch nicht in das Problem der
Benennung der Testmethoden.)</p>
</li>
<li>
<p>Es wird nur das Verhalten der öffentlichen Schnittstelle getestet, nicht die inneren
Strukturen einer Klasse oder Methode.</p>
<p>(Es ist verlockend, auch private Methoden zu testen und in den Tests auch die
Datenstrukturen o.ä. im Blick zu behalten und zu testen. Das führt aber zu sehr
&quot;zerbrechlichen&quot; (<em>brittle</em>) Tests: Sobald sich etwas an der inneren Struktur ändert, ohne
dass sich das von außen beobachtbare Verhalten ändert und also die Klasse/Methode immer
noch ordnungsgemäß funktioniert, gehen all diese &quot;internen&quot; Tests kaputt. Nicht ohne
Grund wird in der objektorientierten Programmierung mit Kapselung (Klassen, Methoden, ...)
gearbeitet.)</p>
</li>
<li>
<p>Von Setup- und Teardown-Methoden sollte eher sparsam Gebrauch gemacht werden.</p>
<p>(Normalerweise folgen wir in der objektorientierten Programmierung dem DRY-Prinzip (<a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" rel="external" target="_blank">Don't
repeat yourself</a>). Entsprechend
liegt es nahe, häufig benötigte Elemente in einer Setup-Methode zentral zu initialisieren
und ggf. in einer Teardown-Methode wieder freizugeben.</p>
<p>Das führt aber speziell bei Unit-Tests dazu, dass die einzelnen Testmethoden schwerer
lesbar werden: Sie hängen von einer gemeinsamen, zentralen Konfiguration ab, die man
üblicherweise nicht gleichzeitig mit dem Code der Testmethode sehen kann (begrenzter Platz
auf der Bildschirmseite).</p>
<p>Wenn nun in einem oder vielleicht mehreren Testfällen der Wunsch nach einer leicht anderen
Konfiguration auftaucht, muss man die gemeinsame Konfiguration entsprechend anpassen bzw.
erweitern. Dabei muss man dann aber <em>alle</em> anderen Testmethoden mit bedenken, die ja
ebenfalls von dieser Konfiguration abhängen! Das führt in der Praxis dann häufig dazu,
dass die gemeinsame Konfiguration sehr schnell sehr groß und verschachtelt und
entsprechend unübersichtlich wird.</p>
<p>Jede Änderung an dieser Konfiguration kann leicht einen oder mehrere Testfälle kaputt
machen (man hat ja i.d.R. nie alle Testfälle gleichzeitig im Blick), weshalb man hier
unbedingt mit passenden <code>assume*</code> arbeiten muss - aber dann kann man eigentlich auch
stattdessen die Konfiguration direkt passend für den jeweiligen Testfall in der jeweiligen
Testmethode erledigen!)</p>
</li>
<li>
<p>Wie immer sollten auch die Namen der Testmethoden klar über ihren Zweck Auskunft geben.</p>
<p>(Der Präfix &quot;test&quot; wird seit JUnit 4.x nicht mehr benötigt, aber dennoch ist es in vielen
Projekten Praxis, diesen Präfix beizubehalten - damit kann man in der Package-Ansicht in
der IDE leichter zwischen den &quot;normalen&quot; und den Testmethoden unterscheiden.)</p>
</li>
</ol>
<p>Diese Erfahrungen werden ausführlich in <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics.html#id_SWEGoogle">[SWEGoogle, pp. 231-256]</a> diskutiert.</p>
<h2 id="wrap-up">Wrap-Up</h2>
<p>JUnit als Framework für (Unit-) Tests; hier JUnit 4 (mit Ausblick auf JUnit 5)</p>
<ul>
<li>Testmethoden mit Annotation <code>@Test</code></li>
<li><code>assert</code> (Testergebnis) vs. <code>assume</code> (Testvorbedingung)</li>
<li>Aufbau der Testumgebung <code>@Before</code></li>
<li>Abbau der Testumgebung <code>@After</code></li>
<li>Steuern von Tests mit <code>@Ignore</code> oder <code>@Test(timout=XXX)</code></li>
<li>Exceptions einfordern mit <code>@Test(expected=package.Exception.class)</code></li>
<li>Tests zusammenfassen zu Testsuiten</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106545&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz JUnit-Basics (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Setup und Teardown</strong></p>
<p>Sie haben in den Challenges in &quot;Intro SW-Test&quot; erste JUnit-Tests für
die Klasse <code>MyList&lt;T&gt;</code> implementiert.</p>
<p>Wie müssten Sie Ihre JUnit-Tests anpassen, wenn Sie im obigen Szenario
Setup- und Teardown-Methoden einsetzen würden?</p>
<p><strong>Parametrisierte Tests</strong></p>
<p>Betrachten Sie die folgende einfache Klasse <code>MyMath</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyMath</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">add</span>(String s, <span style="color:#66d9ef">int</span> c) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> s.<span style="color:#a6e22e">repeat</span>(c);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Beim Testen der Methode <code>MyMath#add</code> fällt auf, dass man hier immer
wieder den selben Testfall mit lediglich anderen Werten ausführt - ein
Fall für parametrisierte Tests.</p>
<p>Schreiben Sie mit Hilfe von JUnit (4.x oder 5.x) einige parametrisierte
Unit-Tests für die Methode <code>MyMath#add</code>.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
                    
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_fernunihagenJunit'>[fernunihagenJunit] <a href='https://wiki.fernuni-hagen.de/eclipse/index.php/Einführung_in_JUnit' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Einführung in JUnit</strong></a><br>Thies, A. und Noelke, C. und Ungerc, Fernuniversität in Hagen.</li> <li id='id_junit4'>[junit4] <a href='https://junit.org/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5</strong></a><br>The JUnit Team, 2022.</li> <li id='id_Kleuker2019'>[Kleuker2019] <strong>Qualitätssicherung durch Softwaretests</strong><br>Kleuker, S., Springer Vieweg, 2019. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-658-24886-4</a>. DOI <a href='https://doi.org/10.1007/978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>10.1007/978-3-658-24886-4</a>.</li> <li id='id_Osherove2014'>[Osherove2014] <strong>The Art of Unit Testing</strong><br>Osherove, R., Manning, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9089-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9089-3</a>.</li> <li id='id_Spillner2012'>[Spillner2012] <strong>Basiswissen Softwaretest</strong><br>Spillner, A. und Linz, T., dpunkt, 2012. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-86490-024-2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-86490-024-2</a>.</li> <li id='id_SWEGoogle'>[SWEGoogle] <strong>Software Engineering at Google: Lessons Learned from Programming Over Time</strong><br>Winters, T. und Manshreck, T. und Wright, H., O'Reilly, 2020. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-49208-279-8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-49208-279-8</a>.</li> <li id='id_vogellaJUnit'>[vogellaJUnit] <a href='https://www.vogella.com/tutorials/JUnit/article.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5 tutorial - Learn how to write unit tests</strong></a><br>vogella GmbH, 2021.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Testfallermittlung: Wie viel und was muss man testen?</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Mit Hilfe der Äquivalenzklassenbildung kann man Testfälle bestimmen. Dabei wird der Eingabebereich
für jeden Parameter einer Methode in Bereiche mit gleichem Verhalten der Methode eingeteilt (die
sogenannten &quot;Äquivalenzklassen&quot;). Dabei können einige Äquivalenzklassen (ÄK) gültigen Eingabebereichen
entsprechen (&quot;gültige ÄK&quot;), also erlaubten/erwarteten Eingaben (die zum gewünschten Verhalten führen),
und die restlichen ÄK entsprechen dann ungültigen Eingabebereichen (&quot;ungültige ÄK&quot;), also nicht
erlaubten Eingaben, die von der Methode zurückgewiesen werden sollten. Jede dieser ÄK muss in mindestens
einem Testfall vorkommen, d.h. man bestimmt einen oder mehrere zufällige Werte in den ÄK. Dabei können
über mehrere Parameter hinweg verschiedene gültige ÄK in einem Testfall kombiniert werden. Bei den
ungültigen ÄK kann dagegen immer nur ein Parameter eine ungültige ÄK haben, für die restlichen Parameter
müssen gültige ÄK genutzt werden, und diese werden dabei als durch diesen Testfall &quot;nicht getestet&quot;
betrachtet.</p>
<p>Zusätzlich entstehen häufig Fehler bei den Grenzen der Bereiche, etwa in Schleifen. Deshalb führt
man zusätzlich noch eine Grenzwertanalyse durch und bestimmt für jede ÄK den unteren und den oberen
Grenzwert und erzeugt aus diesen Werten zusätzliche Testfälle.</p>
<p>Wenn in der getesteten Methode der Zustand des Objekts eine Rolle spielt, wird dieser wie ein weiterer
Eingabeparameter für die Methode betrachtet und entsprechend in die ÄK-Bildung bzw. GW-Analyse einbezogen.</p>
<p>Wenn ein Testfall sich aus den gültigen ÄK/GW speist, spricht man auch von einem &quot;Positiv-Test&quot;; wenn
ungültige ÄK/GW genutzt werden, spricht man auch von einem &quot;Negativ-Test&quot;.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/AR1WWt4AFqI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Testfallermittlung</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/6719b852fd1ce5516a7110089ca465626826ef1e6d35ab62e8ef0ca5a71e2daab68631e2ff891d9562552ba7fa1ec97033e3d6c2ac65cf22b62377d2ceb4ea37' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Testfallermittlung</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Merkmale schlecht testbaren Codes erklären</li> <li>(K2) Merkmale guter Unit-Tests erklären</li> <li>(K3) Erstellen von Testfällen mittels Äquivalenzklassenbildung und Grenzwertanalyse</li></ul>
  </div>
</div>




    <h2 id="hands-on-10-minuten-wieviel-und-was-muss-man-testen">Hands-On (10 Minuten): Wieviel und was muss man testen?</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> credits <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">addToCredits</span>(<span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (credits <span style="color:#f92672">&lt;</span> 0) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException(<span style="color:#e6db74">&#34;Negative Credits!&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">+</span> credits <span style="color:#f92672">&gt;</span> 210) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException(<span style="color:#e6db74">&#34;Mehr als 210 Credits!&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">+=</span> credits;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="jede-methode-mindestens-testen-mitauf"><em>JEDE</em> Methode mindestens testen mit/auf:</h3>
<ul>
<li>Positive Tests: Gutfall (Normalfall) =&gt; &quot;gültige ÄK/GW&quot;</li>
<li>Negativ-Tests (Fehlbedienung, ungültige Werte) =&gt; &quot;ungültige ÄK/GW&quot;</li>
<li>Rand- bzw. Extremwerte =&gt; GW</li>
<li>Exceptions</li>
</ul>
<p>=&gt; Anforderungen abgedeckt (Black-Box)?</p>
<p>=&gt; Wichtige Pfade im Code abgedeckt (White-Box)?</p>
<h3 id="praxis">Praxis</h3>
<ul>
<li>Je kritischer eine Klasse/Methode/Artefakt ist, um so intensiver testen!</li>
<li>Suche nach Kompromissen: Testkosten vs. Kosten von Folgefehlern;
beispielsweise kein Test generierter Methoden</li>
</ul>
<p>=&gt; &quot;Erzeugen&quot; der Testfälle über die Äquivalenzklassenbildung und
Grenzwertanalyse (siehe nächste Folien). Mehr dann später im Wahlfach &quot;Softwarequalität&quot; ...</p>
<h2 id="äquivalenzklassenbildung">Äquivalenzklassenbildung</h2>
<p>Beispiel: Zu testende Methode mit Eingabewert <em>x</em>, der zw. 10 und 100 liegen soll</p>
<p><a href="#R-image-0e68ff46958f0d8f955bb4ef2e454806" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases/aequivalenzklassen.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-0e68ff46958f0d8f955bb4ef2e454806"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases/aequivalenzklassen.png?width=40%25&height=auto"></a></p>
<ul>
<li>
<p>Zerlegung der Definitionsbereiche in Äquivalenzklassen (ÄK):</p>
<ul>
<li>Disjunkte Teilmengen, wobei</li>
<li>Werte <em>einer</em> ÄK führen zu <em>gleichartigem</em> Verhalten</li>
</ul>
</li>
<li>
<p>Annahme: Eingabeparameter sind untereinander unabhängig</p>
</li>
<li>
<p>Unterscheidung gültige und ungültige ÄK</p>
</li>
</ul>
<h3 id="bemerkungen">Bemerkungen</h3>
<p>Hintergrund: Da die Werte einer ÄK zu gleichartigem Verhalten führen, ist es
egal, <em>welchen</em> Wert man aus einer ÄK für den Test nimmt.</p>
<p>Formal hat man <em>eine</em> ungültige ÄK (d.h. die Menge aller ungültigen Werte). In
der Programmierpraxis macht es aber einen Unterschied, ob es sich um Werte
unterhalb oder oberhalb des erlaubten Wertebereichs handelt (Fallunterscheidung).
Beispiel: Eine Funktion soll Werte zwischen 10 und 100 verarbeiten. Dann sind
alle Werte kleiner 10 oder größer 100 mathematisch gesehen in der selben ÄK
&quot;ungültig&quot;. Praktisch macht es aber Sinn, eine ungültige ÄK für &quot;kleiner 10&quot;
und eine weitere ungültige ÄK für &quot;größer 100&quot; zu betrachten ...</p>
<p>Traditionell betrachtet man nur die Eingabeparameter. Es kann aber Sinn machen,
auch die Ausgabeseite zu berücksichtigen (ist aber u.U. nur schwierig zu
realisieren).</p>
<h3 id="faustregeln-bei-der-bildung-von-äk">Faustregeln bei der Bildung von ÄK</h3>
<ul>
<li>
<p>Falls eine Beschränkung einen Wertebereich spezifiziert:
Aufteilung in eine gültige und zwei ungültige ÄK</p>
<p>Beispiel: Eingabewert <em>x</em> soll zw. 10 und 100 liegen</p>
<ul>
<li>Gültige ÄK: <span class="math align-center">$[10, 100]$</span></li>
<li>Ungültige ÄKs: <span class="math align-center">$x < 10$</span> und <span class="math align-center">$100 < x$</span></li>
</ul>
</li>
<li>
<p>Falls eine Beschränkung eine minimale und maximale Anzahl von Werten
spezifiziert:
Aufteilung in eine gültige und zwei ungültige ÄK</p>
<p>Beispiel: Jeder Studi muss pro Semester an mindestens einer LV teilnehmen,
maximal sind 5 LVs erlaubt.</p>
<ul>
<li>Gültige ÄK: <span class="math align-center">$1 \le x \le 5$</span></li>
<li>Ungültige ÄKs: <span class="math align-center">$x = 0$</span> (keine Teilnahme) und <span class="math align-center">$5 < x$</span> (mehr als 5 Kurse)</li>
</ul>
</li>
<li>
<p>Falls eine Beschränkung eine Menge von Werten spezifiziert, die
möglicherweise unterschiedlich behandelt werden:
Für jeden Wert dieser Menge eine eigene gültige ÄK erstellen und zusätzlich
insgesamt eine ungültige ÄK</p>
<p>Beispiel: Das Hotel am Urlaubsort ermöglicht verschiedene Freizeitaktivitäten:
Segway-fahren, Tauchen, Tennis, Golf</p>
<ul>
<li>Gültige ÄKs:
<ul>
<li>Segway-fahren</li>
<li>Tauchen</li>
<li>Tennis</li>
<li>Golf</li>
</ul>
</li>
<li>Ungültige ÄK: &quot;alles andere&quot;</li>
</ul>
</li>
<li>
<p>Falls eine Beschränkung eine Situation spezifiziert, die zwingend erfüllt sein muss:
Aufteilung in eine gültige und eine ungültige ÄK</p>
</li>
</ul>
<p><em>Hinweis</em>: Werden Werte einer ÄK vermutlich nicht gleichwertig behandelt, dann
erfolgt die Aufspaltung der ÄK in kleinere ÄKs. Das ist im Grunde die analoge
Überlegung zu mehreren ungültigen ÄKs.</p>
<p>ÄKs sollten für die weitere Arbeit einheitlich und eindeutig benannt werden.
Typisches Namensschema: &quot;gÄKn&quot; und &quot;uÄKn&quot; für gültige bzw. ungültige ÄKs mit
der laufenden Nummer <span class="math align-center">$n$</span>.</p>
<h2 id="äk-erstellung-der-testfälle">ÄK: Erstellung der Testfälle</h2>
<ul>
<li>
<p>Jede ÄK durch <em>mindestens</em> <strong>einen TF</strong> abdecken</p>
</li>
<li>
<p>Dabei pro Testfall</p>
<ul>
<li><em>mehrere gültige ÄKs</em> kombinieren, oder</li>
<li>genau <em>eine ungültige ÄK</em> untersuchen
(restl. Werte aus gültigen ÄK auffüllen; diese gelten dann aber
nicht als getestet!)</li>
</ul>
</li>
</ul>
<p>Im Prinzip muss man zur Erstellung der Testfälle (TF) eine paarweise vollständige Kombination über
die ÄK bilden, d.h. jede ÄK kommt mit jeder anderen ÄK in einem TF zur Ausführung.</p>
<p><em>Erinnerung</em>: Annahme: Eingabeparameter sind untereinander unabhängig! =&gt; Es reicht, wenn <em>jede</em>
gültige ÄK <em>einmal</em> in einem TF zur Ausführung kommt. =&gt; Kombination verschiedener gültiger ÄK
in <em>einem TF</em>.</p>
<p><strong>Achtung</strong>: Dies gilt nur für die <strong>gültigen</strong> ÄK! Bei den ungültigen ÄKs dürfen diese nicht
miteinander in einem TF kombiniert werden! Bei gleichzeitiger Behandlung verschiedener ungültiger
ÄK bleiben u.U. Fehler unentdeckt, da sich die Wirkungen der ungültigen ÄK überlagern!</p>
<p><strong>Für jeden Testfall (TF) wird aus den zu kombinierenden ÄK ein zufälliger Repräsentant ausgewählt.</strong></p>
<h2 id="äk-beispiel-eingabewert-x-soll-zw-10-und-100-liegen">ÄK: Beispiel: Eingabewert <em>x</em> soll zw. 10 und 100 liegen</h2>
<h3 id="äquivalenzklassen">Äquivalenzklassen</h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Eingabe</th>
          <th style="text-align: left">gültige ÄK</th>
          <th style="text-align: left">ungültige ÄK</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><em>x</em></td>
          <td style="text-align: left">gÄK1: <span class="math align-center">$[10, 100]$</span></td>
          <td style="text-align: left">uÄK2: <span class="math align-center">$x < 10$</span></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left">uÄK3: <span class="math align-center">$100 < x$</span></td>
      </tr>
  </tbody>
</table>
<h3 id="tests">Tests</h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Testnummer</th>
          <th style="text-align: left">1</th>
          <th style="text-align: left">2</th>
          <th style="text-align: left">3</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">geprüfte ÄK</td>
          <td style="text-align: left">gÄK1</td>
          <td style="text-align: left">uÄK2</td>
          <td style="text-align: left">uÄK3</td>
      </tr>
      <tr>
          <td style="text-align: left"><em>x</em></td>
          <td style="text-align: left">42</td>
          <td style="text-align: left">7</td>
          <td style="text-align: left">120</td>
      </tr>
      <tr>
          <td style="text-align: left">Erwartetes Ergebnis</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">Exception</td>
          <td style="text-align: left">Exception</td>
      </tr>
  </tbody>
</table>
<h2 id="grenzwertanalyse">Grenzwertanalyse</h2>
<p><a href="#R-image-85af308647770a191c710dbd425f71a7" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases/grenzwerte.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-85af308647770a191c710dbd425f71a7"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases/grenzwerte.png?width=40%25&height=auto"></a></p>
<p>Beobachtung: Grenzen in Verzweigungen/Schleifen kritisch</p>
<ul>
<li>Grenzen der ÄK (kleinste und größte Werte) <strong>zusätzlich</strong> testen
<ul>
<li>&quot;gültige Grenzwerte&quot; (<em>gGW</em>): Grenzwerte von gültigen ÄK</li>
<li>&quot;ungültige Grenzwerte&quot; (<em>uGW</em>): Grenzwerte von ungültigen ÄK</li>
</ul>
</li>
</ul>
<p>Zusätzlich sinnvoll: Weitere grenznahe Werte, d.h. weitere Werte &quot;rechts&quot; und &quot;links&quot;
der Grenze nutzen.</p>
<p>Bildung der Testfälle:</p>
<ul>
<li>Jeder GW muss in mind. einem TF vorkommen</li>
</ul>
<p><strong>Pro TF darf ein GW (gültig oder ungültig) verwendet werden, die restlichen Parameter
werden (mit zufälligen Werten) aus gültigen ÄK aufgefüllt, um mögliche Grenzwertprobleme
nicht zu überlagern.</strong></p>
<h2 id="gw-beispiel-eingabewert-x-soll-zw-10-und-100-liegen">GW: Beispiel: Eingabewert <em>x</em> soll zw. 10 und 100 liegen</h2>
<h3 id="äquivalenzklassen-1">Äquivalenzklassen</h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Eingabe</th>
          <th style="text-align: left">gültige ÄK</th>
          <th style="text-align: left">ungültige ÄK</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><em>x</em></td>
          <td style="text-align: left">gÄK1: <span class="math align-center">$[10, 100]$</span></td>
          <td style="text-align: left">uÄK2: <span class="math align-center">$x < 10$</span></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left">uÄK3: <span class="math align-center">$100 < x$</span></td>
      </tr>
  </tbody>
</table>
<h3 id="grenzwertanalyse-1">Grenzwertanalyse</h3>
<p>Zusätzliche Testdaten: 9 (uÄK2o) und 10 (gÄK1u) sowie 100 (gÄK1o) und 101 (uÄK3u)</p>
<h3 id="tests-1">Tests</h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Testnummer</th>
          <th style="text-align: left">4</th>
          <th style="text-align: left">5</th>
          <th style="text-align: left">6</th>
          <th style="text-align: left">7</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">geprüfter GW</td>
          <td style="text-align: left">gÄK1u</td>
          <td style="text-align: left">gÄK1o</td>
          <td style="text-align: left">uÄK2o</td>
          <td style="text-align: left">uÄK3u</td>
      </tr>
      <tr>
          <td style="text-align: left"><em>x</em></td>
          <td style="text-align: left">10</td>
          <td style="text-align: left">100</td>
          <td style="text-align: left">9</td>
          <td style="text-align: left">101</td>
      </tr>
      <tr>
          <td style="text-align: left">Erwartetes Ergebnis</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">Exception</td>
          <td style="text-align: left">Exception</td>
      </tr>
  </tbody>
</table>
<p><strong>Hinweis</strong>: Die Ergebnisse der GW-Analyse werden <strong>zusätzlich</strong> zu den Werten aus der ÄK-Analyse
eingesetzt. Für das obige Beispiel würde man also folgende Tests aus der kombinierten ÄK- und
GW-Analyse erhalten:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Testnummer</th>
          <th style="text-align: left">1</th>
          <th style="text-align: left">2</th>
          <th style="text-align: left">3</th>
          <th style="text-align: left">4</th>
          <th style="text-align: left">5</th>
          <th style="text-align: left">6</th>
          <th style="text-align: left">7</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">geprüfte(r) ÄK/GW</td>
          <td style="text-align: left">gÄK1</td>
          <td style="text-align: left">uÄK2</td>
          <td style="text-align: left">uÄK3</td>
          <td style="text-align: left">gÄK1u</td>
          <td style="text-align: left">gÄK1o</td>
          <td style="text-align: left">uÄK2o</td>
          <td style="text-align: left">uÄK3u</td>
      </tr>
      <tr>
          <td style="text-align: left"><em>x</em></td>
          <td style="text-align: left">42</td>
          <td style="text-align: left">7</td>
          <td style="text-align: left">120</td>
          <td style="text-align: left">10</td>
          <td style="text-align: left">100</td>
          <td style="text-align: left">9</td>
          <td style="text-align: left">101</td>
      </tr>
      <tr>
          <td style="text-align: left">Erwartetes Ergebnis</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">Exception</td>
          <td style="text-align: left">Exception</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">Exception</td>
          <td style="text-align: left">Exception</td>
      </tr>
  </tbody>
</table>
<h2 id="anmerkung-analyse-abhängiger-parameter">Anmerkung: Analyse abhängiger Parameter</h2>
<p>Wenn das Ergebnis von der Kombination der Eingabewerte abhängt, dann
sollte man dies bei der Äquivalenzklassenbildung berücksichtigen: Die
ÄK sind in diesem Fall in Bezug auf die Kombinationen zu bilden!</p>
<p>Schauen Sie sich dazu das Beispiel im <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases.html#id_Kleuker2019">[Kleuker2019]</a>, Abschnitt
&quot;4.3 Analyse abhängiger Parameter&quot; an.</p>
<p>Die einfache ÄK-Bildung würde in diesem Fall versagen, da die Eingabewerte
nicht unabhängig sind. Leider ist die Betrachtung der möglichen Kombinationen
u.U. eine sehr komplexe Aufgabe ...</p>
<p>Analoge Überlegungen gelten auch für die ÄK-Bildung im Zusammenhang mit
objektorientierter Programmierung. Die Eingabewerte und der Objektzustand
müssen dann <em>gemeinsam</em> bei der ÄK-Bildung betrachtet werden!</p>
<p>Vergleiche <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases.html#id_Kleuker2019">[Kleuker2019]</a>, Abschnitt &quot;4.4 Äquivalenzklassen und Objektorientierung&quot;.</p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>Gründliches Testen ist ebenso viel Aufwand wie Coden</li>
<li>Äquivalenzklassenbildung und Grenzwertanalyse</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106546&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Testfallermittlung (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>ÄK/GW: RSV Flotte Speiche</strong></p>
<p>Der RSV Flotte Speiche hat in seiner Mitgliederverwaltung (<code>MitgliederVerwaltung</code>) die Methode
<code>testBeitritt</code> implementiert. Mit dieser Methode wird geprüft, ob neue Mitglieder in den Radsportverein
aufgenommen werden können.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MitgliederVerwaltung</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * Testet, ob ein Mitglied in den Verein aufgenommen werden kann.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * &lt;p&gt;Interessierte Personen müssen mindestens 16 Jahre alt sein, um aufgenommen
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * werden zu können. Die Motivation darf nicht zu niedrig und auch nicht zu hoch
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * sein und muss zwischen 4 und 7 (inklusive) liegen, sonst wird der Antrag
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * abgelehnt.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * &lt;p&gt;Der Wertebereich beim Alter umfasst die natürlichen Zahlen zwischen 0 und 99
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * (inklusive), bei der Motivation sind die natürlichen Zahlen zwischen 0 und 10
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * (inklusive) erlaubt.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * &lt;p&gt;Bei Verletzung der zulässigen Wertebereiche der Parameter wird eine
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * &lt;code&gt;IllegalArgumentException&lt;/code&gt; geworfen.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * @param alter       Alter in Lebensjahren, Bereich [0, 99]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * @param motivation  Motivation auf einer Scala von 0 bis 10
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * @return &lt;code&gt;true&lt;/code&gt;, wenn das Mitglied aufgenommen werden kann,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *         sonst &lt;code&gt;false&lt;/code&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * @throws &lt;code&gt;IllegalArgumentException&lt;/code&gt;, wenn Parameter außerhalb
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *                                                der zulässigen Wertebereiche
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">testBeitritt</span>(<span style="color:#66d9ef">int</span> alter, <span style="color:#66d9ef">int</span> motivation) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Implementierung versteckt</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ol>
<li>
<p>Führen Sie eine Äquivalenzklassenbildung durch und geben Sie die gefundenen Äquivalenzklassen (<em>ÄK</em>)
an: laufende Nummer, Definition (Wertebereiche o.ä.), kurze Beschreibung (gültige/ungültige ÄK,
Bedeutung).</p>
</li>
<li>
<p>Führen Sie zusätzlich eine Grenzwertanalyse durch und geben Sie die jeweiligen Grenzwerte (<em>GW</em>) an.</p>
</li>
<li>
<p>Erstellen Sie aus den ÄK und GW wie in der Vorlesung diskutiert Testfälle. Geben Sie pro Testfall (<em>TF</em>)
an, welche ÄK und/oder GW abgedeckt sind, welche Eingaben Sie vorsehen und welche Ausgabe Sie erwarten.</p>
<p><em>Hinweis</em>: Erstellen Sie separate (zusätzliche) TF für die GW, d.h. integrieren Sie diese <em>nicht</em> in die
ÄK-TF.</p>
</li>
<li>
<p>Implementieren Sie die Testfälle in JUnit (JUnit 4 oder 5).</p>
<ul>
<li>Fassen Sie die Testfälle der gültigen ÄK in einem parametrisierten Test zusammen.</li>
<li>Für die ungültigen ÄKs erstellen Sie jeweils eine eigene JUnit-Testmethode. Beachten
Sie, dass Sie auch die Exceptions testen müssen.</li>
</ul>
</li>
</ol>
<p><strong>ÄK/GW: LSF</strong></p>
<p>Das LSF bestimmt mit der Methode <code>LSF#checkStudentCPS</code>, ob ein Studierender bereits zur
Bachelorarbeit oder Praxisphase zugelassen werden kann:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSF</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Status <span style="color:#a6e22e">checkStudentCPS</span>(Student student) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (student.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&gt;=</span> Status.<span style="color:#a6e22e">BACHELOR</span>.<span style="color:#a6e22e">credits</span>) <span style="color:#66d9ef">return</span> Status.<span style="color:#a6e22e">BACHELOR</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (student.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&gt;=</span> Status.<span style="color:#a6e22e">PRAXIS</span>.<span style="color:#a6e22e">credits</span>) <span style="color:#66d9ef">return</span> Status.<span style="color:#a6e22e">PRAXIS</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">return</span> Status.<span style="color:#a6e22e">NONE</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">record</span> <span style="color:#a6e22e">Student</span>(String name, <span style="color:#66d9ef">int</span> credits, <span style="color:#66d9ef">int</span> semester) { }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">enum</span> Status {
</span></span><span style="display:flex;"><span>    NONE(0), PRAXIS(110), BACHELOR(190);  <span style="color:#75715e">// min: 0, max: 210</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> credits;
</span></span><span style="display:flex;"><span>    Status(<span style="color:#66d9ef">int</span> credits) { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">=</span> credits; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ol>
<li>Führen Sie eine Äquivalenzklassenbildung für die Methode <code>LSF#checkStudentCPS</code> durch.</li>
<li>Führen Sie zusätzlich eine Grenzwertanalyse für die Methode <code>LSF#checkStudentCPS</code> durch.</li>
<li>Erstellen Sie aus den ÄK und GW wie in der Vorlesung diskutiert Testfälle.</li>
<li>Implementieren Sie die Testfälle in JUnit (JUnit 4 oder 5).
<ul>
<li>Fassen Sie die Testfälle der gültigen ÄK in einem parametrisierten Test zusammen.</li>
<li>Für die ungültigen ÄKs erstellen Sie jeweils eine eigene JUnit-Testmethode. Beachten
Sie, dass Sie auch die Exceptions testen müssen.</li>
</ul>
</li>
</ol>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
                    
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_fernunihagenJunit'>[fernunihagenJunit] <a href='https://wiki.fernuni-hagen.de/eclipse/index.php/Einführung_in_JUnit' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Einführung in JUnit</strong></a><br>Thies, A. und Noelke, C. und Ungerc, Fernuniversität in Hagen.</li> <li id='id_junit4'>[junit4] <a href='https://junit.org/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5</strong></a><br>The JUnit Team, 2022.</li> <li id='id_Kleuker2019'>[Kleuker2019] <strong>Qualitätssicherung durch Softwaretests</strong><br>Kleuker, S., Springer Vieweg, 2019. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-658-24886-4</a>. DOI <a href='https://doi.org/10.1007/978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>10.1007/978-3-658-24886-4</a>.</li> <li id='id_Osherove2014'>[Osherove2014] <strong>The Art of Unit Testing</strong><br>Osherove, R., Manning, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9089-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9089-3</a>.</li> <li id='id_Spillner2012'>[Spillner2012] <strong>Basiswissen Softwaretest</strong><br>Spillner, A. und Linz, T., dpunkt, 2012. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-86490-024-2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-86490-024-2</a>.</li> <li id='id_vogellaJUnit'>[vogellaJUnit] <a href='https://www.vogella.com/tutorials/JUnit/article.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5 tutorial - Learn how to write unit tests</strong></a><br>vogella GmbH, 2021.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Mocking mit Mockito</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Häufig hat man es in Softwaretests mit dem Problem zu tun, dass die zu testenden Klassen von
anderen, noch nicht implementierten Klassen oder von zufälligen oder langsamen Operationen
abhängen.</p>
<p>In solchen Situationen kann man auf &quot;Platzhalter&quot; für diese Abhängigkeiten zurückgreifen. Dies
können einfache Stubs sein, also Objekte, die einfach einen festen Wert bei einem Methodenaufruf
zurückliefern oder Mocks, wo man auf die Argumente eines Methodenaufrufs reagieren kann und
passende unterschiedliche Rückgabewerte zurückgeben kann.</p>
<p>Mockito ist eine Java-Bibliothek, die zusammen mit JUnit das Mocking von Klassen in Java
erlaubt. Man kann hier zusätzlich auch die Interaktion mit dem gemockten Objekt überprüfen und
testen, ob eine bestimmte Methode mit bestimmten Argumenten aufgerufen wurde und wie oft.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/8deFZKtjXSk' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Mocking</a></li> <li><a href='https://youtu.be/WNEedC7PrVQ' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Stubs</a></li> <li><a href='https://youtu.be/avUyYVePFCI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Mocks</a></li> <li><a href='https://youtu.be/dj3pmOZfS_A' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Spy</a></li> <li><a href='https://youtu.be/CPGqhyC8BjU' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: verify()</a></li> <li><a href='https://youtu.be/JNouzOd0s-w' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Matcher</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/9531e04dd11458ea45915269aca452ba6b9978ef7b1b3a777a424d673573f75724a3fbedd0a2bec5e4d14de4025ea92ae4a966f95ee312e9f6ecca4fde4c98ef' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Mocking</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Begriffe: Mocking, Mock, Stub, Spy</li> <li>(K3) Erzeugen eines Mocks in Mockito</li> <li>(K3) Erzeugen eines Spies in Mockito</li> <li>(K3) Prüfen von Interaktion mit <em>verify()</em></li> <li>(K3) Einsatz von <em>ArgumentMatcher</em></li></ul>
  </div>
</div>




    <h2 id="motivation-entwicklung-einer-studi-prüfungsverwaltung">Motivation: Entwicklung einer Studi-/Prüfungsverwaltung</h2>
<h3 id="szenario">Szenario</h3>
<p>Zwei Teams entwickeln eine neue Studi-/Prüfungsverwaltung für die Hochschule. Ein Team modelliert dabei
die Studierenden, ein anderes Team modelliert die Prüfungsverwaltung LSF.</p>
<ul>
<li>
<p>Team A:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    String name;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Studi</span>(String name, LSF lsf) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name;  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">lsf</span> <span style="color:#f92672">=</span> lsf;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">anmelden</span>(String modul) { <span style="color:#66d9ef">return</span> lsf.<span style="color:#a6e22e">anmelden</span>(name, modul); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">einsicht</span>(String modul) { <span style="color:#66d9ef">return</span> lsf.<span style="color:#a6e22e">ergebnis</span>(name, modul) <span style="color:#f92672">&gt;</span> 50; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
<li>
<p>Team B:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSF</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">anmelden</span>(String name, String modul) { <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> UnsupportedOperationException(); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">ergebnis</span>(String name, String modul) { <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> UnsupportedOperationException(); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
</ul>
<p>Team B kommt nicht so recht vorwärts, Team A ist fertig und will schon testen.</p>
<p>Wie kann Team A seinen Code testen?</p>
<p><strong>Optionen</strong>:</p>
<ul>
<li>Gar nicht testen?!</li>
<li>Das LSF selbst implementieren? Wer pflegt das dann? =&gt; manuell implementierte Stubs</li>
<li>Das LSF durch einen Mock ersetzen =&gt; Einsatz der Bibliothek &quot;mockito&quot;</li>
</ul>
<h3 id="motivation-mocking-und-mockito">Motivation Mocking und Mockito</h3>
<p><a href="https://github.com/mockito/mockito" rel="external" target="_blank">Mockito</a> ist ein Mocking-Framework für JUnit. Es
simuliert das Verhalten eines realen Objektes oder einer realen Methode.</p>
<p>Wofür brauchen wir denn jetzt so ein Mocking-Framework überhaupt?</p>
<p>Wir wollen die Funktionalität einer Klasse isoliert vom Rest testen können.
Dabei stören uns aber bisher so ein paar Dinge:</p>
<ul>
<li>Arbeiten mit den echten Objekten ist langsam (zum Beispiel aufgrund von
Datenbankenzugriffen)</li>
<li>Objekte beinhalten oft komplexe Abhängigkeiten, die in Tests schwer abzudecken
sind</li>
<li>Manchmal existiert der zu testende Teil einer Applikation auch noch gar nicht,
sondern es gibt nur die Interfaces.</li>
<li>Oder es gibt unschöne Seiteneffekte beim Arbeiten mit den realen Objekten. Zum
Beispiel könnte es sein, das immer eine E-Mail versendet wird, wenn wir mit
einem Objekt interagieren.</li>
</ul>
<p>In solchen Situationen wollen wir eine Möglichkeit haben, das Verhalten eines
realen Objektes bzw. der Methoden zu simulieren, ohne dabei die originalen
Methoden aufrufen zu müssen. (Manchmal möchte man das dennoch, aber dazu später
mehr...)</p>
<p>Und genau hier kommt Mockito ins Spiel. Mockito hilft uns dabei, uns von den
externen Abhängigkeiten zu lösen, indem es sogenannte Mocks, Stubs oder Spies
anbietet, mit denen sich das Verhalten der realen Objekte simulieren/überwachen
und testen lässt.</p>
<h3 id="aber-was-genau-ist-denn-jetzt-eigentlich-mocking">Aber was genau ist denn jetzt eigentlich Mocking?</h3>
<p>Ein Mock-Objekt (&quot;etwas vortäuschen&quot;) ist im Software-Test ein Objekt, das als Platzhalter
(Attrappe) für das echte Objekt verwendet wird.</p>
<p>Mocks sind in JUnit-Tests immer dann nützlich, wenn man externe Abhängigkeiten
hat, auf die der eigene Code zugreift. Das können zum Beispiel externe APIs sein
oder Datenbanken etc. ... Mocks helfen einem beim Testen nun dabei, sich von diesen
externen Abhängigkeiten zu lösen und seine Softwarefunktionalität dennoch
schnell und effizient testen zu können ohne evtl. auftretende Verbindungsfehler
oder andere mögliche Seiteneffekte der externen Abhängigkeiten auszulösen.</p>
<p>Dabei simulieren Mocks die Funktionalität der externen APIs oder Datenbankzugriffe.
Auf diese Weise ist es möglich Softwaretests zu schreiben, die scheinbar die gleichen
Methoden aufrufen, die sie auch im regulären Softwarebetrieb nutzen würden, allerdings
werden diese wie oben erwähnt allerdings für die Tests nur simuliert.</p>
<p>Mocking ist also eine Technik, die in Softwaretests verwendet wird, in denen die
gemockten Objekte anstatt der realen Objekte zu Testzwecken genutzt werden. Die
gemockten Objekte liefern dabei bei einem vom Programmierer bestimmten (Dummy-) Input,
einen dazu passenden gelieferten (Dummy-) Output, der durch seine vorhersagbare
Funktionalität dann in den eigentlichen Testobjekten gut für den Test nutzbar ist.</p>
<p>Dabei ist es von Vorteil die drei Grundbegriffe &quot;Mock&quot;, &quot;Stub&quot; oder &quot;Spy&quot;, auf die wir
in der Vorlesung noch häufiger treffen werden, voneinander abgrenzen und
unterscheiden zu können.</p>
<h3 id="dabei-bezeichnet-ein">Dabei bezeichnet ein</h3>
<ul>
<li><strong>Stub</strong>: Ein Stub ist ein Objekt, dessen Methoden nur mit einer minimalen Logik
für den Test implementiert wurden. Häufig werden dabei einfach feste (konstante)
Werte zurückgeliefert, d.h. beim Aufruf einer Methode wird unabhängig von der konkreten
Eingabe immer die selbe Ausgabe zurückgeliefert.</li>
<li><strong>Mock</strong>: Ein Mock ist ein Objekt, welches im Gegensatz zum Stub bei vorher definierten
Funktionsaufrufen mit vorher definierten Argumente eine definierte Rückgabe liefert.</li>
<li><strong>Spy</strong>: Ein Spy ist ein Objekt, welches Aufrufe und übergebene Werte protokolliert und
abfragbar macht. Es ist also eine Art Wrapper um einen Stub oder einen Mock.</li>
</ul>
<h3 id="mockito-setup">Mockito Setup</h3>
<ul>
<li>
<p>Gradle: <code>build.gradle</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-groovy" data-lang="groovy"><span style="display:flex;"><span>dependencies <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    implementation <span style="color:#e6db74">&#39;junit:junit:4.13.2&#39;</span>
</span></span><span style="display:flex;"><span>    implementation <span style="color:#e6db74">&#39;org.mockito:mockito-core:4.5.1&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div>
</li>
<li>
<p>Maven: <code>pom.xml</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;groupId&gt;</span>junit<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;artifactId&gt;</span>junit<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;version&gt;</span>4.13.2<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;groupId&gt;</span>org.mockito<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;artifactId&gt;</span>mockito-core<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;version&gt;</span>4.5.1<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependencies&gt;</span></span></span></code></pre></div>
</li>
</ul>
<h2 id="manuell-stubs-implementieren">Manuell Stubs implementieren</h2>
<p>Team A könnte manuell das LSF rudimentär implementieren (nur für die Tests, einfach mit
festen Rückgabewerten): <strong>Stubs</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StudiStubTest</span> {
</span></span><span style="display:flex;"><span>    Studi studi;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() { lsf <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> LsfStub();  studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() { assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)); }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsicht</span>() { assertTrue(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Stub für das noch nicht fertige LSF</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LsfStub</span> <span style="color:#66d9ef">extends</span> LSF {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">anmelden</span>(String name, String modul) { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>; }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">ergebnis</span>(String name, String modul) { <span style="color:#66d9ef">return</span> 80; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><strong>Problem</strong>: Wartung der Tests (wenn das richtige LSF fertig ist) und Wartung der Stubs (wenn sich die Schnittstelle
des LSF ändert, muss auch der Stub nachgezogen werden).</p>
<p><strong>Problem</strong>: Der Stub hat nur eine Art minimale Default-Logik (sonst könnte man ja das LSF gleich selbst implementieren).
Wenn man im Test andere Antworten braucht, müsste man einen weiteren Stub anlegen ...</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/StudiStubTest.java" target="_blank"><span class="title">Demo hsbi.StudiStubTest</span></a></span></div>
<h2 id="mockito-mocking-von-ganzen-klassen">Mockito: Mocking von ganzen Klassen</h2>
<p><strong>Lösung</strong>: Mocking der Klasse <code>LSF</code> mit Mockito für den Test von <code>Studi</code>: <code>mock()</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StudiMockTest</span> {
</span></span><span style="display:flex;"><span>    Studi studi;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() { lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);  studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() {
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(anyString(), anyString())).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtI</span>() {
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(80);
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtII</span>() {
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(40);
</span></span><span style="display:flex;"><span>        assertFalse(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Der Aufruf <code>mock(LSF.class)</code> erzeugt einen Mock der Klasse (oder des Interfaces) <code>LSF</code>. Dabei wird ein Objekt
vom Typ <code>LSF</code> erzeugt, mit dem man dann wie mit einem normalen Objekt weiter arbeiten kann. Die Methoden sind
allerdings nicht implementiert ...</p>
<p>Mit Hilfe von <code>when().thenReturn()</code> kann man definieren, was genau beim Aufruf einer bestimmten Methode auf dem
Mock passieren soll, d.h. welcher Rückgabewert entsprechend zurückgegeben werden soll. Hier kann man dann für
bestimmte Argumentwerte andere Rückgabewerte definieren. <code>when(lsf.ergebnis(&quot;Harald&quot;, &quot;PM-Dungeon&quot;)).thenReturn(80)</code>
gibt also für den Aufruf von <code>ergebnis</code> mit den Argumenten <code>&quot;Harald&quot;</code> und <code>&quot;PM-Dungeon&quot;</code> auf dem Mock <code>lsf</code>
den Wert 80 zurück.</p>
<p>Dies kann man in weiten Grenzen flexibel anpassen.</p>
<p>Mit Hilfe der Argument-Matcher <code>anyString()</code> wird jedes String-Argument akzeptiert.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/StudiMockTest.java" target="_blank"><span class="title">Demo hsbi.StudiMockTest</span></a></span></div>
<h2 id="mockito-spy--wrapper-um-ein-objekt">Mockito: Spy = Wrapper um ein Objekt</h2>
<p>Team B hat das <code>LSF</code> nun implementiert und Team A kann es endlich für die Tests benutzen. Aber
das <code>LSF</code> hat eine Zufallskomponente (<code>ergebnis()</code>). Wie kann man nun die Reaktion des Studis
testen (<code>einsicht()</code>)?</p>
<p><strong>Lösung</strong>: Mockito-Spy als partieller Mock einer Klasse (Wrapper um ein Objekt): <code>spy()</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StudiSpyTest</span> {
</span></span><span style="display:flex;"><span>    Studi studi;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() { lsf <span style="color:#f92672">=</span> spy(LSF.<span style="color:#a6e22e">class</span>);  studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() { assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtI</span>() {
</span></span><span style="display:flex;"><span>        doReturn(80).<span style="color:#a6e22e">when</span>(lsf).<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtII</span>() {
</span></span><span style="display:flex;"><span>        doReturn(40).<span style="color:#a6e22e">when</span>(lsf).<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        assertFalse(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Der Aufruf <code>spy(LSF.class)</code> erzeugt einen Spy um ein Objekt der Klasse <code>LSF</code>. Dabei bleiben zunächst die Methoden
in <code>LSF</code> erhalten und können aufgerufen werden, sie können aber auch mit einem (partiellen) Mock überlagert werden.
Der Spy zeichnet wie der Mock die Interaktion mit dem Objekt auf.</p>
<p>Mit Hilfe von <code>doReturn().when()</code> kann man definieren, was genau beim Aufruf einer bestimmten Methode auf dem
Spy passieren soll, d.h. welcher Rückgabewert entsprechend zurückgegeben werden soll. Hier kann man analog zum Mock
für bestimmte Argumentwerte andere Rückgabewerte definieren. <code>doReturn(40).when(lsf).ergebnis(&quot;Harald&quot;, &quot;PM-Dungeon&quot;)</code>
gibt also für den Aufruf von <code>ergebnis</code> mit den Argumenten <code>&quot;Harald&quot;</code> und <code>&quot;PM-Dungeon&quot;</code> auf dem Spy <code>lsf</code> den Wert
40 zurück.</p>
<p>Wenn man die Methoden nicht mit einem partiellen Mock überschreibt, dann wird einfach die originale Methode aufgerufen
(Beispiel: In <code>studi.anmelden(&quot;PM-Dungeon&quot;)</code> wird <code>lsf.anmelden(&quot;Harald&quot;, &quot;PM-Dungeon&quot;)</code> aufgerufen.).</p>
<p>Auch hier können Argument-Matcher wie <code>anyString()</code> eingesetzt werden.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/StudiSpyTest.java" target="_blank"><span class="title">Demo hsbi.StudiSpyTest</span></a></span></div>
<h2 id="wurde-eine-methode-aufgerufen">Wurde eine Methode aufgerufen?</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VerifyTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() {
</span></span><span style="display:flex;"><span>        LSF lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);  Studi studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, atLeast(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        verify(lsf, atMost(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, never()).<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verifyNoMoreInteractions(lsf);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Mit der Methode <code>verify()</code> kann auf einem Mock oder Spy überprüft werden, ob und wie oft und in welcher Reihenfolge
Methoden aufgerufen wurden und mit welchen Argumenten. Auch hier lassen sich wieder Argument-Matcher wie <code>anyString()</code>
einsetzen.</p>
<p>Ein einfaches <code>verify(mock)</code> prüft dabei, ob die entsprechende Methode exakt einmal vorher aufgerufen wurde. Dies
ist äquivalent zu <code>verify(mock, times(1))</code>. Analog kann man mit den Parametern <code>atLeast()</code> oder <code>atMost</code> bestimmte
Unter- oder Obergrenzen für die Aufrufe angeben und mit <code>never()</code> prüfen, ob es gar keinen Aufruf vorher gab.</p>
<p><code>verifyNoMoreInteractions(lsf)</code> ist interessant: Es ist genau dann <code>true</code>, wenn es außer den vorher abgefragten
Interaktionen keinerlei sonstigen Interaktionen mit dem Mock oder Spy gab.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>LSF lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>Studi studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>when(lsf.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>InOrder inOrder <span style="color:#f92672">=</span> inOrder(lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>inOrder.<span style="color:#a6e22e">verify</span>(lsf).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;Wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>inOrder.<span style="color:#a6e22e">verify</span>(lsf).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);</span></span></code></pre></div>
<p>Mit <code>InOrder</code> lassen sich Aufrufe auf einem Mock/Spy oder auch auf verschiedenen Mocks/Spies in eine zeitliche
Reihenfolge bringen und so überprüfen.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/VerifyTest.java" target="_blank"><span class="title">Demo hsbi.VerifyTest</span></a></span></div>
<h2 id="fangen-von-argumenten">Fangen von Argumenten</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MatcherTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() {
</span></span><span style="display:flex;"><span>        LSF lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);  Studi studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(anyString(), anyString())).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>        assertFalse(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Wuppie?&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;Wuppie?&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, times(2)).<span style="color:#a6e22e">anmelden</span>(anyString(), anyString());
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(eq(<span style="color:#e6db74">&#34;Harald&#34;</span>), eq(<span style="color:#e6db74">&#34;Wuppie?&#34;</span>));
</span></span><span style="display:flex;"><span>        verify(lsf, times(2)).<span style="color:#a6e22e">anmelden</span>(argThat(<span style="color:#66d9ef">new</span> MyHaraldMatcher()), anyString());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyHaraldMatcher</span> <span style="color:#66d9ef">implements</span> ArgumentMatcher<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span>(String s) { <span style="color:#66d9ef">return</span> s.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>); }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Sie können die konkreten Argumente angeben, für die der Aufruf gelten soll. Alternativ
können Sie mit vordefinierten <code>ArgumentMatchers</code> wie <code>anyString()</code> beispielsweise auf
beliebige Strings reagieren oder selbst einen eigenen <code>ArgumentMatcher&lt;T&gt;</code> für Ihren
Typ <code>T</code> erstellen und nutzen.</p>
<p><strong>Wichtig</strong>: Wenn Sie für einen Parameter einen <code>ArgumentMatcher</code> einsetzen, müssen Sie
für die restlichen Parameter der Methode dies ebenfalls tun. Sie können keine konkreten
Argumente mit <code>ArgumentMatcher</code> mischen.</p>
<p>Sie finden viele weitere vordefinierte Matcher in der Klasse <code>ArgumentMatchers</code>.
Mit der Klasse <code>ArgumentCaptor&lt;T&gt;</code> finden Sie eine alternative Möglichkeit, auf
Argumente in gemockten Methoden zu reagieren. Schauen Sie sich dazu die Javadoc
von <a href="https://javadoc.io/doc/org.mockito/mockito-core/" rel="external" target="_blank">Mockito</a> an.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/MatcherTest.java" target="_blank"><span class="title">Demo hsbi.MatcherTest</span></a></span></div>
<h2 id="ausblick-powermock">Ausblick: PowerMock</h2>
<p>Mockito sehr mächtig, aber unterstützt (u.a.) keine</p>
<ul>
<li>Konstruktoren</li>
<li>private Methoden</li>
<li>final Methoden</li>
<li>static Methoden
(ab Version 3.4.0 scheint auch <a href="https://www.baeldung.com/mockito-mock-static-methods" rel="external" target="_blank">Mockito statische Methoden</a> zu unterstützen)</li>
</ul>
<p>=&gt; Lösung: <a href="https://github.com/powermock/powermock" rel="external" target="_blank">PowerMock</a></p>
<h2 id="ausführlicheres-beispiel-wuppiwarenlager">Ausführlicheres Beispiel: WuppiWarenlager</h2>
<p><strong>Credits</strong>: Der Dank für die Erstellung des nachfolgenden Beispiels und Textes geht an
<a href="https://github.com/jedi101" rel="external" target="_blank">@jedi101</a>.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/stub/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.stub)</span></a></span></div>
<p>Bei dem gezeigten Beispiel unseres <code>WuppiStores</code> sieht man, dass dieser
normalerweise von einem fertigen Warenlager die Wuppis beziehen möchte. Da
dieses Lager aber noch nicht existiert, haben wir uns kurzerhand einfach einen
Stub von unserem <code>IWuppiWarenlager</code>-Interface erstellt, in dem wir zu
Testzwecken händisch ein Paar Wuppis ins Lager geräumt haben.</p>
<p>Das funktioniert in diesem Mini-Testbeispiel ganz gut aber, wenn unsere Stores
erst einmal so richtig Fahrt aufnehmen und wir irgendwann weltweit Wuppis
verkaufen, wird der Code des <code>IWuppiWarenlagers</code> wahrscheinlich sehr schnell viel
komplexer werden, was unweigerlich dann zu Maintenance-Problemen unserer
händisch angelegten Tests führt. Wenn wir zum Beispiel einmal eine Methode
hinzufügen wollen, die es uns ermöglicht, nicht immer alle Wuppis aus dem Lager
zu ordern oder vielleicht noch andere Methoden, die Fluppis orderbar machen,
hinzufügen, müssen wir immer dafür sorgen, dass wir die getätigten Änderungen
händisch in den Stub des Warenlagers einpflegen.</p>
<p>Das will eigentlich niemand...</p>
<h3 id="einsatz-von-mockito">Einsatz von Mockito</h3>
<p>Aber es gibt da einen Ausweg. Wenn es komplexer wird, verwenden wir Mocks.</p>
<p>Bislang haben wir noch keinen Gebrauch von Mockito gemacht. Das ändern wir nun.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/mock/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.mock)</span></a></span></div>
<p>Wie in diesem Beispiel gezeigt, müssen wir nun keinen Stub mehr von Hand
erstellen, sondern überlassen dies Mockito.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>IWuppiWarenlager lager <span style="color:#f92672">=</span> mock(IWuppiWarenlager.<span style="color:#a6e22e">class</span>);</span></span></code></pre></div>
<p>Anschließend können wir, ohne die Methode <code>getAllWuppis()</code> implementiert zu haben,
dennoch so tun als, ob die Methode eine Funktionalität hätte.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Erstellen eines imaginären Lagerbestands.</span>
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> wuppisImLager <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#e6db74">&#34;GruenerWuppi&#34;</span>,<span style="color:#e6db74">&#34;RoterWuppi&#34;</span>);
</span></span><span style="display:flex;"><span>when(lager.<span style="color:#a6e22e">getAlleWuppis</span>()).<span style="color:#a6e22e">thenReturn</span>(wuppisImLager);</span></span></code></pre></div>
<p>Wann immer nun die Methode <code>getAlleWuppis()</code> des gemockten Lagers aufgerufen
wird, wird dieser Aufruf von Mockito abgefangen und wie oben definiert
verändert. Das Ergebnis können wir abschließend einfach in unserem Test testen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Erzeugen des WuppiStores.</span>
</span></span><span style="display:flex;"><span>WuppiStore wuppiStore <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> WuppiStore(lager);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Bestelle alle Wuppis aus dem gemockten Lager List&lt;String&gt;</span>
</span></span><span style="display:flex;"><span>bestellteWuppis <span style="color:#f92672">=</span> wuppiStore.<span style="color:#a6e22e">bestelleAlleWuppis</span>(lager);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Hat die Bestellung geklappt?</span>
</span></span><span style="display:flex;"><span>assertEquals(2,bestellteWuppis.<span style="color:#a6e22e">size</span>());</span></span></code></pre></div>
<h3 id="mockito-spies">Mockito Spies</h3>
<p>Manchmal möchten wir allerdings nicht immer gleich ein ganzes Objekt mocken,
aber dennoch Einfluss auf die aufgerufenen Methoden eines Objekts haben, um
diese testen zu können. Vielleicht gibt es dabei ja sogar eine Möglichkeit unsere
JUnit-Tests, mit denen wir normalerweise nur Rückgabewerte von Methoden testen
können, zusätzlich auch das Verhalten also die Interaktionen mit einem Objekt
beobachtbar zu machen. Somit wären diese Interaktionen auch testbar.</p>
<p>Und genau dafür bietet Mockito eine Funktion: der sogenannte &quot;Spy&quot;.</p>
<p>Dieser Spion erlaubt es uns nun zusätzlich das Verhalten zu testen. Das geht in
die Richtung von <a href="https://de.wikipedia.org/wiki/Behavior_Driven_Development" rel="external" target="_blank">BDD - Behavior Driven Development</a>.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/spy/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.spy)</span></a></span></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Spion erstellen, der unser wuppiWarenlager überwacht.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">wuppiWarenlager</span> <span style="color:#f92672">=</span> spy(WuppiWarenlager.<span style="color:#a6e22e">class</span>);</span></span></code></pre></div>
<p>Hier hatten wir uns einen Spion erzeugt, mit dem sich anschließend das Verhalten
verändern lässt:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>when(wuppiWarenlager.<span style="color:#a6e22e">getAlleWuppis</span>()).<span style="color:#a6e22e">thenReturn</span>(Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#66d9ef">new</span> Wuppi(<span style="color:#e6db74">&#34;Wuppi007&#34;</span>)));</span></span></code></pre></div>
<p>Aber auch der Zugriff lässt sich kontrollieren/testen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>verify(wuppiWarenlager).<span style="color:#a6e22e">addWuppi</span>(normalerWuppi);
</span></span><span style="display:flex;"><span>verifyNoMoreInteractions(wuppiWarenlager);</span></span></code></pre></div>
<p>Die normalen Testmöglichkeiten von JUnit runden unseren Test zudem ab.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>assertEquals(1,wuppiWarenlager.<span style="color:#a6e22e">lager</span>.<span style="color:#a6e22e">size</span>());</span></span></code></pre></div>
<h2 id="mockito-und-annotationen">Mockito und Annotationen</h2>
<p>In Mockito können Sie wie oben gezeigt mit <code>mock()</code> und <code>spy()</code> neue
Mocks bzw. Spies erzeugen und mit <code>verify()</code> die Interaktion überprüfen
und mit <code>ArgumentMatcher&lt;T&gt;</code> bzw. den vordefinierten <code>ArgumentMatchers</code>
auf Argumente zuzugreifen bzw. darauf zu reagieren.</p>
<p>Zusätzlich/alternativ gibt es in Mockito zahlreiche Annotationen, die
<strong>ersatzweise</strong> statt der genannten Methoden genutzt werden können. Hier
ein kleiner Überblick über die wichtigsten in Mockito verwendeten Annotation:</p>
<ul>
<li>
<p><code>@Mock</code> wird zum Markieren des zu mockenden Objekts verwendet.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Mock</span>
</span></span><span style="display:flex;"><span>WuppiWarenlager lager;</span></span></code></pre></div>
</li>
<li>
<p><code>@RunWith(MockitoJUnitRunner.class)</code> ist der entsprechende JUnit-Runner,
wenn Sie Mocks mit <code>@Mock</code> anlegen.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span>(MockitoJUnitRunner.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ToDoBusinessMock</span> {...}</span></span></code></pre></div>
</li>
<li>
<p><code>@Spy</code> erlaubt das Erstellen von partiell gemockten Objekten. Dabei wird eine
Art Wrapper um das zu mockende Objekt gewickelt, der dafür sorgt, dass alle
Methodenaufrufe des Objekts an den Spy delegiert werden. Diese können über den
Spion dann abgefangen/verändert oder ausgewertet werden.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Spy</span>
</span></span><span style="display:flex;"><span>ArrayList<span style="color:#f92672">&lt;</span>Wuppi<span style="color:#f92672">&gt;</span> arrayListenSpion;</span></span></code></pre></div>
</li>
<li>
<p><code>@InjectMocks</code> erlaubt es, Parameter zu markieren, in denen Mocks und/oder
Spies injiziert werden. Mockito versucht dann (in dieser Reihenfolge) per
Konstruktorinjektion, Setterinjektion oder Propertyinjektion die Mocks zu
injizieren. Weitere Informationen darüber findet man hier:
<a href="https://javadoc.io/static/org.mockito/mockito-core/4.5.1/org/mockito/InjectMocks.html" rel="external" target="_blank">Mockito Dokumentation</a></p>
<p><strong>Anmerkung</strong>: Es ist aber nicht ratsam &quot;Field- oder Setterinjection&quot; zu nutzen,
da man nur bei der Verwendung von &quot;Constructorinjection&quot; sicherstellen kann, das
eine Klasse nicht ohne die eigentlich notwendigen Parameter instanziiert wurde.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@InjectMocks</span>
</span></span><span style="display:flex;"><span>Wuppi fluppi;</span></span></code></pre></div>
</li>
<li>
<p><code>@Captor</code> erlaubt es, die Argumente einer Methode abzufangen/auszuwerten. Im
Zusammenspiel mit Mockitos <code>verify()</code>-Methode kann man somit auch die einer
Methode übergebenen Argumente verifizieren.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Captor</span>
</span></span><span style="display:flex;"><span>ArgumentCaptor<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> argumentCaptor;</span></span></code></pre></div>
</li>
<li>
<p><code>@ExtendWith(MockitoExtension.class)</code> wird in JUnit5 verwendet, um die
Initialisierung von Mocks zu vereinfachen. Damit entfällt zum Beispiel die
noch unter JUnit4 nötige Initialisierung der Mocks durch einen Aufruf der
Methode <code>MockitoAnnotations.openMocks()</code> im Setup des Tests (<code>@Before</code> bzw.
<code>@BeforeEach</code>).</p>
</li>
</ul>
<h3 id="prüfen-der-interaktion-mit-verify">Prüfen der Interaktion mit <em>verify()</em></h3>
<p>Mit Hilfe der umfangreichen <code>verify()</code>-Methoden, die uns Mockito mitliefert, können
wir unseren Code unter anderem auf unerwünschte Seiteneffekte testen. So ist es mit
<code>verify</code> zum Beispiel möglich abzufragen, ob mit einem gemockten Objekt interagiert
wurde, wie damit interagiert wurde, welche Argumente dabei übergeben worden sind und
in welcher Reihenfolge die Interaktionen damit erfolgt sind.</p>
<p>Hier nur eine kurze Übersicht über das Testen des Codes mit Hilfe von Mockitos
<code>verify()</code>-Methoden.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_DasKeineInteraktionMitDerListeStattgefundenHat</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, ob die spezifizierte Interaktion mit der Liste nie stattgefunden hat.</span>
</span></span><span style="display:flex;"><span>    verify(fluppisListe, never()).<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_ReihenfolgeDerInteraktionenMitDerFluppisListe</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, ob die Reihenfolge der spezifizierten Interaktionen mit der Liste eingehalten wurde.</span>
</span></span><span style="display:flex;"><span>    fluppisListe.<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>    InOrder reihenfolge <span style="color:#f92672">=</span> inOrder(fluppisListe);
</span></span><span style="display:flex;"><span>    reihenfolge.<span style="color:#a6e22e">verify</span>(fluppisListe).<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#34;Fluppi001&#34;</span>);
</span></span><span style="display:flex;"><span>    reihenfolge.<span style="color:#a6e22e">verify</span>(fluppisListe).<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_FlexibleArgumenteBeimZugriffAufFluppisListe</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, ob schon jemals etwas zu der Liste hinzugefügt wurde.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Dabei ist es egal welcher String eingegeben wurde.</span>
</span></span><span style="display:flex;"><span>    verify(fluppisListe).<span style="color:#a6e22e">add</span>(anyString());
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_InteraktionenMitHilfeDesArgumentCaptor</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, welches Argument beim Methodenaufruf übergeben wurde.</span>
</span></span><span style="display:flex;"><span>    fluppisListe.<span style="color:#a6e22e">addAll</span>(Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#e6db74">&#34;BobDerBaumeister&#34;</span>));
</span></span><span style="display:flex;"><span>    ArgumentCaptor<span style="color:#f92672">&lt;</span>List<span style="color:#f92672">&gt;</span> argumentMagnet <span style="color:#f92672">=</span> ArgumentCaptor.<span style="color:#a6e22e">forClass</span>(FluppisListe.<span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>    verify(fluppisListe).<span style="color:#a6e22e">addAll</span>(argumentMagnet.<span style="color:#a6e22e">capture</span>());
</span></span><span style="display:flex;"><span>    List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> argumente <span style="color:#f92672">=</span> argumentMagnet.<span style="color:#a6e22e">getValue</span>();
</span></span><span style="display:flex;"><span>    assertEquals(<span style="color:#e6db74">&#34;BobDerBaumeister&#34;</span>, argumente.<span style="color:#a6e22e">get</span>(0));
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/verify/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.verify)</span></a></span></div>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Gründliches Testen ist ebenso viel Aufwand wie Coden!</p>
</li>
<li>
<p>Mockito ergänzt JUnit:</p>
<ul>
<li>Mocken ganzer Klassen (<code>mock()</code>, <code>when().thenReturn()</code>)</li>
<li>Wrappen von Objekten (<code>spy()</code>, <code>doReturn().when()</code>)</li>
<li>Auswerten, wie häufig Methoden aufgerufen wurden (<code>verify()</code>)</li>
<li>Auswerten, mit welchen Argumenten Methoden aufgerufen wurden (<code>anyString</code>)</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106547&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Mocking (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachten Sie die drei Klassen <code>Utility.java</code>, <code>Evil.java</code>
und <code>UtilityTest.java</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Utility</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> intResult <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Evil evilClass;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Utility</span>(Evil evilClass) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">evilClass</span> <span style="color:#f92672">=</span> evilClass;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">evilMethod</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 2 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">nonEvilAdd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">evilAdd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>        evilClass.<span style="color:#a6e22e">evilMethod</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">veryEvilAdd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>        evilMethod();
</span></span><span style="display:flex;"><span>        evilClass.<span style="color:#a6e22e">evilMethod</span>();
</span></span><span style="display:flex;"><span>        intResult <span style="color:#f92672">=</span> a <span style="color:#f92672">+</span> b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getIntResult</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> intResult;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Evil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">evilMethod</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 3 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UtilityTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Utility utilityClass;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Initialisieren Sie die Attribute entsprechend vor jedem Test.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test_nonEvilAdd</span>() {
</span></span><span style="display:flex;"><span>        Assertions.<span style="color:#a6e22e">assertEquals</span>(10, utilityClass.<span style="color:#a6e22e">nonEvilAdd</span>(9, 1));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test_evilAdd</span>() {
</span></span><span style="display:flex;"><span>        Assertions.<span style="color:#a6e22e">assertEquals</span>(10, utilityClass.<span style="color:#a6e22e">evilAdd</span>(9, 1));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test_veryEvilAdd</span>() {
</span></span><span style="display:flex;"><span>        utilityClass.<span style="color:#a6e22e">veryEvilAdd</span>(9, 1);
</span></span><span style="display:flex;"><span>        Assertions.<span style="color:#a6e22e">assertEquals</span>(10, utilityClass.<span style="color:#a6e22e">getIntResult</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Testen Sie die Methoden <code>nonEvilAdd</code>, <code>evilAdd</code> und <code>veryEvilAdd</code> der
Klasse <code>Utility.java</code> mit dem <a href="https://junit.org/" rel="external" target="_blank">JUnit-</a> und dem
<a href="https://github.com/mockito/mockito" rel="external" target="_blank">Mockito-Framework</a>.</p>
<p>Vervollständigen Sie dazu die Klasse <code>UtilityTest.java</code> und nutzen Sie
Mocking mit <a href="https://github.com/mockito/mockito" rel="external" target="_blank">Mockito</a>, um die Tests
zum Laufen zu bringen. Die Tests dürfen Sie entsprechend verändern, aber
die Aufrufe aus der Vorgabe müssen erhalten bleiben. Die Klassen <code>Evil.java</code>
und <code>Utility.java</code> dürfen Sie nicht ändern.</p>
<p><em>Hinweis:</em> Die Klasse <code>Evil.java</code> und die Methode <code>evilMethod()</code> aus
<code>Utility.java</code> lösen eine ungewollte bzw. &quot;zufällige&quot; Exception aus,
auf deren Auftreten jedoch <em>nicht</em> getestet werden soll. Stattdessen
sollen diese Klassen bzw. Methoden mit Mockito &quot;weggemockt&quot; werden, so
dass die vorgegebenen Testmethoden (wieder) funktionieren.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Mockito'>[Mockito] <a href='https://github.com/mockito/mockito' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Mockito</strong></a><br>S. Faber and B. Dutheil and R. Winterhalter and T.v.d. Lippe, 2022.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
        </div>
      </main>
    </div>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/clipboard.min.js?1729954976" defer></script>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/perfect-scrollbar.min.js?1729954976" defer></script>
    <script>
      function useMathJax( config ){
        window.MathJax = Object.assign( window.MathJax || {}, {
          tex: {
            inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
            displayMath: [['\\[', '\\]'], ['$$', '$$']], 
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/mathjax/tex-mml-chtml.js?1729954976"></script>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/theme.js?1729954976" defer></script>
  </body>
</html>
