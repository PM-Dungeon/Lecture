<!DOCTYPE html>
<html lang="de-DE" dir="ltr" itemscope itemtype="http://schema.org/Article">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.135.0">
    <meta name="generator" content="Relearn 6.4.1">
    <meta name="description" content="... And, lastly, there&#39;s the explosive growth in demand, which has led to many people doing it who aren&#39;t any good at it. Code is merely a means to an end. Programming is an art and code is merely its medium. Pointing a camera at a subject does not make one a proper photographer. There are a lot of self-described coders out there who couldn&#39;t program their way out of a paper bag.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="IFM 2.1: Programmieren 2 (PO23, Sommer 2024)">
    <meta name="twitter:description" content="... And, lastly, there&#39;s the explosive growth in demand, which has led to many people doing it who aren&#39;t any good at it. Code is merely a means to an end. Programming is an art and code is merely its medium. Pointing a camera at a subject does not make one a proper photographer. There are a lot of self-described coders out there who couldn&#39;t program their way out of a paper bag.">
    <meta property="og:url" content="https://www.hsbi.de/elearning/data/FH-Bielefeld/lm_data/lm_1661234/index.html">
    <meta property="og:title" content="IFM 2.1: Programmieren 2 (PO23, Sommer 2024)">
    <meta property="og:description" content="... And, lastly, there&#39;s the explosive growth in demand, which has led to many people doing it who aren&#39;t any good at it. Code is merely a means to an end. Programming is an art and code is merely its medium. Pointing a camera at a subject does not make one a proper photographer. There are a lot of self-described coders out there who couldn&#39;t program their way out of a paper bag.">
    <meta property="og:locale" content="de_DE">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="IFM 2.1: Programmieren 2 (PO23, Sommer 2024)">
    <meta itemprop="description" content="... And, lastly, there&#39;s the explosive growth in demand, which has led to many people doing it who aren&#39;t any good at it. Code is merely a means to an end. Programming is an art and code is merely its medium. Pointing a camera at a subject does not make one a proper photographer. There are a lot of self-described coders out there who couldn&#39;t program their way out of a paper bag.">
    <meta itemprop="wordCount" content="774">
    <title>IFM 2.1: Programmieren 2 (PO23, Sommer 2024)</title>
    <link href="https://www.hsbi.de/elearning/data/FH-Bielefeld/lm_data/lm_1661234/index.html" rel="canonical" type="text/html" title="IFM 2.1: Programmieren 2 (PO23, Sommer 2024)">

    

    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/images/logo.png?1729954976" rel="icon" type="image/png">

    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fontawesome-all.min.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fontawesome-all.min.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/nucleus.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/auto-complete.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/auto-complete.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/perfect-scrollbar.min.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fonts.css?1729954976" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/fonts.css?1729954976" rel="stylesheet"></noscript>
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/theme.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/theme-auto.css?1729954976" rel="stylesheet" id="R-variant-style">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/chroma-auto.css?1729954976" rel="stylesheet" id="R-variant-chroma-style">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/variant.css?1729954976" rel="stylesheet">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/print.css?1729954976" rel="stylesheet" media="print">
    <link href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/css/format-print.css?1729954976" rel="stylesheet">
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/variant.js?1729954976"></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.relBasePath='.';
      window.relearn.relBaseUri='..\/..\/..\/..\/..';
      window.relearn.absBaseUri='https:\/\/www.hsbi.de\/elearning\/data\/FH-Bielefeld\/lm_data\/lm_1661234';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.index_js_url="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/index.search.js?1729954976";
      // variant stuff
      window.variants && variants.init( [ 'auto', 'zen-light', 'zen-dark', 'relearn-bright', 'relearn-light', 'relearn-dark' ] );
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
    </script><style type="text/css">

 
.center {
    align-content: center;
    text-align: center;
    margin: auto;
}
.alert {
    color: #ff3333;
}
.bsp {
    padding: 0.05cm;
    border-width: 0.05cm;
    border-style: solid;
    border-color: #ddd;
    background-color: #ddd;
    border-radius: 25px;
    float: right;
}
.cbox {
    padding: 0.2cm;
    border-width: 0.1cm;
    border-style: solid;
    border-color: #4070a0;
    background-color: #f2f2f2;
    margin: auto;
    width: 60%;
    text-align: center;
    overflow: auto;
}
.blueArrow {
    color: #4070a0;
    font-family: "Courier New", "Courier", monospace;
    font-weight: bold;
}
.origin {
    background-color: #ededed;
    font-size: 0.8em;
}
.showme {
    background-color: #ededed;
    font-size: 0.8em;
}


 
.tldr {
    background: #dbe4ed;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.recap {
    
    
   margin: 4px 0px 26px 0px;
}
.bib {
    background: #dbe4ed;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.outcomes {
    background: #d9e9d5;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.quizzes {
    background: #d9e9d5;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.challenges {
    background: #ebe4d6;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
.assignments {
    background: #ebe4d6;
    padding: 12px;
    margin: 4px 0px 26px 0px;
}
h1.tldr, h1.recap, h1.bib, h1.outcomes, h1.quizzes, h1.challenges, h1.assignments {
    padding: 0px;
}


 
.noJsAlert {
    padding: 20px;
    background-color: #f44336;  
    color: white;
    margin-bottom: 15px;
}


 
.embed-video-player {
    position: relative;
    padding-bottom: 56%;
    height: 0;
    overflow: hidden;
}
.youtube-player {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border:0;
}


 
#header-wrapper {
    padding:0.6rem;
}


 
#shortcuts {
    padding-top: 2.0rem;
}


 
#chapter p {
    text-align: left;
}


 
figcaption h4 {
    margin-top:-2.5rem;
}
.border1 {
    border:1px solid black;
}

 
td ul, td ol {
    margin: 0 0 1rem 0.5rem;
    padding: 0 0 0 0.5rem;
}

 
h1 { font-size:2.8rem !important;}
h2 { font-size:2.2rem; margin:1.2rem 0}
h3 { font-size:1.9rem; text-align:left !important; font-weight:400 !important;}
h4 { font-size:1.6rem}
h5 { font-size:1.3rem}
h6 { font-size:1rem}

h2 {
    width:100% !important;
    border-bottom:1px solid #5e5e5e !important;
    padding-bottom: 2px;
}
.tldr h2, .recap h2, .bib h2, .outcomes h2, .quizzes h2, .challenges h2, .assignments h2 {
    margin:0.5rem 0
}

.btn-crossreference, .btn-crossreference:hover {
    cursor: initial;
}

</style>

  </head>
  <body class="mobile-support print disableInlineCopyToClipboard" data-url="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <span class="topbar-breadcrumbs highlightable">
            IFM 2.1: Programmieren 2 (PO23, Sommer 2024)
          </span>
          <div class="topbar-area topbar-area-end" data-area="end">
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable home" tabindex="-1">
        <div class="flex-block-wrapper">
          <article class="home">
            <header class="headline">
            </header>

<h1 id="ifm-21-programmieren-2-po23-sommer-2024">IFM 2.1: Programmieren 2 (PO23, Sommer 2024)</h1>

<blockquote>
<p>... And, lastly, there's the explosive growth in demand, which has led to many
people doing it who aren't any good at it. Code is merely a means to an end.
<strong>Programming is an art and code is merely its medium.</strong>
Pointing a camera at a subject does not make one a proper photographer. There are
a lot of self-described coders out there who couldn't program their way out of a
paper bag.</p>
<p>-- John Gruber auf <a href="https://daringfireball.net/2020/04/cobol_programming_coding" rel="external" target="_blank">daringfireball.net</a></p>
</blockquote>
<h2 id="kursbeschreibung">Kursbeschreibung</h2>
<p>Sie haben letztes Semester in <strong>Prog1</strong> die <em>wichtigsten</em> Elemente und Konzepte der
Programmiersprache Java kennen gelernt.</p>
<p>In diesem Modul geht es darum, diese Kenntnisse sowohl auf der Java- als auch auf der
Methoden-Seite so zu erweitern, dass Sie gemeinsam größere Anwendungen erstellen und
pflegen können. Sie werden fortgeschrittene Konzepte in Java kennenlernen und sich mit
etablierten Methoden in der Softwareentwicklung wie Versionierung von Code, Einhaltung
von Coding Conventions, Grundlagen des Softwaretests, Anwendung von Refactoring, Einsatz
von Build-Tools und Logging auseinander setzen. Wenn uns dabei ein Entwurfsmuster &quot;über
den Weg läuft&quot;, werden wir die Gelegenheit nutzen und uns dieses genauer anschauen.</p>
<h2 id="überblick-modulinhalte">Überblick Modulinhalte</h2>
<ol>
<li>Fortgeschrittene Konzepte in Java
<ul>
<li>Funktionale Programmierung: Default-Methoden, Funktionsinterfaces, Methodenreferenzen, Lambdas, Stream-API</li>
<li>Generische Programmierung: Generics</li>
<li>Parallele Programmierung: Threads</li>
<li>Reguläre Ausdrücke, <del>Annotationen</del>, <del>Reflection</del></li>
<li>CLI, Konfiguration, fremde APIs nutzen</li>
<li><del>Graphische Oberflächen mit Swing</del></li>
</ul>
</li>
<li>Fortgeschrittenes OO-Design
<ul>
<li>Entwurfsmuster: <del>Strategy</del>, Template-Method, <del>Factory-Method</del>, <del>Singleton</del>, Observer, Visitor, Command, ...</li>
</ul>
</li>
<li>Programmiermethoden
<ul>
<li>Versionskontrolle: Git</li>
<li>Testen, Coding Conventions, Refactoring</li>
<li>Logging, Build-Tools, CI</li>
</ul>
</li>
</ol>
<p>(<em>durchgestrichene Themen nicht im Sommersemester 2024</em>)</p>
<h2 id="team">Team</h2>
<ul>
<li><a href="https://www.hsbi.de/minden/ueber-uns/personenverzeichnis/carsten-gips" rel="external" target="_blank">Carsten Gips</a> (Sprechstunde nach Vereinbarung)</li>
<li>Tutoren (siehe ILIAS-Mitgliederliste)</li>
</ul>
<h2 id="kursformat">Kursformat</h2>
<p><a href="#R-image-36c7c01252ee5ff2ea76fec471fa6174" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/fahrplan.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-36c7c01252ee5ff2ea76fec471fa6174"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/fahrplan.png?width=80%25&height=auto"></a></p>
<div class="tab-panel" data-tab-group="vl-pr">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="vorlesung"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('vl-pr','vorlesung')"
    >
      <span class="tab-nav-text">Vorlesung</span>
    </button>
    <button
      data-tab-item="praktikum"
      class="tab-nav-button tab-panel-style cstyle initial"
      onclick="switchTab('vl-pr','praktikum')"
    >
      <span class="tab-nav-text">Praktikum</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="vorlesung"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">
<p><strong>Vorlesung (2 SWS)</strong></p>
<p>Mi, 08:00 - 09:30 Uhr (online)</p>
<p>Durchführung als <strong>Flipped Classroom</strong>.</p>
      </div>
    </div>
    <div
      data-tab-item="praktikum"
      class="tab-content tab-panel-style cstyle initial">
      <div class="tab-content-text">
<p><strong>Praktikum (2 SWS)</strong></p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Praktikumsgruppe</th>
          <th style="text-align: left">Zeit</th>
          <th style="text-align: left">Raum</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Gruppe 1</td>
          <td style="text-align: left">Mi, 11:30 - 13:00 Uhr</td>
          <td style="text-align: left">online</td>
      </tr>
      <tr>
          <td style="text-align: left">Gruppe 2</td>
          <td style="text-align: left">Mi, 09:45 - 11:15 Uhr</td>
          <td style="text-align: left">D320</td>
      </tr>
      <tr>
          <td style="text-align: left">Gruppe 3</td>
          <td style="text-align: left">Mi, 09:45 - 11:15 Uhr</td>
          <td style="text-align: left">online</td>
      </tr>
      <tr>
          <td style="text-align: left">Gruppe 4</td>
          <td style="text-align: left">Mi, 11:30 - 13:00 Uhr</td>
          <td style="text-align: left">D320</td>
      </tr>
  </tbody>
</table>
<p>Praktika Gruppen 2 und 4 in <strong>Präsenz</strong>.</p>
      </div>
    </div>
  </div>
</div>
<p>Online-Sitzungen per Zoom (<strong>Zugangsdaten siehe <a href="https://www.hsbi.de/elearning/goto.php?target=crs_1337540&client_id=FH-Bielefeld" rel="external" target="_blank">ILIAS</a></strong>).
Sie <em>können</em> hierzu den Raum J104 nutzen.</p>
<h2 id="fahrplan">Fahrplan</h2>
<div class="box notices cstyle note">
  <div class="box-label">
    <i class="fa-fw fas fa-exclamation-circle"></i> News
  </div>
  <div class="box-content">
<p>Die nächste Klausur für &quot;Programmieren 2&quot; (IFM 2.1, PO23) wird am <strong>Mittwoch, 02. Oktober 2024</strong>
angeboten. Die Klausur wird als digitale Klausur auf dem Prüfungs-ILIAS der HSBI in Präsenz vor Ort
in <strong>Minden im Raum B40</strong> durchgeführt. Die Prüfung beginnt um <strong>08:00 Uhr und dauert 90 Minuten</strong>.
Ein DIN-A4-Zettel ist als Hilfsmittel zugelassen. Der geprüfte Stoff bezieht sich auf den zuletzt
durchgeführten Kurs (Sommer 2024). Weitere Informationen siehe <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/admin/exams.html">Prüfungsvorbereitung</a>.</p>
  </div>
</div>
<p>Hier finden Sie einen abonnierbaren <a href="https://calendar.google.com/calendar/ical/5121604486803dcdb5cfaa8602b8b09ce76743d8b9216795606617cac807e595%40group.calendar.google.com/public/basic.ics" rel="external" target="_blank">Google Kalender</a> mit allen Terminen der Veranstaltung zum Einbinden in Ihre Kalender-App.</p>
<p><span class='alert'><strong>Bitte geben Sie uns Feedback: Nehmen Sie bitte an der <a href="https://www.hsbi.de/elearning/goto.php?target=svy_1394428&client_id=FH-Bielefeld" rel="external" target="_blank">anonymen Umfrage zu &quot;Programmieren 2&quot;</a> teil.</strong></span></p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Monat</th>
          <th style="text-align: left">Tag</th>
          <th style="text-align: left">Vorlesung</th>
          <th style="text-align: left">Praktikum</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">April</td>
          <td style="text-align: left">17.</td>
          <td style="text-align: left">Orga (<strong>Zoom</strong>), <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/discussions/categories/q-a" rel="external" target="_blank">FAQ</a></td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left">24.</td>
          <td style="text-align: left">Generics: <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/generics/classes-methods.html">Klassen und Methoden</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/generics/bounds-wildcards.html">Bounds und Wildcards</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/generics/type-erasure.html">Type Erasure</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/generics/generics-polymorphism.html">Polymorphie</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/gradle.html">Gradle</a></td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/homework/b01.html">B01</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Mai</td>
          <td style="text-align: left">01.</td>
          <td style="text-align: left"><strong>Mai-Feiertag</strong></td>
          <td style="text-align: left"><strong>Mai-Feiertag</strong></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left">08.</td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-intro.html">Einführung Versionierung</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-basics.html">Git Basics</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/lambdas.html">Lambda-Ausdrücke</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/javadoc.html">Javadoc</a></td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/homework/b02.html">B02</a></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left">15.</td>
          <td style="text-align: left"><strong>Dienstbesprechung</strong></td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/homework/b03.html">B03</a></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left">22.</td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/branches.html">Git-Branches</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/branching-strategies.html">Branching-Strategien</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/methodreferences.html">Methodenreferenzen</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/logging.html">Logging</a></td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/homework/b04.html">B04</a></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left">29.</td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/remotes.html">Git-Remotes</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows.html">Git-Workflows</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/stream-api.html">Stream-API</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/records.html">Record-Klassen</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon.html">Intro Dungeon</a></td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/homework/b05.html">B05</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Juni</td>
          <td style="text-align: left">05.</td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro.html">Einführung Testen</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics.html">JUnit-Basics</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional.html">Optional</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor.html">Visitor-Pattern</a></td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/homework/b06.html">B06</a></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left">12.</td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases.html">Testfallermittlung</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/mockito.html">Mocking</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/defaultmethods.html">Default-Methoden</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/observer.html">Observer-Pattern</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/java-jvm/serialisation.html">Serialisierung</a></td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/homework/b07.html">B07</a></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left">19.</td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/smells.html">Code-Smells</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/codingrules.html">Coding-Rules</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/refactoring.html">Refactoring</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci.html">Continuous Integration (CI)</a></td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/homework/b08.html">B08</a></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left">26.</td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/java-jvm/regexp.html">RegExp</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/template-method.html">Template-Method-Pattern</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/command.html">Command-Pattern</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/java-jvm/enums.html">Enumerationen</a></td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/homework/b09.html">B09</a></td>
      </tr>
      <tr>
          <td style="text-align: left">Juli</td>
          <td style="text-align: left">03.</td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-intro.html">Intro Threads</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-synchronisation.html">Synchronisierung</a>, <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-highlevel.html">Highlevel Threadkonzepte</a>; <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/java-jvm/configuration.html">Konfiguration</a></td>
          <td style="text-align: left"><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/homework/b10.html">B10</a></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left">10.</td>
          <td style="text-align: left">Rückblick (<strong>Zoom</strong>), <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/admin/exams.html">Prüfungsvorbereitung</a></td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left"><em>tbd</em></td>
          <td style="text-align: left">Klausur (Campus Minden, B40)</td>
          <td style="text-align: left"></td>
      </tr>
  </tbody>
</table>
<p>Abgabe der Übungsblätter jeweils <strong>bis 08:00 Uhr</strong> <a href="https://www.hsbi.de/elearning/goto.php?target=exc_1356670&client_id=FH-Bielefeld" rel="external" target="_blank">im ILIAS</a>.</p>
<h2 id="prüfungsform-note-und-credits">Prüfungsform, Note und Credits</h2>
<p><strong>Parcoursprüfung</strong>, 5 ECTS (PO23)</p>
<div class="tab-panel" data-tab-group="exams">
  <div class="tab-nav">
    <div class="tab-nav-title">&#8203;</div>
    <button
      data-tab-item="prüfung-im-ersten-zeitraum"
      class="tab-nav-button tab-panel-style cstyle initial active" tabindex="-1"
      onclick="switchTab('exams','prüfung-im-ersten-zeitraum')"
    >
      <span class="tab-nav-text">Prüfung im ersten Zeitraum</span>
    </button>
    <button
      data-tab-item="prüfung-im-zweiten-zeitraum"
      class="tab-nav-button tab-panel-style cstyle initial"
      onclick="switchTab('exams','prüfung-im-zweiten-zeitraum')"
    >
      <span class="tab-nav-text">Prüfung im zweiten Zeitraum</span>
    </button>
  </div>
  <div class="tab-content-container">
    <div
      data-tab-item="prüfung-im-ersten-zeitraum"
      class="tab-content tab-panel-style cstyle initial active">
      <div class="tab-content-text">
<ul>
<li><strong>Stationen</strong>:
<ul>
<li>Praktikum: 10x Übungsblätter mit jeweils 1P
(Einzelbearbeitung, mindestens 60% bearbeitet,
fristgerechte Abgabe der Lösungen im ILIAS,
Vorstellung der Lösungen im Praktikum =&gt; Punkte)</li>
<li>Schriftliche Prüfung (digitale Klausur) mit 100P;
<a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/admin/exams.html">Prüfungsvorbereitung</a></li>
</ul>
</li>
<li><strong>Gesamtnote</strong>: 4.0: ab 50P, alle 5P nächste Teilnote, 1.0: ab 95P</li>
</ul>
      </div>
    </div>
    <div
      data-tab-item="prüfung-im-zweiten-zeitraum"
      class="tab-content tab-panel-style cstyle initial">
      <div class="tab-content-text">
<ul>
<li><strong>Stationen</strong>:
<ul>
<li>Schriftliche Prüfung (digitale Klausur) mit 100P;
<a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/admin/exams.html">Prüfungsvorbereitung</a></li>
</ul>
</li>
<li><strong>Gesamtnote</strong>: 4.0: ab 50P, alle 5P nächste Teilnote, 1.0: ab 95P</li>
</ul>
      </div>
    </div>
  </div>
</div>
<h2 id="materialien">Materialien</h2>
<h3 id="literatur">Literatur</h3>
<ol>
<li><a href="https://openbook.rheinwerk-verlag.de/javainsel/index.html" rel="external" target="_blank">&quot;<strong>Java ist auch eine Insel</strong>&quot;</a>.
Ullenboom, C., Rheinwerk-Verlag, 2021.
ISBN <a href="https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6" rel="external" target="_blank">978-3-8362-8745-6</a>.</li>
<li><a href="https://git-scm.com/book/en/v2" rel="external" target="_blank">&quot;<strong>Pro Git</strong> (Second Edition)&quot;</a>.
Chacon, S. und Straub, B., Apress, 2014.
ISBN <a href="https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-4842-0077-3" rel="external" target="_blank">978-1-4842-0077-3</a>.</li>
<li><a href="https://docs.oracle.com/javase/tutorial/" rel="external" target="_blank">&quot;The Java Tutorials&quot;</a>.
Oracle Corporation, 2023.</li>
<li><a href="https://dev.java/learn/" rel="external" target="_blank">&quot;Learn Java&quot;</a>.
Oracle Corporation, 2023.</li>
</ol>
<h3 id="tools">Tools</h3>
<ul>
<li>JDK: Java SE 21 (LTS) (<a href="https://www.oracle.com/java/technologies/downloads/" rel="external" target="_blank">Oracle</a> oder
<a href="https://code.visualstudio.com/docs/languages/java#_install-a-java-development-kit-jdk" rel="external" target="_blank">Alternativen</a>,
bitte 64-bit Version nutzen)</li>
<li>IDE: <a href="https://www.eclipse.org/downloads/" rel="external" target="_blank">Eclipse IDE for Java Developers</a> oder
<a href="https://www.jetbrains.com/idea/" rel="external" target="_blank">IntelliJ IDEA (Community Edition)</a> oder
<a href="https://code.visualstudio.com/" rel="external" target="_blank">Visual Studio Code</a> oder <a href="https://www.vim.org/" rel="external" target="_blank">Vim</a> oder ...</li>
<li><a href="https://git-scm.com/" rel="external" target="_blank">Git</a></li>
</ul>
<h2 id="förderungen-und-kooperationen">Förderungen und Kooperationen</h2>
<h3 id="förderung-durch-dhnrw-digi-fellowships">Förderung durch DH.NRW (Digi Fellowships)</h3>
<p>Die Überarbeitung dieser Lehrveranstaltung wurde vom Ministerium für Kultur und Wissenschaft
(MKW) in NRW im Einvernehmen mit der Digitalen Hochschule NRW (DH.NRW) gefördert:
<a href="https://www.dh.nrw/kooperationen/Digi-Fellows-2" rel="external" target="_blank">&quot;Fellowships für Innovationen in der digitalen Hochschulbildung&quot;</a> (<em>Digi Fellowships</em>).</p>
<h3 id="kooperation-mit-dem-digikos-projekt">Kooperation mit dem DigikoS-Projekt</h3>
<p>Diese Vorlesung wird zudem vom Projekt <a href="https://www.digikos.de" rel="external" target="_blank">&quot;Digitalbaukasten für kompetenzorientiertes Selbststudium&quot;</a>
(<em>DigikoS</em>) unterstützt. Ein vom DigikoS-Projekt ausgebildeter Digital Learning Scout hat
insbesondere die Koordination der digitalen Gruppenarbeiten, des Peer-Feedbacks und der
Postersessions in ILIAS technisch und inhaltlich begleitet. DigikoS wird als Verbundprojekt
von der Stiftung Innovation in der Hochschullehre gefördert.</p>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of IFM 2.1: Programmieren 2 (PO23, Sommer 2024)</h1>
          <article class="default">
            <header class="headline">
            </header>

<h1 id="generics-umgang-mit-parametrisierten-typen">Generics: Umgang mit parametrisierten Typen</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/generics/classes-methods.html">Generische Klassen &amp; Methoden</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/generics/bounds-wildcards.html">Bounds &amp; Wildcards</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/generics/type-erasure.html">Type Erasure</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/generics/generics-polymorphism.html">Generics und Polymorphie</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Generics: Umgang mit parametrisierten Typen</h1>
<article class="default">
<h1>Generische Klassen &amp; Methoden</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Generische Klassen und Methoden sind ein wichtiger Baustein in der Programmierung mit Java.
Dabei werden Typ-Variablen eingeführt, die dann bei der Instantiierung der generischen
Klassen oder beim Aufruf von generischen Methoden mit existierenden Typen konkretisiert
werden (&quot;Typ-Parameter&quot;).</p>
<p>Syntaktisch definiert man die Typ-Variablen in spitzen Klammern hinter dem Klassennamen bzw.
vor dem Rückgabetyp einer Methode: <code>public class Stack&lt;E&gt; { }</code> und <code>public &lt;T&gt; T foo(T m) { }</code>.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/k6MFPW-shh8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Generische Klassen & Methoden</a></li> <li><a href='https://youtu.be/ekXBXge6VvE' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Generische Methoden</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/5497f0d31a9d0ac4d46e781040b1fd9f20ca7e0103cccc1abe0089c7c36a9251de0126f11fe376341a7b077dcdd43e8683f2c165b895da1a70da6c17d5c4576f' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Generische Klassen & Methoden</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K1) Begriffe generischer Typ, parametrisierter Typ, formaler Typ-Parameter, Typ-Parameter</li> <li>(K3) Erstellen und Nutzen von generischen Klassen und Interfaces</li> <li>(K3) Erstellen und Nutzen von generischen Methoden</li></ul>
  </div>
</div>




    <h2 id="generische-strukturen">Generische Strukturen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Vector speicher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Vector();
</span></span><span style="display:flex;"><span>speicher.<span style="color:#a6e22e">add</span>(1); speicher.<span style="color:#a6e22e">add</span>(2); speicher.<span style="color:#a6e22e">add</span>(3);
</span></span><span style="display:flex;"><span>speicher.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#34;huhu&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> summe <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (Object i : speicher) { summe <span style="color:#f92672">+=</span> (Integer)i; }</span></span></code></pre></div>
<p>Problem: Nutzung des &quot;<em>raw</em>&quot; Typs <code>Vector</code> ist nicht typsicher!</p>
<ul>
<li>Mögliche Fehler fallen erst zur Laufzeit und u.U. erst sehr spät auf: Offenbar werden im obigen
Beispiel <code>int</code>-Werte erwartet, d.h. das Hinzufügen von <code>&quot;huhu&quot;</code> ist vermutlich ein Versehen (wird
vom Compiler aber nicht bemerkt)</li>
<li>Die Iteration über <code>speicher</code> kann nur allgemein als <code>Object</code> erfolgen, d.h. in der Schleife muss
auf den vermuteten/gewünschten Typ gecastet werden: Hier würde dann der String <code>&quot;huhu&quot;</code> Probleme
zur Laufzeit machen</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Vector<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> speicher <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Vector<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>speicher.<span style="color:#a6e22e">add</span>(1); speicher.<span style="color:#a6e22e">add</span>(2); speicher.<span style="color:#a6e22e">add</span>(3);
</span></span><span style="display:flex;"><span>speicher.<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#34;huhu&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> summe <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (Integer i : speicher) { summe <span style="color:#f92672">+=</span> i; }</span></span></code></pre></div>
<p>Vorteile beim Einsatz von Generics:</p>
<ul>
<li>Datenstrukturen/Algorithmen nur einmal implementieren, aber für unterschiedliche Typen nutzen</li>
<li>Keine Vererbungshierarchie nötig</li>
<li>Nutzung ist typsicher, Casting unnötig</li>
<li>Geht nur für Referenztypen</li>
<li>Beispiel: Collections-API</li>
</ul>
<h2 id="generische-klasseninterfaces-definieren">Generische Klassen/Interfaces definieren</h2>
<ul>
<li>
<p><strong>Definition</strong>: &quot;<code>&lt;Typ&gt;</code>&quot; hinter Klassennamen</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Stack</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> E <span style="color:#a6e22e">push</span>(E item) {
</span></span><span style="display:flex;"><span>        addElement(item);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> item;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ul>
<li><code>Stack&lt;E&gt;</code> =&gt; Generische (parametrisierte) Klasse (auch: &quot;<em>generischer Typ</em>&quot;)</li>
<li><code>E</code> =&gt; Formaler Typ-Parameter (auch: &quot;<em>Typ-Variable</em>&quot;)</li>
</ul>
</li>
<li>
<p><strong>Einsatz</strong>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Stack<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> stack <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Stack<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span>();</span></span></code></pre></div>
<ul>
<li><code>Integer</code> =&gt; Typ-Parameter</li>
<li><code>Stack&lt;Integer&gt;</code> =&gt; Parametrisierter Typ</li>
</ul>
</li>
</ul>
<h2 id="generische-klassen-instantiieren">Generische Klassen instantiieren</h2>
<ul>
<li>
<p>Typ-Parameter in spitzen Klammern hinter Klasse bzw. Interface</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>ArrayList<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> il <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>ArrayList<span style="color:#f92672">&lt;</span>Double<span style="color:#f92672">&gt;</span>  dl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Double<span style="color:#f92672">&gt;</span>();</span></span></code></pre></div>
</li>
</ul>
<h2 id="beispiel-i-einfache-generische-klassen">Beispiel I: Einfache generische Klassen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Tutor</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// T kann in Tutor *fast* wie Klassenname verwendet werden</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> T x;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> T <span style="color:#a6e22e">foo</span>(T t) { ... }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Tutor<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>  a <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tutor<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>Tutor<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> b <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tutor<span style="color:#f92672">&lt;&gt;</span>();  <span style="color:#75715e">// ab Java7: &#34;Diamond Operator&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a.<span style="color:#a6e22e">foo</span>(<span style="color:#e6db74">&#34;wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>b.<span style="color:#a6e22e">foo</span>(1);
</span></span><span style="display:flex;"><span>b.<span style="color:#a6e22e">foo</span>(<span style="color:#e6db74">&#34;huhu&#34;</span>);  <span style="color:#f92672">//</span> Fehlermeldung vom Compiler</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/generics/src/classes/GenericClasses.java" target="_blank"><span class="title">Beispiel: classes.GenericClasses</span></a></span></div>
<h3 id="typ-inferenz">Typ-Inferenz</h3>
<p>Typ-Parameter kann bei <code>new()</code> auf der rechten Seite oft weggelassen werden
=&gt; <strong>Typ-Inferenz</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Tutor<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Tutor<span style="color:#f92672">&lt;&gt;</span>();  <span style="color:#f92672">//</span> <span style="color:#f92672">&lt;&gt;</span>: <span style="color:#e6db74">&#34;Diamantoperator&#34;</span></span></span></code></pre></div>
<p>(gilt seit Java 1.7)</p>
<h2 id="beispiel-ii-vererbung-mit-typparametern">Beispiel II: Vererbung mit Typparametern</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Fach</span><span style="color:#f92672">&lt;</span>T1, T2<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">machWas</span>(T1 a, T2 b);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SHK</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> Tutor<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> { ... }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PM</span><span style="color:#f92672">&lt;</span>X, Y, Z<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">implements</span> Fach<span style="color:#f92672">&lt;</span>X, Z<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">machWas</span>(X a, Z b) { ... }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Y <span style="color:#a6e22e">getBla</span>() { ... }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span><span style="color:#f92672">&lt;</span>A,B<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> Person { ... }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Properties</span> <span style="color:#66d9ef">extends</span> Hashtable<span style="color:#f92672">&lt;</span>Object,Object<span style="color:#f92672">&gt;</span> { ... }</span></span></code></pre></div>
<p>Auch Interfaces und abstrakte Klassen können parametrisierbar sein.</p>
<p>Bei der Vererbung sind alle Varianten bzgl. der Typ-Variablen denkbar.
Zu beachten ist dabei vor allem, dass die Typ-Variablen der Oberklasse (gilt
analog für Interfaces) entweder durch Typ-Variablen der Unterklasse oder durch
konkrete Typen spezifiziert sind. Die Typ-Variablen der Oberklasse dürfen
nicht &quot;in der Luft hängen&quot; (siehe auch nächste Folie)!</p>
<h2 id="beispiel-iii-überschreibenüberladen-von-methoden">Beispiel III: Überschreiben/Überladen von Methoden</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Mensch</span> { ... }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span><span style="color:#f92672">&lt;</span>T <span style="color:#66d9ef">extends</span> Mensch<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">f</span>(T t) { ... }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Prof</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> Mensch { ... }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Tutor</span> <span style="color:#66d9ef">extends</span> Studi<span style="color:#f92672">&lt;</span>Mensch<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">f</span>(Mensch t) { ... }      <span style="color:#75715e">// Ueberschreiben</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">f</span>(Tutor t) { ... }       <span style="color:#75715e">// Ueberladen</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="vorsicht-so-geht-es-nicht">Vorsicht: So geht es nicht!</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> T { ... }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fluppie</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> Wuppie<span style="color:#f92672">&lt;</span>S<span style="color:#f92672">&gt;</span> { ... }</span></span></code></pre></div>
<ul>
<li>Generische Klasse <code>Foo&lt;T&gt;</code> kann nicht selbst vom Typ-Parameter <code>T</code> ableiten (warum?)</li>
<li>Bei Ableiten von generischer Klasse <code>Wuppie&lt;S&gt;</code> muss deren Typ-Parameter <code>S</code> bestimmt sein:
etwa durch den Typ-Parameter der ableitenden Klasse, beispielsweise <code>Fluppie&lt;S&gt;</code> (statt <code>Fluppie&lt;T&gt;</code>)</li>
</ul>
<h2 id="generische-methoden-definieren">Generische Methoden definieren</h2>
<ul>
<li>
<p>&quot;<code>&lt;Typ&gt;</code>&quot; vor Rückgabetyp</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Mensch</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> T <span style="color:#a6e22e">myst</span>(T m, T n) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Math.<span style="color:#a6e22e">random</span>() <span style="color:#f92672">&gt;</span> 0.<span style="color:#a6e22e">5</span> <span style="color:#f92672">?</span> m : n;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
<li>
<p>&quot;Mischen possible&quot;:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Mensch</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> T <span style="color:#a6e22e">myst</span>(T m, T n) { ... }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">myst</span>(String m, String n) { ... }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
</ul>
<h2 id="aufruf-generischer-methoden">Aufruf generischer Methoden</h2>
<h3 id="aufruf">Aufruf</h3>
<ul>
<li>Aufruf mit Typ-Parameter vor Methodennamen, oder</li>
<li>Inferenz durch Compiler</li>
</ul>
<h3 id="finden-der-richtigen-methode-durch-den-compiler">Finden der richtigen Methode durch den Compiler</h3>
<ol>
<li>Zuerst Suche nach exakt passender Methode,</li>
<li>danach passend mit Konvertierungen
=&gt; Compiler sucht gemeinsame Oberklasse in Typhierarchie</li>
</ol>
<h3 id="beispiel">Beispiel</h3>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Mensch</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> T <span style="color:#a6e22e">myst</span>(T m, T n) { ... }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>Mensch m <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Mensch();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>m.<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>myst(<span style="color:#e6db74">&#34;Essen&#34;</span>, <span style="color:#e6db74">&#34;lecker&#34;</span>);  <span style="color:#75715e">// Angabe Typ-Parameter</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>m.<span style="color:#a6e22e">myst</span>(<span style="color:#e6db74">&#34;Essen&#34;</span>, 1);          <span style="color:#75715e">// String, Integer =&gt; T: Object</span>
</span></span><span style="display:flex;"><span>m.<span style="color:#a6e22e">myst</span>(<span style="color:#e6db74">&#34;Essen&#34;</span>, <span style="color:#e6db74">&#34;lecker&#34;</span>);   <span style="color:#75715e">// String, String  =&gt; T: String</span>
</span></span><span style="display:flex;"><span>m.<span style="color:#a6e22e">myst</span>(1.<span style="color:#a6e22e">0</span>, 1);              <span style="color:#f92672">//</span> Double, Integer <span style="color:#f92672">=&gt;</span> T: Number</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/generics/src/methods/GenericMethods.java" target="_blank"><span class="title">Beispiel methods.GenericMethods</span></a></span></div>
<p>Reihenfolge der Suche nach passender Methode gilt auch für nicht-generisch überladene Methoden</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Mensch</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> T <span style="color:#a6e22e">myst</span>(T m, T n) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;X#myst: T&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> m;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// NICHT gleichzeitig erlaubt wg. Typ-Löschung (s.u.):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/*
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    public &lt;T1, T2&gt; T1 myst(T1 m, T2 n) {
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        System.out.println(&#34;X#myst: T&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">        return m;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    }
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">myst</span>(String m, String n) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;X#myst: String&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> m;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">myst</span>(<span style="color:#66d9ef">int</span> m, <span style="color:#66d9ef">int</span> n) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;X#myst: int&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> m;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GenericMethods</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>        Mensch m <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Mensch();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        m.<span style="color:#a6e22e">myst</span>(<span style="color:#e6db74">&#34;Hello World&#34;</span>, <span style="color:#e6db74">&#34;m&#34;</span>);
</span></span><span style="display:flex;"><span>        m.<span style="color:#a6e22e">myst</span>(<span style="color:#e6db74">&#34;Hello World&#34;</span>, 1);
</span></span><span style="display:flex;"><span>        m.<span style="color:#a6e22e">myst</span>(3, 4);
</span></span><span style="display:flex;"><span>        m.<span style="color:#a6e22e">myst</span>(m, m);
</span></span><span style="display:flex;"><span>        m.<span style="color:#f92672">&lt;</span>Mensch<span style="color:#f92672">&gt;</span>myst(m, m);
</span></span><span style="display:flex;"><span>        m.<span style="color:#a6e22e">myst</span>(m, 1);
</span></span><span style="display:flex;"><span>        m.<span style="color:#a6e22e">myst</span>(3.<span style="color:#a6e22e">0</span>, 4);
</span></span><span style="display:flex;"><span>        m.<span style="color:#f92672">&lt;</span>Double<span style="color:#f92672">&gt;</span>myst(3, 4);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Begriffe:</p>
<ul>
<li>Generischer Typ: <code>Stack&lt;T&gt;</code></li>
<li>Formaler Typ-Parameter: <code>T</code></li>
<li>Parametrisierter Typ:<code>Stack&lt;Long&gt;</code></li>
<li>Typ-Parameter: <code>Long</code></li>
<li>Raw Type: <code>Stack</code></li>
</ul>
</li>
<li>
<p>Generische Klassen: <code>public class Stack&lt;E&gt; { }</code></p>
<ul>
<li>&quot;<code>&lt;Typ&gt;</code>&quot; hinter Klassennamen</li>
</ul>
</li>
<li>
<p>Generische Methoden: <code>public &lt;T&gt; T foo(T m) { }</code></p>
<ul>
<li>&quot;<code>&lt;Typ&gt;</code>&quot; vor Rückgabewert</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106235&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Generics: Classes & Methods (ILIAS)</a></li></ul>
  </div>
</div>



    



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Bloch2018'>[Bloch2018] <strong>Effective Java</strong><br>Bloch, J., Addison-Wesley, 2018. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-13-468599-1' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-13-468599-1</a>.</li> <li id='id_Java-SE-Tutorial'>[Java-SE-Tutorial] <a href='https://docs.oracle.com/javase/tutorial/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>The Java Tutorials</strong></a><br>Oracle Corporation, 2022.<br><em>Specialized Trails: Generics</em></li> <li id='id_LernJava'>[LernJava] <a href='https://dev.java/learn/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Learn Java</strong></a><br>Oracle Corporation, 2022.<br><em>Kapitel Generics</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kapitel 11.1: Einführung in Java Generics</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Bounds &amp; Wildcards</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Typ-Variablen können weiter eingeschränkt werden, in dem man einen verpflichtenden
Ober- oder Untertyp angibt mit <code>extends</code> bzw. <code>super</code>. Damit muss der später
bei der Instantiierung verwendete Typ-Parameter entweder die Oberklasse selbst
sein oder davon ableiten (bei <code>extends</code>) bzw. der Typ-Parameter muss eine Oberklasse
der angegebenen Schranke sein (<code>super</code>).</p>
<p>Durch die Einschränkung mit <code>extends</code> können in der Klasse/Methode auf der Typ-Variablen
alle Methoden des angegebenen Obertyps verwendet werden.</p>
<p>Ein Wildcard (<code>?</code>) als Typ-Parameter steht für einen beliebigen Typ, wobei die
Typ-Variable keinen Namen bekommt und damit innerhalb der Klasse/Methode nicht
zugreifbar ist.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/OV2vEn2EkWo' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Generics: Bounds & Wildcards</a></li> <li><a href='https://youtu.be/D2hIicsho7I' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Wildcards</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/08ef62f9367140e7ae75cd4e90fde1e63cc3ec6c9e7e4c11a1994065fd45e781f46bc6b3f1fbe4fbe8952db11812d52efe8cd8900fe88843e5eaefad62bbc7d3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Generics: Bounds & Wildcards</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Umgang mit Wildcards und Bounds bei generischen Klassen/Methoden</li></ul>
  </div>
</div>




    <h2 id="bounds-einschränken-der-generischen-typen">Bounds: Einschränken der generischen Typen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Cps</span><span style="color:#f92672">&lt;</span>E <span style="color:#66d9ef">extends</span> Number<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Obere Schranke: E muss Number oder Subklasse sein</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// =&gt; Zugriff auf Methoden aus Number moeglich</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>Cps<span style="color:#f92672">&lt;</span>Double<span style="color:#f92672">&gt;</span> a;
</span></span><span style="display:flex;"><span>Cps<span style="color:#f92672">&lt;</span>Number<span style="color:#f92672">&gt;</span> b;
</span></span><span style="display:flex;"><span>Cps<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> c;  <span style="color:#f92672">//</span> Fehler<span style="color:#f92672">!!!</span></span></span></code></pre></div>
<ul>
<li>
<p>Schlüsselwort <code>extends</code> gilt hier auch für Interfaces</p>
</li>
<li>
<p>Mehrere Interfaces: nach <code>extends</code> Klasse oder Interface, danach
mit &quot;<code>&amp;</code>&quot; getrennt die restlichen Interfaces:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Cps</span><span style="color:#f92672">&lt;</span>E <span style="color:#66d9ef">extends</span> KlasseOderInterface <span style="color:#f92672">&amp;</span> I1 <span style="color:#f92672">&amp;</span> I2 <span style="color:#f92672">&amp;</span> I3<span style="color:#f92672">&gt;</span> {}</span></span></code></pre></div>
</li>
</ul>
<p><em>Anmerkung</em>: Der Typ-Parameter ist analog auch mit <code>super</code> (nach unten) einschränkbar</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/generics/src/bounds/Cps.java" target="_blank"><span class="title">Beispiel bounds.Cps</span></a></span></div>
<h2 id="wildcards-dieser-typ-ist-mir-nicht-so-wichtig">Wildcards: Dieser Typ ist mir nicht so wichtig</h2>
<div class='center'>
<p>Wildcard mit &quot;<code>?</code>&quot; =&gt; steht für unbestimmten Typ</p>
</div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Wuppie</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">m1</span>(List<span style="color:#f92672">&lt;?&gt;</span> a) { ... }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">m2</span>(List<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">extends</span> Number<span style="color:#f92672">&gt;</span> b) { ... }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ul>
<li>
<p><code>m1</code>: <code>List</code> beliebig parametrisierbar
=&gt; In <code>m1</code> für Objekte in Liste <code>a</code> nur Methoden von <code>Object</code> nutzbar!</p>
</li>
<li>
<p><code>m2</code>: <code>List</code> muss mit <code>Number</code> oder Subklasse parametrisiert werden.
=&gt; Dadurch für Objekte in Liste <code>b</code> alle Methoden von <code>Number</code> nutzbar ...</p>
</li>
</ul>
<p>Weitere Eigenschaften:</p>
<ul>
<li>Durch Wildcard kein Zugriff auf den Typ</li>
<li>Wildcard kann durch upper bound eingeschränkt werden</li>
<li>Geht nicht bei Klassen-/Interface-Definitionen</li>
</ul>
<p><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/generics/bounds-wildcards.html#id_Bloch2018">[Bloch2018]</a>: Nur für Parameter und nicht für Rückgabewerte nutzen!</p>
<h2 id="hands-on-ausgabe-für-generische-listen">Hands-On: Ausgabe für generische Listen</h2>
<p>Ausgabe für Listen gesucht, die sowohl Elemente der Klasse <code>A</code> als auch
Elemente der Klasse <code>B</code> enthalten können</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">A</span> { <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printInfo</span>() { System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;A&#34;</span>); } }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">B</span> <span style="color:#66d9ef">extends</span> A { <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printInfo</span>() { System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;B&#34;</span>); } }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">X</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>A<span style="color:#f92672">&gt;</span> x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>A<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>        x.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> A());  x.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> B());
</span></span><span style="display:flex;"><span>        printInfo(x);    <span style="color:#75715e">// Klassenmethode in X, gesucht</span>
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>B<span style="color:#f92672">&gt;</span> y <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>B<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>        y.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> B());  y.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> B());
</span></span><span style="display:flex;"><span>        printInfo(y);    <span style="color:#75715e">// Klassenmethode in X, gesucht</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><strong>Hinweis</strong>: Dieses Beispiel beinhaltet auch Polymorphie bei/mit generischen Datentypen, bitte vorher
auch das Video zum vierten Teil &quot;Generics und Polymorphie&quot; anschauen</p>
<h3 id="erster-versuch-a-und-b-und-main-wie-oben">Erster Versuch (<em>A</em> und <em>B</em> und <em>main()</em> wie oben)</h3>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">X</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printInfo</span>(List<span style="color:#f92672">&lt;</span>A<span style="color:#f92672">&gt;</span> list) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (A a : list) { a.<span style="color:#a6e22e">printInfo</span>(); }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>=&gt; <strong>So gehts nicht!</strong> Eine <code>List&lt;B&gt;</code> ist <strong>keine</strong> <code>List&lt;A&gt;</code>
(auch wenn ein <code>B</code> ein <code>A</code> ist, vgl. spätere Sitzung zu Generics und
Vererbung ...)!</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/generics/src/wildcards/v1/X.java" target="_blank"><span class="title">Beispiel wildcards.v1.X</span></a></span></div>
<h3 id="zweiter-versuch-mit-wildcards-a-und-b-und-main-wie-oben">Zweiter Versuch mit Wildcards (<em>A</em> und <em>B</em> und <em>main()</em> wie oben)</h3>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">X</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printInfo</span>(List<span style="color:#f92672">&lt;?&gt;</span> list) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Object a : list) { a.<span style="color:#a6e22e">printInfo</span>(); }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>=&gt; <strong>So gehts auch nicht!</strong> Im Prinzip passt das jetzt
für <code>List&lt;A&gt;</code> und <code>List&lt;B&gt;</code>. Dummerweise hat man durch das Wildcard
keinen Zugriff mehr auf den Typ-Parameter und muss für den Typ der
Laufvariablen in der <code>for</code>-Schleife dann <code>Object</code> nehmen. Aber
<code>Object</code> kennt unser <code>printInfo</code> nicht ... Außerdem könnte man die
Methode <code>X#printInfo</code> dank des Wildcards auch mit allen anderen
Typen aufrufen ...</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/generics/src/wildcards/v2/X.java" target="_blank"><span class="title">Beispiel wildcards.v2.X</span></a></span></div>
<h3 id="dritter-versuch-lösung-mit-wildcards-und-bounds-a-und-b-und-main-wie-oben">Dritter Versuch (Lösung) mit Wildcards und Bounds (<em>A</em> und <em>B</em> und <em>main()</em> wie oben)</h3>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">X</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printInfo</span>(List<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">extends</span> A<span style="color:#f92672">&gt;</span> list) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (A a : list) { a.<span style="color:#a6e22e">printInfo</span>(); }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Das ist die Lösung. Man erlaubt als Argument nur <code>List</code>-Objekte und fordert,
dass sie mit <code>A</code> oder einer Unterklasse von <code>A</code> parametrisiert sind. D.h.
in der Schleife kann man sich auf den gemeinsamen Obertyp <code>A</code> abstützen
und hat dann auch wieder die <code>printInfo</code>-Methode zur Verfügung ...</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/generics/src/wildcards/v3" target="_blank"><span class="title">Konsole wildcards.v3.X</span></a></span></div>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Ein Wildcard (<code>?</code>) als Typ-Parameter steht für einen beliebigen Typ</p>
<ul>
<li>Ist in Klasse oder Methode dann aber nicht mehr zugreifbar</li>
</ul>
</li>
<li>
<p>Mit Bounds kann man Typ-Parameter nach oben oder nach unten einschränken
(im Sinne einer Vererbungshierarchie)</p>
<ul>
<li><code>extends</code>: Der Typ-Parameter muss eine Unterklasse eines bestimmten Typen sein</li>
<li><code>super</code>: Der Typ-Parameter muss eine Oberklasse eines bestimmten Typen sein</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106236&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Generics: Bounds & Wildcards (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Spieler, Mannschaften und Ligen</strong>
Modellieren Sie in Java verschiedene Spielertypen sowie generische Mannschaften und Ligen,
die jeweils bestimmte Spieler (-typen) bzw. Mannschaften aufnehmen können.</p>
<ol>
<li>
<p>Implementieren Sie die Klasse <code>Spieler</code>, die das Interface <code>ISpieler</code> erfüllt.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">ISpieler</span> {
</span></span><span style="display:flex;"><span>    String <span style="color:#a6e22e">getName</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
<li>
<p>Implementieren Sie die beiden Klassen <code>FussballSpieler</code> und <code>BasketballSpieler</code> und
sorgen Sie dafür, dass beide Klassen vom Compiler als Spieler betrachtet werden
(geeignete Vererbungshierarchie).</p>
</li>
<li>
<p>Betrachten Sie das nicht-generische Interface <code>IMannschaft</code>. Erstellen Sie daraus ein
generisches Interface <code>IMannschaft</code> mit einer Typ-Variablen. Stellen Sie durch geeignete
Beschränkung der Typ-Variablen sicher, dass nur Mannschaften mit von <code>ISpieler</code> abgeleiteten
Spielern gebildet werden können.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IMannschaft</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">aufnehmen</span>(ISpieler spieler);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">rauswerfen</span>(ISpieler spieler);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
<li>
<p>Betrachten Sie das nicht-generische Interface <code>ILiga</code>. Erstellen Sie daraus ein generisches
Interface <code>ILiga</code> mit einer Typvariablen. Stellen Sie durch geeignete Beschränkung der
Typvariablen sicher, dass nur Ligen mit von <code>IMannschaft</code> abgeleiteten Mannschaften angelegt
werden können.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">ILiga</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">aufnehmen</span>(IMannschaft mannschaft);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">rauswerfen</span>(IMannschaft mannschaft);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
<li>
<p>Leiten Sie von <code>ILiga</code> das <strong>generische</strong> Interface <code>IBundesLiga</code> ab. Stellen Sie durch
geeignete Formulierung der Typvariablen sicher, dass nur Ligen mit Mannschaften angelegt
werden können, deren Spieler vom Typ <code>FussballSpieler</code> (oder abgeleitet) sind.</p>
<p>Realisieren Sie nun noch die Funktionalität von <code>IBundesLiga</code> als <strong>nicht-generisches</strong>
Interface <code>IBundesLiga2</code>.</p>
</li>
</ol>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Bloch2018'>[Bloch2018] <strong>Effective Java</strong><br>Bloch, J., Addison-Wesley, 2018. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-13-468599-1' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-13-468599-1</a>.</li> <li id='id_Java-SE-Tutorial'>[Java-SE-Tutorial] <a href='https://docs.oracle.com/javase/tutorial/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>The Java Tutorials</strong></a><br>Oracle Corporation, 2022.<br><em>Specialized Trails: Generics</em></li> <li id='id_LernJava'>[LernJava] <a href='https://dev.java/learn/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Learn Java</strong></a><br>Oracle Corporation, 2022.<br><em>Kapitel Generics</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kapitel 11.3</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Type Erasure</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>
Generics existieren eigentlich nur auf Quellcode-Ebene. Nach der Typ-Prüfung etc.
entfernt der Compiler alle generischen Typ-Parameter und alle <code>&lt;...&gt;</code> (=&gt;
&quot;Type-Erasure&quot;), d.h. im Byte-Code stehen nur noch Raw-Typen bzw. die oberen
Typ-Schranken der Typ-Parameter, in der Regel <code>Object</code>. Zusätzlich baut der Compiler
die nötigen Casts ein. Als Anwender merkt man davon nichts, muss das &quot;Type-Erasure&quot;
wegen der Auswirkungen aber auf dem Radar haben!
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/vo0WKkPBMAM' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Generics: Type Erasure</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/5fad3671a098d262206f0b0eb995b2d692a6e9914a336b1c28fc99753b0c874a637d310dcdc639afdd200d831b4e3ee5924ea8073b4a32751aebe4fa91c32bef' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Generics: Type Erasure</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Typ-Löschung und Auswirkungen</li></ul>
  </div>
</div>




    <h2 id="typ-löschung-type-erasure">Typ-Löschung (<em>Type-Erasure</em>)</h2>
<p>Der Compiler ersetzt nach Prüfung der Typen und ihrer Verwendung alle Typ-Parameter
durch</p>
<ol>
<li>deren obere (Typ-)Schranke und</li>
<li>passende explizite Cast-Operationen (im Byte-Code).</li>
</ol>
<p>Die obere Typ-Schranke ist in der Regel der Typ der ersten Bounds-Klausel
oder <code>Object</code>, wenn keine Einschränkungen formuliert sind.</p>
<p>Bei parametrisierten Typen wie <code>List&lt;T&gt;</code> wird der Typ-Parameter entfernt,
es entsteht ein sogenannter <em>Raw</em>-Typ (<code>List</code>, quasi implizit mit <code>Object</code>
parametrisiert).</p>
<p>=&gt; Ergebnis: Nur <strong>eine</strong> (untypisierte) Klasse! Zur Laufzeit gibt es
keine Generics mehr!</p>
<p><strong>Hinweis</strong>: In C++ ist man den anderen möglichen Weg gegangen und erzeugt
für jede Instantiierung die passende Klasse. Siehe Modul &quot;Systemprogrammierung&quot; :)</p>
<p><strong>Beispiel</strong>: Aus dem folgenden harmlosen Code-Fragment:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    T <span style="color:#a6e22e">myst</span>(T m, T n) { <span style="color:#66d9ef">return</span> n; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>        Studi<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> a <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> a.<span style="color:#a6e22e">myst</span>(1, 3);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>wird nach der Typ-Löschung durch Compiler (das steht dann quasi im Byte-Code):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    Object <span style="color:#a6e22e">myst</span>(Object m, Object n) { <span style="color:#66d9ef">return</span> n; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>        Studi a <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> (Integer) a.<span style="color:#a6e22e">myst</span>(1, 3);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Die obere Schranke meist <code>Object</code> =&gt; <code>new T()</code> verboten/sinnfrei (s.u.)!</p>
<h2 id="type-erasure-bei-nutzung-von-bounds">Type-Erasure bei Nutzung von Bounds</h2>
<div class='columns'>
<div class='column'>
<p>vor der Typ-Löschung durch Compiler:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Cps</span><span style="color:#f92672">&lt;</span>T <span style="color:#66d9ef">extends</span> Number<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    T <span style="color:#a6e22e">myst</span>(T m, T n) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> n;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>        Cps<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> a <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Cps<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> a.<span style="color:#a6e22e">myst</span>(1, 3);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
<div class='column'>
<p>nach der Typ-Löschung durch Compiler:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Cps</span> {
</span></span><span style="display:flex;"><span>    Number <span style="color:#a6e22e">myst</span>(Number m, Number n) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> n;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>        Cps a <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Cps();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> (Integer) a.<span style="color:#a6e22e">myst</span>(1, 3);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
</div>
<h2 id="raw-types-ich-mag-meine-generics-well-done--">Raw-Types: Ich mag meine Generics &quot;well done&quot; :-)</h2>
<p>Raw-Types: Instanziierung ohne Typ-Parameter =&gt; <code>Object</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Stack s <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Stack(); <span style="color:#f92672">//</span> Stack von Object<span style="color:#f92672">-</span>Objekten</span></span></code></pre></div>
<ul>
<li>Wegen Abwärtskompatibilität zu früheren Java-Versionen noch erlaubt.</li>
<li>Nutzung wird nicht empfohlen! (Warum?)</li>
</ul>
<h3 id="anmerkung">Anmerkung</h3>
<p>Raw-Types darf man zwar selbst im Quellcode verwenden (so wie im Beispiel
hier), <strong>sollte</strong> die Verwendung aber vermeiden wegen der Typ-Unsicherheit:
Der Compiler sieht im Beispiel nur noch einen Stack für <code>Object</code>, d.h. dort
dürfen Objekte aller Typen abgelegt werden - es kann keine Typprüfung
durch den Compiler stattfinden. Auf einem <code>Stack&lt;String&gt;</code> kann der Compiler
prüfen, ob dort wirklich nur <code>String</code>-Objekte abgelegt werden und ggf.
entsprechend Fehler melden.</p>
<p>Etwas anderes ist es, dass der Compiler im Zuge von Type-Erasure selbst
Raw-Types in den Byte-Code schreibt. Da hat er vorher bereits die
Typsicherheit geprüft und er baut auch die passenden Casts ein.</p>
<p>Das Thema ist eigentlich nur noch aus Kompatibilität zu Java5 oder früher
da, weil es dort noch keine Generics gab (wurden erst mit Java6 eingeführt).</p>
<h2 id="folgen-der-typ-löschung-new">Folgen der Typ-Löschung: <em>new</em></h2>
<div class='center'>
<p><code>new</code> mit parametrisierten Klassen ist nicht erlaubt!</p>
</div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fach</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> T <span style="color:#a6e22e">foo</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> T();  <span style="color:#75715e">// nicht erlaubt!!!</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Grund: Zur Laufzeit keine Klasseninformationen über <code>T</code> mehr</p>
<p>Im Code steht <code>return (CAST) new Object();</code>. Das neue Object
kann man anlegen, aber ein Cast nach irgendeinem anderen Typ
ist sinnfrei: Jede Klasse ist ein Untertyp von <code>Object</code>, aber
eben nicht andersherum. Außerdem fehlt dem Objekt vom Typ
<code>Object</code> auch sämtliche Information und Verhalten, die der
Cast-Typ eigentlich mitbringt ...</p>
<h2 id="folgen-der-typ-löschung-static">Folgen der Typ-Löschung: <em>static</em></h2>
<div class='center'>
<p><code>static</code> mit generischen Typen ist nicht erlaubt!</p>
</div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fach</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> T t;                    <span style="color:#75715e">// nicht erlaubt!!!</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> Fach<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> c;              <span style="color:#75715e">// nicht erlaubt!!!</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">foo</span>(T t) { ... };  <span style="color:#75715e">// nicht erlaubt!!!</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Fach<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>  a;
</span></span><span style="display:flex;"><span>Fach<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> b;</span></span></code></pre></div>
<p>Grund: Compiler generiert nur <span class='alert'>eine</span> Klasse! Beide Objekte würden
sich die statischen Attribute teilen (Typ zur Laufzeit unklar!).</p>
<p><em>Hinweis</em>: Generische (statische) Methoden sind erlaubt.</p>
<h2 id="folgen-der-typ-löschung-instanceof">Folgen der Typ-Löschung: <em>instanceof</em></h2>
<div class='center'>
<p><code>instanceof</code> mit parametrisierten Klassen ist nicht erlaubt!</p>
</div>
<div class='columns'>
<div class='column'>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fach</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printType</span>(Fach<span style="color:#f92672">&lt;?&gt;</span> p) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (p <span style="color:#66d9ef">instanceof</span> Fach<span style="color:#f92672">&lt;</span>Number<span style="color:#f92672">&gt;</span>)
</span></span><span style="display:flex;"><span>            ...
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (p <span style="color:#66d9ef">instanceof</span> Fach<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>)
</span></span><span style="display:flex;"><span>            ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
<div class='column'>
<p>Grund: Unsinniger Code nach Typ-Löschung:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fach</span> {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printType</span>(Fach p) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (p <span style="color:#66d9ef">instanceof</span> Fach)
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (p <span style="color:#66d9ef">instanceof</span> Fach)
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
</div>
<h2 id="folgen-der-typ-löschung-class">Folgen der Typ-Löschung: <em>.class</em></h2>
<div class='center'>
<p><code>.class</code> mit parametrisierten Klassen ist nicht erlaubt!</p>
</div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">boolean</span> x;
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>  a <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> b <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> (List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>.<span style="color:#a6e22e">class</span> <span style="color:#f92672">==</span> List<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span>.<span style="color:#a6e22e">class</span>);  <span style="color:#75715e">// Compiler-Fehler</span>
</span></span><span style="display:flex;"><span>x <span style="color:#f92672">=</span> (a.<span style="color:#a6e22e">getClass</span>() <span style="color:#f92672">==</span> b.<span style="color:#a6e22e">getClass</span>());               <span style="color:#f92672">//</span> <span style="color:#66d9ef">true</span></span></span></code></pre></div>
<p>Grund: Es gibt nur <code>List.class</code> (und kein <code>List&lt;String&gt;.class</code> bzw. <code>List&lt;Integer&gt;.class</code>)!</p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>Generics existieren eigentlich nur auf Quellcode-Ebene</li>
<li>&quot;Type-Erasure&quot;:
<ul>
<li>Compiler entfernt nach Typ-Prüfungen etc.
generische Typ-Parameter etc. =&gt; im Byte-Code nur noch Raw-Typen
bzw. die oberen Typ-Schranken der Typ-Parameter, in der Regel <code>Object</code></li>
<li>Compiler baut passende Casts in Byte-Code ein</li>
<li>Transparent für User; Auswirkungen beachten!</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106237&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Generics: Type Erasure (ILIAS)</a></li></ul>
  </div>
</div>



    



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Bloch2018'>[Bloch2018] <strong>Effective Java</strong><br>Bloch, J., Addison-Wesley, 2018. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-13-468599-1' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-13-468599-1</a>.</li> <li id='id_Java-SE-Tutorial'>[Java-SE-Tutorial] <a href='https://docs.oracle.com/javase/tutorial/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>The Java Tutorials</strong></a><br>Oracle Corporation, 2022.<br><em>Specialized Trails: Generics</em></li> <li id='id_LernJava'>[LernJava] <a href='https://dev.java/learn/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Learn Java</strong></a><br>Oracle Corporation, 2022.<br><em>Kapitel Generics</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kapitel 11.2 und 11.6</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Generics und Polymorphie</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Auch mit generischen Klassen stehen die Mechanismen Vererbung und Überladen zur Verfügung. Dabei muss
aber beachtet werden, dass generische Klassen sich <strong>&quot;invariant&quot;</strong> verhalten: Der Typ selbst folgt der
Vererbungsbeziehung, eine Vererbung des Typ-Parameters begründet <em>keine</em> Vererbungsbeziehung! D.h.
aus <code>U extends O</code> folgt <strong>nicht</strong> <code>A&lt;U&gt; extends A&lt;O&gt;</code>.</p>
<p>Bei Arrays ist es genau anders herum: Wenn <code>U extends O</code> dann gilt auch <code>U[] extends O[]</code> ... (Dies
nennt man &quot;<em>kovariantes</em>&quot; Verhalten.)</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/RiTA43wTixQ' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Generics und Polymorphie</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/a0d6f4ada3f85cd9f78dfde923f045f5fd43819a4930c5ef989ff6acb150c2f53208a061cf87f3c3f03823f6d645e10b1388009bfd9cfe474cfb4bdc93302fc2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Generics und Polymorphie</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Vererbungsbeziehungen mit generischen Klassen</li> <li>(K3) Umgang mit Arrays und generischen Typen</li></ul>
  </div>
</div>




    <h2 id="generische-polymorphie">Generische Polymorphie</h2>
<div class='center'>
<p><code>B&lt;E&gt; extends A&lt;E&gt;</code></p>
</div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">A</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> { ... }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">B</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> A<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> { ... }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>A<span style="color:#f92672">&lt;</span>Double<span style="color:#f92672">&gt;</span> ad <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> B<span style="color:#f92672">&lt;</span>Double<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>A<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> as <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> B<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>();</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Vector</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> { ... }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Stack</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> Vector<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> { ... }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Vector<span style="color:#f92672">&lt;</span>Double<span style="color:#f92672">&gt;</span> vd <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Stack<span style="color:#f92672">&lt;</span>Double<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>Vector<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> vs <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Stack<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span>();</span></span></code></pre></div>
<p>=&gt; Polymorphie bei Generics bezieht sich auf <strong>Typ</strong> (nicht Typ-Parameter)</p>
<p><strong>Invarianz</strong>: Generics sind <em>invariant</em>, d.h. ein <code>HashSet&lt;String&gt;</code> ist ein
Untertyp von <code>Set&lt;String&gt;</code>. Bei der Vererbung muss der Typ-Parameter identisch
sein.</p>
<h2 id="polymorphie-bei-generics-bezieht-sich-nur-auf-typ">Polymorphie bei Generics bezieht sich nur auf Typ!</h2>
<div class='center'>
<p>&quot;<code>B extends A</code>&quot; <span class='alert'><strong>bedeutet nicht</strong></span> &quot;<code>C&lt;B&gt; extends C&lt;A&gt;</code>&quot;</p>
</div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Stack<span style="color:#f92672">&lt;</span>Number<span style="color:#f92672">&gt;</span> s <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Stack<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span>(); <span style="color:#75715e">// DAS GEHT SO NICHT!</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Folgen (wenn obiges gehen wuerde):</span>
</span></span><span style="display:flex;"><span>s.<span style="color:#a6e22e">push</span>(<span style="color:#66d9ef">new</span> Integer(3)); <span style="color:#75715e">// das ginge sowieso ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Folgen (wenn obiges gehen wuerde):</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Stack&lt;Number&gt; waere Oberklasse auch von Stack&lt;Double&gt;</span>
</span></span><span style="display:flex;"><span>s.<span style="color:#a6e22e">push</span>(<span style="color:#66d9ef">new</span> Double(2.<span style="color:#a6e22e">0</span>)); <span style="color:#75715e">// waere dann auch erlaubt ...</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Das Objekt (Stack&lt;Integer&gt;) kann aber keine Double speichern!</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> Zur Laufzeit keine Typ<span style="color:#f92672">-</span>Informationen mehr<span style="color:#f92672">!</span></span></span></code></pre></div>
<ul>
<li>Typ-Löschung =&gt; zur Laufzeit keine Typinformationen vorhanden</li>
<li>Compiler muss Typen prüfen (können)!</li>
</ul>
<h2 id="abgrenzung-polymorphie-bei-arrays">Abgrenzung: Polymorphie bei Arrays</h2>
<div class='center'>
<p>Wenn &quot;<code>B extends A</code>&quot; dann &quot;<code>B[] extends A[]</code>&quot;</p>
</div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Object<span style="color:#f92672">[]</span> x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String<span style="color:#f92672">[]</span> {<span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#e6db74">&#34;World&#34;</span>, <span style="color:#e6db74">&#34;:-)&#34;</span>};
</span></span><span style="display:flex;"><span>x<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hallo&#34;</span>;
</span></span><span style="display:flex;"><span>x<span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Double(2.<span style="color:#a6e22e">0</span>);  <span style="color:#75715e">// Laufzeitfehler</span>
</span></span><span style="display:flex;"><span>String<span style="color:#f92672">[]</span> y <span style="color:#f92672">=</span> x;  <span style="color:#f92672">//</span> String<span style="color:#f92672">[]</span> ist KEIN Object<span style="color:#f92672">[]!!!</span></span></span></code></pre></div>
<ul>
<li>Arrays besitzen Typinformationen über gespeicherte Elemente</li>
<li>Prüfung auf Typ-Kompatibilität zur <strong>Laufzeit</strong> (nicht Kompilierzeit!)</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://openbook.rheinwerk-verlag.de/javainsel/11_002.html#u11.2.2" target="_blank"><span class="title">Hinweis auf Java-Geschichte (Java-Insel: &quot;Type Erasure&quot;)</span></a></span></div>
<p>Arrays gab es sehr früh, Generics erst relativ spät (ab Java6) =&gt; bei
Arrays fand man das Verhalten natürlich und pragmatisch (trotz der Laufzeit-Überprüfung).</p>
<p>Bei der Einführung von Generics musste man Kompatibilität sicherstellen (alter
Code soll auch mit neuen Compilern übersetzt werden können - obwohl im alten
Code Raw-Types verwendet werden). Außerdem wollte man von Laufzeit-Prüfung hin zu
Compiler-Prüfung. Da würde das von Arrays bekannte Verhalten Probleme machen ...</p>
<p><strong>Kovarianz</strong>: Arrays sind <em>kovariant</em>, d.h. ein Array vom Typ <code>String[]</code> ist wegen
<code>String extends Object</code> ein Untertyp von <code>Object[]</code>.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/generics/src/arrays/X.java" target="_blank"><span class="title">Beispiel arrays.X</span></a></span></div>
<h2 id="arrays-vs-parametrisierte-klassen">Arrays vs. parametrisierte Klassen</h2>
<p>=&gt; Keine Arrays mit parametrisierten Klassen!</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Foo<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;[]</span> x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Foo<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;[</span>2<span style="color:#f92672">]</span>;   <span style="color:#75715e">// Compilerfehler</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Foo<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">[]&gt;</span> y <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Foo<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">[]&gt;</span>();  <span style="color:#f92672">//</span> OK :)</span></span></code></pre></div>
<p>Arrays mit parametrisierten Klassen sind nicht erlaubt! Arrays brauchen zur
Laufzeit Typinformationen, die aber durch die Typ-Löschung entfernt werden.</p>
<h2 id="diskussion-vererbung-vs-generics">Diskussion Vererbung vs. Generics</h2>
<p><strong>Vererbung:</strong></p>
<ul>
<li><em>IS-A</em>-Beziehung</li>
<li>Anwendung: Vererbungsbeziehung vorliegend, Eigenschaften verfeinern</li>
<li>Beispiel: Ein Student <em>ist eine</em> Person</li>
</ul>
<p><strong>Generics:</strong></p>
<ul>
<li>Schablone (Template) für viele Datentypen</li>
<li>Anwendung: Identischer Code für unterschiedliche Typen</li>
<li>Beispiel: Datenstrukturen, Algorithmen generisch realisieren</li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Generics: Vererbung und Überladen möglich, aber:
<strong>Aus &quot;<code>U extends O</code>&quot; folgt <span class='alert'><strong>nicht</strong></span> &quot;<code>A&lt;U&gt; extends A&lt;O&gt;</code>&quot;</strong></p>
</li>
<li>
<p>Achtung: Bei Arrays gilt aber: Wenn &quot;<code>U extends O</code>&quot; dann gilt auch &quot;<code>U[] extends O[]</code>&quot; ...</p>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106238&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Generics und Polymorphie (ILIAS)</a></li></ul>
  </div>
</div>



    



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Bloch2018'>[Bloch2018] <strong>Effective Java</strong><br>Bloch, J., Addison-Wesley, 2018. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-13-468599-1' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-13-468599-1</a>.</li> <li id='id_Java-SE-Tutorial'>[Java-SE-Tutorial] <a href='https://docs.oracle.com/javase/tutorial/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>The Java Tutorials</strong></a><br>Oracle Corporation, 2022.<br><em>Specialized Trails: Generics</em></li> <li id='id_LernJava'>[LernJava] <a href='https://dev.java/learn/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Learn Java</strong></a><br>Oracle Corporation, 2022.<br><em>Kapitel Generics</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kapitel 11.5</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
          <article class="default">
            <header class="headline">
            </header>

<h1 id="bauen-von-programmen-automatisierung-continuous-integration">Bauen von Programmen, Automatisierung, Continuous Integration</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/gradle.html">Build-Systeme: Gradle</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci.html">Continuous Integration (CI)</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Bauen von Programmen, Automatisierung, Continuous Integration</h1>
<article class="default">
<h1>Build-Systeme: Gradle</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Um beim Übersetzen und Testen von Software von den spezifischen Gegebenheiten auf einem
Entwicklerrechner unabhängig zu werden, werden häufig sogenannte Build-Tools eingesetzt.
Mit diesen konfiguriert man sein Projekt abseits einer IDE und übersetzt, testet und
baut seine Applikation damit entsprechend unabhängig. In der Java-Welt sind aktuell die
Build-Tools Ant, Maven und Gradle weit verbreitet.</p>
<p>In Gradle ist ein Java-Entwicklungsmodell quasi eingebaut. Über die Konfigurationsskripte
müssen nur noch bestimmte Details wie benötigte externe Bibliotheken oder die Hauptklasse
und sonstige Projektbesonderheiten konfiguriert werden. Über &quot;Tasks&quot; wie <code>build</code>, <code>test</code>
oder <code>run</code> können Java-Projekte übersetzt, getestet und ausgeführt werden. Dabei werden die
externen Abhängigkeiten (Bibliotheken) aufgelöst (soweit konfiguriert) und auch abhängige
Tasks mit erledigt, etwa muss zum Testen vorher der Source-Code übersetzt werden.</p>
<p>Gradle bietet eine Fülle an Plugins für bestimmte Aufgaben an, die jeweils mit neuen Tasks
einher kommen. Beispiele sind das Plugin <code>java</code>, welches weitere Java-spezifische Tasks
wie <code>classes</code> mitbringt, oder das Plugin <code>checkstyle</code> zum Überprüfen von Coding-Style-Richtlinien.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/aVtDkFpwd_E' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Build-Systeme: Gradle</a></li> <li><a href='https://youtu.be/OhQRGaNO4iA' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Gradle</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/3af48428e1b62bd42410e2a802cf355309212ea621509aa20833c5e1c486ffe9214b027c29e55d775f135f45ab7d3fcd59d735812d64bc04a71de8d59df8a3f5' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Build-Systeme: Gradle</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Schreiben und Verstehen einfacher Gradle-Skripte</li></ul>
  </div>
</div>




    <h2 id="automatisieren-von-arbeitsabläufen">Automatisieren von Arbeitsabläufen</h2>
<div class='center'>
<p>Works on my machine ...</p>
</div>
<p>Einen häufigen Ausspruch, den man bei der Zusammenarbeit in Teams zu hören
bekommt, ist &quot;Also, bei mir läuft der Code.&quot; ...</p>
<p>Das Problem dabei ist, dass jeder Entwickler eine andere Maschine hat, oft ein
anderes Betriebssystem oder eine andere OS-Version. Dazu kommen noch eine andere
IDE und/oder andere Einstellungen und so weiter.</p>
<p>Wie bekommt man es hin, dass Code zuverlässig auch auf anderen Rechnern baut?
Ein wichtiger Baustein dafür sind sogenannte &quot;Build-Systeme&quot;, also Tools, die
unabhängig von der IDE (und den IDE-Einstellungen) für das Übersetzen der
Software eingesetzt werden und deren Konfiguration dann mit im Repo eingecheckt
wird. Damit kann die Software dann auf allen Rechnern und insbesondere dann auch
auf dem Server (Stichwort &quot;Continuous Integration&quot;) unabhängig von der IDE o.ä.
automatisiert gebaut und getestet werden.</p>
<ul>
<li>Build-Tools:
<ul>
<li>Apache Ant</li>
<li>Apache Maven</li>
<li><strong>Gradle</strong></li>
</ul>
</li>
</ul>
<p>Das sind die drei am häufigsten anzutreffenden Build-Tools in der Java-Welt.</p>
<p>Ant ist von den drei genannten Tools das älteste und setzt wie Maven auf XML als
Beschreibungssprache. In Ant müssen dabei alle Regeln stets explizit formuliert
werden, die man benutzen möchte.</p>
<p>In Maven wird dagegen von einem bestimmten Entwicklungsmodell ausgegangen, hier
müssen nur noch die Abweichungen zu diesem Modell konfiguriert werden.</p>
<p>In Gradle wird eine DSL basierend auf der Skriptsprache Groovy (läuft auf der
JVM) eingesetzt, und es gibt hier wie in Maven ein bestimmtes eingebautes
Entwicklungsmodell. Gradle bringt zusätzlich noch einen Wrapper mit, d.h. es
wird eine Art Gradle-Starter im Repo konfiguriert, der sich quasi genauso
verhält wie ein fest installiertes Gradle (s.u.).</p>
<p><strong>Achtung</strong>: Während Ant und Maven relativ stabil in der API sind, verändert
sich Gradle teilweise deutlich zwischen den Versionen. Zusätzlich sind bestimmte
Gradle-Versionen oft noch von bestimmten JDK-Versionen abhängig. In der Praxis
bedeutet dies, dass man Gradle-Skripte im Laufe der Zeit relativ oft überarbeiten
muss (einfach nur, damit das Skript wieder läuft - ohne dass man dabei
irgendwelche neuen Features oder sonstige Vorteile erzielen würde). Ein großer
Vorteil ist aber der Gradle-Wrapper (s.u.).</p>
<h2 id="gradle-eine-dsl-in-groovy">Gradle: Eine DSL in Groovy</h2>
<p>DSL: <em>Domain Specific Language</em></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-groovy" data-lang="groovy"><span style="display:flex;"><span><span style="color:#75715e">// build.gradle
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>plugins <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    id <span style="color:#e6db74">&#39;java&#39;</span>
</span></span><span style="display:flex;"><span>    id <span style="color:#e6db74">&#39;application&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>repositories <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    mavenCentral<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dependencies <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    testImplementation <span style="color:#e6db74">&#39;junit:junit:4.13.2&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>application <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    mainClass <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;fluppie.App&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div>
<p>Dies ist mit die einfachste Build-Datei für Gradle.</p>
<p>Über Plugins wird die Unterstützung für Java und das Bauen von Applikationen aktiviert,
d.h. es stehen darüber entsprechende spezifische Tasks zur Verfügung.</p>
<p>Abhängigkeiten sollen hier aus dem Maven-Repository <a href="https://mvnrepository.com/repos/central" rel="external" target="_blank">MavenCentral</a>
geladen werden. Zusätzlich wird hier als Abhängigkeit für den Test (<code>testImplementation</code>)
die JUnit-Bibliothek in einer Maven-artigen Notation angegeben (vgl.
<a href="https://mvnrepository.com/" rel="external" target="_blank">mvnrepository.com</a>). (Für nur zur Übersetzung der Applikation
benötigte Bibliotheken verwendet man stattdessen das Schlüsselwort <code>implementation</code>.)</p>
<p>Bei der Initialisierung wurde als Package <code>fluppie</code> angegeben. Gradle legt darunter per
Default die Klasse <code>App</code> mit einer <code>main()</code>-Methode an. Entsprechend kann man über den
Eintrag <code>application</code> den Einsprungpunkt in die Applikation konfigurieren.</p>
<h2 id="gradle-dsl">Gradle-DSL</h2>
<p>Ein Gradle-Skript ist letztlich ein in Groovy geschriebenes Skript.
<a href="https://groovy-lang.org/" rel="external" target="_blank">Groovy</a> ist eine auf Java basierende und auf
der JVM ausgeführte Skriptsprache. Seit einigen Versionen kann man die
Gradle-Build-Skripte auch in der Sprache Kotlin schreiben.</p>
<h2 id="dateien">Dateien</h2>
<p>Für das Bauen mit Gradle benötigt man drei Dateien im Projektordner:</p>
<ul>
<li>
<p><code>build.gradle</code>: Die auf der Gradle-DSL beruhende Definition des Builds
mit den Tasks (und ggf. Abhängigkeiten) eines Projekts.</p>
<p>Ein Multiprojekt hat pro Projekt eine solche Build-Datei. Dabei können
die Unterprojekte Eigenschaften der Eltern-Buildskripte &quot;erben&quot; und so
relativ kurz ausfallen.</p>
</li>
<li>
<p><code>settings.gradle</code>: Eine optionale Datei, in der man beispielsweise den
Projektnamen oder bei einem Multiprojekt die relevanten Unterprojekte
festlegt.</p>
</li>
<li>
<p><code>gradle.properties</code>: Eine weitere optionale Datei, in der projektspezifische
Properties für den Gradle-Build spezifizieren kann.</p>
</li>
</ul>
<h2 id="gradle-init">Gradle Init</h2>
<p>Um eine neue Gradle-Konfiguration anlegen zu lassen, geht man in einen Ordner
und führt darin <code>gradle init</code> aus. Gradle fragt der Reihe nach einige Einstellungen
ab:</p>
<pre><code>$ gradle init

Select type of project to generate:
  1: basic
  2: application
  3: library
  4: Gradle plugin
Enter selection (default: basic) [1..4] 2

Select implementation language:
  1: C++
  2: Groovy
  3: Java
  4: Kotlin
  5: Scala
  6: Swift
Enter selection (default: Java) [1..6] 3

Split functionality across multiple subprojects?:
  1: no - only one application project
  2: yes - application and library projects
Enter selection (default: no - only one application project) [1..2] 1

Select build script DSL:
  1: Groovy
  2: Kotlin
Enter selection (default: Groovy) [1..2] 1

Select test framework:
  1: JUnit 4
  2: TestNG
  3: Spock
  4: JUnit Jupiter
Enter selection (default: JUnit Jupiter) [1..4] 1

Project name (default: tmp): wuppie
Source package (default: tmp): fluppie
</code></pre>
<p>Typischerweise möchte man eine Applikation bauen (Auswahl 2 bei der ersten Frage).
Als nächstes wird nach der Sprache des Projekts gefragt sowie nach der Sprache für
das Gradle-Build-Skript (Default ist Groovy) sowie nach dem Testframework, welches
verwendet werden soll.</p>
<p>Damit wird die eingangs gezeigte Konfiguration angelegt.</p>
<h2 id="ordner">Ordner</h2>
<p>Durch <code>gradle init</code> wird ein neuer Ordner <code>wuppie/</code> mit folgender Ordnerstruktur
angelegt:</p>
<pre><code>drwxr-xr-x 4 cagix cagix 4096 Apr  8 11:43 ./
drwxrwxrwt 1 cagix cagix 4096 Apr  8 11:43 ../
-rw-r--r-- 1 cagix cagix  154 Apr  8 11:43 .gitattributes
-rw-r--r-- 1 cagix cagix  103 Apr  8 11:43 .gitignore
drwxr-xr-x 3 cagix cagix 4096 Apr  8 11:43 app/
drwxr-xr-x 3 cagix cagix 4096 Apr  8 11:42 gradle/
-rwxr-xr-x 1 cagix cagix 8070 Apr  8 11:42 gradlew*
-rw-r--r-- 1 cagix cagix 2763 Apr  8 11:42 gradlew.bat
-rw-r--r-- 1 cagix cagix  370 Apr  8 11:43 settings.gradle
</code></pre>
<p>Es werden Einstellungen für Git erzeugt (<code>.gitattributes</code> und
<code>.gitignore</code>).</p>
<p>Im Ordner <code>gradle/</code> wird der Gradle-Wrapper abgelegt (s.u.). Dieser
Ordner wird normalerweise mit ins Repo eingecheckt. Die Skripte
<code>gradlew</code> und <code>gradlew.bat</code> sind die Startskripte für den Gradle-Wrapper
(s.u.) und werden normalerweise ebenfalls ins Repo mit eingecheckt.</p>
<p>Der Ordner <code>.gradle/</code> (erscheint ggf. nach dem ersten Lauf von Gradle
auf dem neuen Projekt) ist nur ein Hilfsordner (&quot;Cache&quot;) von Gradle.
Hier werden heruntergeladene Dateien etc. abgelegt. Dieser Order
sollte <strong>nicht</strong> ins Repo eingecheckt werden und ist deshalb auch
per Default im generierten <code>.gitignore</code> enthalten. (Zusätzlich gibt es
im User-Verzeichnis auch noch einen Ordner <code>.gradle/</code> mit einem globalen
Cache.)</p>
<p>In <code>settings.gradle</code> finden sich weitere Einstellungen. Die eigentliche
Gradle-Konfiguration befindet sich zusammen mit dem eigentlichen Projekt
im Unterordner <code>app/</code>:</p>
<pre><code>drwxr-xr-x 4 root root 4096 Apr  8 11:50 ./
drwxr-xr-x 5 root root 4096 Apr  8 11:49 ../
drwxr-xr-x 5 root root 4096 Apr  8 11:50 build/
-rw-r--r-- 1 root root  852 Apr  8 11:43 build.gradle
drwxr-xr-x 4 root root 4096 Apr  8 11:43 src/
</code></pre>
<p>Die Datei <code>build.gradle</code> ist die durch <code>gradle init</code> erzeugte (und
eingangs gezeigte) Konfigurationsdatei, vergleichbar mit <code>build.xml</code>
für Ant oder <code>pom.xml</code> für Maven. Im Unterordner <code>build/</code> werden die
generierten <code>.class</code>-Dateien etc. beim Build-Prozess abgelegt.</p>
<p>Unter <code>src/</code> findet sich dann eine Maven-typische Ordnerstruktur
für die Sourcen:</p>
<pre><code>$ tree src/
src/
|-- main
|   |-- java
|   |   `-- fluppie
|   |       `-- App.java
|   `-- resources
`-- test
    |-- java
    |   `-- fluppie
    |       `-- AppTest.java
    `-- resources
</code></pre>
<p>Unterhalb von <code>src/</code> ist ein Ordner <code>main/</code> für die Quellen der Applikation (Sourcen
und Ressourcen). Für jede Sprache gibt es einen eigenen Unterordner, hier entsprechend
<code>java/</code>. Unterhalb diesem folgt dann die bei der Initialisierung angelegte Package-Struktur
(hier <code>fluppie</code> mit der Default-Main-Klasse <code>App</code> mit einer <code>main()</code>-Methode). Diese
Strukturen wiederholen sich für die Tests unterhalb von <code>src/test/</code>.</p>
<p>Wer die herkömmlichen, deutlich flacheren Strukturen bevorzugt, also unterhalb von <code>src/</code>
direkt die Java-Package-Strukturen für die Sourcen der Applikation und unterhalb von <code>test/</code>
entsprechend die Strukturen für die JUnit-Test, der kann dies im Build-Skript einstellen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-groovy" data-lang="groovy"><span style="display:flex;"><span>sourceSets <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    main <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        java <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            srcDirs <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;src&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        resources <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            srcDirs <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;res&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    test <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        java <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            srcDirs <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;test&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div>
<h2 id="ablauf-eines-gradle-builds">Ablauf eines Gradle-Builds</h2>
<p>Ein Gradle-Build hat zwei Hauptphasen: Konfiguration und Ausführung.</p>
<p>Während der Konfiguration wird das gesamte Skript durchlaufen (vgl. Ausführung
der direkten Anweisungen eines Tasks). Dabei wird ein Graph erzeugt: welche
Tasks hängen von welchen anderen ab etc.</p>
<p>Anschließend wird der gewünschte Task ausgeführt. Dabei werden zuerst alle
Tasks ausgeführt, die im Graphen auf dem Weg zu dem gewünschten Task liegen.</p>
<p>Mit <code>gradle tasks</code> kann man sich die zur Verfügung stehenden Tasks ansehen.
Diese sind der Übersicht halber noch nach &quot;Themen&quot; sortiert.</p>
<p>Für eine Java-Applikation sind die typischen Tasks <code>gradle build</code> zum Bauen der
Applikation (inkl. Ausführen der Tests) sowie <code>gradle run</code> zum Starten der Anwendung.
Wer nur die Java-Sourcen compilieren will, würde den Task <code>gradle compileJava</code> nutzen.
Mit <code>gradle check</code> würde man compilieren und die Tests ausführen sowie weitere Checks
durchführen (<code>gradle test</code> würde nur compilieren und die Tests ausführen), mit <code>gradle jar</code>
die Anwendung in ein <code>.jar</code>-File packen und mit <code>gradle javadoc</code> die Javadoc-Dokumentation
erzeugen und mit <code>gradle clean</code> die generierten Hilfsdateien aufräumen (löschen).</p>
<h2 id="plugin-architektur">Plugin-Architektur</h2>
<p>Für bestimmte Projekttypen gibt es immer wieder die gleichen Aufgaben. Um hier
Schreibaufwand zu sparen, existieren verschiedene Plugins für verschiedene
Projekttypen. In diesen Plugins sind die entsprechenden Tasks bereits mit den
jeweiligen Abhängigkeiten formuliert. Diese Idee stammt aus Maven, wo dies
für Java-basierte Projekte umgesetzt ist.</p>
<p>Beispielsweise erhält man über das Plugin <code>java</code> den Task <code>clean</code> zum Löschen
aller generierten Build-Artefakte, den Task <code>classes</code>, der die Sourcen zu
<code>.class</code>-Dateien kompiliert oder den Task <code>test</code>, der die JUnit-Tests
ausführt ...</p>
<p>Sie können sich Plugins und weitere Tasks relativ leicht auch selbst definieren.</p>
<h2 id="auflösen-von-abhängigkeiten">Auflösen von Abhängigkeiten</h2>
<p>Analog zu Maven kann man Abhängigkeiten (etwa in einer bestimmten Version
benötigte Bibliotheken) im Gradle-Skript angeben. Diese werden (transparent für
den User) von einer ebenfalls angegeben Quelle, etwa einem Maven-Repository,
heruntergeladen und für den Build genutzt. Man muss also nicht mehr die
benötigten <code>.jar</code>-Dateien der Bibliotheken mit ins Projekt einchecken.
Analog zu Maven können erzeugte Artefakte automatisch publiziert werden, etwa
in einem Maven-Repository.</p>
<p>Für das Projekt benötigte Abhängigkeiten kann man über den Eintrag <code>dependencies</code>
spezifizieren. Dabei unterscheidet man u.a. zwischen Applikation und Tests:
<code>implementation</code> und <code>testImplementation</code> für das Compilieren und Ausführen von
Applikation bzw. Tests. Diese Abhängigkeiten werden durch Gradle über die im
Abschnitt <code>repositories</code> konfigurierten Repositories aufgelöst und die entsprechenden
<code>.jar</code>-Files geladen (in den <code>.gradle/</code>-Ordner).</p>
<p>Typische Repos sind das Maven-Repo selbst (<code>mavenCentral()</code>) oder das Google-Maven-Repo
(<code>google()</code>).</p>
<p>Die Einträge in <code>dependencies</code> erfolgen dabei in einer Maven-Notation, die Sie
auch im Maven-Repo <a href="https://mvnrepository.com/" rel="external" target="_blank">mvnrepository.com</a> finden.</p>
<h2 id="beispiel-mit-weiteren-konfigurationen-ua-checkstyle-und-javadoc">Beispiel mit weiteren Konfigurationen (u.a. Checkstyle und Javadoc)</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-groovy" data-lang="groovy"><span style="display:flex;"><span>plugins <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    id <span style="color:#e6db74">&#39;java&#39;</span>
</span></span><span style="display:flex;"><span>    id <span style="color:#e6db74">&#39;application&#39;</span>
</span></span><span style="display:flex;"><span>    id <span style="color:#e6db74">&#39;checkstyle&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>repositories <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    mavenCentral<span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>application <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    mainClass <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;hangman.Main&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>java <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    sourceCompatibility <span style="color:#f92672">=</span> JavaVersion<span style="color:#f92672">.</span><span style="color:#a6e22e">VERSION_11</span>
</span></span><span style="display:flex;"><span>    targetCompatibility <span style="color:#f92672">=</span> JavaVersion<span style="color:#f92672">.</span><span style="color:#a6e22e">VERSION_11</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>run <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    standardInput <span style="color:#f92672">=</span> System<span style="color:#f92672">.</span><span style="color:#a6e22e">in</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>sourceSets <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    main <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        java <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            srcDirs <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;src&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        resources <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            srcDirs <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;res&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>checkstyle <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    configFile <span style="color:#f92672">=</span> file<span style="color:#f92672">(</span><span style="color:#960050;background-color:#1e0010">“</span>$<span style="color:#f92672">{</span>rootDir<span style="color:#f92672">}/</span>google_checks<span style="color:#f92672">.</span><span style="color:#a6e22e">xml</span><span style="color:#960050;background-color:#1e0010">”</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    toolVersion <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;10.19.0&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>dependencies <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    implementation group: <span style="color:#e6db74">&#39;org.apache.poi&#39;</span><span style="color:#f92672">,</span> name: <span style="color:#e6db74">&#39;poi&#39;</span><span style="color:#f92672">,</span> version: <span style="color:#e6db74">&#39;4.1.2&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>javadoc <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    options<span style="color:#f92672">.</span><span style="color:#a6e22e">showAll</span><span style="color:#f92672">()</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div>
<p>Hier sehen Sie übrigens noch eine weitere mögliche Schreibweise für das Notieren
von Abhängigkeiten: <code>implementation group: 'org.apache.poi', name: 'poi', version: '4.1.2'</code>
und <code>implementation 'org.apache.poi:poi:4.1.2'</code> sind gleichwertig, wobei die letztere
Schreibweise sowohl in den generierten Builds-Skripten und in der offiziellen Dokumentation
bevorzugt wird.</p>
<h2 id="gradle-und-ant-und-maven">Gradle und Ant (und Maven)</h2>
<p>Vorhandene Ant-Buildskripte kann man nach Gradle importieren und ausführen
lassen. Über die DSL kann man auch direkt Ant-Tasks aufrufen. Siehe auch
<a href="https://docs.gradle.org/current/userguide/ant.html" rel="external" target="_blank">&quot;Using Ant from Gradle&quot;</a>.</p>
<h2 id="gradle-wrapper">Gradle-Wrapper</h2>
<pre><code>project
|-- app/
|-- build.gradle
|-- gradlew
|-- gradlew.bat
`-- gradle/
    `-- wrapper/
        |-- gradle-wrapper.jar
        `-- gradle-wrapper.properties
</code></pre>
<p>Zur Ausführung von Gradle-Skripten benötigt man eine lokale Gradle-Installation.
Diese sollte für i.d.R. alle User, die das Projekt bauen wollen, identisch sein.
Leider ist dies oft nicht gegeben bzw. nicht einfach lösbar.</p>
<p>Zur Vereinfachung gibt es den Gradle-Wrapper <code>gradlew</code> (bzw. <code>gradlew.bat</code> für Windows).
Dies ist ein kleines Shellskript, welches zusammen mit einigen kleinen <code>.jar</code>-Dateien im
Unterordner <code>gradle/</code> mit ins Repo eingecheckt wird und welches direkt die Rolle des
<code>gradle</code>-Befehls einer Gradle-Installation übernehmen kann. Man kann also in Konfigurationskripten,
beispielsweise für Gitlab CI, alle Aufrufe von <code>gradle</code> durch Aufrufe von <code>gradlew</code> ersetzen.</p>
<p>Beim ersten Aufruf lädt <code>gradlew</code> dann die spezifizierte Gradle-Version herunter und speichert
diese in einem lokalen Ordner <code>.gradle/</code>. Ab dann greift <code>gradlew</code> auf diese lokale (nicht
&quot;installierte&quot;) <code>gradle</code>-Version zurück.</p>
<p><code>gradle init</code> erzeugt den Wrapper automatisch in der verwendeten Gradle-Version mit.
Alternativ kann man den Wrapper nachträglich über <code>gradle wrapper --gradle-version 6.5</code>
in einer bestimmten (gewünschten) Version anlegen lassen.</p>
<p>Da der Gradle-Wrapper im Repository eingecheckt ist, benutzen alle Entwickler damit
automatisch die selbe Version, ohne diese auf ihrem System zuvor installieren zu müssen.
Deshalb ist der Einsatz des Wrappers einem fest installierten Gradle vorzuziehen!</p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Automatisieren von Arbeitsabläufen mit Build-Tools/-Skripten</p>
</li>
<li>
<p>Einstieg in <strong>Gradle</strong> (DSL zur Konfiguration)</p>
<ul>
<li>Typisches Java-Entwicklungsmodell eingebaut</li>
<li>Konfiguration der Abweichungen (Abhängigkeiten, Namen, ...)</li>
<li>Gradle-Wrapper: Ersetzt eine feste Installation</li>
</ul>
</li>
</ul>
<h2 id="link-sammlung-gradle">Link-Sammlung Gradle</h2>
<ul>
<li><a href="https://docs.gradle.org/current/userguide/getting_started.html" rel="external" target="_blank">&quot;Getting Started&quot;</a></li>
<li><a href="https://docs.gradle.org/current/samples/sample_building_java_applications.html" rel="external" target="_blank">&quot;Building Java Applications Sample&quot;</a></li>
<li><a href="https://docs.gradle.org/current/samples/sample_building_java_applications_multi_project.html" rel="external" target="_blank">&quot;Building Java Applications with libraries Sample&quot;</a></li>
<li><a href="https://docs.gradle.org/current/samples/sample_building_java_libraries.html" rel="external" target="_blank">&quot;Building Java Libraries Sample&quot;</a></li>
<li><a href="https://docs.gradle.org/current/userguide/building_java_projects.html" rel="external" target="_blank">&quot;Building Java &amp; JVM projects&quot;</a></li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106220&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Gradle (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachten Sie das Buildskript <code>gradle.build</code> aus <a href="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/build.gradle" rel="external" target="_blank">Dungeon-CampusMinden/Dungeon</a>.</p>
<p>Erklären Sie, in welche Abschnitte das Buildskript unterteilt ist und welche Aufgaben diese
Abschnitte jeweils erfüllen. Gehen Sie dabei im <em>Detail</em> auf das Plugin <code>java</code> und die dort
bereitgestellten Tasks und deren Abhängigkeiten untereinander ein.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Gradle'>[Gradle] <a href='https://gradle.org/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Gradle Build Tool</strong></a><br>Gradle Inc., 2022.</li> <li id='id_Inden2013'>[Inden2013] <strong>Der Weg zum Java-Profi</strong><br>Inden, M., dpunkt.verlag, 2013. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8649-1245-0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8649-1245-0</a>.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Continuous Integration (CI)</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>In größeren Projekten mit mehreren Teams werden die Beteiligten i.d.R. nur noch &quot;ihre&quot;
Codestellen compilieren und testen. Dennoch ist es wichtig, das gesamte Projekt regelmäßig
zu &quot;bauen&quot; und auch umfangreichere Testsuiten regelmäßig laufen zu lassen. Außerdem ist
es wichtig, das in einer definierten Umgebung zu tun und nicht auf einem oder mehreren
Entwicklerrechnern, die i.d.R. (leicht) unterschiedlich konfiguriert sind, um zuverlässige
und nachvollziehbare Ergebnisse zu bekommen. Weiterhin möchte man auf bestimmte Ereignisse
reagieren, wie etwa neue Commits im Git-Server, oder bei Pull-Requests möchte man vor dem
Merge automatisiert sicherstellen, dass damit die vorhandenen Tests alle &quot;grün&quot; sind und
auch die Formatierung etc. stimmt.</p>
<p>Dafür hat sich &quot;Continuous Integration&quot; etabliert. Hier werden die angesprochenen Prozesse
regelmäßig auf einem dafür eingerichteten System durchgeführt. Aktivitäten wie Übersetzen,
Testen, Style-Checks etc. werden in sogenannten &quot;Pipelines&quot; oder &quot;Workflows&quot; zusammengefasst
und automatisiert durch Commits, Pull-Requests oder Merges auf dem Git-Server ausgelöst. Die
Aktionen können dabei je nach Trigger und Branch unterschiedlich sein, d.h. man könnte etwa
bei PR gegen den Master umfangreichere Tests laufen lassen als bei einem PR gegen einen
Develop-Branch. In einem Workflow oder einer Pipeline können einzelne Aktionen wiederum von
anderen Aktionen abhängen. Das Ergebnis kann man dann auf dem Server einsehen oder bekommt
man komfortabel als Report per Mail zugeschickt.</p>
<p>Wir schauen uns hier exemplarisch GitHub Actions und GitLab CI/CD an. Um CI sinnvoll einsetzen
zu können, benötigt man Kenntnisse über Build-Tools. &quot;CI&quot; tritt üblicherweise zusammen mit &quot;CD&quot;
(Continuous Delivery) auf, also als &quot;CI/CD&quot;. Der &quot;CD&quot;-Teil ist nicht Gegenstand der Betrachtung
in dieser Lehrveranstaltung.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/NCWxo-PN4gs' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Continuous Integration</a></li> <li><a href='https://youtu.be/rpkZvuiyvTU' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo GitHub Actions</a></li> <li><a href='https://youtu.be/2ydDA4WY1wA' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Demo GitLab CI/CD</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/74a8f8c2e1a07d9fb70c8984e522d884141b2260c27dadfd7a23884bee8c0573136475ce66f28562097ca34a63fcf9c6d1c45ff695485d79465a4131878180ca' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Continuous Integration</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Arbeitsweise von/mit CI</li></ul>
  </div>
</div>




    <h2 id="motivation-zusammenarbeit-in-teams">Motivation: Zusammenarbeit in Teams</h2>
<h3 id="szenario">Szenario</h3>
<ul>
<li>Projekt besteht aus diversen Teilprojekten</li>
<li>Verschiedene Entwicklungs-Teams arbeiten (getrennt) an verschiedenen Projekten</li>
<li>Tester entwickeln Testsuiten für die Teilprojekte</li>
<li>Tester entwickeln Testsuiten für das Gesamtprojekt</li>
</ul>
<h3 id="manuelle-ausführung-der-testsuiten-reicht-nicht">Manuelle Ausführung der Testsuiten reicht nicht</h3>
<ul>
<li>Belastet den Entwicklungsprozess</li>
<li>Keine (einheitliche) Veröffentlichung der Ergebnisse</li>
<li>Keine (einheitliche) Eskalation bei Fehlern</li>
<li>Keine regelmäßige Integration in Gesamtprojekt</li>
</ul>
<h3 id="continuous-integration">Continuous Integration</h3>
<ul>
<li>Regelmäßige, automatische Ausführung: Build und Tests</li>
<li>Reporting</li>
<li>Weiterführung der Idee: Regelmäßiges Deployment (<em>Continuous Deployment</em>)</li>
</ul>
<h2 id="continuous-integration-ci">Continuous Integration (CI)</h2>
<p><a href="#R-image-94842bc0bc904d58d7660646b2cf4fde" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/ci.png?width=60%25&height=auto" style=" height: auto; width: 60%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-94842bc0bc904d58d7660646b2cf4fde"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/ci.png?width=60%25&height=auto"></a></p>
<h3 id="vorgehen">Vorgehen</h3>
<ul>
<li>Entwickler und Tester committen ihre Änderungen regelmäßig (Git, SVN, ...)</li>
<li>CI-Server arbeitet Build-Skripte ab, getriggert durch Events: Push-Events, Zeit/Datum, ...
<ul>
<li>Typischerweise wird dabei:
<ul>
<li>Das Gesamtprojekt übersetzt (&quot;gebaut&quot;)</li>
<li>Die Unit- und die Integrationstests abgearbeitet</li>
<li>Zu festen Zeiten werden zusätzlich Systemtests gefahren</li>
</ul>
</li>
<li>Typische weitere Builds: &quot;Nightly Build&quot;, Release-Build, ...</li>
<li>Ergebnisse jeweils auf der Weboberfläche einsehbar (und per E-Mail)</li>
</ul>
</li>
</ul>
<h3 id="einige-vorteile">Einige Vorteile</h3>
<ul>
<li>Tests werden regelmäßig durchgeführt (auch wenn sie lange dauern oder die
Maschine stark belasten)</li>
<li>Es wird regelmäßig ein Gesamt-Build durchgeführt</li>
<li>Alle Teilnehmer sind über aktuellen Projekt(-zu-)stand informiert</li>
</ul>
<h3 id="beispiele-für-verbreitete-ci-umgebungen">Beispiele für verbreitete CI-Umgebungen</h3>
<ul>
<li><a href="https://www.jenkins.io/" rel="external" target="_blank">Jenkins</a></li>
<li><a href="https://docs.gitlab.com/ee/ci/" rel="external" target="_blank">GitLab CI/CD</a></li>
<li><a href="https://github.com/features/actions" rel="external" target="_blank">GitHub Actions</a> und <a href="https://resources.github.com/ci-cd/" rel="external" target="_blank">GitHub CI/CD</a></li>
<li><a href="https://www.atlassian.com/software/bamboo" rel="external" target="_blank">Bamboo</a></li>
<li><a href="https://www.travis-ci.com/" rel="external" target="_blank">Travis CI</a></li>
</ul>
<h2 id="gitlab-cicd">GitLab CI/CD</h2>
<p>Siehe auch <a href="http://git03-ifm-min.ad.hsbi.de/help/ci/quick_start/index.md" rel="external" target="_blank">&quot;Get started with Gitlab CI/CD&quot;</a>.
(Für den Zugriff wird VPN benötigt!)</p>
<h3 id="übersicht-über-pipelines">Übersicht über Pipelines</h3>
<p><a href="#R-image-7dff42265b05a0699bec131339a982b4" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-gitlabci-pipelines.png?width=60%25&height=auto" style=" height: auto; width: 60%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-7dff42265b05a0699bec131339a982b4"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-gitlabci-pipelines.png?width=60%25&height=auto"></a></p>
<ul>
<li>In Spalte &quot;Status&quot; sieht man das Ergebnis der einzelnen Pipelines:
&quot;pending&quot; (die Pipeline läuft gerade), &quot;cancelled&quot; (Pipeline wurde manuell
abgebrochen), &quot;passed&quot; (alle Jobs der Pipeline sind sauber durchgelaufen),
&quot;failed&quot; (ein Job ist fehlgeschlagen, Pipeline wurde deshalb abgebrochen)</li>
<li>In Spalte &quot;Pipeline&quot; sind die Pipelines eindeutig benannt aufgeführt,
inkl. Trigger (Commit und Branch)</li>
<li>In Spalte &quot;Stages&quot; sieht man den Zustand der einzelnen Stages</li>
</ul>
<p>Wenn man mit der Maus auf den Status oder die Stages geht, erfährt man mehr bzw.
kann auf eine Seite mit mehr Informationen kommen.</p>
<h3 id="detailansicht-einer-pipeline">Detailansicht einer Pipeline</h3>
<p><a href="#R-image-f2a6f706a44f0368ef94904a92b28a9f" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-gitlabci-triggeredpipeline.png?width=60%25&height=auto" style=" height: auto; width: 60%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f2a6f706a44f0368ef94904a92b28a9f"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-gitlabci-triggeredpipeline.png?width=60%25&height=auto"></a></p>
<p>Wenn man in eine Pipeline in der Übersicht klickt, werden die einzelnen
Stages dieser Pipeline genauer dargestellt.</p>
<h3 id="detailansicht-eines-jobs">Detailansicht eines Jobs</h3>
<p><a href="#R-image-b3ba133054f355fc8cd81de76b1acdca" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-gitlabci-job.png?width=60%25&height=auto" style=" height: auto; width: 60%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-b3ba133054f355fc8cd81de76b1acdca"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-gitlabci-job.png?width=60%25&height=auto"></a></p>
<p>Wenn man in einen Job einer Stage klickt, bekommt man quasi die Konsolenausgabe
dieses Jobs. Hier kann man ggf. Fehler beim Ausführen der einzelnen Skripte
oder die Ergebnisse beispielsweise der JUnit-Läufe anschauen.</p>
<h3 id="gitlab-cicd-konfiguration-mit-yaml-datei">GitLab CI/CD: Konfiguration mit YAML-Datei</h3>
<p>Datei <code>.gitlab-ci.yml</code> im Projekt-Ordner:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">stages</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">my.compile</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#ae81ff">my.test</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">job1</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">script</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#ae81ff">echo &#34;Hello&#34;</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#ae81ff">./gradlew compileJava</span>
</span></span><span style="display:flex;"><span>        - <span style="color:#ae81ff">echo &#34;wuppie!&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">stage</span>: <span style="color:#ae81ff">my.compile</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">only</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#ae81ff">wuppie</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">job2</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">script</span>: <span style="color:#e6db74">&#34;./gradlew test&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">stage</span>: <span style="color:#ae81ff">my.test</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">job3</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">script</span>:
</span></span><span style="display:flex;"><span>        - <span style="color:#ae81ff">echo &#34;Job 3&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">stage</span>: <span style="color:#ae81ff">my.compile</span></span></span></code></pre></div>
<h4 id="stages">Stages</h4>
<p>Unter <code>stages</code> werden die einzelnen Stages einer Pipeline definiert. Diese werden
in der hier spezifizierten Reihenfolge durchgeführt, d.h. zuerst würde <code>my.compile</code>
ausgeführt, und erst wenn alle Jobs in <code>my.compile</code> erfolgreich ausgeführt wurden,
würde anschließend <code>my.test</code> ausgeführt.</p>
<p>Dabei gilt: Die Jobs einer Stage werden (potentiell) parallel zueinander ausgeführt,
und die Jobs der nächsten Stage werden erst dann gestartet, wenn alle Jobs der
aktuellen Stage erfolgreich beendet wurden.</p>
<p>Wenn keine eigenen <code>stages</code> definiert werden, kann man
(<a href="http://git03-ifm-min.ad.hsbi.de/help/ci/yaml/index.md#stages" rel="external" target="_blank">lt. Doku</a>)
auf die Default-Stages <code>build</code>, <code>test</code> und <code>deploy</code> zurückgreifen. <strong>Achtung</strong>: Sobald
man eigene Stages definiert, stehen diese Default-Stages <em>nicht</em> mehr zur Verfügung!</p>
<h4 id="jobs">Jobs</h4>
<p><code>job1</code>, <code>job2</code> und <code>job3</code> definieren jeweils einen Job.</p>
<ul>
<li>
<p><code>job1</code> besteht aus mehreren Befehlen (unter <code>script</code>). Alternativ
kann man die bei <code>job2</code> gezeigte Syntax nutzen, wenn nur ein
Befehl zu bearbeiten ist.</p>
<p>Die Befehle werden von GitLab CI/CD in einer Shell ausgeführt.</p>
</li>
<li>
<p>Die Jobs <code>job1</code> und <code>job2</code> sind der Stage <code>my.compile</code> zugeordnet (Abschnitt
<code>stage</code>). Einer Stage können mehrere Jobs zugeordnet sein, die dann parallel
ausgeführt werden.</p>
<p>Wenn ein Job nicht explizit einer Stage zugeordnet ist, wird er
(<a href="http://git03-ifm-min.ad.hsbi.de/help/ci/yaml/index.md#stages" rel="external" target="_blank">lt. Doku</a>)
zur Default-Stage <code>test</code> zugewiesen. (Das geht nur, wenn es diese
Stage auch gibt!)</p>
</li>
<li>
<p>Mit <code>only</code> und <code>except</code> kann man u.a. Branches oder Tags angeben,
für die dieser Job ausgeführt (bzw. nicht ausgeführt) werden soll.</p>
</li>
</ul>
<p>Durch die Kombination von Jobs mit der Zuordnung zu Stages und Events lassen
sich unterschiedliche Pipelines für verschiedene Zwecke definieren.</p>
<h3 id="hinweise-zur-konfiguration-von-gitlab-cicd">Hinweise zur Konfiguration von GitLab CI/CD</h3>
<p>Im Browser in den Repo-Einstellungen arbeiten:</p>
<ol>
<li>Unter <code>Settings &gt; General &gt; Visibility, project features, permissions</code>
das <code>CI/CD</code> aktivieren</li>
<li>Prüfen unter <code>Settings &gt; CI/CD &gt; Runners</code>, dass unter
<code>Available shared Runners</code> mind. ein shared Runner verfügbar ist
(mit grün markiert ist)</li>
<li>Unter <code>Settings &gt; CI/CD &gt; General pipelines</code> einstellen:
<ul>
<li><code>Git strategy</code>: <code>git clone</code></li>
<li><code>Timeout</code>: <code>10m</code></li>
<li><code>Public pipelines</code>: <code>false</code> (nicht angehakt)</li>
</ul>
</li>
<li>YAML-File (<code>.gitlab-ci.yml</code>) in Projektwurzel anlegen,
Aufbau siehe oben</li>
<li>Build-Skript erstellen, <strong>lokal</strong> lauffähig bekommen, dann in Jobs nutzen</li>
<li>Im <code>.gitlab-ci.yml</code> die relevanten Branches einstellen (s.o.)</li>
<li>Pushen, und unter <code>CI/CD &gt; Pipelines</code> das Builden beobachten
<ul>
<li>in Status reinklicken und schauen, ob und wo es hakt</li>
</ul>
</li>
<li><code>README.md</code> anlegen in Projektwurzel (neben <code>.gitlab-ci.yml</code>),
Markdown-Schnipsel aus <code>Settings &gt; CI/CD &gt; General pipelines &gt; Pipeline status</code>
auswählen und einfügen .&hellip;</li>
</ol>
<p><em>Optional</em>:</p>
<ol start="9">
<li>Ggf. Schedules unter <code>CI/CD &gt; Schedules</code> anlegen</li>
<li>Ggf. extra Mails einrichten: <code>Settings &gt; Integrations &gt; Pipeline status emails</code></li>
</ol>
<h2 id="github-actions">GitHub Actions</h2>
<p>Siehe <a href="https://github.com/features/actions" rel="external" target="_blank">&quot;GitHub Actions: Automate your workflow from idea to production&quot;</a>
und auch <a href="https://resources.github.com/ci-cd/" rel="external" target="_blank">&quot;GitHub: CI/CD explained&quot;</a>.</p>
<h3 id="übersicht-über-workflows">Übersicht über Workflows</h3>
<p><a href="#R-image-f52a50398c7cb5e4da5a6ee15c346f1e" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-githubci-workflows.png?width=60%25&height=auto" style=" height: auto; width: 60%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f52a50398c7cb5e4da5a6ee15c346f1e"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-githubci-workflows.png?width=60%25&height=auto"></a></p>
<p>Hier sieht man das Ergebnis der letzten Workflows. Dazu sieht man den
Commit und den Branch, auf dem der Workflow gelaufen ist sowie wann er
gelaufen ist. Über die Spalten kann man beispielsweise nach Status oder
Event filtern.</p>
<p>In der Abbildung ist ein Workflow mit dem Namen &quot;GitHub CI&quot; zu sehen, der
aktuell noch läuft.</p>
<h3 id="detailansicht-eines-workflows">Detailansicht eines Workflows</h3>
<p><a href="#R-image-a20f446eca9ebb15ba253f1d67432bf8" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-githubci-triggeredworkflow.png?width=60%25&height=auto" style=" height: auto; width: 60%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-a20f446eca9ebb15ba253f1d67432bf8"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-githubci-triggeredworkflow.png?width=60%25&height=auto"></a></p>
<p>Wenn man in einen Workflow in der Übersicht anklickt, werden die einzelnen
Jobs dieses Workflows genauer dargestellt. &quot;job3&quot; ist erfolgreich gelaufen, &quot;job1&quot;
läuft gerade, und &quot;job2&quot; hängt von &quot;job1&quot; ab, d.h. kann erst nach dem erfolgreichen
Lauf von &quot;job2&quot; starten.</p>
<h3 id="detailansicht-eines-jobs-1">Detailansicht eines Jobs</h3>
<p><a href="#R-image-60d3c351373e5e75ad472cdeebe5ea3a" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-githubci-job.png?width=60%25&height=auto" style=" height: auto; width: 60%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-60d3c351373e5e75ad472cdeebe5ea3a"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot-githubci-job.png?width=60%25&height=auto"></a></p>
<p>Wenn man in einen Job anklickt, bekommt man quasi die Konsolenausgabe
dieses Jobs. Hier kann man ggf. Fehler beim Ausführen der einzelnen Skripte
oder die Ergebnisse beispielsweise der JUnit-Läufe anschauen.</p>
<h3 id="github-actions-konfiguration-mit-yaml-datei">GitHub Actions: Konfiguration mit YAML-Datei</h3>
<p>Workflows werden als YAML-Dateien im Ordner <code>.github/workflows/</code> angelegt.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">name</span>: <span style="color:#ae81ff">GitHub CI</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">on</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># push on master branch</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">push</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">branches</span>: [<span style="color:#ae81ff">master]</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># manually triggered</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">workflow_dispatch</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">jobs</span>:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">job1</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">steps</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v4</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/setup-java@v3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">java-version</span>: <span style="color:#e6db74">&#39;17&#39;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">distribution</span>: <span style="color:#e6db74">&#39;temurin&#39;</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">gradle/wrapper-validation-action@v1</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">run</span>: <span style="color:#ae81ff">echo &#34;Hello&#34;</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">run</span>: <span style="color:#ae81ff">./gradlew compileJava</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">run</span>: <span style="color:#ae81ff">echo &#34;wuppie!&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">job2</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">needs</span>: <span style="color:#ae81ff">job1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">steps</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v4</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/setup-java@v3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">with</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">java-version</span>: <span style="color:#e6db74">&#39;17&#39;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">distribution</span>: <span style="color:#e6db74">&#39;temurin&#39;</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">gradle/wrapper-validation-action@v1</span>
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">run</span>: <span style="color:#ae81ff">./gradlew test</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">job3</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-latest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">steps</span>:
</span></span><span style="display:flex;"><span>      - <span style="color:#f92672">run</span>: <span style="color:#ae81ff">echo &#34;Job 3&#34;</span></span></span></code></pre></div>
<h4 id="workflowname-und-trigger-events">Workflowname und Trigger-Events</h4>
<p>Der Name des Workflows wird mit dem Eintrag <code>name</code> spezifiziert und sollte sich im
Dateinamen widerspiegeln, also im Beispiel <code>.github/workflows/github_ci.yml</code>.</p>
<p>Im Eintrag <code>on</code> können die Events definiert werden, die den Workflow triggern. Im
Beispiel ist ein Push-Event auf dem <code>master</code>-Branch definiert sowie mit <code>workflow_dispatch:</code>
das manuelle Triggern (auf einem beliebigen Branch) freigeschaltet.</p>
<h4 id="jobs-1">Jobs</h4>
<p>Die Jobs werden unter dem Eintrag <code>jobs</code> definiert: <code>job1</code>, <code>job2</code> und <code>job3</code> definieren
jeweils einen Job.</p>
<ul>
<li>
<p><code>job1</code> besteht aus mehreren Befehlen (unter <code>steps</code>), die auf einem aktuellen
virtualisierten Ubuntu-Runner ausgeführt werden.</p>
<p>Es wird zunächst das Repo mit Hilfe der Checkout-Action ausgecheckt
(<code>uses: actions/checkout@v4</code>), das JDK eingerichtet/installiert
(<code>uses: actions/setup-java@v3</code>) und der im Repo enthaltene Gradle-Wrapper
auf Unversehrtheit geprüft (<code>uses: gradle/wrapper-validation-action@v1</code>).</p>
<p>Die Actions sind vordefinierte Actions und im Github unter <code>github.com/</code> + Action
zu finden, d.h. <a href="https://github.com/actions/checkout" rel="external" target="_blank"><code>actions/checkout</code></a> oder
<a href="https://github.com/actions/setup-java" rel="external" target="_blank"><code>actions/setup-java</code></a>. Actions können
von jedermann definiert und bereitgestellt werden, in diesem Fall handelt es sich
um von GitHub selbst im Namespace &quot;actions&quot; bereit gestellte direkt nutzbare Actions.
Man kann Actions auch selbst im Ordner <code>.github/actions/</code> für das Repo definieren
(Beispiel:
<a href="https://github.com/plfa/plfa.github.io/blob/dev/.github/actions/setup-haskell/action.yml" rel="external" target="_blank">plfa.github.io</a>).</p>
<p>Mit <code>run</code> werden Befehle in der Shell auf dem genutzten Runner (hier Ubuntu) ausgeführt.</p>
</li>
<li>
<p>Die Jobs <code>job2</code> ist von <code>job1</code> abhängig und wird erst gestartet, wenn <code>job1</code> erfolgreich
abgearbeitet ist.</p>
<p>Ansonsten können die Jobs prinzipiell parallel ausgeführt werden.</p>
</li>
</ul>
<p>Durch die Kombination von Workflows mit verschiedenen Jobs und Abhängigkeiten zwischen Jobs
lassen sich unterschiedliche Pipelines (&quot;Workflows&quot;) für verschiedene Zwecke definieren.</p>
<p>Es lassen sich auch andere Runner benutzen, etwa ein virtualisiertes Windows oder macOS.
Man kann auch über einen &quot;Matrix-Build&quot; den Workflow auf mehreren Betriebssystemen gleichzeitig
laufen lassen.</p>
<p>Man kann auch einen Docker-Container benutzen. Dabei muss man beachten, dass dieser am besten
aus einer Registry (etwa von Docker-Hub oder aus der GitHub-Registry) &quot;gezogen&quot; wird, weil das
Bauen des Docker-Containers aus einem Docker-File in der Action u.U. relativ lange dauert.</p>
<h3 id="hinweise-zur-konfiguration-von-github-actions">Hinweise zur Konfiguration von GitHub Actions</h3>
<p>Im Browser in den Repo-Einstellungen arbeiten:</p>
<ol>
<li>
<p>Unter <code>Settings &gt; Actions &gt; General &gt; Actions permissions</code> die Actions aktivieren
(Auswahl, welche Actions erlaubt sind)</p>
<p><a href="#R-image-99e791ede98e7c4f8e563131abf41013" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot_github_settings_actions.png?width=60%25&height=auto" style=" height: auto; width: 60%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-99e791ede98e7c4f8e563131abf41013"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot_github_settings_actions.png?width=60%25&height=auto"></a></p>
</li>
<li>
<p>Unter <code>Settings &gt; Actions &gt; General &gt; Workflow permissions</code> ggf. bestimmen, ob die
Actions das Repo nur lesen dürfen oder auch zusätzlich schreiben dürfen</p>
<p><a href="#R-image-e16c362a7eb9c797eab9a7a10f332d82" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot_github_settings_permissions.png?width=60%25&height=auto" style=" height: auto; width: 60%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-e16c362a7eb9c797eab9a7a10f332d82"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot_github_settings_permissions.png?width=60%25&height=auto"></a></p>
</li>
<li>
<p>Unter <code>Actions &gt; &lt;WORKFLOW&gt;</code> den Workflow ggf. deaktivieren:</p>
<p><a href="#R-image-67ab4b7d5111bea246521725ae887260" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot_github_actions.png?width=60%25&height=auto" style=" height: auto; width: 60%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-67ab4b7d5111bea246521725ae887260"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/building/ci/screenshot_github_actions.png?width=60%25&height=auto"></a></p>
</li>
</ol>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Überblick über Continuous Integration:</p>
<ul>
<li>Konfigurierbare Aktionen, die auf dem Gitlab-/GitHub-Server ausgeführt werden</li>
<li>Unterschiedliche Trigger: Commit, Merge, ...</li>
<li>Aktionen können Branch-spezifisch sein</li>
<li>Aktionen können von anderen Aktionen abhängen</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106219&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Continuous Integration (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachten Sie erneut das Projekt <a href="https://github.com/emilybache/Theatrical-Players-Refactoring-Kata" rel="external" target="_blank">Theatrical Players Refactoring Kata</a>.
Erstellen Sie für dieses Projekt einen GitHub-Workflow, der das Projekt kompiliert und die Testsuite ausführt
(nur für den Java-Teil, den restlichen Code können Sie ignorieren).</p>
<p>Dabei soll das Ausführen der JUnit-Tests nur dann erfolgen, wenn das Kompilieren erfolgreich durchgeführt wurde.</p>
<p>Der Workflow soll automatisch für Commits in den Hauptbranch sowie für Pull-Requests loslaufen. Es soll zusätzlich
auch manuell aktivierbar sein.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
            
            
            
            
            

            
            
                
            
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_GitHubCI'>[GitHubCI] <a href='https://resources.github.com/ci-cd/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Documentation GitHub CI</strong></a><br>GitHub Inc., 2022.</li> <li id='id_GitlabCI'>[GitlabCI] <a href='http://git03-ifm-min.ad.hsbi.de/help/ci/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Documentation Gitlab CI</strong></a></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
          <article class="default">
            <header class="headline">
            </header>

<h1 id="versionierung-mit-git">Versionierung mit Git</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-intro.html">Intro: Versionskontrolle in der Softwareentwicklung</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-basics.html">Basics der Versionsverwaltung mit Git (lokale Repos)</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/branches.html">Git Branches: Features unabhängig entwickeln und mit Git verwalten</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/branching-strategies.html">Branching-Strategien mit Git</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/remotes.html">Arbeiten mit Git Remotes (dezentrale Repos)</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows.html">Zusammenarbeit: Git-Workflows und Merge-/Pull-Requests</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Versionierung mit Git</h1>
<article class="default">
<h1>Intro: Versionskontrolle in der Softwareentwicklung</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>In der Softwareentwicklung wird häufig ein Versionsmanagementsystem (VCS) eingesetzt, welches die Verwaltung
von Versionsständen und Änderungen ermöglicht. Ein Repository sammelt dabei die verschiedenen Änderungen
(quasi wie eine Datenbank der Software-Versionsstände). Die Software <em>Git</em> ist verbreiteter Vertreter und
arbeitet mit dezentralen Repositories.</p>
<p>Ein neues lokales Repository kann man mit <code>git init</code> anlegen. Der Befehl legt den Unterordner <code>.git/</code> im
aktuellen Ordner an, darin befindet sich das lokale Repository und weitere von Git benötigte Dateien
(FINGER WEG!). Die Dateien und anderen Unterordner im aktuellen Ordner können nun der Versionskontrolle
hinzugefügt werden.</p>
<p>Den lokal vorliegenden (Versions-) Stand der Dateien im aktuellen Ordner nennt man auch &quot;Workingcopy&quot;.</p>
<p>Ein bereits existierendes Repo kann mit <code>git clone &lt;url&gt;</code> geklont werden.</p>
<p><a href="https://github.com" rel="external" target="_blank">GitHub</a> ist nicht Git, sondern ein kommerzieller Anbieter, der das Hosten von
Git-Repositories und weitere Features anbietet.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/Ac3-pZhVf_c' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Intro</a></li> <li><a href='https://youtu.be/0noYvZvQhic' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Config</a></li> <li><a href='https://youtu.be/ZaWEwIpER-U' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Repo</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/12ee47d53c582cf255d80fd186bb79bebeb65e63ca954a8070cb270eb82c4e5d492dc812da74cbdcdb3e697eeccdaf0b585852697306ac82d890229adffbf401' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Intro</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K1) Varianten der Versionierung</li> <li>(K1) Begriffe Workingcopy und Repository</li> <li>(K2) Github ist nicht Git</li> <li>(K2) Erstellung von lokalen Git-Repositories</li> <li>(K3) Umgang mit entsprechenden Git-Befehlen auf der Konsole</li></ul>
  </div>
</div>




    <h2 id="typische-probleme-bei-sw-entwicklung">Typische Probleme bei SW-Entwicklung</h2>
<ul>
<li>Was hat wer wann (und wo) geändert? Und warum?</li>
<li>Ich brauche den Stand von gestern/letzter Woche/...</li>
<li>Ich will schnell mal eine neue Idee ausprobieren ...</li>
<li>Ich arbeite an mehreren Rechnern (Synchronisation)</li>
<li>Wir müssen gemeinsam an der gleichen Codebasis arbeiten.</li>
<li>Wir arbeiten am Release v42, aber Kunde braucht schnell einen Fix für v40</li>
</ul>
<h2 id="folgen-sw-entwicklung-ohne-versionsverwaltung">Folgen SW-Entwicklung ohne Versionsverwaltung</h2>
<p><a href="#R-image-94454e89ec7aa182000fceeeeee6f263" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-intro/screenshot_zusammenarbeit_ohne_vcs.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-94454e89ec7aa182000fceeeeee6f263"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-intro/screenshot_zusammenarbeit_ohne_vcs.png?width=80%25&height=auto"></a></p>
<ul>
<li>Filesystem müllt voll mit manuell versionierten
Dateien/Sicherungen ala <code>file_20120507_version2_cagi.txt</code></li>
<li>Ordner/Projekte müssen dupliziert werden für neue Ideen</li>
<li>Code müllt voll mit auskommentierten Zeilen (&quot;Könnte ja noch gebraucht werden&quot;)</li>
<li>Unklar, wann welche Änderung von wem warum eingeführt wurde</li>
<li>Unbeabsichtigtes Überschreiben mit älteren Versionen beim Upload
in gemeinsamen Filesharing-Bereich</li>
</ul>
<h2 id="prinzip-versionsverwaltung">Prinzip Versionsverwaltung</h2>
<div class='columns'>
<div class='column'>
<p><a href="#R-image-89e08a2dc3b069c4bb6b5e249037bdab" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-intro/local.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-89e08a2dc3b069c4bb6b5e249037bdab"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-intro/local.png?width=40%25&height=auto"></a></p>
</div>
<div class='column'>
<ul>
<li>
<p><span class='alert'><strong>Repository:</strong></span>
<strong>Datenbank</strong> mit verschiedenen Versionsständen, Kommentaren, Tags etc.</p>
</li>
<li>
<p><span class='alert'><strong>Workingcopy:</strong></span>
<strong>Arbeitskopie</strong> eines bestimmten Versionsstandes</p>
</li>
</ul>
</div>
</div>
<h2 id="varianten-zentrale-versionsverwaltung-beispiel-svn">Varianten: Zentrale Versionsverwaltung (Beispiel SVN)</h2>
<p><a href="#R-image-755de34affd234c29a9bc9afc4659427" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-intro/centralised.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-755de34affd234c29a9bc9afc4659427"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-intro/centralised.png?width=80%25&height=auto"></a></p>
<p>Es gibt ein zentrales Repository (typischerweise auf einem Server), von dem die Developer einen
bestimmten Versionsstand &quot;auschecken&quot; (sich lokal kopieren) und in welches sie Änderungen wieder
zurück &quot;pushen&quot;.</p>
<p>Zur Abfrage der Historie und zum Veröffentlichen von Änderungen benötigt man entsprechend immer
eine Verbindung zum Server.</p>
<h2 id="varianten-verteilte-versionsverwaltung-beispiel-git">Varianten: Verteilte Versionsverwaltung (Beispiel Git)</h2>
<p><a href="#R-image-829dbda93459033359d35f677ca2768c" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-intro/distributed.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-829dbda93459033359d35f677ca2768c"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-intro/distributed.png?width=80%25&height=auto"></a></p>
<p>In diesem Szenario hat jeder Developer nicht nur die Workingcopy, sondern auch noch eine Kopie
des Repositories. Zusätzlich kann es einen oder mehrere Server geben, auf denen dann nur das
Repository vorgehalten wird, d.h. dort gibt es normalerweise keine Workingcopy. Damit kann
unabhängig voneinander gearbeitet werden.</p>
<p>Allerdings besteht nun die Herausforderung, die geänderten Repositories miteinander abzugleichen.
Das kann zwischen dem lokalen Rechner und dem Server passieren, aber auch zwischen zwei &quot;normalen&quot;
Rechnern (also zwischen den Developern).</p>
<p><strong>Hinweis</strong>: <em>GitHub ain't no Git!</em> Git ist eine Technologie zur Versionsverwaltung. Es gibt verschiedene
Implementierungen und Plugins für IDEs und Editoren. <a href="https://github.com" rel="external" target="_blank">GitHub</a> ist dagegen <em>ein</em>
Dienstleister, wo man Git-Repositories ablegen kann und auf diese mit Git (von der Konsole oder aus der
IDE) zugreifen kann. Darüber hinaus bietet der Service aber zusätzliche Features an, beispielsweise
ein Issue-Management oder sogenannte <em>Pull-Requests</em>. Dies hat aber zunächst mit Git nichts zu tun.
Weitere populäre Anbieter sind beispielsweise <a href="https://bitbucket.org/" rel="external" target="_blank">Bitbucket</a> oder <a href="https://gitlab.com" rel="external" target="_blank">Gitlab</a>
oder <a href="https://gitea.io/en-us/" rel="external" target="_blank">Gitea</a>, wobei einige auch selbst gehostet werden können.</p>
<h2 id="versionsverwaltung-mit-git-typische-arbeitsschritte">Versionsverwaltung mit Git: Typische Arbeitsschritte</h2>
<ol>
<li>
<p>Repository anlegen (oder clonen)</p>
</li>
<li>
<p>Dateien neu erstellen (und löschen, umbenennen, verschieben)</p>
</li>
<li>
<p>Änderungen einpflegen (&quot;committen&quot;)</p>
</li>
<li>
<p>Änderungen und Logs betrachten</p>
</li>
<li>
<p>Änderungen rückgängig machen</p>
</li>
<li>
<p>Projektstand markieren (&quot;taggen&quot;)</p>
</li>
<li>
<p>Entwicklungszweige anlegen (&quot;branchen&quot;)</p>
</li>
<li>
<p>Entwicklungszweige zusammenführen (&quot;mergen&quot;)</p>
</li>
<li>
<p>Änderungen verteilen (verteiltes Arbeiten, Workflows)</p>
</li>
</ol>
<h2 id="globale-konfiguration">(Globale) Konfiguration</h2>
<p><strong>Minimum</strong>:</p>
<ul>
<li><code>git config --global user.name &lt;name&gt;</code></li>
<li><code>git config --global user.email &lt;email&gt;</code></li>
</ul>
<p>Diese Konfiguration muss man nur einmal machen.</p>
<p>Wenn man den Schalter <code>--global</code> weglässt, gelten die Einstellungen nur
für das aktuelle Projekt/Repo.</p>
<p>Zumindest Namen und EMail-Adresse <strong>muss</strong> man setzen, da Git diese
Information beim Anlegen der Commits speichert (== benötigt!).</p>
<p><strong>Aliase</strong>:</p>
<ul>
<li><code>git config --global alias.ci commit</code></li>
<li><code>git config --global alias.co checkout</code></li>
<li><code>git config --global alias.br branch</code></li>
<li><code>git config --global alias.st status</code></li>
<li><code>git config --global alias.ll 'log --all --graph --decorate --oneline'</code></li>
</ul>
<p>Zusätzlich kann man weitere Einstellungen vornehmen, etwa auf bunte
Ausgabe umschalten: <code>git config --global color.ui auto</code> oder Abkürzungen
(Aliase) für Befehle definieren: <code>git config --global alias.ll 'log --all --oneline --graph --decorate'</code> ...</p>
<p>Git (und auch GitHub) hat kürzlich den Namen des Default-Branches von <code>master</code>
auf <code>main</code> geändert. Dies kann man in Git ebenfalls selbst einstellen:
<code>git config --global init.defaultBranch &lt;name&gt;</code>.</p>
<p>Anschauen kann man sich die Einstellungen in der Textdatei <code>~/.gitconfig</code>
oder per Befehl <code>git config --global -l</code>.</p>
<h2 id="neues-repo-anlegen">Neues Repo anlegen</h2>
<ul>
<li>
<p><code>git init</code></p>
<p>=&gt; Erzeugt neues Repository im akt. Verzeichnis</p>
</li>
<li>
<p><code>git clone &lt;url&gt;</code></p>
<p>=&gt; Erzeugt (verlinkte) Kopie des Repos unter <code>&lt;url&gt;</code></p>
</li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>Git: Versionsmanagement mit dezentralen Repositories</li>
<li>Anlegen eines lokalen Repos mit <code>git init</code></li>
<li>Clonen eines existierenden Repos mit <code>git clone &lt;url&gt;</code></li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106239&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Git Intro (ILIAS)</a></li></ul>
  </div>
</div>



    



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_AtlassianGit'>[AtlassianGit] <a href='https://www.atlassian.com/git/tutorials' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Become a git guru.</strong></a><br>Atlassian Pty Ltd, 2022.</li> <li id='id_Chacon2014'>[Chacon2014] <a href='https://git-scm.com/book/en/v2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Pro Git</strong></a><br>Chacon, S. und Straub, B., Apress, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-4842-0077-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-4842-0077-3</a>.<br><em>Kapitel 1 und 2</em></li> <li id='id_GitCheatSheet'>[GitCheatSheet] <a href='https://training.github.com/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Git Cheat Sheets</strong></a><br>Github Inc., 2022.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Basics der Versionsverwaltung mit Git (lokale Repos)</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Änderungen an Dateien (in der Workingcopy) werden mit <code>git add</code> zum &quot;Staging&quot; (Index) hinzugefügt.
Dies ist eine Art Sammelbereich für Änderungen, die mit dem nächsten Commit in das Repository
überführt werden. Neue (bisher nicht versionierte Dateien) müssen ebenfalls zunächst mit
<code>git add</code> zum Staging hinzugefügt werden.</p>
<p>Änderungen kann man mit <code>git log</code> betrachten, dabei erhält man u.a. eine Liste der Commits und der
jeweiligen Commmit-Messages.</p>
<p>Mit <code>git diff</code> kann man gezielt Änderungen zwischen Commits oder Branches betrachten.</p>
<p>Mit <code>git tag</code> kann man bestimmte Commits mit einem &quot;Stempel&quot; (zusätzlicher Name) versehen, um diese
leichter finden zu können.</p>
<p>Wichtig sind die Commit-Messages: Diese sollten eine kurze Zusammenfassung haben, die <strong>aktiv</strong>
formuliert wird (was ändert dieser Commit: &quot;Formatiere den Java-Code entsprechend Style&quot;; nicht aber
&quot;Java-Code nach Style formatiert&quot;). Falls der Kommentar länger sein soll, folgt eine Leerzeile auf
die erste Zeile (Zusammenfassung) und danach ein Block mit der längeren Erklärung.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/GxJI8nmZVE8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Basics</a></li> <li><a href='https://youtu.be/ITF8wj8GluM' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo New Files</a></li> <li><a href='https://youtu.be/SFIVudlVUhg' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Arbeitsablauf: Datei ändern - stagen - committen</a></li> <li><a href='https://youtu.be/0uczjI7wsrQ' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Amend</a></li> <li><a href='https://youtu.be/vmb-PZ1Efkg' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Log</a></li> <li><a href='https://youtu.be/XB8lfGuU6ZI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Diff</a></li> <li><a href='https://youtu.be/F1W0RqrxCho' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Tag</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/3a44c8a32e7699db77ae922c6b8944acf0d8c65b78d02859e707ffdf783ea45a78200312cdb8102c1052f382101b69a5092bcaf0a11ded36b98f4552a4aca345' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Basics</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Umgang mit Dateien: Hinzufügen zum und Löschen aus Repo</li> <li>(K3) Umgang mit Änderungen: Hinzufügen zum Staging und Commit</li> <li>(K3) Herausfinden von Unterschieden, Ansehen der Historie</li> <li>(K3) Ignorieren von Dateien und Ordnern</li></ul>
  </div>
</div>




    <h2 id="versionsverwaltung-mit-git-typische-arbeitsschritte">Versionsverwaltung mit Git: Typische Arbeitsschritte</h2>
<ol>
<li>
<p>Repository anlegen (oder clonen)</p>
</li>
<li>
<p>Dateien neu erstellen (und löschen, umbenennen, verschieben)</p>
</li>
<li>
<p>Änderungen einpflegen (&quot;committen&quot;)</p>
</li>
<li>
<p>Änderungen und Logs betrachten</p>
</li>
<li>
<p>Änderungen rückgängig machen</p>
</li>
<li>
<p>Projektstand markieren (&quot;taggen&quot;)</p>
</li>
<li>
<p>Entwicklungszweige anlegen (&quot;branchen&quot;)</p>
</li>
<li>
<p>Entwicklungszweige zusammenführen (&quot;mergen&quot;)</p>
</li>
<li>
<p>Änderungen verteilen (verteiltes Arbeiten, Workflows)</p>
</li>
</ol>
<h2 id="dateien-unter-versionskontrolle-stellen">Dateien unter Versionskontrolle stellen</h2>
<p><a href="#R-image-dcc6f04b4789df15c9d8d929ee1defd2" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-basics/workflow.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-dcc6f04b4789df15c9d8d929ee1defd2"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-basics/workflow.png?width=80%25&height=auto"></a></p>
<ol>
<li>
<p><code>git add .</code> (oder <code>git add &lt;file&gt;</code>)</p>
<p>=&gt; Stellt <span class='alert'>alle</span> Dateien (bzw. die Datei <code>&lt;file&gt;</code>)
im aktuellen Verzeichnis unter Versionskontrolle</p>
</li>
<li>
<p><code>git commit</code></p>
<p>=&gt; Fügt die Dateien dem Repository hinzu</p>
</li>
</ol>
<p><strong>Abfrage mit <code>git status</code></strong></p>
<h2 id="änderungen-einpflegen">Änderungen einpflegen</h2>
<p><a href="#R-image-9693ec5235cd6e552256258447d57bac" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-basics/lifecycle.png?width=70%25&height=auto" style=" height: auto; width: 70%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-9693ec5235cd6e552256258447d57bac"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-basics/lifecycle.png?width=70%25&height=auto"></a></p>
<ul>
<li>Abfrage mit: <code>git status</code></li>
<li>&quot;Staging&quot; von modifizierten Dateien: <code>git add &lt;file&gt;</code></li>
<li>Committen der Änderungen im Stage: <code>git commit</code></li>
</ul>
<p><em>Anmerkung</em>: Alternativ auch mit <code>git commit -m &quot;Kommentar&quot;</code>, um das Öffnen
des Editors zu vermeiden ... geht einfach schneller ;)</p>
<p>Das &quot;staging area&quot; stellt eine Art Zwischenebene zwischen Working Copy und
Repository dar: Die Änderungen sind temporär &quot;gesichert&quot;, aber noch nicht
endgültig im Repository eingepflegt (&quot;committed&quot;).</p>
<p>Man kann den Stage dazu nutzen, um Änderungen an einzelnen Dateien zu sammeln
und diese dann (in einem Commit) gemeinsam einzuchecken.</p>
<p>Man kann den Stage in der Wirkung umgehen, indem man alle in der Working Copy
vorliegenden Änderungen per <code>git commit -a -m &quot;Kommentar&quot;</code> eincheckt. Der
Schalter &quot;<code>-a</code>&quot; nimmt alle vorliegenden Änderungen an <strong>bereits versionierten</strong>
Dateien, fügt diese dem Stage hinzu und führt dann den Commit durch. Das ist
das von SVN bekannte Verhalten. Achtung: Nicht versionierte Dateien bleiben
dabei außen vor!</p>
<h2 id="letzten-commit-ergänzen">Letzten Commit ergänzen</h2>
<ul>
<li>
<p><code>git commit --amend -m &quot;Eigentlich wollte ich das so sagen&quot;</code></p>
<p>Wenn keine Änderungen im Stage sind, wird so die letzte Commit-Message geändert.</p>
</li>
<li>
<p><code>git add &lt;file&gt;; git commit --amend</code></p>
<p>Damit können vergessene Änderungen an der Datei <code>&lt;file&gt;</code>
zusätzlich im letzten Commit aufgezeichnet werden.</p>
<p><span class='alert'>In beiden Fällen ändert sich die Commit-ID!</span></p>
</li>
</ul>
<h2 id="weitere-datei-operationen-hinzufügen-umbenennen-löschen">Weitere Datei-Operationen: hinzufügen, umbenennen, löschen</h2>
<ul>
<li>Neue (unversionierte) Dateien und Änderungen an versionierten Dateien zum Staging hinzufügen: <code>git add &lt;file&gt;</code></li>
<li>Löschen von Dateien (Repo+Workingcopy): <code>git rm &lt;file&gt;</code></li>
<li>Löschen von Dateien (nur Repo): <code>git rm --cached &lt;file&gt;</code></li>
<li>Verschieben/Umbenennen: <code>git mv &lt;fileAlt&gt; &lt;fileNeu&gt;</code></li>
</ul>
<p>Aus Sicht von Git sind zunächst alle Dateien &quot;untracked&quot;, d.h. stehen nicht
unter Versionskontrolle.</p>
<p>Mit <code>git add &lt;file&gt;</code> (und <code>git commit</code>) werden Dateien in den Index (den
Staging-Bereich, d.h. nach dem Commit letztlich in das Repository) aufgenommen.
Danach stehen sie unter &quot;Beobachtung&quot; (Versionskontrolle). So lange, wie eine
Datei identisch zur Version im Repository ist, gilt sie als unverändert
(&quot;unmodified&quot;). Eine Änderung führt entsprechend zum Zustand &quot;modified&quot;, und
ein <code>git add &lt;file&gt;</code> speichert die Änderungen im Stage. Ein Commit überführt
die im Stage vorgemerkte Änderung in das Repo, d.h. die Datei gilt wieder
als &quot;unmodified&quot;.</p>
<p>Wenn eine Datei nicht weiter versioniert werden soll, kann sie aus dem Repo
entfernt werden. Dies kann mit <code>git rm &lt;file&gt;</code> geschehen, wobei die Datei auch
aus der Workingcopy gelöscht wird. Wenn die Datei erhalten bleiben soll, aber
nicht versioniert werden soll (also als &quot;untracked&quot; markiert werden soll), dann
muss sie mit <code>git rm --cached &lt;file&gt;</code> aus der Versionskontrolle gelöscht werden.
Achtung: Die Datei ist dann nur ab dem aktuellen Commit gelöscht, d.h. frühere
Revisionen enthalten die Datei noch!</p>
<p>Wenn eine Datei umbenannt werden soll, geht das mit <code>git mv &lt;fileAlt&gt; &lt;fileNeu&gt;</code>.
Letztlich ist dies nur eine Abkürzung für die Folge <code>git rm --cached &lt;fileAlt&gt;</code>,
manuelles Umbenennen der Datei in der Workingcopy und <code>git add &lt;fileNeu&gt;</code>.</p>
<h2 id="commits-betrachten">Commits betrachten</h2>
<ul>
<li>
<p>Liste aller Commits: <code>git log</code></p>
<ul>
<li><code>git log -&lt;n&gt;</code> oder <code>git log --since=&quot;3 days ago&quot;</code>
Meldungen eingrenzen ...</li>
<li><code>git log --stat</code> Statistik ...</li>
<li><code>git log --author=&quot;pattern&quot;</code> Commits eines Autors</li>
<li><code>git log &lt;file&gt;</code> Änderungen einer Datei</li>
</ul>
</li>
<li>
<p>Inhalt eines Commits: <code>git show</code></p>
</li>
</ul>
<h2 id="änderungen-und-logs-betrachten">Änderungen und Logs betrachten</h2>
<ul>
<li>
<p><code>git diff [&lt;file&gt;]</code></p>
<p>Änderungen zwischen Workingcopy und letztem Commit (ohne Stage)</p>
<p>Das &quot;staging area&quot; wird beim Diff von Git behandelt, als wären die dort
hinzugefügten Änderungen bereits eingecheckt (genauer: als letzter Commit
im aktuellen Branch im Repo vorhanden).
D.h. wenn Änderungen in einer Datei mittels <code>git add &lt;datei&gt;</code> dem Stage
hinzugefügt wurden, zeigt <code>git diff &lt;datei&gt;</code> keine Änderungen an!</p>
</li>
<li>
<p><code>git diff commitA commitB</code></p>
<p>Änderungen zwischen Commits</p>
</li>
<li>
<p>Blame: <code>git blame &lt;file&gt;</code></p>
<p>Wer hat was wann gemacht?</p>
</li>
</ul>
<h2 id="dateien-ignorieren-gitignore">Dateien ignorieren: <em>.gitignore</em></h2>
<ul>
<li>Nicht alle Dateien gehören ins Repo:
<ul>
<li>generierte Dateien: <code>.class</code></li>
<li>temporäre Dateien</li>
</ul>
</li>
<li>Datei <code>.gitignore</code> anlegen und committen
<ul>
<li>Wirkt auch für Unterordner</li>
<li>Inhalt: Reguläre Ausdrücke für zu ignorierende Dateien und Ordner</li>
</ul>
</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0"><code class="language-gitignore" data-lang="gitignore">    # Compiled source #
    *.class
    *.o
    *.so

    # Packages #
    *.zip

    # All directories and files in a directory #
    bin/**/*</code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://linux.die.net/man/5/gitignore" target="_blank"><span class="title">man 5 gitignore</span></a></span></div>
<h2 id="zeitmaschine">Zeitmaschine</h2>
<ul>
<li>
<p>Änderungen in Workingcopy rückgängig machen</p>
<ul>
<li>Änderungen nicht in Stage: <code>git checkout &lt;file&gt;</code> oder <code>git restore &lt;file&gt;</code></li>
<li>Änderungen in Stage: <code>git reset HEAD &lt;file&gt;</code> oder <code>git restore --staged &lt;file&gt;</code></li>
</ul>
<p>=&gt; Hinweise von <code>git status</code> beachten!</p>
</li>
<li>
<p>Datei aus altem Stand holen:</p>
<ul>
<li><code>git checkout &lt;commit&gt; &lt;file&gt;</code>, oder</li>
<li><code>git restore --source &lt;commit&gt; &lt;file&gt;</code></li>
</ul>
</li>
<li>
<p>Commit verwerfen, Geschichte neu: <code>git revert &lt;commit&gt;</code></p>
</li>
</ul>
<p><em>Hinweis</em>: In den neueren Versionen von Git ist der Befehl <code>git restore</code> hinzugekommen, mit
dem Änderungen rückgängig gemacht werden können. Der bisherige Befehl <code>git checkout</code> steht
immer noch zur Verfügung und bietet über <code>git restore</code> hinaus weitere Anwendungsmöglichkeiten.</p>
<ul>
<li>Stempel (Tag) vergeben:
<code>git tag &lt;tagname&gt; &lt;commit&gt;</code></li>
<li>Tags anzeigen: <code>git tag</code> und <code>git show &lt;tagname&gt;</code></li>
</ul>
<h2 id="wann-und-wie-committen">Wann und wie committen?</h2>
<div class='center'>
<p><span class='alert'><strong>Jeder Commit stellt einen Rücksetzpunkt dar!</strong></span></p>
</div>
<p>Typische Regeln:</p>
<ul>
<li>Kleinere &quot;Häppchen&quot; einchecken: ein Feature oder Task
(das nennt man auch <em>atomic commit</em>: das kleinste Set an Änderungen, die
gemeinsam Sinn machen und die ggf. gemeinsam zurückgesetzt werden können)</li>
<li>Logisch zusammenhängende Änderungen gemeinsam einchecken</li>
<li>Projekt muss nach Commit compilierbar sein</li>
<li>Projekt sollte nach Commit lauffähig sein</li>
</ul>
<p>Ein Commit sollte in sich geschlossen sein, d.h. die kleinste Menge an Änderungen
enthalten, die gemeinsam einen Sinn ergeben und die (bei Bedarf) gemeinsam
zurückgesetzt oder verschoben werden können. Das nennt man auch <strong>atomic commit</strong>.</p>
<p>Wenn Sie versuchen, die Änderungen in Ihrem Commit zu beschreiben (siehe nächste Folie
&quot;Commit-Messages&quot;), dann werden Sie einen <em>atomic commit</em> mit einem kurzen Satz (natürlich
im Imperativ!) beschreiben können. Wenn Sie mehr Text brauchen, haben Sie wahrscheinlich
keinen <em>atomic commit</em> mehr vor sich.</p>
<p><strong>Lesen Sie dazu auch <a href="https://dev.to/samuelfaure/how-atomic-git-commits-dramatically-increased-my-productivity-and-will-increase-yours-too-4a84" rel="external" target="_blank">How atomic Git commits dramatically increased my productivity - and will increase yours too</a>.</strong></p>
<h2 id="schreiben-von-commit-messages-warum">Schreiben von Commit-Messages: WARUM?!</h2>
<p>Schauen Sie sich einmal einen Screenshot eines <code>git log --oneline 61e48f0..e2c8076</code>
im <a href="https://github.com/Dungeon-CampusMinden/Dungeon" rel="external" target="_blank">Dungeon-CampusMinden/Dungeon</a> an:</p>
<p><a href="#R-image-ae4f7c543f84da8437a7b35be6d10bef" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-basics/screenshot_git_log.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-ae4f7c543f84da8437a7b35be6d10bef"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-basics/screenshot_git_log.png?width=auto&height=auto"></a></p>
<p>Nun stellen Sie sich vor, Sie sind auf der Suche nach Informationen, suchen einen
bestimmten Commit oder wollen eine bestimmte Änderung finden ...</p>
<p>Wenn man das genauer analysiert, dann stören bestimmte Dinge:</p>
<ul>
<li>Mischung aus Deutsch und Englisch</li>
<li>&quot;Vor-sich-hin-Murmeln&quot;: &quot;Layer system 5&quot;</li>
<li>Teileweise werden Tags genutzt wie <code>[BUG]</code>, aber nicht durchgängig</li>
<li>Mischung zwischen verschiedenen Formen: &quot;Repo umbenennen&quot;, &quot;Benenne Repo um&quot;, &quot;Repo umbenannt&quot;</li>
<li>Unterschiedliche Groß- und Kleinschreibung</li>
<li>Sehr unterschiedlich lange Zeilen/Kommentare</li>
</ul>
<p><strong>Das Beachten einheitlicher Regeln ist enorm wichtig!</strong></p>
<p>Leider sagt sich das so leicht - in der Praxis macht man es dann
doch schnell wieder unsauber. Dennoch, auch im Dungeon-Repo gibt
es einen positiven Trend (<code>git log --oneline 8039d6c..7f49e89</code>):</p>
<p><a href="#R-image-f5ff68e8155f729d009994f638b084bd" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-basics/screenshot_git_log_recent.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f5ff68e8155f729d009994f638b084bd"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-basics/screenshot_git_log_recent.png?width=auto&height=auto"></a></p>
<p>Typische Regeln und Konventionen tauchen überall auf, beispielsweise
in <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/git-basics.html#id_Chacon2014">[Chacon2014]</a> oder bei Tim Pope (siehe nächstes Beispiel) oder bei
<a href="https://cbea.ms/git-commit/" rel="external" target="_blank">&quot;How to Write a Git Commit Message&quot;</a>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-markdown" data-lang="markdown"><span style="display:flex;"><span>Short (50 chars or less) summary of changes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>More detailed explanatory text, if necessary.  Wrap it to about
</span></span><span style="display:flex;"><span>72 characters or so.  In some contexts, the first line is treated
</span></span><span style="display:flex;"><span>as the subject of an email and the rest of the text as the body.
</span></span><span style="display:flex;"><span>The blank line separating the summary from the body is critical
</span></span><span style="display:flex;"><span>(unless you omit the body entirely); tools like rebase can get
</span></span><span style="display:flex;"><span>confused if you run the two together.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Further paragraphs come after blank lines.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">-</span> Bullet points are okay, too
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">-</span> Typically a hyphen or asterisk is used for the bullet, preceded
</span></span><span style="display:flex;"><span>   by a single space, with blank lines in between, but conventions
</span></span><span style="display:flex;"><span>   vary here</span></span></code></pre></div>
<p><span class='origin'>Quelle: <a href="https://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html" rel="external" target="_blank">&quot;A Note About Git Commit Messages&quot;</a> by <a href="https://tpo.pe/" rel="external" target="_blank">Tim Pope</a> on tbaggery.com</span></p>
<p>Denken Sie sich die Commit-Message als E-Mail an einen zukünftigen Entwickler,
der das in fünf Jahren liest!</p>
<p>Vom Aufbau her hat eine E-Mail auch eine Summary und dann den eigentlichen Inhalt ...
Erklären Sie das <strong>&quot;WARUM&quot;</strong> der Änderung! (Das &quot;WER&quot;, &quot;WAS&quot;, &quot;WANN&quot; wird bereits
automatisch von Git aufgezeichnet ...)</p>
<div class='center'>
<p><span class='alert'><strong>Lesen (und beachten) Sie unbedingt auch <a href="https://cbea.ms/git-commit/" rel="external" target="_blank">&quot;How to Write a Git Commit Message&quot;</a>!</strong></span></p>
</div>
<h2 id="ausflug-conventional-commits">Ausflug &quot;Conventional Commits&quot;</h2>
<p>Die Commit-Messages dienen vor allem der Dokumentation und werden von Entwicklern gelesen.</p>
<p>Wenn man die Messages ein wenig stärker formalisieren würde, dann könnte man diese aber auch
mit Tools verarbeiten und beispielsweise automatisiert Changelogs oder Release-Texte verfassen!</p>
<p>Betrachten Sie einmal das Projekt <a href="https://github.com/conventional-commits/conventionalcommits.org" rel="external" target="_blank">ConventionalCommits.org</a>.
Dies ist ein solcher Versuch, die Commit-Messages (a) einheitlicher und lesbarer zu gestalten
und (b) auch eine Tool-gestützte Auswertung zu erlauben.</p>
<p>Das Projekt schlägt als Erweitung der üblichen Regeln zum Formatieren von Commit-Messages vor,
dass in der ersten Zeile der <em>Summary</em> noch eine Abkürzung für die in diesem Commit erfolgte
Änderung (Bug-Fix, neues Feature, ...) vorangestellt wird. Dieser Abkürzung kann in Klammern
noch der Scope der Änderung hinzugefügt werden, beispielsweise den Bereich im Projekt, der von
diesem Commit berührt wird. Wenn es eine <em>breaking change</em> ist, also alter Code nach dieser Änderung
sich anders verhält oder vielleicht sogar nicht mehr kompiliert, wird noch ein &quot;!&quot; hinter dem
Typ der Änderung ergänzt.</p>
<p><strong>Beispiel</strong>: Stellen Sie sich vor, im Dungeon-Projekt wurde ein neues Verhalten hinzugefügt.</p>
<ol>
<li>
<p>Normalerweise hätten Sie vielleicht diese Message geschrieben (angepasste Version aus <a href="https://github.com/Dungeon-CampusMinden/Dungeon/pull/469" rel="external" target="_blank">Dungeon-CampusMinden/Dungeon/pull/469</a>):</p>
<pre><code>add fight skill

-   `DamageProjectileSkill` creates a new entity which causes `HealthDamage` when hitting another entity
-   `FireballSkill` is a more concrete implementation of this
-   Melee skills can be created with `DamageProjectileSkill` using a customised range
    -   Example: the `FireballSkill` has a range of 10, a melee would have a considerably smaller range

fixes #24
fixes #126
fixes #224
</code></pre>
</li>
<li>
<p>Mit <a href="https://www.conventionalcommits.org/en/v1.0.0/#examples" rel="external" target="_blank">ConventionalCommits.org</a> könnte
das dann so aussehen:</p>
<pre><code>feat: add fight skill

-   `DamageProjectileSkill` creates a new entity which causes `HealthDamage` when hitting another entity
-   `FireballSkill` is a more concrete implementation of this
-   Melee skills can be created with `DamageProjectileSkill` using a customised range
    -   Example: the `FireballSkill` has a range of 10, a melee would have a considerably smaller range

fixes #24
fixes #126
fixes #224
</code></pre>
<p>Da es sich um ein neues Feature handelt, wurde der Summary in der ersten Zeile ein <code>feat:</code> vorangestellt.</p>
<p>Die zu verwendenden Typen/Abkürzungen sind im Prinzip frei definierbar. Das Projekt
<a href="https://github.com/conventional-commits/conventionalcommits.org" rel="external" target="_blank">ConventionalCommits.org</a>
schlägt eine Reihe von Abkürzungen vor. Auf diese Weise sollen in möglichst allen Projekten, die Conventional
Commits nutzen, die selben Abkürzungen/Typen eingesetzt werden und so eine Tool-gestützte Auswertung möglich
werden.</p>
</li>
<li>
<p>Oder zusätzlich mit dem Scope der Änderung:</p>
<pre><code>feat(game): add fight skill

-   `DamageProjectileSkill` creates a new entity which causes `HealthDamage` when hitting another entity
-   `FireballSkill` is a more concrete implementation of this
-   Melee skills can be created with `DamageProjectileSkill` using a customised range
    -   Example: the `FireballSkill` has a range of 10, a melee would have a considerably smaller range

fixes #24
fixes #126
fixes #224
</code></pre>
<p>Der Typ <code>feat</code> wurde hier noch ergänzt um einen frei definierbaren Identifier für den Projektbereich. Dieser
wird in Klammern direkt hinter den Typ notiert (hier <code>feat(game):</code>).</p>
<p>Im Beispiel habe ich als Bereich &quot;game&quot; genommen, weil die Änderung sich auf den Game-Aspekt des Projekts
bezieht. Im konkreten Projekt wären andere Bereiche eventuell &quot;dsl&quot; (für die im Projekt entwickelte
Programmiersprache plus Interpreter) und &quot;blockly&quot; (für die Integration von Google Blockly zur Programmierung
des Dungeons mit LowCode-Ansätzen). Das ist aber letztlich vom Projekt abhängig und weitestgehend
Geschmackssache.</p>
</li>
<li>
<p>Oder zusätzlich noch als Auszeichnung &quot;breaking change&quot; (hier mit <em>scope</em>, geht aber auch ohne <em>scope</em>):</p>
<pre><code>feat(game)!: add fight skill

-   `DamageProjectileSkill` creates a new entity which causes `HealthDamage` when hitting another entity
-   `FireballSkill` is a more concrete implementation of this
-   Melee skills can be created with `DamageProjectileSkill` using a customised range
    -   Example: the `FireballSkill` has a range of 10, a melee would have a considerably smaller range

fixes #24
fixes #126
fixes #224
</code></pre>
<p>Angenommen, das neue Feature muss in der API etwas ändern, so dass existierender Code nun nicht mehr
funktionieren würde. Dies wird mit dem extra Ausrufezeichen hinter dem Typ/Scope kenntlich gemacht
(hier <code>feat(game)!:</code>).</p>
<p>Zusätzlich kann man einen &quot;Footer&quot; in die Message einbauen, also eine extra Zeile am Ende, die mit dem String
&quot;BREAKING CHANGE:&quot; eingeleitet wird. (vgl. <a href="https://www.conventionalcommits.org/en/v1.0.0/#examples" rel="external" target="_blank">Conventional Commits &gt; Examples</a>)</p>
</li>
</ol>
<p>Es gibt noch viele weitere Initiativen, Commit-Messages lesbarer zu gestalten und zu vereinheitlichen.
Schauen Sie sich beispielsweise einmal <a href="https://github.com/carloscuesta/gitmoji" rel="external" target="_blank">gitmoji.dev</a> an.
(<em>Mit einem Einsatz in einem professionellen Umfeld wäre ich hier aber sehr ... vorsichtig.</em>)</p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>Änderungen einpflegen zweistufig (<code>add</code>, <code>commit</code>)</li>
<li>Status der Workingcopy mit <code>status</code> ansehen</li>
<li>Logmeldungen mit <code>log</code> ansehen</li>
<li>Änderungen auf einem File mit <code>diff</code> bzw. <code>blame</code> ansehen</li>
<li>Projektstand markieren mit <code>tag</code></li>
<li>Ignorieren von Dateien/Ordnern: Datei <code>.gitignore</code></li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106241&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Git Basics (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Versionierung 101</strong></p>
<ol>
<li>Legen Sie ein Repository an.</li>
<li>Fügen Sie Dateien dem Verzeichnis hinzu und stellen Sie <em>einige</em> davon
unter Versionskontrolle.</li>
<li>Ändern Sie eine Datei und versionieren Sie die Änderung.</li>
<li>Was ist der Unterschied zwischen &quot;<code>git add .; git commit</code>&quot; und
&quot;<code>git commit -a</code>&quot;?</li>
<li>Wie finden Sie heraus, welche Dateien geändert wurden?</li>
<li>Entfernen Sie eine Datei aus der Versionskontrolle, aber nicht aus dem
Verzeichnis!</li>
<li>Entfernen Sie eine Datei komplett (Versionskontrolle und Verzeichnis).</li>
<li>Ändern Sie eine Datei und betrachten die Unterschiede zum letzten Commit.</li>
<li>Fügen Sie eine geänderte Datei zum Index hinzu. Was erhalten Sie bei
<code>git diff &lt;datei&gt;</code>?</li>
<li>Wie können Sie einen früheren Stand einer Datei wiederherstellen? Wie
finden Sie überhaupt den Stand?</li>
<li>Legen Sie sich ein Java-Projekt in Ihrer IDE an an. Stellen Sie dieses
Projekt unter Git-Versionskontrolle. Führen Sie die vorigen Schritte mit
Ihrer IDE durch.</li>
</ol>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_AtlassianGit'>[AtlassianGit] <a href='https://www.atlassian.com/git/tutorials' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Become a git guru.</strong></a><br>Atlassian Pty Ltd, 2022.</li> <li id='id_Chacon2014'>[Chacon2014] <a href='https://git-scm.com/book/en/v2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Pro Git</strong></a><br>Chacon, S. und Straub, B., Apress, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-4842-0077-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-4842-0077-3</a>.<br><em>Kapitel 2</em></li> <li id='id_GitCheatSheet'>[GitCheatSheet] <a href='https://training.github.com/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Git Cheat Sheets</strong></a><br>Github Inc., 2022.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Git Branches: Features unabhängig entwickeln und mit Git verwalten</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Die Commits in Git bauen aufeinander auf und bilden dabei eine verkettete &quot;Liste&quot;. Diese &quot;Liste&quot; nennt man
auch <em>Branch</em> (Entwicklungszweig). Beim Initialisieren eines Repositories wird automatisch ein Default-Branch
angelegt, auf dem die Commits dann eingefügt werden.</p>
<p>Weitere Branches kann man mit <code>git branch</code> anlegen, und die Workingcopy kann mit <code>git switch</code> oder <code>git checkout</code>
auf einen anderen Branch umgeschaltet werden. Auf diese Weise kann man an mehreren Features parallel arbeiten,
ohne dass die Arbeiten sich gegenseitig stören.</p>
<p>Zum Mergen (Vereinigen) von Branches gibt es <code>git merge</code>. Dabei werden die Änderungen im angegebenen Branch in
den aktuell in der Workingcopy ausgecheckten Branch integriert und hier ggf. ein neuer Merge-Commit erzeugt. Falls
es in beiden Branches inkompatible Änderungen an der selben Stelle gab, entsteht beim Mergen ein Merge-Konflikt.
Dabei zeigt Git in den betroffenen Dateien jeweils an, welche Änderung aus welchem Branch stammt und man muss
diesen Konflikt durch Editieren der Stellen manuell beheben.</p>
<p>Mit <code>git rebase</code> kann die Wurzel eines Branches an eine andere Stelle verschoben werden. Dies wird später bei
Workflows eine Rolle spielen.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/WXPJOsgeR10' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Branches</a></li> <li><a href='https://youtu.be/B8sesK1GyiE' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Anlegen und Mergen von Branches</a></li> <li><a href='https://youtu.be/iEr9i8auF7c' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Auflösen von Merge-Konflikten</a></li> <li><a href='https://youtu.be/U4gd0FBBqZQ' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo HEAD</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/858546c533e356ef9cdbf1341719281a76d4f9b4405b654dfa6e96c0043ebb87a098da0d8bdca88088d1deb52433f117ab880c24495ce6dafa64ba02cfaabcf2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Branches</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Erzeugen von Branches</li> <li>(K3) Mergen von Branches, Auflösen möglicher Konflikte</li> <li>(K3) Rebasen von Branches</li></ul>
  </div>
</div>




    <h2 id="neues-feature-entwickelnausprobieren">Neues Feature entwickeln/ausprobieren</h2>
<pre><code>A---B---C  master
</code></pre>
<ul>
<li>Bisher nur lineare Entwicklung: Commits bauen aufeinander auf (lineare Folge von Commits)</li>
<li><code>master</code> ist der (Default-) Hauptentwicklungszweig
<ul>
<li>Pointer auf letzten Commit</li>
<li>Default-Name: &quot;<code>master</code>&quot; (muss aber nicht so sein bzw. kann geändert werden)</li>
</ul>
</li>
</ul>
<p><em>Anmerkung</em>: Git und auch Github haben den Namen für den Default-Branch von <code>master</code>
auf <code>main</code>geändert. Der Name an sich ist aber für Git bedeutungslos und kann mittels
<code>git config --global init.defaultBranch &lt;name&gt;</code> geändert werden. In Github hat der
Default-Branch eine gewisse Bedeutung, beispielsweise ist der Default-Branch das
automatische Ziel beim Anlegen von Pull-Requests. In Github kann man den Default-Namen
global in den User-Einstellungen (Abschnitt &quot;Repositories&quot;) und für jedes einzelne
Repository in den Repo-Einstellungen (Abschnitt &quot;Branches&quot;) ändern.</p>
<p>Entwicklung des neuen Features soll stabilen <code>master</code>-Branch nicht beeinflussen
=&gt; Eigenen Entwicklungszweig für die Entwicklung des Features anlegen:</p>
<ol>
<li>Neuen Branch erstellen: <code>git branch wuppie</code></li>
<li>Neuen Branch auschecken: <code>git checkout wuppie</code> oder <code>git switch wuppie</code></li>
</ol>
<p>Alternativ: <code>git checkout -b wuppie</code> oder <code>git switch -c wuppie</code> (neuer Branch und auschecken in einem Schritt)</p>
<pre><code>A---B---C  master, wuppie
</code></pre>
<p>Startpunkt: prinzipiell beliebig (jeder Commit in der Historie möglich).</p>
<p>Die gezeigten Beispiel zweigen den neuen Branch direkt vom aktuell ausgecheckten
Commit/Branch ab. Also aufpassen, was gerade in der Workingcopy los ist!</p>
<p>Alternativ nutzen Sie die Langform: <code>git branch wuppie master</code> (mit <code>master</code> als
Startpunkt; hier kann jeder beliebige Branch, Tag oder Commit genutzt werden).</p>
<p>Nach Anlegen des neuen Branches zeigen beide Pointer auf den selben Commit.</p>
<p><em>Anmerkung</em>: In neueren Git-Versionen wurde der Befehl &quot;<code>switch</code>&quot; eingeführt,
mit dem Sie in der Workingcopy auf einen anderen Branch wechseln können. Der
bisherige Befehl &quot;<code>checkout</code>&quot; funktioniert aber weiterhin.</p>
<h2 id="arbeiten-im-entwicklungszweig-">Arbeiten im Entwicklungszweig ...</h2>
<pre><code>          D  wuppie
         /
A---B---C  master
</code></pre>
<ul>
<li>Entwicklung des neuen Features erfolgt im eigenen Branch: beeinflusst den
stabilen <code>master</code>-Branch nicht</li>
<li>Wenn in der Workingcopy der Feature-Branch ausgecheckt ist, gehen die
Commits in den Feature-Branch; der <code>master</code> bleibt auf dem alten Stand</li>
<li>Wenn der <code>master</code> ausgecheckt wäre, würden die Änderungen in den <code>master</code>
gehen, d.h. der <code>master</code> würde sich ab Commit <code>C</code> parallel zu <code>wuppie</code>
entwickeln</li>
</ul>
<h2 id="problem-fehler-im-ausgelieferten-produkt">Problem: Fehler im ausgelieferten Produkt</h2>
<pre><code>          D  wuppie
         /
A---B---C  master
</code></pre>
<p>Fix für <code>master</code> nötig:</p>
<ol>
<li><code>git checkout master</code></li>
<li><code>git checkout -b fix</code></li>
<li>Änderungen in <code>fix</code> vornehmen ...</li>
</ol>
<p>Das führt zu dieser Situation:</p>
<pre><code>          D  wuppie
         /
A---B---C  master
         \
          E  fix
</code></pre>
<p><code>git checkout &lt;branchname&gt;</code> holt den aktuellen Stand des jeweiligen
Branches in die Workingcopy. (Das geht in neueren Git-Versionen auch
mit <code>git switch &lt;branchname&gt;</code>.)</p>
<p>Man kann weitere Branches anlegen, d.h. hier im Beispiel ein neuer
Feature-Branch <code>fix</code>, der auf dem <code>master</code> basiert. Analog könnte man
auch Branches auf der Basis von <code>wuppie</code> anlegen ...</p>
<h2 id="fix-ist-stabil-integration-in-master">Fix ist stabil: Integration in <em>master</em></h2>
<pre><code>          D  wuppie
         /
A---B---C  master
         \
          E  fix
</code></pre>
<ol>
<li><code>git checkout master</code></li>
<li><code>git merge fix</code> =&gt; <span class='alert'><strong>fast forward</strong></span> von <code>master</code></li>
<li><code>git branch -d fix</code></li>
</ol>
<p>Der letzte Schritt entfernt den Branch <code>fix</code>.</p>
<pre><code>          D  wuppie
         /
A---B---C---E  master
</code></pre>
<ul>
<li>
<p>Allgemein: <code>git merge &lt;branchname&gt;</code> führt die Änderungen im angegebenen Branch
<code>&lt;branchname&gt;</code> in den aktuell in der Workingcopy ausgecheckten Branch ein. Daraus
resultiert für den aktuell ausgecheckten Branch ein neuer Commit, der Branch
<code>&lt;branchname&gt;</code> bleibt dagegen auf seinem bisherigen Stand.</p>
<p>Beispiel:</p>
<ul>
<li>Die Workingcopy ist auf <code>A</code></li>
<li><code>git merge B</code> führt <code>A</code> und <code>B</code> zusammen: <code>B</code> wird <strong>in</strong> <code>A</code> gemergt</li>
<li>Wichtig: Der Merge-Commit (sofern nötig) findet hierbei in <code>A</code> statt!</li>
</ul>
<p>In der Abbildung ist <code>A</code> der <code>master</code> und <code>B</code> der <code>fix</code>.</p>
</li>
<li>
<p>Nach dem Merge existieren beide Branches weiter (sofern sie nicht explizit
gelöscht werden)</p>
</li>
<li>
<p>Hier im Beispiel findet ein sogenannter &quot;Fast forward&quot; statt.</p>
<p>&quot;Fast forward&quot; ist ein günstiger Spezialfall beim Merge: Beide Branches
liegen in einer direkten Kette, d.h. der Zielbranch kann einfach
&quot;weitergeschaltet&quot; werden. Ein Merge-Commit ist in diesem Fall nicht
notwendig und wird auch nicht angelegt.</p>
</li>
</ul>
<h2 id="feature-weiter-entwickeln-">Feature weiter entwickeln ...</h2>
<pre><code>          D---F  wuppie
         /
A---B---C---E  master
</code></pre>
<ol>
<li><code>git switch wuppie</code></li>
<li>Weitere Änderungen im Branch <code>wuppie</code> ...</li>
</ol>
<p><code>git switch &lt;branchname&gt;</code> holt den aktuellen Stand des jeweiligen Branches in
die Workingcopy. Man kann also jederzeit in der Workingcopy die Branches wechseln
und entsprechend weiterarbeiten.</p>
<p><em>Hinweis</em>: Während der neue <code>git switch</code>-Befehl nur Branches umschalten kann,
funktioniert <code>git checkout</code> sowohl mit Branchnamen und Dateinamen - damit kann
man also auch eine andere Version einer Datei in der Workingcopy &quot;auschecken&quot;.
Falls gleiche Branch- und Dateinamen existieren, muss man für das Auschecken
einer Datei noch &quot;<code>--</code>&quot; nutzen: <code>git checkout -- &lt;dateiname&gt;</code>.</p>
<h2 id="feature-ist-stabil-integration-in-master">Feature ist stabil: Integration in <em>master</em></h2>
<pre><code>          D---F  wuppie                            D---F  wuppie
         /                     =&gt;                 /     \
A---B---C---E  master                    A---B---C---E---G  master
</code></pre>
<ol>
<li><code>git checkout master</code></li>
<li><code>git merge wuppie</code> =&gt; Kein <em>fast forward</em> möglich: Git sucht nach gemeinsamen Vorgänger</li>
</ol>
<p>Hier im Beispiel ist der Standardfall beim Mergen dargestellt: Die beiden
Branches liegen nicht in einer direkten Kette von Commits, d.h. hier wurde
parallel weitergearbeitet.</p>
<p>Git sucht in diesem Fall nach dem gemeinsamen Vorgänger beider Branches und
führt die jeweiligen Änderungen (Differenzen) seit diesem Vorgänger in einem
Merge-Commit zusammen.</p>
<p>Im <code>master</code> entsteht ein neuer Commit, da kein <em>fast forward</em> beim
Zusammenführen der Branches möglich!</p>
<p><em>Anmerkung</em>: <code>git checkout wuppie; git merge master</code> würde den <code>master</code> in den
<code>wuppie</code> mergen, d.h. der Merge-Commit wäre dann in <code>wuppie</code>.</p>
<p>Beachten Sie dabei die &quot;Merge-Richtung&quot;:</p>
<ul>
<li>Die Workingcopy ist auf <code>A</code></li>
<li><code>git merge B</code> führt <code>A</code> und <code>B</code> zusammen: <code>B</code> wird <strong>in</strong> <code>A</code> gemergt</li>
<li>Wichtig: Der Merge-Commit (sofern nötig) findet hierbei in <code>A</code> statt!</li>
</ul>
<p>In der Abbildung ist <code>A</code> der <code>master</code> und <code>B</code> der <code>wuppie</code>.</p>
<p><strong>Achtung</strong>: Richtung beachten! <code>git checkout A; git merge B</code> führt beide Branches zusammen,
genauer: führt die Änderungen von <code>B</code> in <code>A</code> ein, d.h. der entsprechende Merge-Commit ist in <code>A</code>!</p>
<h2 id="konflikte-beim-mergen">Konflikte beim Mergen</h2>
<p>(Parallele) Änderungen an selber Stelle =&gt; Merge-Konflikte</p>
<pre><code>$ git merge wuppie
Auto-merging hero.java
CONFLICT (content): Merge conflict in hero.java
Automatic merge failed; fix conflicts and then commit the result.
</code></pre>
<p>Git fügt Konflikt-Marker in die Datei ein:</p>
<pre><code>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD:hero.java
public void getActiveAnimation() {
    return null;
=======
public Animation getActiveAnimation() {
    return this.idleAnimation;
&gt;&gt;&gt;&gt;&gt;&gt;&gt; wuppie:hero.java
</code></pre>
<ul>
<li>Der Teil mit <code>HEAD</code> ist aus dem aktuellen Branch in der Workingcopy</li>
<li>Der Teil aus dem zu mergenden Branch ist unter <code>wuppie</code> notiert</li>
<li>Das <code>=======</code> trennt beide Bereiche</li>
</ul>
<h2 id="merge-konflikte-auflösen">Merge-Konflikte auflösen</h2>
<p>Manuelles Editieren nötig (Auflösung des Konflikts):</p>
<ol>
<li>Entfernen der Marker</li>
<li>Hinzufügen der Datei zum Index</li>
<li>Analog für restliche Dateien mit Konflikt</li>
<li>Commit zum Abschließen des Merge-Vorgangs</li>
</ol>
<p>Alternativ: Nutzung graphischer Oberflächen mittels <code>git mergetool</code></p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://youtu.be/B8sesK1GyiE" target="_blank"><span class="title">Konsole: Branchen und Mergen</span></a></span></div>
<h2 id="rebasen-verschieben-von-branches">Rebasen: Verschieben von Branches</h2>
<pre><code>          D---F  wuppie                            D---F  wuppie
         /                     =&gt;                 /     \
A---B---C---E  master                    A---B---C---E---G  master
</code></pre>
<p>Bisher haben wir Branches durch Mergen zusammengeführt. Dabei entsteht in der Regel ein extra
Merge-Commit (im Beispiel <code>G</code>), außer es handelt sich um ein <em>fast forward</em>. Außerdem erkennt
man in der Historie sehr gut, dass hier in einem separaten Branch gearbeitet wurde, der irgendwann
in den <code>master</code> gemergt wurde.</p>
<p>Leider wird dieses Vorgehen in großen Projekten recht schnell sehr unübersichtlich. Außerdem
werden Merges in der Regeln nur von besonders berechtigten Personen (Manager) durchgeführt, die im
Falle von Merge-Konflikten diese dann selbst auflösen müssten (ohne aber die fachliche Befähigung
zu haben). Hier greift man dann häufig zur Alternative <em>Rebase</em>. Dabei wird der Ursprung eines
Branches auf einen bestimmten Commit verschoben. Im Anschluss ist dann ein Merge mit <em>fast forward</em>,
also ohne die typischen rautenförmigen Ketten in der Historie und ohne extra Merge-Commit möglich.
Dies kann aber auch als Nachteil gesehen werden, da man in der Historie den früheren Branch nicht
mehr erkennt! Ein weiterer schwerwiegender Nachteil ist, dass alle Commits im verschobenen Branch
umgeschrieben werden und damit neue Commit-IDs bekommen. Das verursacht bei der Zusammenarbeit in
Projekten massive Probleme! Als Vorteil gilt, dass man mögliche Merge-Konflikte bereits beim Rebasen
auflösen muss, d.h. hier muss derjenige, der den Merge &quot;beantragt&quot;, durch einen vorherigen Rebase den
konfliktfreien Merge sicherstellen. Mehr dazu in <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/branching-strategies.html">&ldquo;Branching-Strategien&rdquo;</a>
und <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows.html">&ldquo;Workflows&rdquo;</a>.</p>
<div class='columns'>
<div class='column'>
<pre><code>git rebase master wuppie
</code></pre>
<p>führt zu</p>
</div>
<div class='column'>
<pre><code>              D'---F'  wuppie
             /
A---B---C---E  master
</code></pre>
</div>
</div>
<p>Nach dem Rebase von <code>wuppie</code> auf <code>master</code> sieht es so aus, als ob der Branch <code>wuppie</code>
eben erst vom <code>master</code> abgezweigt wurde. Damit ist dann ein <em>fast forward</em> Merge von <code>wuppie</code>
in den <code>master</code> möglich, d.h. es gibt keine Raute und auch keinen extra Merge-Commit (hier nicht
gezeigt).</p>
<p>Man beachte aber die Änderung der Commit-IDs von <code>wuppie</code>: Aus <code>D</code> wird <code>D'</code>! (Datum, Ersteller
und Message bleiben aber erhalten.)</p>
<h2 id="dont-lose-your-head">Don't lose your HEAD</h2>
<ul>
<li>
<p>Branches sind wie Zeiger auf letzten Stand (Commit) eines Zweiges</p>
</li>
<li>
<p><code>HEAD</code>: Spezieller Pointer</p>
<ul>
<li>Zeigt auf den aktuellen Branch der Workingcopy</li>
</ul>
</li>
<li>
<p>Früheren Commit auschecken (ohne Branch): &quot;headless state&quot;</p>
<ul>
<li>
<p>Workingcopy ist auf früherem Commit</p>
</li>
<li>
<p>Kein Branch =&gt; Änderungen gehen verloren!</p>
<p>Eventuelle Änderungen würden ganz normal als Commits auf
dem <code>HEAD</code>-Branch aufgezeichnet. Sobald man aber einen
anderen Branch auscheckt, wird der <code>HEAD</code> auf diesen anderen
Branch gesetzt, so dass die eben gemachten Commits &quot;in der
Luft hängen&quot;. Sofern man die SHA's kennt, kommt man noch auf
die Commits zurück. Allerdings laufen von Zeit zu Zeit interne
Aufräum-Aktionen, so dass die Chance gut steht, dass die
&quot;kopflosen&quot; Commits irgendwann tatsächlich verschwinden.</p>
</li>
</ul>
</li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>Anlegen von Branches mit <code>git branch</code></li>
<li>Umschalten der Workingcopy auf anderen Branch: <code>git checkout</code> oder <code>git switch</code></li>
<li>Mergen von Branches und Auflösen von Konflikten: <code>git merge</code></li>
<li>Verschieben von Branches mit <code>git rebase</code></li>
</ul>


    



    
    
        
        
        
            
        
    
        
        
        
            
        
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106242&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Git Branches (ILIAS)</a></li> <li><a href='https://learngitbranching.js.org/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Tutorial: Welcome to Learn Git Branching</a></li> <li><a href='https://marklodato.github.io/visual-git-guide/index-en.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Tutorial: A Visual Git Reference</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Branches und Merges</strong></p>
<ol>
<li>
<p>Legen Sie in Ihrem Projekt einen Branch an. Ändern Sie einige Dateien
und committen Sie die Änderungen. Checken Sie den Master-Branch aus und
mergen Sie die Änderungen. Was beobachten Sie?</p>
</li>
<li>
<p>Legen Sie einen weiteren Branch an. Ändern Sie einige Dateien und
committen Sie die Änderungen. Checken Sie den Master-Branch aus und
ändern Sie dort ebenfalls:</p>
<ul>
<li>Ändern Sie eine Datei an einer Stelle, die nicht bereits im Branch
modifiziert wurde.</li>
<li>Ändern Sie eine Datei an einer Stelle, die bereits im Branch
manipuliert wurde.</li>
</ul>
<p>Committen Sie die Änderungen.</p>
<p>Mergen Sie den Branch jetzt in den Master-Branch. Was beobachten Sie? Wie
lösen Sie Konflikte auf?</p>
</li>
</ol>
<p><strong>Mergen am Beispiel</strong></p>
<p>Sie verwalten Ihr Projekt mit Git. Es existieren zwei Branches: <code>master</code> (zeigt
auf Commit <span class="math align-center">$C$</span>) und <code>feature</code> (zeigt auf Version <span class="math align-center">$F$</span>). In Ihrer Workingcopy
haben Sie den Branch <code>feature</code> ausgecheckt:</p>
<p><a href="#R-image-4ebff2d41b7bc35a4980f01b63fd1f1e" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/git/images/before.png?raw=true?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-4ebff2d41b7bc35a4980f01b63fd1f1e"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/git/images/before.png?raw=true?width=auto&height=auto"></a></p>
<p>(1) Mit welcher Befehlsfolge können Sie den Branch <code>feature</code> in den Branch <code>master</code>
mergen, so dass nach dem Merge die im folgenden Bild dargestellte Situation
entsteht?</p>
<p><a href="#R-image-65deb9db3fd8d606959d597a2500f9fb" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/git/images/after.png?raw=true?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-65deb9db3fd8d606959d597a2500f9fb"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/git/images/after.png?raw=true?width=auto&height=auto"></a></p>
<p>(Der Merge läuft ohne Konflikte ab. Es ist irrelevant, welcher Branch am Ende
in der Workingcopy ausgecheckt ist.)</p>
<p>(2) Wie können Sie erreichen, dass es keinen Merge-Commit gibt, sondern dass die Änderungen
in <span class="math align-center">$D$</span> und <span class="math align-center">$F$</span> im <code>master</code> als eine lineare Folge von Commits erscheinen?</p>
<p><strong>Interaktive Git-Tutorials</strong>: Schaffen Sie die Rätsel?</p>
<ul>
<li><a href="https://learngitbranching.js.org/" rel="external" target="_blank">Learn Git Branching</a></li>
<li><a href="https://ohmygit.org/" rel="external" target="_blank">Oh My Git!</a></li>
<li><a href="https://git.bradwoods.io/" rel="external" target="_blank">Git Time</a></li>
</ul>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_AtlassianGit'>[AtlassianGit] <a href='https://www.atlassian.com/git/tutorials' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Become a git guru.</strong></a><br>Atlassian Pty Ltd, 2022.</li> <li id='id_Chacon2014'>[Chacon2014] <a href='https://git-scm.com/book/en/v2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Pro Git</strong></a><br>Chacon, S. und Straub, B., Apress, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-4842-0077-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-4842-0077-3</a>.<br><em>Kapitel 3</em></li> <li id='id_GitCheatSheet'>[GitCheatSheet] <a href='https://training.github.com/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Git Cheat Sheets</strong></a><br>Github Inc., 2022.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Branching-Strategien mit Git</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Das Erstellen und Mergen von Branches ist in Git besonders einfach. Dies kann man sich in der Entwicklung zunutze machen
und die einzelnen Features unabhängig voneinander in eigenen Hilfs-Branches ausarbeiten.</p>
<p>Es haben sich zwei grundlegende Modelle etabliert: &quot;Git-Flow&quot; und &quot;GitHub Flow&quot;.</p>
<p>In <strong>Git-Flow</strong> gibt es ein umfangreiches Konzept mit verschiedenen Branches für feste Aufgaben, welches sich besonders
gut für Entwicklungmodelle mit festen Releases eignet. Es gibt zwei langlaufende Branches: <code>master</code> enthält den stabilen
veröffentlichten Stand, in <code>develop</code> werden die Ergebnisse der Entwicklung gesammelt. Features werden in kleinen Feature-Branches
entwickelt, die von <code>develop</code> abzweigen und dort wieder hineinmünden. Für Releases wird von <code>develop</code> ein eigener Release-Branch
angelegt und nach Finalisierung in den <code>master</code> und in <code>develop</code> gemergt. Fixes werden vom <code>master</code> abgezweigt, und wieder
in den <code>master</code> und auch nach <code>develop</code> integriert. Dadurch stehen auf dem <code>master</code> immer die stabilen Release-Stände zur
Verfügung, und im <code>develop</code> sammeln sich die Entwicklungsergebnisse.</p>
<p>Der <strong>GitHub Flow</strong> basiert auf einem deutlich schlankeren Konzept und passt gut für die kontinuierliche Entwicklung ohne
echte Releases. Hier hat man auch wieder einen <code>master</code> als langlaufenden Branch, der die stabilen Release-Stände enthält.
Vom <code>master</code> zweigen direkt die kleinen Feature-Branches ab und werden auch wieder direkt in den <code>master</code> integriert.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/v1WHIPdoA0k' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Branching-Strategien</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/aad8053a927c859084bf51c4145ed70f49a0e87a1cf246b3d232d266d6d77bd57c140bda4159b09ab8218345523463036bcb92ebef2591cd573ebdf3745f4ede' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Branching-Strategien</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Einsatz von Themenbranches in der Entwicklung</li> <li>(K3) Git-Flow-Modell anwenden</li> <li>(K3) GitHub Flow-Modell anwenden</li></ul>
  </div>
</div>




    <h2 id="nutzung-von-git-in-projekten-verteiltes-git-und-workflows">Nutzung von Git in Projekten: Verteiltes Git (und Workflows)</h2>
<p><a href="#R-image-295a780c37b4d03c56e3d49b58cb72fc" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/branching-strategies/distributed.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-295a780c37b4d03c56e3d49b58cb72fc"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/branching-strategies/distributed.png?width=80%25&height=auto"></a></p>
<p>Git ermöglicht ein einfaches und schnelles Branchen. Dies kann man mit
entsprechenden Branching-Strategien sinnvoll für die SW-Entwicklung einsetzen.</p>
<p>Im Folgenden sollen also die Frage betrachtet werden: <strong>Wie setze ich Branches sinnvoll ein?</strong></p>
<h2 id="umgang-mit-branches-themen-branches">Umgang mit Branches: Themen-Branches</h2>
<pre><code>                I---J---K  wuppieV1
               /
          D---F  wuppie
         /
A---B---C---E  master
             \
              G---H  test
</code></pre>
<p>Branchen ist in Git sehr einfach und schnell. Deshalb wird (gerade auch im Vergleich mit
SVN) gern und viel gebrancht.</p>
<p>Ein häufiges anzutreffendes Modell ist dabei die Nutzung von
<strong>Themen-Branches</strong>: Man hat einen Hauptzweig (<code>master</code>). Wann immer eine neue
Idee oder ein Baustein unabhängig entwickelt werden soll/kann, wird ein
entsprechender Themen-Branch aufgemacht. Dabei handelt es sich normalerweise
um <strong>kleine Einheiten</strong>!</p>
<p>Themenbranches haben in der Regel eine <strong>kurze Lebensdauer</strong>: Wenn die Entwicklung
abgeschlossen ist, wird die Idee bzw. der Baustein in den Hauptzweig integriert
und der Themenbranch gelöscht.</p>
<ul>
<li>
<p>Vorteil: Die Entwicklung im Themenbranch ist in sich gekapselt und stört
nicht die Entwicklung in anderen Branches (und diese stören umgekehrt nicht
die Entwicklung im Themenbranch).</p>
</li>
<li>
<p>Nachteil:</p>
<ul>
<li>Mangelnder Überblick durch viele Branches</li>
<li>Ursprung der Themenbranches muss überlegt gewählt werden, d.h. alle
dort benötigten Features müssen zu dem Zeitpunkt im Hauptzweig
vorhanden sein</li>
</ul>
</li>
</ul>
<h2 id="umgang-mit-branches-langlaufende-branches">Umgang mit Branches: Langlaufende Branches</h2>
<pre><code>A---B---D  master
     \
      C---E---I  develop
           \
            F---G---H  topic
</code></pre>
<p>Häufig findet man in (größeren) Projekten Branches, die über die gesamte
Lebensdauer des Projekts existieren, sogenannte &quot;langlaufende Branches&quot;.</p>
<p>Normalerweise gibt es einen Branch, in dem stets der stabile Stand des Projekts
enthalten ist. Dies ist häufig der <code>master</code>. In diesem Branch gibt es nur
sehr wenige Commits: normalerweise nur Merges aus dem <code>develop</code>-Branch (etwa
bei Fertigstellung einer Release-Version) und ggf. Fehlerbehebungen.</p>
<p>Die aktive Entwicklung findet in einem separaten Branch statt: <code>develop</code>. Hier
nutzt man zusätzlich Themen-Branches für die Entwicklung einzelner Features,
die nach Fertigstellung in den <code>develop</code> gemergt werden.</p>
<p>Kleinere Projekte kommen meist mit den zwei langlaufenden Branches in der
obigen Darstellung aus. Bei größeren Projekten finden sich häufig noch etliche
weitere langlaufende Branches, beispielsweise &quot;Proposed Updates&quot; etc. beim
Linux-Kernel.</p>
<ul>
<li>Vorteile:
<ul>
<li>Mehr Struktur im Projekt durch in ihrer Semantik wohldefinierte
Branches</li>
<li>Durch weniger Commits pro Branch lässt sich die Historie leichter
verfolgen (u.a. auch aus bestimmter Rollen-Perspektive: Entwickler,
Manager, ...)</li>
</ul>
</li>
<li>Nachteile: Bestimmte &quot;ausgezeichnete&quot; Branches; zusätzliche Regeln zum
Umgang mit diesen beachten</li>
</ul>
<h2 id="komplexe-branching-strategie-git-flow">Komplexe Branching-Strategie: Git-Flow</h2>
<pre><code>A---B---------------------G---J1  master
     \                   / \ /
      \                 /   X  fix
       \               /     \
        C-------------F----I--J2  develop
         \           / \  /
          \         /   H1  featureB
           \       /
            D1----D2  featureA
             \
              E1---E2---E3---E4---E5  featureC
</code></pre>
<p>Das Git-Flow-Modell von Vincent Driessen
(<a href="http://nvie.com/posts/a-successful-git-branching-model/" rel="external" target="_blank">nvie.com/posts/a-successful-git-branching-model</a>)
zeigt einen in der Praxis überaus bewährten Umgang mit Branches. Lesen Sie an
der angegebenen Stelle nach, besser kann man die Nutzung dieses eleganten
Modells eigentlich nicht erklären :-)</p>
<h2 id="git-flow-hauptzweige-master-und-develop">Git-Flow: Hauptzweige <em>master</em> und <em>develop</em></h2>
<pre><code>A---B-------E---------------J  master
     \     /               /
      C---D---F---G---H---I---K  develop
</code></pre>
<p>Bei Git-Flow gibt es zwei langlaufende Branches: Den <code>master</code>, der immer den stabilen
Stand enthält und in den <em>nie</em> ein direkter Commit gemacht wird, sowie den <code>develop</code>,
wo letztlich (ggf. über Themenbranches) die eigentliche Entwicklung stattfindet.</p>
<p>Änderungen werden zunächst im <code>develop</code> erstellt und getestet. Wenn die Features
stabil sind, erfolgt ein Merge von <code>develop</code> in den <code>master</code>. Hier kann noch der
Umweg über einen <code>release</code>-Branch genommen werden: Als &quot;Feature-Freeze&quot; wird vom
<code>develop</code> ein <code>release</code>-Branch abgezweigt. Darin wird das Release dann aufpoliert,
d.h. es erfolgen nur noch kleinere Korrekturen und Änderungen, aber keine echte
Entwicklungsarbeit mehr. Nach Fertigstellung wird der <code>release</code> dann sowohl in den
<code>master</code> als auch <code>develop</code> gemergt.</p>
<h2 id="git-flow-weitere-branches-als-themen-branches">Git-Flow: Weitere Branches als Themen-Branches</h2>
<pre><code>A---B---------------------I-------------K  master
     \                   /             /
      C------------F----H-------------J---L  develop
       \          / \  /             /
        \        /   G1  featureB   /
         \      /                  /
          D1---D2  featureA       /
           \                     /
            E1---E2---E3---E4---E5  featureC
</code></pre>
<p>Für die Entwicklung eigenständiger Features bietet es sich auch im
Git-Flow an, vom <code>develop</code> entsprechende Themenbranches abzuzweigen
und darin jeweils isoliert die Features zu entwickeln. Wenn diese
Arbeiten eine gewisse Reife haben, werden die Featurebranches in den
<code>develop</code> integriert.</p>
<h2 id="git-flow-merging-detail">Git-Flow: Merging-Detail</h2>
<pre><code>---C--------E  develop
    \      /                 git merge --no-ff
     D1---D2  featureA
</code></pre>
<p>vs.</p>
<pre><code>---C---D1---D2  develop      git merge
</code></pre>
<p>Wenn beim Mergen ein &quot;<em>fast forward</em>&quot; möglich ist, würde Git beim Mergen
eines (Feature-) Branches in den <code>develop</code> (oder allgemein in einen anderen
Branch) <em>keinen</em> separaten Commit erzeugen (Situation rechts in der Abbildung).</p>
<p>Damit erscheint der <code>develop</code>-Branch wie eine lineare Folge von Commits. In
manchen Projekten wird dies bevorzugt, weil die Historie sehr übersichtlich
aussieht.</p>
<p>Allerdings verliert man die Information, dass hier ein Feature entwickelt wurde
und wann es in den <code>develop</code> integriert wurde (linke Seite in obiger Abbildung).
Häufig wird deshalb ein extra Merge-Commit mit <code>git merge --no-ff &lt;branch&gt;</code>
(extra Schalter &quot;<code>--no-ff</code>&quot;) erzwungen, obwohl ein &quot;<em>fast forward</em>&quot; möglich wäre.</p>
<p>Anmerkung: Man kann natürlich auch über Konventionen in den Commit-Kommentaren
eine gewisse Übersichtlichkeit erzwingen. Beispielsweise könnte man vereinbaren,
dass alle Commit-Kommentare zu einem Feature &quot;A&quot; mit &quot;<code>feature a:</code>&quot; starten müssen.</p>
<h2 id="git-flow-umgang-mit-fehlerbehebung">Git-Flow: Umgang mit Fehlerbehebung</h2>
<pre><code>A---B---D--------F1  master
     \   \      /
      \   E1---E2  fix
       \        \
        C1-------F2  develop
</code></pre>
<p>Wenn im stabilen Branch (also dem <code>master</code>) ein Problem bekannt wird,
darf man es nicht einfach im <code>master</code> fixen. Stattdessen wird ein extra
Branch vom <code>master</code> abgezweigt, in dem der Fix entwickelt wird. Nach
Fertigstellung wird dieser Branch sowohl in den <code>master</code> als auch den
<code>develop</code> gemergt, damit auch im Entwicklungszweig der Fehler behoben ist.</p>
<p>Dadurch entspricht jeder Commit im <code>master</code> einem Release.</p>
<h2 id="vereinfachte-braching-strategie-github-flow">Vereinfachte Braching-Strategie: GitHub Flow</h2>
<pre><code>A---B---C----D-----------E  master
     \   \  /           /
      \   ta1  topicA  /
       \              /
        tb1---tb2---tb3  topicB
</code></pre>
<p>Github verfolgt eine deutlich vereinfachte Strategie: &quot;GitHub Flow&quot;
(vgl. <a href="https://githubflow.github.io/" rel="external" target="_blank">&quot;GitHub Flow&quot; (S. Chacon)</a>
bzw. <a href="https://docs.github.com/en/get-started/quickstart/github-flow" rel="external" target="_blank">&quot;GitHub flow&quot; (GitHub, Inc.)</a>).</p>
<p>Hier ist der stabile Stand ebenfalls immer im <code>master</code>. Features werden ebenso
wie im Git-Flow-Modell in eigenen Feature-Branches entwickelt.</p>
<p>Allerdings zweigen Feature-Branches <em>immer direkt</em> vom <code>master</code> ab und werden nach
dem Test auch immer dort wieder direkt integriert (es gibt also keine weiteren
langlaufenden Branches wie <code>develop</code> oder <code>release</code>).</p>
<p>In der obigen Abbildung ist zu sehen, dass für die Entwicklung eines Features ein
entsprechender Themenbranch vom <code>master</code> abgezweigt wird. Darin erfolgt dann die
Entwicklung des Features, d.h. mehrere Commits. Das Mergen des Features in den
<code>master</code> erfolgt dann aber nicht lokal, sondern mit einem &quot;Pull-Request&quot; auf dem
Server: Sobald man im Feature-Branch einen &quot;diskussionswürdigen&quot; Stand hat, wird ein
<strong>Pull-Request</strong> (<em>PR</em>) über die Weboberfläche aufgemacht (streng genommen gehört
dies in die Kategorie <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows.html">&ldquo;Zusammenarbeit&rdquo; bzw. &ldquo;Workflows&rdquo;</a>;
außerdem gehört ein PR nicht zu Git selbst, sondern zum Tooling von Github). In
einem PR können andere Entwickler den Code kommentieren und ergänzen. Jeder weitere
Commit auf dem Themenbranch wird ebenfalls Bestandteil des Pull-Requests. Parallel
laufen ggf. automatisierte Tests etc. und durch das Akzeptieren des PR in der
Weboberfläche erfolgt schließlich der Merge des Feature-Branches in den <code>master</code>.</p>
<h2 id="diskussion-git-flow-vs-github-flow">Diskussion: Git-Flow vs. GitHub Flow</h2>
<p>In der Praxis zeigt sich, dass das Git-Flow-Modell besonders gut geeignet ist,
wenn man tatsächlich so etwas wie &quot;Releases&quot; hat, die zudem nicht zu häufig
auftreten.</p>
<p>Das GitHub-Flow-Vorgehen bietet sich an, wenn man entweder keine Releases hat
oder diese sehr häufig erfolgen (typisch bei agiler Vorgehensweise). Zudem
vermeidet man so, dass die Feature-Branches zu lange laufen, womit normalerweise
die Wahrscheinlichkeit von Merge-Konflikten stark steigt.
<strong>Achtung</strong>: Da die Feature-Branches direkt in den <code>master</code>, also den stabilen
Produktionscode gemergt werden, ist es hier besonders wichtig, <em>vor</em> dem Merge
entsprechende Tests durchzuführen und den Merge erst zu machen, wenn alle Tests
&quot;grün&quot; sind.</p>
<p>Hier ein paar Einstiegsseiten für die Diskussion, die teilweise sehr erbittert
(und mit ideologischen Zügen) geführt wird (erinnert an die Diskussionen, welche
Linux-Distribution die bessere sei):</p>
<ul>
<li><a href="https://nvie.com/posts/a-successful-git-branching-model/" rel="external" target="_blank">Git-Flow-Modell von Vincent Driessen</a></li>
<li><a href="https://guides.github.com/introduction/flow/" rel="external" target="_blank">Kurzer Überblick über das GitHub-Flow-Modell</a></li>
<li><a href="https://githubflow.github.io/" rel="external" target="_blank">Diskussion des GitHub-Flow-Modells (Github)</a></li>
<li><a href="https://lucamezzalira.com/2014/03/10/git-flow-vs-github-flow/" rel="external" target="_blank">Luca Mezzalira: &quot;Git-Flow vs Github Flow&quot;</a></li>
<li><a href="https://scottchacon.com/2011/08/31/github-flow.html" rel="external" target="_blank">Scott Schacon, Autor des Pro-Git-Buchs</a></li>
<li><a href="https://hackernoon.com/a-branching-and-releasing-strategy-that-fits-github-flow-be1b6c48eca2" rel="external" target="_blank">Noch eine (längere) Betrachtung (Robin Daugherty)</a></li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>Einsatz von Themenbranches für die Entwicklung</li>
<li>Unterschiedliche Modelle:
<ul>
<li>Git-Flow: umfangreiches Konzept, gut für Entwicklung mit festen Releases</li>
<li>GitHub Flow: deutlich schlankeres Konzept, passend für kontinuierliche Entwicklung ohne echte Releases</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106243&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Git Branching-Strategien (ILIAS)</a></li></ul>
  </div>
</div>



    



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_AtlassianGit'>[AtlassianGit] <a href='https://www.atlassian.com/git/tutorials' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Become a git guru.</strong></a><br>Atlassian Pty Ltd, 2022.</li> <li id='id_Chacon2014'>[Chacon2014] <a href='https://git-scm.com/book/en/v2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Pro Git</strong></a><br>Chacon, S. und Straub, B., Apress, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-4842-0077-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-4842-0077-3</a>.<br><em>Kapitel 3</em></li> <li id='id_GitCheatSheet'>[GitCheatSheet] <a href='https://training.github.com/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Git Cheat Sheets</strong></a><br>Github Inc., 2022.</li> <li id='id_GitFlow'>[GitFlow] <a href='https://nvie.com/posts/a-successful-git-branching-model/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Git-Flow: A successful Git branching model</strong></a><br>Driessen, V., 2010.</li> <li id='id_GitHubFlow'>[GitHubFlow] <a href='https://githubflow.github.io/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>GitHub Flow</strong></a><br>Chacon, S., 2013.</li> <li id='id_GitHubFlowGH'>[GitHubFlowGH] <a href='https://docs.github.com/en/get-started/quickstart/github-flow' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>GitHub flow</strong></a><br>GitHub Inc., 2022.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Arbeiten mit Git Remotes (dezentrale Repos)</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Eine der Stärken von Git ist das Arbeiten mit verteilten Repositories. Zu jeder Workingcopy gehört
eine Kopie des Repositories, wodurch jederzeit alle Informationen einsehbar sind und auch offline
gearbeitet werden kann. Allerdings muss man für die Zusammenarbeit mit anderen Entwicklern die lokalen
Repos mit den &quot;entfernten&quot; Repos (auf dem Server oder anderen Entwicklungsrechnern) synchronisieren.</p>
<p>Beim Klonen eines Repositories mit <code>git clone &lt;url&gt;</code> wird das fremde Repo mit dem Namen <code>origin</code>
im lokalen Repo festgehalten. Dieser Name wird auch als Präfix für die Branches in diesem Repo genutzt,
d.h. die Branches im Remote-Repo tauchen als <code>origin/&lt;branch&gt;</code> im lokalen Repo auf. Diese Remote-Branches
kann man nicht direkt bearbeiten, sondern man muss diese Remote-Branches in einem lokalen Branch auschecken
und dann darin weiterarbeiten. Es können beliebig viele weitere Remotes dem eigenen Repository hinzugefügt
werden.</p>
<p>Änderungen aus einem Remote-Repo können mit <code>git fetch &lt;remote&gt;</code> in das lokale Repo geholt werden.
Dies aktualisiert <strong>nur</strong> die Remote-Branches <code>&lt;remote&gt;/&lt;branch&gt;</code>! Die Änderungen können anschließend
mit <code>git merge &lt;remote&gt;/&lt;branch&gt;</code> in den aktuell in der Workingcopy ausgecheckten Branch gemergt werden.
(<em>Anmerkung</em>: Wenn mehrere Personen an einem Branch arbeiten, will man die eigenen Arbeiten in dem Branch
vermutlich eher auf den aktuellen Stand des Remote <strong>rebasen</strong> statt mergen!) Eigene Änderungen können
mit <code>git push &lt;remote&gt; &lt;branch&gt;</code> in das Remote-Repo geschoben werden.</p>
<p>Um den Umgang mit den Remote-Branches und den davon abgeleiteten lokalen Branches zu vereinfachen,
gibt es das Konzept der &quot;Tracking Branches&quot;. Dabei &quot;folgt&quot; ein lokaler Branch einem Remote-Branch.
Ein einfaches <code>git pull</code> oder <code>git push</code> holt dann Änderungen aus dem Remote-Branch in den ausgecheckten
lokalen Branch bzw. schiebt Änderungen im lokalen Branch in den Remote-Branch.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/_uhEseblDYU' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Remotes</a></li> <li><a href='https://youtu.be/moqywsxtEy8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Fetch, Pull und Push</a></li> <li><a href='https://youtu.be/0RoqM5Wmxfc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Tracking-Branches</a></li> <li><a href='https://youtu.be/jL4AvSsjjKg' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Verknüpfen weiterer Remotes</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/8aa3f0e96448352e436aead353f54a3de6bbd3737bf33b6bd935b098352690544dc527e59424068ec65b6e0d67f6aff6bd6aa0a602127ce2a02a360658e0151d' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Remotes</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Erzeugen eines Clones von fremden Git-Repositories</li> <li>(K3) Holen der Änderungen vom fremden Repo</li> <li>(K3) Aktualisierung der lokalen Branches</li> <li>(K3) Pushen der lokalen Änderungen ins fremde Repo</li> <li>(K3) Anlegen von lokalen Branches vs. Anlegen von entfernten Branches</li> <li>(K3) Anlegen eines Tracking Branches zum Vereinfachen der Arbeit</li></ul>
  </div>
</div>




    <h2 id="nutzung-von-git-in-projekten-verteiltes-git-und-workflows">Nutzung von Git in Projekten: Verteiltes Git (und Workflows)</h2>
<p><a href="#R-image-d869a4b0cb9d2ff1d20c07501bc55f79" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/remotes/distributed.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-d869a4b0cb9d2ff1d20c07501bc55f79"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/remotes/distributed.png?width=80%25&height=auto"></a></p>
<p>Git ermöglicht eine einfaches Zusammenarbeit in verteilten Teams. Nachdem wir die verschiedenen
Branching-Strategien betrachtet haben, soll im Folgenden die Frage betrachtet werden: <strong>Wie arbeite
ich sinnvoll über Git mit anderen Kollegen und Teams zusammen? Welche Modelle haben sich etabliert?</strong></p>
<h2 id="clonen-kann-sich-lohnen-">Clonen kann sich lohnen ...</h2>
<pre><code>https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture

---C---D---E  master
</code></pre>
<p>=&gt; <code>git clone https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture</code></p>
<pre><code>./Prog2-Lecture/  (lokaler Rechner)

---C---D---E  master
           ^origin/master
</code></pre>
<p>Git-Repository mit der URL <code>&lt;URL-Repo&gt;</code> in lokalen Ordner <code>&lt;directory&gt;</code> auschecken:</p>
<ul>
<li><code>git clone &lt;URL-Repo&gt; [&lt;directory&gt;]</code></li>
<li>Workingcopy ist automatisch über den Namen <code>origin</code> mit dem remote Repo auf
dem Server verbunden</li>
<li>Lokaler Branch <code>master</code> ist mit dem remote Branch <code>origin/master</code> verbunden
(&quot;Tracking Branch&quot;, s.u.), der den Stand des <code>master</code>-Branches auf dem
Server spiegelt</li>
</ul>
<p>Für die URL sind verschiedene Protokolle möglich, beispielsweise:</p>
<ul>
<li>&quot;<code>file://</code>&quot; für über das Dateisystem erreichbare Repositories (ohne Server)</li>
<li>&quot;<code>https://</code>&quot; für Repo auf einem Server: Authentifikation mit Username
und Passwort (!)</li>
<li>&quot;<code>git@</code>&quot; für Repo auf einem Server: Authentifikation mit <strong>SSH-Key</strong> (diese
Variante wird im Praktikum im Zusammenspiel mit dem Gitlab-Server im
SW-Labor verwendet)</li>
</ul>
<h2 id="eigener-und-entfernter-master-entwickeln-sich-weiter-">Eigener und entfernter <em>master</em> entwickeln sich weiter ...</h2>
<pre><code>https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture

---C---D---E---F---G  master
</code></pre>
<p></p>
<pre><code>./Prog2-Lecture/  (lokaler Rechner)

---C---D---E---H  master
           ^origin/master
</code></pre>
<p>Nach dem Auschecken liegen (in diesem Beispiel) drei <code>master</code>-Branches vor:</p>
<ol>
<li>Der <code>master</code> auf dem Server,</li>
<li>der lokale <code>master</code>, und</li>
<li>die lokale Referenz auf den <code>master</code>-Branch auf dem Server: <code>origin/master</code>.</li>
</ol>
<p>Der lokale <code>master</code> ist ein normaler Branch und kann durch Commits verändert
werden.</p>
<p>Der <code>master</code> auf dem Server kann sich ebenfalls ändern, beispielsweise weil
jemand anderes seine lokalen Änderungen mit dem Server abgeglichen hat
(<code>git push</code>, s.u.).</p>
<p>Der Branch <code>origin/master</code> lässt sich nicht direkt verändern! Das ist lediglich
eine lokale Referenz auf den <code>master</code>-Branch auf dem Server und zeigt an,
welchen Stand man bei der letzten Synchronisierung hatte. D.h. erst mit dem
nächsten Abgleich wird sich dieser Branch ändern (sofern sich der entsprechende
Branch auf dem Server verändert hat).</p>
<p><em>Anmerkung</em>: Dies gilt analog für alle anderen Branches. Allerdings wird
nur der <code>origin/master</code> beim Clonen automatisch als lokaler Branch ausgecheckt.</p>
<p>Zur Abbildung:
Während man lokal arbeitet (Commit <code>H</code> auf dem lokalen <code>master</code>), kann es passieren,
dass sich auch das remote Repo ändert. Im Beispiel wurden dort die beiden Commits
<code>F</code> und <code>G</code> angelegt (durch <code>git push</code>, s.u.).</p>
<p>Wichtig: Da in der Zwischenzeit das lokale Repo nicht mit dem Server abgeglichen
wurde, zeigt der remote Branch <code>origin/master</code> immer noch auf den Commit
<code>E</code>!</p>
<h2 id="änderungen-im-remote-holen-und-branches-zusammenführen">Änderungen im Remote holen und Branches zusammenführen</h2>
<pre><code>https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture

---C---D---E---F---G  master
</code></pre>
<p>=&gt; <code>git fetch origin</code></p>
<pre><code>./Prog2-Lecture/  (lokaler Rechner)

---C---D---E---H  master
            \
             F---G  origin/master
</code></pre>
<h3 id="änderungen-auf-dem-server-mit-dem-eigenen-repo-abgleichen">Änderungen auf dem Server mit dem eigenen Repo abgleichen</h3>
<p>Mit <code>git fetch origin</code> alle Änderungen holen</p>
<ul>
<li>Alle remote Branches werden aktualisiert und entsprechen den jeweiligen
Branches auf dem Server: Im Beispiel zeigt jetzt <code>origin/master</code> ebenso
wie der <code>master</code> auf dem Server auf den Commit <code>G</code>.</li>
<li>Neue Branches auf dem Server werden ebenfalls &quot;geholt&quot;, d.h. sie liegen
nach dem Fetch als entsprechende remote Branches vor</li>
<li>Auf dem Server gelöschte Branches werden nicht automatisch lokal gelöscht;
dies kann man mit <code>git fetch --prune origin</code> automatisch erreichen</li>
</ul>
<p><em>Wichtig</em>: Es werden nur die remote Branches aktualisiert, nicht die lokalen Branches!</p>
<h3 id="master-branch-nach-git-fetch-origin-zusammenführen"><em>master</em>-Branch nach &quot;git fetch origin&quot; zusammenführen</h3>
<ol>
<li>Mit <code>git checkout master</code> Workingcopy auf eigenen <code>master</code> umstellen</li>
<li>Mit <code>git merge origin/master</code> Änderungen am <code>origin/master</code> in eigenen <code>master</code> mergen</li>
<li>Mit <code>git push origin master</code> eigene Änderungen ins remote Repo pushen</li>
</ol>
<p></p>
<pre><code>https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture

---C---D---E---H---I  master
            \     /
             F---G
</code></pre>
<p></p>
<pre><code>./Prog2-Lecture/  (lokaler Rechner)

---C---D---E---H---I  master
            \     /^origin/master
             F---G
</code></pre>
<p><em>Anmerkung</em>: Schritt (2) kann man auch per <code>git pull origin master</code> erledigen ... Ein <code>pull</code>
fasst <code>fetch</code> und <code>merge</code> zusammen (s.u.).</p>
<p><em>Anmerkung</em> Statt dem <code>merge</code> in Schritt (2) kann man auch den lokalen <code>master</code> auf den
aktualisierten <code>origin/master</code> rebasen und vermeidet damit die &quot;Raute&quot;. Der <code>pull</code> kann
mit der Option &quot;<code>--rebase</code>&quot; auf &quot;rebase&quot; umgestellt werden (per Default wird bei <code>pull</code>
ein &quot;merge&quot; ausgeführt).</p>
<h3 id="auf-dem-server-ist-nur-ein-fast-forward-merge-möglich">Auf dem Server ist nur ein <em>fast forward merge</em> möglich</h3>
<p>Sie können Ihre Änderungen in Ihrem lokalen <code>master</code> auch direkt in das remote Repo
pushen, solange auf dem Server ein <strong>fast forward merge</strong> möglich ist.</p>
<p>Wenn aber (wie in der Abbildung) der lokale und der remote <code>master</code> divergieren,
müssen Sie den Merge wie beschrieben lokal durchführen (<code>fetch</code>/<code>merge</code> oder <code>pull</code>)
und das Ergebnis wieder in das remote Repo pushen (dann ist ja wieder ein
<em>fast forward merge</em> möglich, es sei denn, jemand hat den remote <code>master</code> in der
Zwischenzeit weiter geschoben - dann muss die Aktualisierung erneut durchgeführt
werden).</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://youtu.be/moqywsxtEy8" target="_blank"><span class="title">Beispiel für Zusammenführen (merge und push), Anmerkung zu fast forward merge</span></a></span></div>
<h2 id="branches-und-remotes">Branches und Remotes</h2>
<ul>
<li>
<p>Eigenen (neuen) lokalen Branch ins remote Repo schicken</p>
<ul>
<li><code>git push &lt;remote&gt; &lt;branch&gt;</code></li>
</ul>
</li>
<li>
<p>Neuer Branch im remote Repo</p>
<ul>
<li><code>git fetch &lt;remote&gt;</code> holt (auch) alle neuen Branches</li>
<li>Lokale Änderungen an remote Branches nicht möglich!
=&gt; <strong>Remote Branch in lokalen Branch mergen</strong> (oder auschecken)</li>
</ul>
</li>
</ul>
<h2 id="zusammenfassung-arbeiten-mit-remotes">Zusammenfassung: Arbeiten mit Remotes</h2>
<ol>
<li>
<p>Änderungen vom Server holen: <code>git fetch &lt;remote&gt;</code>
=&gt; Holt alle Änderungen vom Repo <code>&lt;remote&gt;</code> ins eigene Repo
(<span class='alert'>Workingcopy bleibt unangetastet!</span>)</p>
</li>
<li>
<p>Aktuellen lokalen Branch auffrischen: <code>git merge &lt;remote&gt;/&lt;branch&gt;</code>
(oder alternativ <code>git pull &lt;remote&gt; &lt;branch&gt;</code>)</p>
</li>
<li>
<p>Eigene Änderungen hochladen: <code>git push &lt;remote&gt; &lt;branch&gt;</code></p>
</li>
</ol>
<h3 id="anmerkung-push-geht-nur-wenn">Anmerkung: <em>push</em> geht nur, wenn</h3>
<ol>
<li>Ziel ein &quot;bare&quot;-Repository ist, <strong>und</strong></li>
<li>keine Konflikte entstehen</li>
</ol>
<p>=&gt; im remote Repo <span class='alert'>nur</span> &quot;fast forward&quot;-Merge möglich</p>
<p>=&gt; bei Konflikten erst <code>fetch</code> und <code>merge</code>, danach <code>push</code></p>
<p><strong>Anmerkung</strong>: Ein &quot;bare&quot;-Repository enthält keine Workingcopy, sondern nur
das Repo an sich. Die ist bei Repos, die Sie auf einem Server wie Gitlab oder
Github anlegen, automatisch der Fall. Sie können aber auch lokal ein solches
&quot;bare&quot;-Repo anlegen, indem Sie beim Initialisieren den Schalter <code>--bare</code>
mitgeben: <code>git init --bare</code> ...</p>
<h3 id="beispiel">Beispiel</h3>
<pre><code>git fetch origin           # alle Änderungen vom Server holen
git checkout master        # auf lokalen Master umschalten
git merge origin/master    # lokalen Master aktualisieren

... # Herumspielen am lokalen Master

git push origin master     # lokalen Master auf Server schicken
</code></pre>
<h2 id="vereinfachung-tracking-branches">Vereinfachung: Tracking Branches</h2>
<ul>
<li>
<p><strong>Tracking Branch</strong>: lokaler Branch, der remote Branch &quot;verfolgt&quot;</p>
<ul>
<li>Beispiel: lokaler <code>master</code>-Branch folgt <code>origin/master</code> per Default</li>
</ul>
</li>
<li>
<p><strong>Vereinfachung im Workflow</strong>:</p>
<ul>
<li><code>git pull</code> entspricht
<ol>
<li><code>git fetch &lt;remote&gt;</code> <strong>plus</strong></li>
<li><code>git merge &lt;remote&gt;/&lt;branch&gt;</code></li>
</ol>
</li>
<li><code>git push</code> entspricht <code>git push &lt;remote&gt; &lt;branch&gt;</code></li>
</ul>
</li>
</ul>
<p><span class='alert'>Vorsicht</span>: <code>pull</code> und <code>push</code> beziehen sich nur auf ausgecheckten Tracking Branch</p>
<h2 id="einrichten-von-tracking-branches">Einrichten von Tracking Branches</h2>
<ul>
<li>
<p><code>git clone</code>: lokaler <code>master</code> trackt automatisch <code>origin/master</code></p>
</li>
<li>
<p>Remote Branch als Tracking Branch einrichten:</p>
<ol>
<li>Änderungen aus remote Repo holen: <code>git fetch &lt;remote&gt;</code></li>
<li>Tracking Branch anlegen: <code>git checkout -t &lt;remote&gt;/&lt;branch&gt;</code>
(=&gt; Option <code>-t</code> richtet den remote Branch als Tracking Branch ein)</li>
</ol>
</li>
<li>
<p>Lokalen neuen Branch ins remote Repo schicken und als Tracking Branch einrichten:</p>
<ol>
<li>Lokalen Branch erzeugen: <code>git checkout -b &lt;branch&gt;</code></li>
<li>Lokalen Branch ins Repo schicken: <code>git push -u &lt;remote&gt; &lt;branch&gt;</code>
(=&gt; Option <code>-u</code> richtet den lokalen Branch als Tracking Branch ein)</li>
</ol>
</li>
</ul>
<h2 id="hinzufügen-eines-weiteren-remote-repository">Hinzufügen eines (weiteren) Remote Repository</h2>
<p><a href="#R-image-7321655aaacaf26fc8df5a73aa168a27" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/remotes/screenshot_branches.png?width=75%25&height=auto" style=" height: auto; width: 75%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-7321655aaacaf26fc8df5a73aa168a27"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/remotes/screenshot_branches.png?width=75%25&height=auto"></a></p>
<p>Sie können einem Repo beliebig viele Remotes hinzufügen:</p>
<p><code>git remote add &lt;name&gt; &lt;url&gt;</code></p>
<p><strong>Beispiel</strong>: <code>git remote add  andi  git@github.com:andi/repo.git</code></p>
<ul>
<li>Remote <code>origin</code> wird bei <code>clone</code> automatisch angelegt</li>
<li>Ansehen der Remotes mit <code>git remote -v</code></li>
<li><code>fetch</code>, <code>push</code> und <code>pull</code> jeweils über den vergebenen Namen</li>
</ul>
<p>Beispiel: <code>git fetch andi</code> oder <code>git push origin master</code></p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Synchronisierung des lokalen Repos mit anderen Repos</p>
<ul>
<li>Repo kopieren: <code>git clone &lt;url&gt;</code></li>
<li>Interner Name fürs fremde Repo: <code>origin</code></li>
<li>Änderungen vom fremden Repo holen: <code>git fetch &lt;remote&gt;</code></li>
<li>Änderungen in lokalen Branch einpflegen: <code>git merge &lt;remote&gt;/&lt;branch&gt;</code></li>
<li>Eigene Änderungen ins fremde Repo schieben: <code>git push &lt;remote&gt; &lt;branch&gt;</code></li>
</ul>
</li>
<li>
<p>Tracking Branches (Konzept, Anwendung)</p>
<ul>
<li>Remote Branches können lokal nicht verändert werden:
<ul>
<li>In lokale Branches mergen, oder</li>
<li>Tracking Branches anlegen =&gt; einfaches <code>pull</code> und <code>push</code> nutzen</li>
</ul>
</li>
<li>Tracking Branches sind lokale Branches, die remote Branches verfolgen (&quot;tracken&quot;)</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106245&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Git Remotes (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Synchronisierung mit Remote-Repos</strong></p>
<p>Sie haben ein Repo von github.com geklont. Beide Repos, das Original auf dem Server
als auch Ihre lokale Kopie, haben sich danach unabhängig voneinander weiter
entwickelt (siehe Skizze).</p>
<p><a href="#R-image-4ada71ce1a534d02e06b7a599ddf3747" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/git/images/remote-branches-2.png?raw=true?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-4ada71ce1a534d02e06b7a599ddf3747"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/git/images/remote-branches-2.png?raw=true?width=auto&height=auto"></a></p>
<p>Wie können Sie Ihre Änderung im lokalen Repo auf den Server pushen? Analysieren Sie die
Situation und erklären Sie zwei verschiedene Lösungsansätze und geben Sie jeweils die
entsprechenden Git-Befehle an.</p>
<p><strong>Interaktive Git-Tutorials</strong>: Schaffen Sie die Rätsel?</p>
<ul>
<li><a href="https://learngitbranching.js.org/" rel="external" target="_blank">Learn Git Branching</a></li>
<li><a href="https://ohmygit.org/" rel="external" target="_blank">Oh My Git!</a></li>
<li><a href="https://git.bradwoods.io/" rel="external" target="_blank">Git Time</a></li>
</ul>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_AtlassianGit'>[AtlassianGit] <a href='https://www.atlassian.com/git/tutorials' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Become a git guru.</strong></a><br>Atlassian Pty Ltd, 2022.</li> <li id='id_Chacon2014'>[Chacon2014] <a href='https://git-scm.com/book/en/v2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Pro Git</strong></a><br>Chacon, S. und Straub, B., Apress, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-4842-0077-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-4842-0077-3</a>.<br><em>Kapitel 3</em></li> <li id='id_GitCheatSheet'>[GitCheatSheet] <a href='https://training.github.com/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Git Cheat Sheets</strong></a><br>Github Inc., 2022.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Zusammenarbeit: Git-Workflows und Merge-/Pull-Requests</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Git erlaubt unterschiedliche Formen der Zusammenarbeit.</p>
<p>Bei kleinen Teams kann man einen einfachen zentralen Ansatz einsetzen. Dabei gibt es ein zentrales
Repo auf dem Server, und alle Team-Mitglieder dürfen direkt in dieses Repo pushen. Hier muss man
sich gut absprechen und ein vernünftiges Branching-Schema ist besonders wichtig.</p>
<p>In größeren Projekten gibt es oft ein zentrales öffentliches Repo, wo aber nur wenige Personen
Schreibrechte haben. Hier forkt man sich dieses Repo, erstellt also eine öffentliche Kopie auf dem
Server. Diese Kopie klont man lokal und arbeitet hier und pusht die Änderungen in den eigenen öffentlich
sichtbaren Fork. Um die Änderungen ins Projekt-Repo integrieren zu lassen, wird auf dem Server ein
sogenannter Merge-Request (Gitlab) bzw. Pull-Request (GitHub) erstellt. Dies erlaubt zusätzlich ein
Review und eine Diskussion direkt am Code. Damit man die Änderungen im Hauptprojekt in den eigenen
Fork bekommt, trägt man das Hauptprojekt als weiteres Remote in die Workingcopy ein und aktualisiert
regelmäßig die Hauptbranches, von denen dann auch die eigenen Feature-Branches ausgehen sollten.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/3xqmNGN39wE' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Workflows</a></li> <li><a href='https://youtu.be/-8NOia7k0WI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Anlegen eines Forks, Erstellen eines Pull-Requests (PR)</a></li> <li><a href='https://youtu.be/4LaZc080Ajo' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Arbeiten mit einem PR, Review eines PR</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/b673fe50e18f064b2b5c81108c81dfea940b2eb81790d54b27e8ade26f0afa10d0d05f8a0c0c852e8e9da6c558065f053033d83384810b47a6ca7f5110482153' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Git Workflows</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Git-Workflows für die Zusammenarbeit</li> <li>(K2) Unterschied zwischen einem Pull/Merge und einem Pull/Rebase</li> <li>(K2) Welche Commits werden Bestandteil eines Merge-Requests (und warum)</li> <li>(K3) Einsatz des zentralisierten Workflows</li> <li>(K3) Einsatz des einfachen verteilten Workflows mit unterschiedlichen Repos</li> <li>(K3) Aktualisieren Ihres Clones und Ihres Forks mit Änderungen aus dem blessed Repo</li> <li>(K3) Erstellen von Beiträgen zu einem Projekt über Merge-Requests</li> <li>(K3) Aktualisierung von Merge-Requests</li> <li>(K3) Diskussion über den Code in Merge-Requests</li></ul>
  </div>
</div>




    <h2 id="nutzung-von-git-in-projekten-verteiltes-git-und-workflows">Nutzung von Git in Projekten: Verteiltes Git (und Workflows)</h2>
<p><a href="#R-image-7ce9c42984dc63a7a9ee439e19eff427" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows/distributed.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-7ce9c42984dc63a7a9ee439e19eff427"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows/distributed.png?width=80%25&height=auto"></a></p>
<p>Git ermöglicht ein einfaches und schnelles Branchen. Dies kann man mit
entsprechenden Branching-Strategien sinnvoll für die SW-Entwicklung einsetzen.</p>
<p>Auf der anderen Seite ermöglicht Git ein sehr einfaches verteiltes Arbeiten.
Auch hier ergeben sich verschiedene Workflows, wie man mit anderen Entwicklern
an einem Projekt arbeiten will/kann.</p>
<p>Im Folgenden sollen also die Frage betrachtet werden: <strong>Wie gestalte ich die Zusammenarbeit?</strong>
Antwort: Workflows mit Git ...</p>
<h2 id="zusammenarbeit-zentraler-workflow-mit-git-analog-zu-svn">Zusammenarbeit: Zentraler Workflow mit Git (analog zu SVN)</h2>
<p><a href="#R-image-0b672c888c9c372f437a228f138c6bf8" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows/centralised.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-0b672c888c9c372f437a228f138c6bf8"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows/centralised.png?width=80%25&height=auto"></a></p>
<p>In kleinen Projektgruppen wie beispielsweise Ihrer Arbeitsgruppe wird häufig
ein einfacher zentralisierter Workflow bei der Versionsverwaltung genutzt. Im
Mittelpunkt steht dabei ein zentrales Repository, auf dem alle Teammitglieder
gleichberechtigt und direkt pushen dürfen.</p>
<ul>
<li>
<p>Vorteile:</p>
<ul>
<li>Einfachstes denkbares Modell</li>
<li>Ein gemeinsames Repo (wie bei SVN)</li>
<li>Alle haben Schreibzugriff auf ein gemeinsames Repo</li>
</ul>
</li>
<li>
<p>Nachteile:</p>
<ul>
<li>Definition und Umsetzung von Rollen mit bestimmten Rechten (&quot;Manager&quot;,
&quot;Entwickler&quot;, &quot;Gast-Entwickler&quot;, ...) schwierig bis unmöglich
(das ist kein Git-Thema, sondern hängt von der Unterstützung durch den
Anbieter des Servers ab)</li>
<li>Jeder darf überall pushen: Enge und direkte Abstimmung nötig</li>
<li>Modell funktioniert meist nur in sehr kleinen Teams (2..3 Personen)</li>
</ul>
</li>
</ul>
<h2 id="zusammenarbeit-einfacher-verteilter-workflow-mit-git">Zusammenarbeit: Einfacher verteilter Workflow mit Git</h2>
<p><a href="#R-image-733734463271ccd524198a3705da1580" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows/workflow_remote.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-733734463271ccd524198a3705da1580"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows/workflow_remote.png?width=80%25&height=auto"></a></p>
<p>In großen und/oder öffentlichen Projekten wird üblicherweise ein Workflow
eingesetzt, der auf den Möglichkeiten von verteilten Git-Repositories basiert.</p>
<p>Dabei wird zwischen verschiedenen Rollen (&quot;Integrationsmanager&quot;, &quot;Entwickler&quot;)
unterschieden.</p>
<p>Sie finden dieses Vorgehen beispielsweise beim Linux-Kernel und auch häufig bei
Projekten auf Github.</p>
<ul>
<li>
<p>Es existiert ein geschütztes (&quot;blessed&quot;) Master-Repo</p>
<ul>
<li>Stellt die Referenz für das Projekt dar</li>
<li>Push-Zugriff nur für ausgewählte Personen (&quot;Integrationsmanager&quot;)</li>
</ul>
</li>
<li>
<p>Entwickler</p>
<ul>
<li>Forken das Master-Repo auf dem Server und klonen ihren Fork lokal</li>
<li>Arbeiten auf lokalem Klon: Unabhängige Entwicklung eines Features</li>
<li>Pushen ihren Stand in ihren Fork (ihr eigenes öffentliches Repo):
Veröffentlichung des Beitrags zum Projekt (sobald fertig bzw. diskutierbar)</li>
<li>Lösen Pull- bzw. Merge-Request gegen das Master-Repo aus: Beitrag
soll geprüft und ins Projekt aufgenommen werden (Merge ins Master-Repo
durch den Integrationsmanager)</li>
</ul>
</li>
<li>
<p>Integrationsmanager</p>
<ul>
<li>Prüft die Änderungen im Pull- bzw. Merge-Request und fordert ggf.
Nacharbeiten an bzw. lehnt Integration ab (technische oder politische
Gründe)</li>
<li>Führt Merge der Entwickler-Zweige mit den Hauptzweigen durch Akzeptieren
der Pull- bzw. Merge-Requests durch: Beitrag der Entwickler ist im
Projekt angekommen und ist beim nächsten Pull in deren lokalen Repos
vorhanden</li>
</ul>
</li>
</ul>
<p>Den hier gezeigten Zusammenhang kann man auf weitere Ebenen verteilen, vgl. den
im Linux-Kernel gelebten &quot;Dictator and Lieutenants Workflow&quot; (siehe Literatur).</p>
<p><em>Hinweis</em>: Hier wird nur die Zusammenarbeit im verteilten Team dargestellt. Dazu
kommt noch das Arbeiten mit verschiedenen Branches!</p>
<p><em>Anmerkung</em>: In der Workingcopy wird das eigene (öffentliche) Repo oft als <code>origin</code>
und das geschützte (&quot;blessed&quot;) Master-Repo als <code>upstream</code> referenziert.</p>
<h3 id="anmerkungen-zum-forken">Anmerkungen zum Forken</h3>
<p>Sie könnten auch das Original-Repo direkt clonen. Allerdings würden dann die
<code>push</code> dort aufschlagen, was in der Regel nicht erwünscht ist (und auch nicht
erlaubt ist).</p>
<p>Deshalb forkt man das Original-Repo auf dem Server, d.h. auf dem Server wird
eine Kopie des Original-Repos im eigenen Namespace angelegt. Auf diese Kopie
hat man dann uneingeschränkten Zugriff.</p>
<h3 id="anmerkungen-zu-den-namen-für-die-remotes-origin-und-upstream">Anmerkungen zu den Namen für die Remotes: <code>origin</code> und <code>upstream</code></h3>
<p>Üblicherweise checkt man die <em>Kopie</em> lokal aus (d.h. erzeugt einen Clone).
In der Workingcopy verweist dann <code>origin</code> auf die Kopie. Um Änderungen am
Original-Repo zu erhalten, fügt man dieses unter dem Namen <code>upstream</code> als
weiteres Remote-Repo hinzu. Dies ist eine nützliche <em>Konvention</em>.</p>
<p>Um Änderungen aus dem Original-Repo in den eigenen Fork (und die Workingcopy)
zu bringen, führt man dann einfach folgendes aus (im Beispiel für den <code>master</code>):</p>
<pre><code>$ git checkout master         # Workingcopy auf master
$ git pull upstream master    # Aktualisiere lokalen master mit master aus Original-Repo
$ git push origin master      # Pushe lokalen master in den Fork
</code></pre>
<h2 id="feature-branches-aktualisieren-mergen-mit-master-vs-rebase-auf-master">Feature-Branches aktualisieren: Mergen mit <em>master</em> vs. Rebase auf <em>master</em></h2>
<p>Im Netz finden sich häufig Anleitungen, wonach man Änderungen im <code>master</code>
mit einem Merge in den Feature-Branch holt, also sinngemäß:</p>
<pre><code>$ git checkout master         # Workingcopy auf master
$ git pull upstream master    # Aktualisiere lokalen master mit master aus Vorgabe-Repo
$ git checkout feature        # Workingcopy auf feature
$ git merge master            # Aktualisiere feature: Merge master in feature
$ git push origin feature     # Push aktuellen feature ins Team-Repo
</code></pre>
<p>Das funktioniert rein technisch betrachtet.</p>
<p>Allerdings spielt in den meisten Git-Projekten der <code>master</code> üblicherweise eine besondere Rolle
(vgl. <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/branching-strategies.html">Branching-Strategien</a>) und ist
üblicherweise stets das <strong>Ziel</strong> eines Merge, aber nie die Quelle! D.h. per Konvention geht der
Fluß von Änderungen stets <strong>in</strong> den <code>master</code> (und nicht heraus).</p>
<p>Wenn man sich nicht an diese Konvention hält, hat man später möglicherweise Probleme, die
Merge-Historie zu verstehen (welche Änderung kam von woher)!</p>
<p>Um die Änderungen im <code>master</code> in einen Feature-Branch zu bekommen, sollte deshalb ein <strong>Rebase</strong>
(des Feature-Branches auf den <code>master</code>) vor einem Merge (des <code>master</code> in den Feature-Branch)
bevorzugt werden.</p>
<p><span class='alert'><strong>Merk-Regel</strong>: Merge niemals nie den <code>master</code> in Feature-Branches!</span></p>
<p><strong>Achtung</strong>: Ein Rebase bei veröffentlichten Branches ist problematisch, da Dritte auf diesem
Branch arbeiten könnten und entsprechend auf die Commit-IDs angewiesen sind. Nach einem Rebase
stimmen diese Commit-IDs nicht mehr, was normalerweise mindestens zu Verärgerung führt ... Die
Dritten müssten ihre Arbeit dann auf den neuen Feature-Branch (d.h. den Feature-Branch nach
dessen Rebase) rebasen ... vgl. auch &quot;The Perils of Rebasing&quot; in Abschnitt &quot;3.6 Rebasing&quot; in
<a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows.html#id_Chacon2014">[Chacon2014]</a>.</p>
<h3 id="mögliches-szenario-im-praktikum">Mögliches Szenario im Praktikum</h3>
<p>Im Praktikum haben Sie das Vorgabe-Repo. Dieses könnten Sie als <code>upstream</code> in Ihre lokale
Workingcopy einbinden.</p>
<p>Mit Ihrem Team leben Sie vermutlich einen zentralen Workflow, d.h. Sie binden Ihr gemeinsames
Repo als <code>origin</code> in Ihre lokale Workingcopy ein.</p>
<p>Dann müssen Sie den lokalen <code>master</code> aus <em>beiden</em> Remotes aktualisieren. Zusätzlich
wollen Sie Ihren aktuellen Themenbranch auf den aktuellen <code>master</code> rebasen.</p>
<pre><code>$ git checkout master         # Workingcopy auf master
$ git pull upstream master    # Aktualisiere lokalen master mit master aus Vorgabe-Repo
$ git pull origin master      # Aktualisiere lokalen master mit master aus Team-Repo
$ git push origin master      # Pushe lokalen master in das Team-Repo zurück
$ git rebase master feature   # Rebase feature auf den aktuellen lokalen master
$ git push -f origin feature  # Push aktuellen feature ins Team-Repo (&quot;-f&quot; wg. geänderter IDs durch rebase)
</code></pre>
<p><strong>Anmerkung</strong>: Dabei können in Ihrem <code>master</code> die unschönen &quot;Rauten&quot; entstehen. Wenn
Sie das vermeiden wollen, tauschen Sie den zweiten und den dritten Schritt und führen
den Pull gegen den Upstream-<code>master</code> als <code>pull --rebase</code> durch. Dann müssen Sie Ihren
lokalen <code>master</code> allerdings auch force-pushen in Ihr Team-Repo und die anderen
Team-Mitglieder sollten darüber informiert werden, dass sich der <code>master</code> auf
inkompatible Weise geändert hat ...</p>
<h2 id="kommunikation-merge--bzw-pull-requests">Kommunikation: Merge- bzw. Pull-Requests</h2>
<p>Mergen kann man auf der Konsole (oder in der IDE) und anschließend die (neuen) Branches
auf den Server pushen.</p>
<p>Die verschiedenen Git-Server erlauben ebenfalls ein GUI-gestütztes Mergen von Branches:
&quot;Merge-Requests&quot; (<em>MR</em>, Gitlab) bzw. &quot;Pull-Requests&quot; (<em>PR</em>, Github). Das hat gegenüber
dem lokalen Mergen wichtige Vorteile: Andere Entwickler sehen den beabsichtigten Merge
(frühzeitig) und können direkt den Code kommentieren und die vorgeschlagenen Änderungen
diskutieren, aber auch allgemeine Kommentare abgeben.</p>
<p>Falls möglich, sollte man einen MR/PR immer dem Entwickler zuweisen, der sich weiter
um diesen MR/PR kümmern wird (also zunächst ist man das erstmal selbst). Zusätzlich
kann man einen Reviewer bestimmen, d.h. wer soll sich den Code ansehen.</p>
<p>Hier ein Screenshot der Änderungsansicht unseres Gitlab-Servers (SW-Labor):</p>
<p><a href="#R-image-e5d033719e19056f236f0a1c8d4c29bd" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows/screenshot_merge-request_code.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-e5d033719e19056f236f0a1c8d4c29bd"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows/screenshot_merge-request_code.png?width=80%25&height=auto"></a></p>
<p>Nachfolgend für den selben MR aus der letzten Abbildung noch die reine Diskussionsansicht:</p>
<p><a href="#R-image-bb2b8c4126bf65179c2cfa728d62a8c5" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows/screenshot_merge-request_discussion.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-bb2b8c4126bf65179c2cfa728d62a8c5"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/git/workflows/screenshot_merge-request_discussion.png?width=80%25&height=auto"></a></p>
<h2 id="best-practices-bei-merge-pull-requests">Best Practices bei Merge-/Pull-Requests</h2>
<ol>
<li>MR/PR so zeitig wie möglich aufmachen
<ul>
<li>Am besten sofort, wenn ein neuer Branch auf den Server gepusht wird!</li>
<li>Ggf. mit dem Präfix &quot;WIP&quot; im Titel gegen unbeabsichtigtes vorzeitiges Mergen
sperren ... (bei GitHub als &quot;Draft&quot;-PR öffnen)</li>
</ul>
</li>
<li>Auswahl Start- und Ziel-Branch (und ggf. Ziel-Repo)
<ul>
<li>Es gibt verschiedene Stellen, um einen MR/PR zu erstellen. Manchmal kann man nur
noch den Ziel-Branch einstellen, manchmal beides.</li>
<li>Bitte auch darauf achten, welches Ziel-Repo eingestellt ist! Bei Forks wird
hier immer das Original-Repo voreingestellt!</li>
<li>Den Ziel-Branch kann man ggf. auch nachträglich durch Editieren des MR/PR
anpassen (Start-Branch und Ziel-Repo leider nicht, also beim Erstellen aufpassen!).</li>
</ul>
</li>
<li>Titel (<em>Summary</em>): Das ist das, was man in der Übersicht sieht!
<ul>
<li>Per Default wird die letzte Commit-Message eingesetzt.</li>
<li>Analog zur Commit-Message: Bitte hier unbedingt einen sinnvollen Titel
einsetzen: Was macht der MR/PR (kurz)?</li>
</ul>
</li>
<li>Beschreibung: Was passiert, wenn man diesen MR/PR akzeptiert (ausführlicher)?
<ul>
<li>Analog zur Commit-Message sollte hier bei Bedarf die Summary ausformuliert
werden und beschreiben, was der MR/PR ändert.</li>
</ul>
</li>
<li>Assignee: Wer soll sich drum kümmern?
<ul>
<li>Ein MR/PR sollte immer jemanden zugewiesen sein, d.h. nicht &quot;unassigned&quot;
sein. Ansonsten ist nicht klar, wer den Request durchführen/akzeptieren
soll.</li>
<li>Außerdem taucht ein nicht zugewiesener MR/PR nicht in der Übersicht &quot;meiner&quot;
MR/PR auf, d.h. diese MR/PR haben die Tendenz, vergessen zu werden!</li>
</ul>
</li>
<li>Diskussion am (und neben) dem Code
<ul>
<li>Nur die vorgeschlagenen Code-Änderungen diskutieren!</li>
<li>Weitergehende Diskussionen (etwa über Konzepte o.ä.) besser in separaten Issues
erledigen, da sonst die Anzeige des MR/PR langsam wird (ist beispielsweise ein
Problem bei Gitlab).</li>
</ul>
</li>
<li>Weitere Commits auf dem zu mergenden Branch gehen automatisch mit in den Request</li>
<li>Weitere Entwickler kann man mit &quot;<code>@username</code>&quot; in einem Kommentar auf &quot;CC&quot;
setzen und in die Diskussion einbinden</li>
</ol>
<p><em>Anmerkung</em>: Bei Gitlab (d.h. auch bei dem Gitlab-Server im SW-Labor) gibt es
&quot;<em>Merge-Requests</em>&quot; (MR). Bei Github gibt es &quot;<em>Pull-Requests</em>&quot; (PR) ...</p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Git-Workflows für die Zusammenarbeit:</p>
<ul>
<li>einfacher zentraler Ansatz für kleine Arbeitsgruppen vs.</li>
<li>einfacher verteilter Ansatz mit einem &quot;blessed&quot; Repo (häufig in Open-Source-Projekten zu finden)</li>
</ul>
</li>
<li>
<p>Aktualisieren Ihres Clones und Ihres Forks mit Änderungen aus dem &quot;blessed&quot; Repo</p>
</li>
<li>
<p>Unterschied zwischen einem Pull/Merge und einem Pull/Rebase</p>
</li>
<li>
<p>Erstellen von Beiträgen zu einem Projekt über Merge-Requests</p>
<ul>
<li>Welche Commits werden Bestandteil eines Merge-Requests (und warum)</li>
<li>Diskussion über den Code in Merge-Requests</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106246&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Git Workflows (ILIAS)</a></li></ul>
  </div>
</div>



    



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_AtlassianGit'>[AtlassianGit] <a href='https://www.atlassian.com/git/tutorials' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Become a git guru.</strong></a><br>Atlassian Pty Ltd, 2022.</li> <li id='id_Chacon2014'>[Chacon2014] <a href='https://git-scm.com/book/en/v2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Pro Git</strong></a><br>Chacon, S. und Straub, B., Apress, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-4842-0077-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-4842-0077-3</a>.<br><em>Kapitel 5 (Distributed Git) sowie Abschnitt 4.8 (Gitlab) und Kapitel 6 (GitHub)</em></li> <li id='id_GitCheatSheet'>[GitCheatSheet] <a href='https://training.github.com/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Git Cheat Sheets</strong></a><br>Github Inc., 2022.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
          <article class="default">
            <header class="headline">
            </header>

<h1 id="modern-java-funktionaler-stil-und-stream-api">Modern Java: Funktionaler Stil und Stream-API</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/lambdas.html">Lambda-Ausdrücke und funktionale Interfaces</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/methodreferences.html">Methoden-Referenzen</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/stream-api.html">Stream-API</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/records.html">Record-Klassen</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional.html">Optional</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/defaultmethods.html">Interfaces: Default-Methoden</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Modern Java: Funktionaler Stil und Stream-API</h1>
<article class="default">
<h1>Lambda-Ausdrücke und funktionale Interfaces</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Mit einer anonymen inneren Klasse erstellt man gewissermaßen ein Objekt einer &quot;Wegwerf&quot;-Klasse:
Man leitet <em>on-the-fly</em> von einem Interface ab oder erweitert eine Klasse und implementiert die
benötigten Methoden und erzeugt von dieser Klasse sofort eine Instanz (Objekt). Diese neue Klasse
ist im restlichen Code nicht sichtbar.</p>
<p>Anonyme innere Klassen sind beispielsweise in Swing recht nützlich, wenn man einer Komponente einen
Listener mitgeben will: Hier erzeugt man eine anonyme innere Klasse basierend auf dem passenden
Listener-Interface, implementiert die entsprechenden Methoden und übergibt das mit dieser Klasse
erzeugte Objekt als neuen Listener der Swing-Komponente.</p>
<p>Mit Java 8 können unter gewissen Bedingungen diese anonymen inneren Klassen zu Lambda-Ausdrücken
(und Methoden-Referenzen) vereinfacht werden. Dazu muss die anonyme innere Klasse ein sogenanntes
<strong>funktionales Interface</strong> implementieren.</p>
<p>Funktionale Interfaces sind Interfaces mit <em>genau einer abstrakten Methode</em>. Es können beliebig
viele Default-Methoden im Interface enthalten sein, und es können <code>public</code> sichtbare abstrakte
Methoden von <code>java.lang.Object</code> geerbt/überschrieben werden.</p>
<p>Die Lambda-Ausdrücke entsprechen einer anonymen Methode: Die Parameter werden aufgelistet (in
Klammern), und hinter einem Pfeil kommt entweder <em>ein</em> Ausdruck (Wert - gleichzeitig Rückgabewert
des Lambda-Ausdrucks) oder beliebig viele Anweisungen (in geschweiften Klammern, mit Semikolon):</p>
<ul>
<li>Form 1: <code>(parameters)  -&gt;  expression</code></li>
<li>Form 2: <code>(parameters)  -&gt;  { statements; }</code></li>
</ul>
<p>Der Lambda-Ausdruck muss von der Signatur her genau der einen abstrakten Methode im unterliegenden
funktionalen Interface entsprechen.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/Wd8KG7xtp4c' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Lambda-Ausdrücke und funktionale Interfaces</a></li> <li><a href='https://youtu.be/QEXpQwRYoYc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Anonyme innere Klasse</a></li> <li><a href='https://youtu.be/2LJIxsVw4pM' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Lambda-Ausdruck</a></li> <li><a href='https://youtu.be/93O1oDL5_5c' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Funktionale Interfaces selbst definiert</a></li> <li><a href='https://youtu.be/jzEw8IH8Mfc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Vordefinierte funktionale Interfaces im JDK</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/d2398cc8e1279e6b6bf1df06bd30b731e714d04d10e15b87a5f89aa07cbaf97978bb12f82ea0c7eff8a3133eb65134521933218fb94856fb6e8a6dc187dded28' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Lambda-Ausdrücke und funktionale Interfaces</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Funktionales Interfaces (Definition)</li> <li>(K3) Einsatz innerer und anonymer Klassen</li> <li>(K3) Erstellen eigener funktionaler Interfaces</li> <li>(K3) Einsatz von Lambda-Ausdrücken</li></ul>
  </div>
</div>




    <h2 id="problem-sortieren-einer-studi-liste">Problem: Sortieren einer Studi-Liste</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Liste sortieren?</span>
</span></span><span style="display:flex;"><span>sl.<span style="color:#a6e22e">sort</span>(<span style="color:#f92672">???</span>);  <span style="color:#f92672">//</span> Parameter: java.<span style="color:#a6e22e">util</span>.<span style="color:#a6e22e">Comparator</span><span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span></span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyCompare</span> <span style="color:#66d9ef">implements</span> Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span>(Studi o1, Studi o2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Liste sortieren?</span>
</span></span><span style="display:flex;"><span>MyCompare mc <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> MyCompare();
</span></span><span style="display:flex;"><span>sl.<span style="color:#a6e22e">sort</span>(mc);</span></span></code></pre></div>
<p>Da <code>Comparator&lt;T&gt;</code> ein Interface ist, muss man eine extra Klasse anlegen, die die
abstrakte Methode aus dem Interface implementiert und ein Objekt von dieser Klasse
erzeugen und dieses dann der <code>sort()</code>-Methode übergeben.</p>
<p>Die Klasse bekommt wie in Java üblich eine eigene Datei und ist damit in der
Package-Struktur offen sichtbar und &quot;verstopft&quot; mir damit die Strukturen: Diese
Klasse ist doch nur eine Hilfsklasse ... Noch schlimmer: Ich brauche einen Namen
für diese Klasse!</p>
<p>Den ersten Punkt könnte man über verschachtelte Klassen lösen: Die Hilfsklasse
wird innerhalb der Klasse definiert, die das Objekt benötigt. Für den zweiten
Punkt brauchen wir mehr Anlauf ...</p>
<h2 id="erinnerung-verschachtelte-klassen-nested-classes">Erinnerung: Verschachtelte Klassen (&quot;<em>Nested Classes</em>&quot;)</h2>
<p>Man kann Klassen innerhalb von Klassen definieren: Verschachtelte Klassen.</p>
<ul>
<li>Implizite Referenz auf Instanz der äußeren Klasse, Zugriff auf <strong>alle</strong> Elemente</li>
<li><strong>Begriffe</strong>:
<ul>
<li>&quot;normale&quot; innere Klassen: &quot;<em>inner classes</em>&quot;</li>
<li>statische innere Klassen: &quot;<em>static nested classes</em>&quot;</li>
</ul>
</li>
<li>Einsatzzweck:
<ul>
<li>Hilfsklassen: Zusätzliche Funktionalität kapseln; Nutzung <strong>nur</strong> in äußerer Klasse</li>
<li>Kapselung von Rückgabewerten</li>
</ul>
</li>
</ul>
<p>Sichtbarkeit: Wird u.U. von äußerer Klasse &quot;überstimmt&quot;</p>
<h3 id="innere-klassen-inner-classes">Innere Klassen (&quot;<em>Inner Classes</em>&quot;)</h3>
<ul>
<li>Objekt der äußeren Klasse muss existieren</li>
<li>Innere Klasse ist normales Member der äußeren Klasse</li>
<li>Implizite Referenz auf Instanz äußerer Klasse</li>
<li>Zugriff auf <strong>alle</strong> Elemente der äußeren Klasse</li>
<li>Sonderfall: Definition innerhalb von Methoden (&quot;local classes&quot;)
<ul>
<li>Nur innerhalb der Methode sichtbar</li>
<li>Kennt zusätzlich <code>final</code> Attribute der Methode</li>
</ul>
</li>
</ul>
<p>Beispiel:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Outer</span> {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Inner</span> {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Outer.<span style="color:#a6e22e">Inner</span> inner <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Outer().<span style="color:#a6e22e">new</span> Inner();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/nested/StudiListNested.java" target="_blank"><span class="title">Beispiel mit Iterator als innere Klasse: nested.StudiListNested</span></a></span></div>
<h3 id="statische-innere-klassen-static-nested-classes">Statische innere Klassen (&quot;<em>Static Nested Classes</em>&quot;)</h3>
<ul>
<li>Keine implizite Referenz auf Objekt</li>
<li>Nur Zugriff auf Klassenmethoden und -attribute</li>
</ul>
<p>Beispiel:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Outer</span> {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StaticNested</span> {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Outer.<span style="color:#a6e22e">StaticNested</span> nested <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Outer.<span style="color:#a6e22e">StaticNested</span>();</span></span></code></pre></div>
<h2 id="lösung-comparator-als-anonyme-innere-klasse">Lösung: Comparator als anonyme innere Klasse</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Parametrisierung mit anonymer Klasse</span>
</span></span><span style="display:flex;"><span>sl.<span style="color:#a6e22e">sort</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span>(Studi o1, Studi o2) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        });  <span style="color:#f92672">//</span> Semikolon nicht vergessen<span style="color:#f92672">!!!</span></span></span></code></pre></div>
<p>=&gt; Instanz einer anonymen inneren Klasse, die das Interface <code>Comparator&lt;Studi&gt;</code> implementiert</p>
<ul>
<li>Für spezielle, einmalige Aufgabe: nur eine Instanz möglich</li>
<li>Kein Name, kein Konstruktor, oft nur eine Methode</li>
<li>Müssen Interface implementieren oder andere Klasse erweitern
<ul>
<li>Achtung Schreibweise: ohne <code>implements</code> oder <code>extends</code>!</li>
</ul>
</li>
<li>Konstruktor kann auch Parameter aufweisen</li>
<li>Zugriff auf alle Attribute der äußeren Klasse plus alle <code>final</code> lokalen
Variablen</li>
<li>Nutzung typischerweise bei GUIs: Event-Handler etc.</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/nested/DemoAnonymousInnerClass.java" target="_blank"><span class="title">Demo: nested.DemoAnonymousInnerClass</span></a></span></div>
<h2 id="vereinfachung-mit-lambda-ausdruck">Vereinfachung mit Lambda-Ausdruck</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Parametrisierung mit anonymer Klasse</span>
</span></span><span style="display:flex;"><span>sl.<span style="color:#a6e22e">sort</span>(
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>() {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span>(Studi o1, Studi o2) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        });  <span style="color:#75715e">// Semikolon nicht vergessen!!!</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Parametrisierung mit Lambda-Ausdruck</span>
</span></span><span style="display:flex;"><span>sl.<span style="color:#a6e22e">sort</span>( (Studi o1, Studi o2) <span style="color:#f92672">-&gt;</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>() );</span></span></code></pre></div>
<p><strong>Anmerkung</strong>: Damit für den Parameter alternativ auch ein Lambda-Ausdruck verwendet
werden kann, muss der erwartete Parameter vom Typ her ein &quot;<strong>funktionales Interface</strong>&quot;
(s.u.) sein!</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/nested/DemoLambda.java" target="_blank"><span class="title">Demo: nested.DemoLambda</span></a></span></div>
<h2 id="syntax-für-lambdas">Syntax für Lambdas</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>(Studi o1, Studi o2)  <span style="color:#f92672">-&gt;</span>  o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>()</span></span></code></pre></div>
<p>Ein Lambda-Ausdruck ist eine Funktion ohne Namen und besteht aus drei Teilen:</p>
<ol>
<li>Parameterliste (in runden Klammern),</li>
<li>Pfeil</li>
<li>Funktionskörper (rechte Seite)</li>
</ol>
<p>Falls es <em>genau einen</em> Parameter gibt, <em>können</em> die runden Klammern um den Parameter
entfallen.</p>
<p>Dabei kann der Funktionskörper aus <em>einem Ausdruck</em> (&quot;<em>expression</em>&quot;) bestehen oder
einer <em>Menge von Anweisungen</em> (&quot;<em>statements&quot;</em>), die dann in geschweifte Klammern
eingeschlossen werden müssen (Block mit Anweisungen).</p>
<p>Der Wert des Ausdrucks ist zugleich der Rückgabewert des Lambda-Ausdrucks.</p>
<p>Varianten:</p>
<ul>
<li>
<p><strong><code>(parameters)  -&gt;  expression</code></strong></p>
</li>
<li>
<p><strong><code>(parameters)  -&gt;  { statements; }</code></strong></p>
</li>
</ul>
<h2 id="quiz-welches-sind-keine-gültigen-lambda-ausdrücke">Quiz: Welches sind keine gültigen Lambda-Ausdrücke?</h2>
<ol>
<li><code>() -&gt; {}</code></li>
<li><code>() -&gt; &quot;wuppie&quot;</code></li>
<li><code>() -&gt; { return &quot;fluppie&quot;; }</code></li>
<li><code>(Integer i) -&gt; return i + 42;</code></li>
<li><code>(String s) -&gt; { &quot;foo&quot;; }</code></li>
<li><code>(String s) -&gt; s.length()</code></li>
<li><code>(Studi s) -&gt; s.getCredits() &gt; 300</code></li>
<li><code>(List&lt;Studi&gt; sl) -&gt; sl.isEmpty()</code></li>
<li><code>(int x, int y) -&gt; { System.out.println(&quot;Erg: &quot;); System.out.println(x+y); }</code></li>
<li><code>() -&gt; new Studi()</code></li>
<li><code>s -&gt; s.getCps() &gt; 100 &amp;&amp; s.getCps() &lt; 300</code></li>
<li><code>s -&gt; { return s.getCps() &gt; 100 &amp;&amp; s.getCps() &lt; 300; }</code></li>
</ol>
<div class="expand">
  <input type="checkbox" id="R-expand-81e988a5bf9aaf03691f734e61952968" aria-controls="R-expandcontent-81e988a5bf9aaf03691f734e61952968">
  <label class="expand-label" for="R-expand-81e988a5bf9aaf03691f734e61952968">
    <i class="expander-icon fa-fw fas fa-chevron-down"></i>
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> Show Me
  </label>
  <div id="R-expandcontent-81e988a5bf9aaf03691f734e61952968" class="expand-content">
<p>Auflösung:</p>
<p>(4) und (5): <code>return</code> ist eine Anweisung, d.h. bei (4) fehlen die geschweiften
Klammern. <code>&quot;foo&quot;</code> ist ein String und als solcher ein Ausdruck, d.h. hier sind
die geschweiften Klammern zu viel (oder man ergänze den String mit einem <code>return</code>,
also <code>return &quot;foo&quot;;</code> ...).</p>
  </div>
</div>
<h2 id="definition-funktionales-interface-functional-interfaces">Definition &quot;Funktionales Interface&quot; (&quot;<em>functional interfaces</em>&quot;)</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@FunctionalInterface</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Wuppie</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">wuppie</span>(T obj);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">equals</span>(Object obj);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">fluppie</span>() { <span style="color:#66d9ef">return</span> 42; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><code>Wuppie&lt;T&gt;</code> ist ein <span class='alert'><strong>funktionales Interface</strong></span>
(&quot;<em>functional interface</em>&quot;) (seit Java 8)</p>
<ul>
<li>Hat <strong>genau <em>eine</em> abstrakte Methode</strong></li>
<li>Hat evtl. weitere Default-Methoden</li>
<li>Hat evtl. weitere abstrakte Methoden, die <code>public</code> Methoden von
<code>java.lang.Object</code> überschreiben</li>
</ul>
<p>Die Annotation <code>@FunctionalInterface</code> selbst ist nur für den Compiler: Falls
das Interface <em>kein</em> funktionales Interface ist, würde er beim Vorhandensein
dieser Annotation einen Fehler werfen. Oder anders herum: Allein durch das
Annotieren mit <code>@FunctionalInterface</code> wird aus einem Interface noch kein
funktionales Interface! Vergleichbar mit <code>@Override</code> ...</p>
<p><span class='alert'><strong>Während man für eine anonyme Klasse lediglich ein &quot;normales&quot; Interface
(oder eine Klasse) benötigt, braucht man für Lambda-Ausdrücke zwingend ein
passendes funktionales Interface!</strong></span></p>
<p><em>Anmerkung</em>: Es scheint keine einheitliche deutsche Übersetzung für den Begriff
<em>functional interface</em> zu geben. Es wird häufig mit &quot;funktionales Interface&quot;,
manchmal aber auch mit &quot;Funktionsinterface&quot; übersetzt.</p>
<p>Das in den obigen Beispielen eingesetzte Interface <code>java.util.Comparator&lt;T&gt;</code>
ist also ein funktionales Interface: Es hat nur <em>eine</em> eigene abstrakte Methode
<code>int compare(T o1, T o2);</code>.</p>
<p>Im Package <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/function/package-summary.html" rel="external" target="_blank">java.util.function</a>
sind einige wichtige funktionale Interfaces bereits vordefiniert, beispielsweise
<code>Predicate</code> (Test, ob eine Bedingung erfüllt ist) und <code>Function</code> (verarbeite
einen Wert und liefere einen passenden Ergebniswert). Diese kann man auch in
eigenen Projekten nutzen!</p>
<h2 id="quiz-welches-ist-kein-funktionales-interface">Quiz: Welches ist kein funktionales Interface?</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Wuppie</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">wuppie</span>(<span style="color:#66d9ef">int</span> a);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Fluppie</span> <span style="color:#66d9ef">extends</span> Wuppie {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">wuppie</span>(<span style="color:#66d9ef">double</span> a);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Foo</span> {
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Bar</span> <span style="color:#66d9ef">extends</span> Wuppie {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">bar</span>() { <span style="color:#66d9ef">return</span> 42; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="expand">
  <input type="checkbox" id="R-expand-ced9f57588af42179887368cae0207c2" aria-controls="R-expandcontent-ced9f57588af42179887368cae0207c2">
  <label class="expand-label" for="R-expand-ced9f57588af42179887368cae0207c2">
    <i class="expander-icon fa-fw fas fa-chevron-down"></i>
    <i class="expander-icon fa-fw fas fa-chevron-right"></i> Show Me
  </label>
  <div id="R-expandcontent-ced9f57588af42179887368cae0207c2" class="expand-content">
<p>Auflösung:</p>
<ul>
<li><code>Wuppie</code> hat <em>genau eine</em> abstrakte Methode =&gt; funktionales Interface</li>
<li><code>Fluppie</code> hat zwei abstrakte Methoden =&gt; <strong>kein</strong> funktionales Interface</li>
<li><code>Foo</code> hat gar keine abstrakte Methode =&gt; <strong>kein</strong> funktionales Interface</li>
<li><code>Bar</code> hat <em>genau eine</em> abstrakte Methode (und eine Default-Methode) =&gt; funktionales Interface</li>
</ul>
  </div>
</div>
<h2 id="lambdas-und-funktionale-interfaces-typprüfung">Lambdas und funktionale Interfaces: Typprüfung</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">java</span>.<span style="color:#a6e22e">util</span>.<span style="color:#a6e22e">Comparator</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span>(T o1, T o2);    <span style="color:#75715e">// abstrakte Methode</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Verwendung ohne weitere Typinferenz</span>
</span></span><span style="display:flex;"><span>Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> c1 <span style="color:#f92672">=</span> (Studi o1, Studi o2) <span style="color:#f92672">-&gt;</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Verwendung mit Typinferenz</span>
</span></span><span style="display:flex;"><span>Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> c2 <span style="color:#f92672">=</span> (o1, o2) <span style="color:#f92672">-&gt;</span> o1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> o2.<span style="color:#a6e22e">getCredits</span>();</span></span></code></pre></div>
<p>Der Compiler prüft in etwa folgende Schritte, wenn er über einen Lambda-Ausdruck stolpert:</p>
<ol>
<li>In welchem Kontext habe ich den Lambda-Ausdruck gesehen?</li>
<li>OK, der Zieltyp ist hier <code>Comparator&lt;Studi&gt;</code>.</li>
<li>Wie lautet die <strong>eine</strong> abstrakte Methode im <code>Comparator&lt;T&gt;</code>-Interface?</li>
<li>OK, das ist <code>int compare(T o1, T o2);</code></li>
<li>Da <code>T</code> hier an <code>Studi</code> gebunden ist, muss der Lambda-Ausdruck
der Methode <code>int compare(Studi o1, Studi o2);</code> entsprechen:
2x <code>Studi</code> als Parameter und als Ergebnis ein <code>int</code></li>
<li>Ergebnis:
a)  Cool, passt zum Lambda-Ausdruck <code>c1</code>. Fertig.
b)  D.h. in <code>c2</code> müssen <code>o1</code> und <code>o2</code> vom Typ <code>Studi</code> sein.
Cool, passt zum Lambda-Ausdruck <code>c2</code>. Fertig.</li>
</ol>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Anonyme Klassen: &quot;Wegwerf&quot;-Innere Klassen</p>
<ul>
<li>Müssen Interface implementieren oder Klasse erweitern</li>
</ul>
</li>
<li>
<p>Java8: <strong>Lambda-Ausdrücke</strong> statt anonymer Klassen (<strong>funktionales Interface nötig</strong>)</p>
<ul>
<li>Zwei mögliche Formen:
<ul>
<li>Form 1: <code>(parameters)  -&gt;  expression</code></li>
<li>Form 2: <code>(parameters)  -&gt;  { statements; }</code></li>
</ul>
</li>
<li>Im jeweiligen Kontext muss ein <strong>funktionales Interface</strong> verwendet werden,
d.h. ein Interface mit <strong>genau</strong> einer abstrakten Methode</li>
<li>Der Lambda-Ausdruck muss von der Signatur her dieser einen abstrakten Methode
entsprechen</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106523&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Lambda-Ausdrücke und funktionale Interfaces (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Beispiel aus einem Code-Review im <a href="https://github.com/Dungeon-CampusMinden/Dungeon" rel="external" target="_blank">Dungeon-CampusMinden/Dungeon</a></strong></p>
<p>Erklären Sie folgenden Code:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IFightAI</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fight</span>(Entity entity);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AIComponent</span> <span style="color:#66d9ef">extends</span> Component {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> IFightAI fightAI;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    fightAI <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>                entity1 <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;TIME TO FIGHT!&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#75715e">// todo replace with melee skill</span>
</span></span><span style="display:flex;"><span>                };
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><strong>Sortieren mit Lambdas und funktionalen Interfaces</strong></p>
<p>Betrachten Sie die Klasse <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/challenges/lambda/Student.java" rel="external" target="_blank">Student</a>.</p>
<ol>
<li>Definieren Sie eine Methode, die das Sortieren einer <code>Student</code>-Liste erlaubt. Übergeben Sie die Liste als Parameter.</li>
<li>Schaffen Sie es, das Sortierkriterium ebenfalls als Parameter zu übergeben (als Lambda-Ausdruck)?</li>
<li>Definieren Sie eine weitere Methode, die wieder eine <code>Student</code>-Liste als Parameter bekommt und liefern sie das erste
<code>Student</code>-Objekt zurück, welches einer als Lambda-Ausdruck übergebenen Bedingung genügt.</li>
<li>Definieren Sie noch eine Methode, die wieder eine <code>Student</code>-Liste als Parameter bekommt sowie einen Lambda-Ausdruck,
welcher aus einem <code>Student</code>-Objekt ein Objekt eines anderen Typen <code>T</code> berechnet. Wenden Sie in der Methode den
Lambda-Ausdruck auf jedes Objekt der Liste an und geben sie die resultierende neue Liste als Ergebnis zurück.</li>
</ol>
<p>Verwenden Sie in dieser Aufgabe jeweils Lambda-Ausdrücke. Rufen Sie alle drei/vier Methoden an einem kleinen Beispiel auf.</p>
  </div>
</div>



    




    




    
    
        
        

        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kapitel 12: Lambda-Ausdrücke und funktionale Programmierung</em></li> <li id='id_Urma2014'>[Urma2014] <strong>Java 8 in Action: Lambdas, Streams, and Functional-Style Programming</strong><br>Urma, R.-G. und Fusco, M. und Mycroft, A., Manning Publications, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9199-9' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9199-9</a>.<br><em>Kapitel 3: Lambda Expressions, Kapitel 5: Working with streams</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Methoden-Referenzen</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Seit Java8 können <strong>Referenzen auf Methoden</strong> statt anonymer Klassen eingesetzt werden
(<strong>funktionales Interface nötig</strong>).</p>
<p>Dabei gibt es drei mögliche Formen:</p>
<ul>
<li>Form 1: Referenz auf eine statische Methode: <code>ClassName::staticMethodName</code>
(wird verwendet wie <code>(args) -&gt; ClassName.staticMethodName(args)</code>)</li>
<li>Form 2: Referenz auf eine Instanz-Methode eines Objekts: <code>objectref::instanceMethodName</code>
(wird verwendet wie <code>(args) -&gt; objectref.instanceMethodName(args)</code>)</li>
<li>Form 3: Referenz auf eine Instanz-Methode eines Typs: <code>ClassName::instanceMethodName</code>
(wird verwendet wie <code>(o1, args) -&gt; o1.instanceMethodName(args)</code>)</li>
</ul>
<p>Im jeweiligen Kontext muss ein passendes funktionales Interface verwendet werden, d.h. ein
Interface mit <strong>genau</strong> einer abstrakten Methode. Die Methoden-Referenz muss von der
Syntax her dieser einen abstrakten Methode entsprechen (bei der dritten Form wird die
Methode auf dem ersten Parameter aufgerufen).</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/z0mfvvrsRzc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Methoden-Referenzen</a></li> <li><a href='https://youtu.be/YFdPcxE_1Eo' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Referenz auf statische Methode</a></li> <li><a href='https://youtu.be/ImJTywhXrJo' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Referenz auf Instanz-Methode (Objekt)</a></li> <li><a href='https://youtu.be/DVz2x27WHU8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Referenz auf Instanz-Methode (Typ)</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/662003c5cb2cdef08b5d35cefd49b05f561fa26471cf3da22c4ff4310596909d0e21300133fc2fac353dfc4a391c8bb9af0dd47293efabfa8c3464429534d719' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Methoden-Referenzen</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Funktionales Interfaces (Definition)</li> <li>(K3) Einsatz von Methoden-Referenzen</li></ul>
  </div>
</div>




    <h2 id="beispiel-sortierung-einer-liste">Beispiel: Sortierung einer Liste</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Anonyme innere Klasse</span>
</span></span><span style="display:flex;"><span>Collections.<span style="color:#a6e22e">sort</span>(sl, <span style="color:#66d9ef">new</span> Comparator<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compare</span>(Studi o1, Studi o2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Studi.<span style="color:#a6e22e">cmpCpsClass</span>(o1, o2);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Lambda-Ausdruck</span>
</span></span><span style="display:flex;"><span>Collections.<span style="color:#a6e22e">sort</span>(sl, (o1, o2) <span style="color:#f92672">-&gt;</span> Studi.<span style="color:#a6e22e">cmpCpsClass</span>(o1, o2));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Methoden-Referenz</span>
</span></span><span style="display:flex;"><span>Collections.<span style="color:#a6e22e">sort</span>(sl, Studi::cmpCpsClass);</span></span></code></pre></div>
<h3 id="anmerkung">Anmerkung</h3>
<p>Für das obige Beispiel wird davon ausgegangen, dass in der Klasse <code>Studi</code> eine
statische Methode <code>cmpCpsClass()</code> existiert:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">cmpCpsClass</span>(Studi s1, Studi s2) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> s1.<span style="color:#a6e22e">getCps</span>() <span style="color:#f92672">-</span> s2.<span style="color:#a6e22e">getCps</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Wenn man im Lambda-Ausdruck nur Methoden der eigenen Klasse aufruft, kann man das
auch direkt per <em>Methoden-Referenz</em> abkürzen!</p>
<ul>
<li>Erinnerung: <code>Comparator&lt;T&gt;</code> ist ein funktionales Interface</li>
<li>Instanzen können wie üblich durch Ableiten bzw. anonyme Klassen erzeugt werden</li>
<li>Alternativ kann seit Java8 auch ein passender Lambda-Ausdruck verwendet werden</li>
<li>Ab Java8: Referenzen auf passende Methoden (Signatur!) können ein funktionales
Interface &quot;implementieren&quot;
<ul>
<li>Die statische Methode <code>static int cmpCpsClass(Studi s1, Studi s2)</code> hat die
selbe Signatur wie <code>int compare(Studi s1, Studi s2)</code> aus <code>Comparator&lt;Studi&gt;</code></li>
<li>Kann deshalb wie eine Instanz von <code>Comparator&lt;Studi&gt;</code> genutzt werden</li>
<li>Name der Methode spielt dabei keine Rolle</li>
</ul>
</li>
</ul>
<h2 id="überblick-arten-von-methoden-referenzen">Überblick: Arten von Methoden-Referenzen</h2>
<ol>
<li>
<p>Referenz auf eine statische Methode</p>
<ul>
<li>Form: <code>ClassName::staticMethodName</code></li>
<li>Wirkung: Aufruf mit <code>(args) -&gt; ClassName.staticMethodName(args)</code></li>
</ul>
</li>
<li>
<p>Referenz auf Instanz-Methode eines bestimmten Objekts</p>
<ul>
<li>Form: <code>objectref::instanceMethodName</code></li>
<li>Wirkung: Aufruf mit <code>(args) -&gt; objectref.instanceMethodName(args)</code></li>
</ul>
</li>
<li>
<p>Referenz auf Instanz-Methode eines bestimmten Typs</p>
<ul>
<li>Form: <code>ClassName::instanceMethodName</code></li>
<li>Wirkung: Aufruf mit <code>(arg0, rest) -&gt; arg0.instanceMethodName(rest)</code>
(<code>arg0</code> ist vom Typ <code>ClassName</code>)</li>
</ul>
</li>
</ol>
<p><em>Anmerkung</em>: Analog zur Referenz auf eine statische Methode gibt es noch die
Form der Referenz auf einen Konstruktor: <code>ClassName::new</code>. Für Referenzen auf
Konstruktoren mit mehr als 2 Parametern muss ein eigenes passendes funktionales
Interface mit entsprechend vielen Parametern definiert werden ...</p>
<h2 id="methoden-referenz-1-referenz-auf-statische-methode">Methoden-Referenz 1: Referenz auf statische Methode</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">cmpCpsClass</span>(Studi s1, Studi s2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> s1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> s2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Referenz auf statische Methode</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, Studi::cmpCpsClass);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Entsprechender Lambda-Ausdruck</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, (o1, o2) <span style="color:#f92672">-&gt;</span> Studi.<span style="color:#a6e22e">cmpCpsClass</span>(o1, o2));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/methodreferences/DemoStaticMethodReference.java" target="_blank"><span class="title">Demo: methodreferences.DemoStaticMethodReference</span></a></span></div>
<p><code>Collections.sort()</code> erwartet in diesem Szenario als zweiten Parameter eine Instanz von
<code>Comparator&lt;Studi&gt;</code> mit einer Methode <code>int compare(Studi o1, Studi o2)</code>.</p>
<p>Die übergebene Referenz auf die <strong>statische Methode <code>cmpCpsClass</code> der Klasse <code>Studi</code></strong>
hat die <strong>selbe Signatur</strong> und wird deshalb von <code>Collections.sort()</code> genauso genutzt wie
die eigentlich erwartete Methode <code>Comparator&lt;Studi&gt;#compare(Studi o1, Studi o2)</code>, d.h.
statt <code>compare(o1, o2)</code> wird nun für jeden Vergleich <strong><code>Studi.cmpCpsClass(o1, o2)</code></strong>
aufgerufen.</p>
<h2 id="methoden-referenz-2-referenz-auf-instanz-methode-objekt">Methoden-Referenz 2: Referenz auf Instanz-Methode (Objekt)</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">cmpCpsInstance</span>(Studi s1, Studi s2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> s1.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> s2.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>        Studi holger <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Holger&#34;</span>, 42);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Referenz auf Instanz-Methode eines Objekts</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, holger::cmpCpsInstance);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Entsprechender Lambda-Ausdruck</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, (o1, o2) <span style="color:#f92672">-&gt;</span> holger.<span style="color:#a6e22e">cmpCpsInstance</span>(o1, o2));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/methodreferences/DemoInstanceMethodReferenceObject.java" target="_blank"><span class="title">Demo: methodreferences.DemoInstanceMethodReferenceObject</span></a></span></div>
<p><code>Collections.sort()</code> erwartet in diesem Szenario als zweites Argument wieder eine Instanz
von <code>Comparator&lt;Studi&gt;</code> mit einer Methode <code>int compare(Studi o1, Studi o2)</code>.</p>
<p>Die übergebene Referenz auf die <strong>Instanz-Methode <code>cmpCpsInstance</code> des Objekts <code>holger</code></strong>
hat die selbe Signatur und wird entsprechend von <code>Collections.sort()</code> genauso genutzt wie
die eigentlich erwartete Methode <code>Comparator&lt;Studi&gt;#compare(Studi o1, Studi o2)</code>, d.h.
statt <code>compare(o1, o2)</code> wird nun für jeden Vergleich <strong><code>holger.cmpCpsInstance(o1, o2)</code></strong>
aufgerufen.</p>
<h2 id="methoden-referenz-3-referenz-auf-instanz-methode-typ">Methoden-Referenz 3: Referenz auf Instanz-Methode (Typ)</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">cmpCpsInstance</span>(Studi studi) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getCredits</span>() <span style="color:#f92672">-</span> studi.<span style="color:#a6e22e">getCredits</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Referenz auf Instanz-Methode eines Typs</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, Studi::cmpCpsInstance);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Entsprechender Lambda-Ausdruck</span>
</span></span><span style="display:flex;"><span>        Collections.<span style="color:#a6e22e">sort</span>(sl, (o1, o2) <span style="color:#f92672">-&gt;</span> o1.<span style="color:#a6e22e">cmpCpsInstance</span>(o2));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/methodreferences/DemoInstanceMethodReferenceType.java" target="_blank"><span class="title">Demo: methodreferences.DemoInstanceMethodReferenceType</span></a></span></div>
<p><code>Collections.sort()</code> erwartet in diesem Szenario als zweites Argument wieder eine Instanz
von <code>Comparator&lt;Studi&gt;</code> mit einer Methode <code>int compare(Studi o1, Studi o2)</code>.</p>
<p>Die übergebene Referenz auf die <strong>Instanz-Methode <code>cmpCpsInstance</code> des Typs <code>Studi</code></strong> hat
die Signatur <code>int cmpCpsInstance(Studi studi)</code> und wird von <code>Collections.sort()</code> so genutzt:
Statt <code>compare(o1, o2)</code> wird nun für jeden Vergleich <strong><code>o1.cmpCpsInstance(o2)</code></strong>
aufgerufen.</p>
<h2 id="ausblick-threads">Ausblick: Threads</h2>
<p>Erinnerung an bzw. Vorgriff auf <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-intro.html">&ldquo;Threads: Intro&rdquo;</a>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Runnable</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Damit lassen sich Threads auf verschiedene Arten erzeugen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ThreadStarter</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">wuppie</span>() { System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;wuppie(): wuppie&#34;</span>); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thread t1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Thread(<span style="color:#66d9ef">new</span> Runnable() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;t1: wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thread t2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Thread(() <span style="color:#f92672">-&gt;</span> System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;t2: wuppie&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thread t3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Thread(ThreadStarter::wuppie);</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/methodreferences/ThreadStarter.java" target="_blank"><span class="title">Beispiel: methodreferences.ThreadStarter</span></a></span></div>
<h2 id="ausblick-datenstrukturen-als-streams">Ausblick: Datenstrukturen als Streams</h2>
<p>Erinnerung an bzw. Vorgriff auf <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/stream-api.html">&ldquo;Stream-API&rdquo;</a>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">X</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">gtFour</span>(<span style="color:#66d9ef">int</span> x) { <span style="color:#66d9ef">return</span> (x <span style="color:#f92672">&gt;</span> 4) <span style="color:#f92672">?</span> <span style="color:#66d9ef">true</span> : <span style="color:#66d9ef">false</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> words <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#e6db74">&#34;Java8&#34;</span>, <span style="color:#e6db74">&#34;Lambdas&#34;</span>, <span style="color:#e6db74">&#34;PM&#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Dungeon&#34;</span>, <span style="color:#e6db74">&#34;libGDX&#34;</span>, <span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#e6db74">&#34;World&#34;</span>, <span style="color:#e6db74">&#34;Wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> wordLengths <span style="color:#f92672">=</span> words.<span style="color:#a6e22e">stream</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">map</span>(String::length)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">filter</span>(X::gtFour)
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">sorted</span>()
</span></span><span style="display:flex;"><span>        .<span style="color:#a6e22e">collect</span>(toList());</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/methodreferences/CollectionStreams.java" target="_blank"><span class="title">Beispiel: methodreferences.CollectionStreams</span></a></span></div>
<ul>
<li>Collections können als Datenstrom betrachtet werden: <code>stream()</code>
<ul>
<li>Iteration über die Collection, analog zu externer Iteration mit <code>foreach</code></li>
</ul>
</li>
<li>Daten aus dem Strom filtern: <code>filter</code>, braucht Prädikat</li>
<li>Auf alle Daten eine Funktion anwenden: <code>map</code></li>
<li>Daten im Strom sortieren: <code>sort</code> (auch mit Comparator)</li>
<li>Daten wieder einsammeln mit <code>collect</code></li>
</ul>
<p>=&gt; Typische Elemente <strong>funktionaler Programmierung</strong></p>
<p>=&gt; Verweis auf Wahlfach &quot;Spezielle Methoden der Programmierung&quot;</p>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Seit Java8: <strong>Methoden-Referenzen</strong> statt anonymer Klassen (<strong>funktionales Interface nötig</strong>)</p>
<ul>
<li>
<p>Drei mögliche Formen:</p>
<ul>
<li>Form 1: Referenz auf statische Methode: <code>ClassName::staticMethodName</code>
(verwendet wie <code>(args) -&gt; ClassName.staticMethodName(args)</code>)</li>
<li>Form 2: Referenz auf Instanz-Methode eines Objekts: <code>objectref::instanceMethodName</code>
(verwendet wie <code>(args) -&gt; objectref.instanceMethodName(args)</code>)</li>
<li>Form 3: Referenz auf Instanz-Methode eines Typs: <code>ClassName::instanceMethodName</code>
(verwendet wie <code>(o1, args) -&gt; o1.instanceMethodName(args)</code>)</li>
</ul>
</li>
<li>
<p>Im jeweiligen Kontext muss ein passendes funktionales Interface verwendet werden
(d.h. ein Interface mit <strong>genau</strong> einer abstrakten Methode)</p>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106524&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Methoden-Referenzen (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachten Sie den folgenden Java-Code:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Cat</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> gewicht;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Cat</span>(<span style="color:#66d9ef">int</span> gewicht) { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">gewicht</span> <span style="color:#f92672">=</span> gewicht; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Cat<span style="color:#f92672">&gt;</span> clouder <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(100));  clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(1));  clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(10));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        clouder.<span style="color:#a6e22e">sort</span>(...);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ol>
<li>Ergänzen Sie den Methodenaufruf <code>clouder.sort(...);</code> mit einer geeigneten
anonymen Klasse, daß der <code>clouder</code> aufsteigend nach Gewicht sortiert wird.</li>
<li>Statt einer anonymen Klasse kann man auch Lambda-Ausdrücke einsetzen. Geben
Sie eine konkrete Form an.</li>
<li>Statt einer anonymen Klasse kann man auch Methodenreferenzen einsetzen. Dafür
gibt es mehrere Formen. Geben Sie für zwei Formen der Methodenreferenz sowohl
den Aufruf als auch die Implementierung der entsprechenden Methoden in der
Klasse <code>Cat</code> an.</li>
</ol>
  </div>
</div>



    




    




    
    
        
        

        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Urma2014'>[Urma2014] <strong>Java 8 in Action: Lambdas, Streams, and Functional-Style Programming</strong><br>Urma, R.-G. und Fusco, M. und Mycroft, A., Manning Publications, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9199-9' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9199-9</a>.<br><em>Kapitel 3: Lambda Expressions, Kapitel 5: Working with streams</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Stream-API</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Mit der Collection-API existiert in Java die Möglichkeit, Daten auf verschiedenste Weisen zu
speichern (<code>Collection&lt;T&gt;</code>). Mit der Stream-API gibt es die Möglichkeit, diese Daten in einer
Art Pipeline zu verarbeiten. Ein <code>Stream&lt;T&gt;</code> ist eine Folge von Objekten vom Typ <code>T</code>. Die
Verarbeitung der Daten ist &quot;lazy&quot;, d.h. sie erfolgt erst auf Anforderung (durch die terminale
Operation).</p>
<p>Ein Stream hat eine Datenquelle und kann beispielsweise über <code>Collection#stream()</code> oder
<code>Stream.of()</code> angelegt werden. Streams speichern keine Daten. Die Daten werden aus der
verbundenen Datenquelle geholt.</p>
<p>Auf einem Stream kann man eine Folge von intermediären Operationen wie <code>peek()</code>, <code>map()</code>,
<code>flatMap()</code>, <code>filter()</code>, <code>sorted()</code> ... durchführen. Alle diese Operationen arbeiten auf
dem Stream und erzeugen einen neuen Stream als Ergebnis. Dadurch kann die typische
Pipeline-artige Verkettung der Operationen ermöglicht werden. Die intermediären Operationen
werden erst ausgeführt, wenn der Stream durch eine terminale Operation geschlossen wird.</p>
<p>Terminale Operationen wie <code>count()</code>, <code>forEach()</code>, <code>allMatch()</code> oder <code>collect()</code></p>
<ul>
<li><code>collect(Collectors.toList())</code> (bzw. direkt mit <code>stream.toList()</code> (ab Java16))</li>
<li><code>collect(Collectors.toSet())</code></li>
<li><code>collect(Collectors.toCollection(LinkedList::new))</code> (als <code>Supplier&lt;T&gt;</code>)</li>
</ul>
<p>stoßen die Verarbeitung des Streams an und schließen den Stream damit ab.</p>
<p>Wir können hier nur die absoluten Grundlagen betrachten. Die Stream-API ist sehr groß und
mächtig und lohnt die weitere selbstständige Auseinandersetzung :-)</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/zZMyk0u5hJk' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Stream-API</a></li> <li><a href='https://youtu.be/KBP72tCkBt8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Stream-API</a></li> <li><a href='https://youtu.be/jzEw8IH8Mfc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Vordefinierte funktionale Interfaces im JDK</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/429bb37eaea02582785bfb46a92d68a3ed76cb18bdc98ec0f04ae438cecf82a595e1e46947d2ffcc2fd868d67ca1ed3beba73f216ae4886f2a9492167c006784' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Stream-API</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Streams speichern keine Daten</li> <li>(K2) Streams verarbeiten die Daten lazy</li> <li>(K2) <code>map()</code> ändert den Typ (und Inhalt) von Objekten im Stream, aber nicht die Anzahl</li> <li>(K2) <code>filter()</code> ändert die Anzahl der Objekte im Stream, aber nicht deren Typ (und Inhalt)</li> <li>(K2) Streams machen ausführlich Gebrauch von den funktionalen Interfaces in <code>java.util.function</code></li> <li>(K2) Streams sollten nicht in Attributen gehalten oder als Argument von Methoden herumgereicht werden</li> <li>(K3) Anlegen eines Streams</li> <li>(K3) Verkettung von intermediären Operationen</li> <li>(K3) Durchführung der Berechnung und Abschluss des Streams mit einer terminalen Operation</li> <li>(K3) Einsatz von <code>flatMap()</code></li></ul>
  </div>
</div>




    <h2 id="motivation">Motivation</h2>
<p>Es wurden Studis, Studiengänge und Fachbereiche modelliert (aus Gründen der Übersichtlichkeit
einfach als Record-Klassen).</p>
<p>Nun soll pro Fachbereich die Anzahl der Studis ermittelt werden, die bereits 100 ECTS
oder mehr haben. Dazu könnte man über alle Studiengänge im Fachbereich iterieren, und
in der inneren Schleife über alle Studis im Studiengang. Dann filtert man alle Studis,
deren ECTS größer 100 sind und erhöht jeweils den Zähler:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">Studi</span>(String name, <span style="color:#66d9ef">int</span> credits) {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">Studiengang</span>(String name, List<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> studis) {}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">Fachbereich</span>(String name, List<span style="color:#f92672">&lt;</span>Studiengang<span style="color:#f92672">&gt;</span> studiengaenge) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountFB</span>(Fachbereich fb) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span> count <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (Studiengang sg : fb.<span style="color:#a6e22e">studiengaenge</span>()) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Studi s : sg.<span style="color:#a6e22e">studis</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (s.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&gt;</span> 100) count <span style="color:#f92672">+=</span> 1;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> count;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Dies ist ein Beispiel, welches klassisch in OO-Manier als Iteration über Klassen
realisiert ist. (Inhaltlich ist es vermutlich nicht sooo sinnvoll.)</p>
<h2 id="innere-schleife-mit-streams-umgeschrieben">Innere Schleife mit Streams umgeschrieben</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountSG</span>(Studiengang sg) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> sg.<span style="color:#a6e22e">studis</span>().<span style="color:#a6e22e">stream</span>()
</span></span><span style="display:flex;"><span>                      .<span style="color:#a6e22e">map</span>(Studi::credits)
</span></span><span style="display:flex;"><span>                      .<span style="color:#a6e22e">filter</span>(c <span style="color:#f92672">-&gt;</span> c <span style="color:#f92672">&gt;</span> 100)
</span></span><span style="display:flex;"><span>                      .<span style="color:#a6e22e">count</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountFB2</span>(Fachbereich fb) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span> count <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (Studiengang sg : fb.<span style="color:#a6e22e">studiengaenge</span>()) {
</span></span><span style="display:flex;"><span>        count <span style="color:#f92672">+=</span> getCountSG(sg);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> count;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="erklärung-des-beispiels">Erklärung des Beispiels</h3>
<p>Im Beispiel wurde die innere Schleife in einen Stream ausgelagert.</p>
<p>Mit der Methode <code>Collection#stream()</code> wird aus der Collection ein
neuer Stream erzeugt. Auf diesem wird für jedes Element durch die
Methode <code>map()</code> die Methode <code>Studi#credits()</code> angewendet, was aus
einem Strom von <code>Studi</code> einen Strom von <code>Integer</code> macht. Mit <code>filter()</code>
wird auf jedes Element das Prädikat <code>c -&gt; c &gt; 100</code> angewendet und
alle Elemente aus dem Strom entfernt, die der Bedingung nicht
entsprechen. Am Ende wird mit <code>count()</code> gezählt, wie viele Elemente
im Strom enthalten sind.</p>
<h3 id="was-ist-ein-stream">Was ist ein Stream?</h3>
<p>Ein &quot;Stream&quot; ist ein Strom (Folge) von Daten oder Objekten. In Java wird
die Collections-API für die Speicherung von Daten (Objekten) verwendet.
Die Stream-API dient zur Iteration über diese Daten und entsprechend
zur Verarbeitung der Daten. In Java speichert ein Stream keine Daten.</p>
<p>Das Konzept kommt aus der funktionalen Programmierung und wurde in Java
nachträglich eingebaut (wobei dieser Prozess noch lange nicht abgeschlossen
zu sein scheint).</p>
<p>In der funktionalen Programmierung kennt man die Konzepte &quot;map&quot;, &quot;filter&quot;
und &quot;reduce&quot;: Die Funktion &quot;map()&quot; erhält als Parameter eine Funktion und
wendet diese auf alle Elemente eines Streams an. Die Funktion &quot;filter()&quot;
bekommt ein Prädikat als Parameter und prüft jedes Element im Stream, ob
es dem Prädikat genügt (also ob das Prädikat mit dem jeweiligen Element
zu <code>true</code> evaluiert - die anderen Objekte werden entfernt). Mit &quot;reduce()&quot;
kann man Streams zu einem einzigen Wert zusammenfassen (denken Sie etwa
an das Aufsummieren aller Elemente eines Integer-Streams). Zusätzlich kann
man in der funktionalen Programmierung ohne Probleme unendliche Ströme
darstellen: Die Auswertung erfolgt nur bei Bedarf und auch dann auch nur
so weit wie nötig. Dies nennt man auch &quot;<em>lazy evaluation</em>&quot;.</p>
<p>Die Streams in Java versuchen, diese Konzepte aus der funktionalen Programmierung
in die objektorientierte Programmierung zu übertragen. Ein Stream in Java
hat eine Datenquelle, von wo die Daten gezogen werden - ein Stream speichert
selbst keine Daten. Es gibt &quot;intermediäre Operationen&quot; auf einem Stream,
die die Elemente verarbeiten und das Ergebnis als Stream zurückliefern. Daraus
ergibt sich typische Pipeline-artige Verkettung der Operationen. Allerdings
werden diese Operationen erst durchgeführt, wenn eine &quot;terminale Operation&quot; den
Stream &quot;abschließt&quot;. Ein Stream ohne eine terminale Operation macht also
tatsächlich <em>nichts</em>.</p>
<p>Die Operationen auf dem Stream sind üblicherweise zustandslos, können aber
durchaus auch einen Zustand haben. Dies verhindert üblicherweise die parallele
Verarbeitung der Streams. Operationen sollten aber nach Möglichkeit keine
<em>Seiteneffekte</em> haben, d.h. keine Daten außerhalb des Streams modifizieren.
Operationen dürfen auf keinen Fall die Datenquelle des Streams modifizieren!</p>
<h2 id="erzeugen-von-streams">Erzeugen von Streams</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> l1 <span style="color:#f92672">=</span> List.<span style="color:#a6e22e">of</span>(<span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#e6db74">&#34;World&#34;</span>, <span style="color:#e6db74">&#34;foo&#34;</span>, <span style="color:#e6db74">&#34;bar&#34;</span>, <span style="color:#e6db74">&#34;wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>Stream<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s1 <span style="color:#f92672">=</span> l1.<span style="color:#a6e22e">stream</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Stream<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s2 <span style="color:#f92672">=</span> Stream.<span style="color:#a6e22e">of</span>(<span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#e6db74">&#34;World&#34;</span>, <span style="color:#e6db74">&#34;foo&#34;</span>, <span style="color:#e6db74">&#34;bar&#34;</span>, <span style="color:#e6db74">&#34;wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Random random <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Random();
</span></span><span style="display:flex;"><span>Stream<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> s3 <span style="color:#f92672">=</span> Stream.<span style="color:#a6e22e">generate</span>(random::nextInt);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Pattern pattern <span style="color:#f92672">=</span> Pattern.<span style="color:#a6e22e">compile</span>(<span style="color:#e6db74">&#34; &#34;</span>);
</span></span><span style="display:flex;"><span>Stream<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s4 <span style="color:#f92672">=</span> pattern.<span style="color:#a6e22e">splitAsStream</span>(<span style="color:#e6db74">&#34;Hello world! foo bar wuppie!&#34;</span>);</span></span></code></pre></div>
<p>Dies sind möglicherweise die wichtigsten Möglichkeiten, in Java einen Stream
zu erzeugen.</p>
<p>Ausgehend von einer Klasse aus der Collection-API kann man die Methode
<code>Collection#stream()</code> aufrufen und bekommt einen seriellen Stream.</p>
<p>Alternativ bietet das Interface <code>Stream</code> verschiedene statische Methoden wie
<code>Stream.of()</code> an, mit deren Hilfe Streams angelegt werden können. Dies funktioniert
auch mit Arrays ...</p>
<p>Und schließlich kann man per <code>Stream.generate()</code> einen Stream anlegen, wobei
als Argument ein &quot;Supplier&quot; (Interface <code>java.util.function.Supplier&lt;T&gt;</code>) übergeben
werden muss. Dieses Argument wird dann benutzt, um die Daten für den Stream zu
generieren.</p>
<p>Wenn man aufmerksam hinschaut, findet man an verschiedensten Stellen die
Möglichkeit, die Daten per Stream zu verarbeiten, u.a. bei regulären Ausdrücken.</p>
<p>Man kann per <code>Collection#parallelStream()</code> auch parallele Streams erzeugen, die
intern das &quot;Fork&amp;Join-Framework&quot; nutzen. Allerdings sollte man nur dann parallele
Streams anlegen, wenn dadurch tatsächlich Vorteile durch die Parallelisierung zu
erwarten sind (Overhead!).</p>
<h2 id="intermediäre-operationen-auf-streams">Intermediäre Operationen auf Streams</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">dummy</span>(Studiengang sg) {
</span></span><span style="display:flex;"><span>    sg.<span style="color:#a6e22e">studis</span>().<span style="color:#a6e22e">stream</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">peek</span>(s <span style="color:#f92672">-&gt;</span> System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Looking at: &#34;</span> <span style="color:#f92672">+</span> s.<span style="color:#a6e22e">name</span>()))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">map</span>(Studi::credits)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">peek</span>(c <span style="color:#f92672">-&gt;</span> System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;This one has: &#34;</span> <span style="color:#f92672">+</span> c <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; ECTS&#34;</span>))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">filter</span>(c <span style="color:#f92672">-&gt;</span> c <span style="color:#f92672">&gt;</span> 5)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">peek</span>(c <span style="color:#f92672">-&gt;</span> System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Filtered: &#34;</span> <span style="color:#f92672">+</span> c))
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">sorted</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">forEach</span>(System.<span style="color:#a6e22e">out</span>::println);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>An diesem (weitestgehend sinnfreien) Beispiel werden einige intermediäre Operationen
demonstriert.</p>
<p>Die Methode <code>peek()</code> liefert einen Stream zurück, die aus den Elementen des Eingabestroms
bestehen. Auf jedes Element wird die Methode <code>void accept(T)</code> des <code>Consumer&lt;T&gt;</code> angewendet
(Argument der Methode), was aber nicht zu einer Änderung der Daten führt.
<strong>Hinweis</strong>: Diese Methode dient vor allem zu Debug-Zwecken! Durch den Seiteneffekt kann
die Methode eine schlechtere Laufzeit zur Folge haben oder sogar eine sonst mögliche
parallele Verarbeitung verhindern oder durch eine parallele Verarbeitung verwirrende
Ergebnisse zeigen!</p>
<p>Die Methode <code>map()</code> liefert ebenfalls einen Stream zurück, der durch die Anwendung der Methode
<code>R apply(T)</code> der als Argument übergebenen <code>Function&lt;T,R&gt;</code> auf jedes Element des Eingabestroms
entsteht. Damit lassen sich die Elemente des ursprünglichen Streams verändern; für jedes Element
gibt es im Ergebnis-Stream ebenfalls ein Element (der Typ ändert sich, aber nicht die Anzahl
der Elemente).</p>
<p>Mit der Methode <code>filter()</code> wird ein Stream erzeugt, der alle Objekte des Eingabe-Streams
enthält, auf denen die Anwendung der Methode <code>boolean test(T)</code> des Arguments <code>Predicate&lt;T&gt;</code>
zu <code>true</code> evaluiert (der Typ und Inhalt der Elemente ändert sich nicht, aber die Anzahl der
Elemente).</p>
<p>Mit <code>sorted()</code> wird ein Stream erzeugt, der die Elemente des Eingabe-Streams sortiert
(existiert auch mit einem <code>Comparator&lt;T&gt;</code> als Parameter).</p>
<p>Diese Methoden sind alles <strong>intermediäre</strong> Operationen. Diese arbeiten auf einem Stream und
erzeugen einen neuen Stream und werden erst dann ausgeführt, wenn eine terminale Operation den
Stream abschließt.</p>
<p>Dabei sind die gezeigten intermediären Methoden bis auf <code>sorted()</code> ohne inneren Zustand.
<code>sorted()</code> ist eine Operation mit innerem Zustand (wird für das Sortieren benötigt). Dies
kann ordentlich in Speicher und Zeit zuschlagen und u.U. nicht/nur schlecht parallelisierbar
sein. Betrachten Sie den fiktiven parallelen Stream <code>stream.parallel().sorted().skip(42)</code>:
Hier müssen erst <em>alle</em> Elemente sortiert werden, bevor mit <code>skip(42)</code> die ersten 42 Elemente
entfernt werden. Dies kann auch nicht mehr parallel durchgeführt werden.</p>
<p>Die Methode <code>forEach()</code> schließlich ist eine <strong>terminale</strong> Operation, die auf jedes Element des
Eingabe-Streams die Methode <code>void accept(T)</code> des übergebenen <code>Consumer&lt;T&gt;</code> anwendet. Diese
Methode ist eine <strong>terminale Operation</strong>, d.h. sie führt zur Auswertung der anderen <em>intermediären</em>
Operationen und schließt den Stream ab.</p>
<h2 id="was-tun-wenn-eine-methode-streams-zurückliefert">Was tun, wenn eine Methode Streams zurückliefert</h2>
<p>Wir konnten vorhin nur die innere Schleife in eine Stream-basierte Verarbeitung
umbauen. Das Problem ist: Die äußere Schleife würde einen Stream liefern (Stream
von Studiengängen), auf dem wir die <code>map</code>-Funktion anwenden müssten und darin dann
für jeden Studiengang einen (inneren) Stream mit den Studis eines Studiengangs
verarbeiten müssten.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountSG</span>(Studiengang sg) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> sg.<span style="color:#a6e22e">studis</span>().<span style="color:#a6e22e">stream</span>().<span style="color:#a6e22e">map</span>(Studi::credits).<span style="color:#a6e22e">filter</span>(c <span style="color:#f92672">-&gt;</span> c <span style="color:#f92672">&gt;</span> 100).<span style="color:#a6e22e">count</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountFB2</span>(Fachbereich fb) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span> count <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (Studiengang sg : fb.<span style="color:#a6e22e">studiengaenge</span>()) {
</span></span><span style="display:flex;"><span>        count <span style="color:#f92672">+=</span> getCountSG(sg);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> count;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Dafür ist die Methode <code>flatMap()</code> die Lösung. Diese Methode bekommt als Argument
ein Objekt vom Typ <code>Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt;</code> mit einer
Methode <code>Stream&lt;? extends R&gt; apply(T)</code>. Die Methode <code>flatMap()</code> verarbeitet den
Stream in zwei Schritten:</p>
<ol>
<li>
<p>Mappe über alle Elemente des Eingabe-Streams mit der Funktion. Im Beispiel würde
also aus einem <code>Stream&lt;Studiengang&gt;</code> jeweils ein <code>Stream&lt;Stream&lt;Studi&gt;&gt;</code>, also
alle <code>Studiengang</code>-Objekte werden durch je ein <code>Stream&lt;Studi&gt;</code>-Objekt ersetzt.
Wir haben jetzt also einen Stream von <code>Stream&lt;Studi&gt;</code>-Objekten.</p>
</li>
<li>
<p>&quot;Klopfe den Stream wieder flach&quot;, d.h. nimm die einzelnen <code>Studi</code>-Objekte aus
den <code>Stream&lt;Studi&gt;</code>-Objekten und setze diese stattdessen in den Stream. Das
Ergebnis ist dann wie gewünscht ein <code>Stream&lt;Studi&gt;</code> (Stream mit <code>Studi</code>-Objekten).</p>
</li>
</ol>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountFB3</span>(Fachbereich fb) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> fb.<span style="color:#a6e22e">studiengaenge</span>().<span style="color:#a6e22e">stream</span>()
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">flatMap</span>(sg <span style="color:#f92672">-&gt;</span> sg.<span style="color:#a6e22e">studis</span>().<span style="color:#a6e22e">stream</span>())
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">map</span>(Studi::credits)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">filter</span>(c <span style="color:#f92672">-&gt;</span> c <span style="color:#f92672">&gt;</span> 100)
</span></span><span style="display:flex;"><span>            .<span style="color:#a6e22e">count</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Zum direkten Vergleich hier noch einmal der ursprüngliche Code mit zwei
verschachtelten Schleifen und entsprechenden Hilfsvariablen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">getCountFB</span>(Fachbereich fb) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span> count <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (Studiengang sg : fb.<span style="color:#a6e22e">studiengaenge</span>()) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Studi s : sg.<span style="color:#a6e22e">studis</span>()) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (s.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&gt;</span> 100) count <span style="color:#f92672">+=</span> 1;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> count;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="streams-abschließen-terminale-operationen">Streams abschließen: Terminale Operationen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Stream<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s <span style="color:#f92672">=</span> Stream.<span style="color:#a6e22e">of</span>(<span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#e6db74">&#34;World&#34;</span>, <span style="color:#e6db74">&#34;foo&#34;</span>, <span style="color:#e6db74">&#34;bar&#34;</span>, <span style="color:#e6db74">&#34;wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">long</span> count <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">count</span>();
</span></span><span style="display:flex;"><span>s.<span style="color:#a6e22e">forEach</span>(System.<span style="color:#a6e22e">out</span>::println);
</span></span><span style="display:flex;"><span>String first <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">findFirst</span>().<span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>Boolean b <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">anyMatch</span>(e <span style="color:#f92672">-&gt;</span> e.<span style="color:#a6e22e">length</span>() <span style="color:#f92672">&gt;</span> 3);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s1 <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">collect</span>(Collectors.<span style="color:#a6e22e">toList</span>());
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s2 <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">toList</span>();   <span style="color:#75715e">// ab Java16</span>
</span></span><span style="display:flex;"><span>Set<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s3 <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">collect</span>(Collectors.<span style="color:#a6e22e">toSet</span>());
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> s4 <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">collect</span>(Collectors.<span style="color:#a6e22e">toCollection</span>(LinkedList::<span style="color:#66d9ef">new</span>));</span></span></code></pre></div>
<p>Streams müssen mit <strong><em>einer</em> terminalen Operation</strong> abgeschlossen werden, damit die Verarbeitung
tatsächlich angestoßen wird (<em>lazy evaluation</em>).</p>
<p>Es gibt viele verschiedene terminale Operationen. Wir haben bereits <code>count()</code> und <code>forEach()</code>
gesehen. In der Sitzung zu <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional.html">&ldquo;Optionals&rdquo;</a>
werden wir noch <code>findFirst()</code> näher kennenlernen.</p>
<p>Daneben gibt es beispielsweise noch <code>allMatch()</code>, <code>anyMatch()</code> und <code>noneMatch()</code>, die jeweils
ein Prädikat testen und einen Boolean zurückliefern (matchen alle, mind. eines oder keines der
Objekte im Stream).</p>
<p>Mit <code>min()</code> und <code>max()</code> kann man sich das kleinste und das größte Element des Streams liefern
lassen. Beide Methoden benötigen dazu einen <code>Comparator&lt;T&gt;</code> als Parameter.</p>
<p>Mit der Methode <code>collect()</code> kann man eine der drei Methoden aus <code>Collectors</code> über den Stream
laufen lassen und eine <code>Collection</code> erzeugen lassen:</p>
<ol>
<li><code>toList()</code> sammelt die Elemente in ein <code>List</code>-Objekt (bzw. direkt mit <code>stream.toList()</code> (ab Java16))</li>
<li><code>toSet()</code> sammelt die Elemente in ein <code>Set</code>-Objekt</li>
<li><code>toCollection()</code> sammelt die Elemente durch Anwendung der Methode <code>T get()</code> des übergebenen
<code>Supplier&lt;T&gt;</code>-Objekts auf</li>
</ol>
<p>Die ist nur die sprichwörtliche &quot;Spitze des Eisbergs&quot;! Es gibt viele weitere Möglichkeiten, sowohl
bei den intermediären als auch den terminalen Operationen. Schauen Sie in die Dokumentation!</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/streams/Demo.java" target="_blank"><span class="title">Demo: streams.Demo</span></a></span></div>
<h2 id="spielregeln">Spielregeln</h2>
<ul>
<li>
<p>Operationen dürfen nicht die Stream-Quelle modifizieren</p>
</li>
<li>
<p>Operationen können die Werte im Stream ändern (<code>map</code>) oder die Anzahl (<code>filter</code>)</p>
</li>
<li>
<p>Keine Streams in Attributen/Variablen speichern oder als Argumente übergeben: Sie könnten bereits &quot;gebraucht&quot; sein!</p>
<p>=&gt; Ein Stream sollte immer sofort nach der Erzeugung benutzt werden</p>
</li>
<li>
<p>Operationen auf einem Stream sollten keine Seiteneffekte (Veränderungen von Variablen/Attributen außerhalb des Streams) haben
(dies verhindert u.U. die parallele Verarbeitung)</p>
</li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<p><code>Stream&lt;T&gt;</code>: Folge von Objekten vom Typ <code>T</code>, Verarbeitung &quot;lazy&quot;
(Gegenstück zu <code>Collection&lt;T&gt;</code>: Dort werden Daten <strong>gespeichert</strong>, hier werden Daten <strong>verarbeitet</strong>)</p>
<ul>
<li>
<p>Neuen Stream anlegen: <code>Collection#stream()</code> oder <code>Stream.of()</code> ...</p>
</li>
<li>
<p>Intermediäre Operationen: <code>peek()</code>, <code>map()</code>, <code>flatMap()</code>, <code>filter()</code>, <code>sorted()</code> ...</p>
</li>
<li>
<p>Terminale Operationen: <code>count()</code>, <code>forEach()</code>, <code>allMatch()</code>, <code>collect()</code> ...</p>
<ul>
<li><code>collect(Collectors.toList())</code></li>
<li><code>collect(Collectors.toSet())</code></li>
<li><code>collect(Collectors.toCollection())</code> (mit <code>Supplier&lt;T&gt;</code>)</li>
</ul>
</li>
<li>
<p>Streams speichern keine Daten</p>
</li>
<li>
<p>Intermediäre Operationen laufen erst bei Abschluss des Streams los</p>
</li>
<li>
<p>Terminale Operation führt zur Verarbeitung und Abschluss des Streams</p>
</li>
</ul>
<p>Schöne Doku: <a href="https://dev.java/learn/api/streams/" rel="external" target="_blank">&quot;The Stream API&quot;</a>, und auch
<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/stream/package-summary.html" rel="external" target="_blank">&quot;Package java.util.stream&quot;</a>.</p>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106528&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Stream-API (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachten Sie den folgenden Java-Code:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">record</span> <span style="color:#a6e22e">Cat</span>(<span style="color:#66d9ef">int</span> weight){};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Cat<span style="color:#f92672">&gt;</span> clouder <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(100));  clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(1));  clouder.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> Cat(10));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        sumOverWeight(8, clouder);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sumOverWeight</span>(<span style="color:#66d9ef">int</span> threshold, List<span style="color:#f92672">&lt;</span>Cat<span style="color:#f92672">&gt;</span> cats) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> result <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Cat c : cats) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">int</span> weight <span style="color:#f92672">=</span> c.<span style="color:#a6e22e">weight</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (weight <span style="color:#f92672">&gt;</span> threshold) {
</span></span><span style="display:flex;"><span>                result <span style="color:#f92672">+=</span> weight;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Schreiben Sie die Methode <code>sumOverWeight</code> unter Beibehaltung der Funktionalität so
um, dass statt der <code>for</code>-Schleife und der <code>if</code>-Abfrage Streams und Stream-Operationen
eingesetzt werden. Nutzen Sie passende Lambda-Ausdrücke und nach Möglichkeit
Methodenreferenzen.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_LernJava'>[LernJava] <a href='https://dev.java/learn/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Learn Java</strong></a><br>Oracle Corporation, 2022.<br><em>Tutorials \> The Stream API</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kap. 17.3 - 17.6: Java Stream-API</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Record-Klassen</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Häufig schreibt man relativ viel <em>Boiler Plate Code</em>, um einfach ein paar Daten plus den
Konstruktor und die Zugriffsmethoden zu kapseln. Und selbst wenn die IDE dies zum Teil
abnehmen kann - lesen muss man diesen Overhead trotzdem noch.</p>
<p>Für den Fall von Klassen mit <code>final</code> Attributen wurden in Java14 die <strong>Record-Klassen</strong>
eingeführt. Statt dem Schlüsselwort <code>class</code> wird das neue Schlüsselwort <code>record</code> verwendet.
Nach dem Klassennamen kommen in runden Klammern die &quot;Komponenten&quot; - eine Auflistung der
Parameter für den Standardkonstruktor (Typ, Name). Daraus wird automatisch ein &quot;kanonischer
Konstruktor&quot; mit exakt diesen Parametern generiert. Es werden zusätzlich <code>private final</code>
Attribute generiert für jede Komponente, und diese werden durch den kanonischen Konstruktor
gesetzt. Außerdem wird für jedes Attribut automatisch ein Getter mit dem Namen des Attributs
generiert (also ohne den Präfix &quot;get&quot;).</p>
<p>Beispiel:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiR</span>(String name, <span style="color:#66d9ef">int</span> credits) {}</span></span></code></pre></div>
<p>Der Konstruktor und die Getter können überschrieben werden, es können auch eigene Methoden
definiert werden (eigene Konstruktoren <em>müssen</em> den kanonischen Konstruktor aufrufen). Es
gibt außer den über die Komponenten definierten Attribute keine weiteren Attribute. Da eine
Record-Klasse intern von <code>java.lang.Record</code> ableitet, kann eine Record-Klasse nicht von
weiteren Klassen ableiten (erben). Man kann aber beliebig viele Interfaces implementieren.
Record-Klassen sind implizit final, d.h. man nicht von Record-Klassen erben.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/5RMhdCsZL6Y' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Record-Klassen</a></li> <li><a href='https://youtu.be/jWBAXWH0MUc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Record-Klassen</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/461caa1e97e1655109ce66647c169cf01b35d4b268bfaa64a6289c505f247a5ebfde054a98b08a1b5235195ff21b1fffa4d12e3968c7a68a0f001b0dabe6b695' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Record-Klassen</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Record-Klassen sind final</li> <li>(K2) Record-Klassen haben einen kanonischen Konstruktor</li> <li>(K2) Die Attribute von Record-Klassen sind final und werden automatisch angelegt und über den Konstruktor gesetzt</li> <li>(K2) Die Getter in Record-Klassen haben die Namen und Typen der Komponenten, also keinen Präfix 'get'</li> <li>(K2) Der kanonische Konstruktor kann ergänzt werden</li> <li>(K2) Es können weitere Methoden definiert werden</li> <li>(K2) Record-Klassen können nicht von anderen Klassen erben, können aber Interfaces implementieren</li> <li>(K3) Einsatz von Record-Klassen</li></ul>
  </div>
</div>




    <h2 id="motivation-klasse-studi">Motivation; Klasse Studi</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> String name;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> credits;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Studi</span>(String name, <span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">=</span> credits;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getName</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> name;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getCredits</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> credits;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="klasse-studi-als-record">Klasse Studi als Record</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiR</span>(String name, <span style="color:#66d9ef">int</span> credits) {}</span></span></code></pre></div>
<ul>
<li>
<p>Immutable Klasse mit Feldern <code>String name</code> und <code>int credits</code>
=&gt; &quot;<code>(String name, int credits)</code>&quot; werden &quot;Komponenten&quot; des Records genannt</p>
</li>
<li>
<p>Standardkonstruktor setzt diese Felder (&quot;Kanonischer Konstruktor&quot;)</p>
</li>
<li>
<p>Getter für beide Felder:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">name</span>() { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span>; }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">credits</span>() { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span>; }</span></span></code></pre></div>
</li>
</ul>
<p>Record-Klassen wurden in Java14 eingeführt und werden immer wieder in
neuen Releases erweitert/ergänzt.</p>
<p>Der kanonische Konstruktor hat das Aussehen wie die Record-Deklaration, im
Beispiel also <code>public StudiR(String name, int credits)</code>. Dabei werden die
Komponenten über eine Kopie der Werte initialisiert.</p>
<p>Für die Komponenten werden automatisch private Attribute mit dem selben
Namen angelegt.</p>
<p>Für die Komponenten werden automatisch Getter angelegt. Achtung: Die Namen
entsprechen denen der Komponenten, es fehlt also der übliche &quot;get&quot;-Präfix!</p>
<h2 id="eigenschaften-und-einschränkungen-von-record-klassen">Eigenschaften und Einschränkungen von Record-Klassen</h2>
<ul>
<li>
<p>Records erweitern implizit die Klasse <code>java.lang.Record</code>:
Keine andere Klassen mehr erweiterbar! (Interfaces kein Problem)</p>
</li>
<li>
<p>Record-Klassen sind implizit final</p>
</li>
<li>
<p>Keine weiteren (Instanz-) Attribute definierbar (nur die Komponenten)</p>
</li>
<li>
<p>Keine Setter definierbar für die Komponenten: Attribute sind final</p>
</li>
<li>
<p>Statische Attribute mit Initialisierung erlaubt</p>
</li>
</ul>
<h2 id="records-prüfungen-im-konstruktor">Records: Prüfungen im Konstruktor</h2>
<p>Der Konstruktor ist erweiterbar:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiS</span>(String name, <span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">StudiS</span>(String name, <span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (name <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) { <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException(<span style="color:#e6db74">&#34;Name cannot be null!&#34;</span>); }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (credits <span style="color:#f92672">&lt;</span> 0) { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">=</span> 0; }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">=</span> credits; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>In dieser Form muss man die Attribute selbst setzen.</p>
<p>Alternativ kann man die &quot;kompakte&quot; Form nutzen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiT</span>(String name, <span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> StudiT {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (name <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) { <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException(<span style="color:#e6db74">&#34;Name cannot be null!&#34;</span>); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (credits <span style="color:#f92672">&lt;</span> 0) { credits <span style="color:#f92672">=</span> 0; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>In der kompakten Form kann man nur die Werte der Parameter des Konstruktors ändern.
Das Setzen der Attribute ergänzt der Compiler nach dem eigenen Code.</p>
<p>Es sind weitere Konstruktoren definierbar, diese <em>müssen</em> den kanonischen Konstruktor
aufrufen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#a6e22e">StudiT</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>(<span style="color:#e6db74">&#34;&#34;</span>, 42);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="getter-und-methoden">Getter und Methoden</h2>
<p>Getter werden vom Compiler automatisch generiert. Dabei entsprechen die Methoden-Namen
den Namen der Attribute:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiR</span>(String name, <span style="color:#66d9ef">int</span> credits) {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>    StudiR r <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StudiR(<span style="color:#e6db74">&#34;Sabine&#34;</span>, 75);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> r.<span style="color:#a6e22e">credits</span>();
</span></span><span style="display:flex;"><span>    String y <span style="color:#f92672">=</span> r.<span style="color:#a6e22e">name</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Getter überschreibbar und man kann weitere Methoden definieren:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">record</span> <span style="color:#a6e22e">StudiT</span>(String name, <span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">credits</span>() { <span style="color:#66d9ef">return</span> credits <span style="color:#f92672">+</span> 42; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">wuppie</span>() { System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;WUPPIE&#34;</span>); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Die Komponenten/Attribute sind aber <code>final</code> und können nicht über Methoden
geändert werden!</p>
<h2 id="beispiel-aus-den-challenges">Beispiel aus den Challenges</h2>
<p>In den Challenges zum Thema Optional gibt es die Klasse <code>Katze</code> in den
<a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/challenges/optional/Katze.java" rel="external" target="_blank">Vorgaben</a>.</p>
<p>Die Katze wurde zunächst &quot;klassisch&quot; modelliert: Es gibt drei Eigenschaften <code>name</code>,
<code>gewicht</code>und <code>lieblingsBox</code>. Ein Konstruktor setzt diese Felder und es gibt drei
Getter für die einzelnen Eigenschaften. Das braucht 18 Zeilen Code (ohne Kommentare
Leerzeilen). Zudem erzeugt der Boilerplate-Code relativ viel &quot;visual noise&quot;, so dass
der eigentliche Kern der Klasse schwerer zu erkennen ist.</p>
<p>In einem Refactoring wurde diese Klasse durch eine äquivalente Record-Klasse ersetzt,
die nur noch 2 Zeilen Code (je nach Code-Style auch nur 1 Zeile) benötigt. Gleichzeitig
wurde die Les- und Wartbarkeit deutlich verbessert.</p>
<p><a href="#R-image-36b5cdd9166cc337a2e7724bf5f2bd71" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/records/screenshot_katze.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-36b5cdd9166cc337a2e7724bf5f2bd71"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/records/screenshot_katze.png?width=auto&height=auto"></a></p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>Records sind immutable Klassen:
<ul>
<li><code>final</code> Attribute (entsprechend den Komponenten)</li>
<li>Kanonischer Konstruktor</li>
<li>Automatische Getter (Namen wie Komponenten)</li>
</ul>
</li>
<li>Konstruktoren und Methoden können ergänzt/überschrieben werden</li>
<li>Keine Vererbung von Klassen möglich (kein <code>extends</code>)</li>
</ul>
<p>Schöne Doku: <a href="https://dev.java/learn/using-record-to-model-immutable-data/" rel="external" target="_blank">&quot;Using Record to Model Immutable Data&quot;</a>.</p>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106527&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Record-Klassen (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachen Sie den folgenden Code:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Person</span> {
</span></span><span style="display:flex;"><span>    String <span style="color:#a6e22e">getName</span>();
</span></span><span style="display:flex;"><span>    Date <span style="color:#a6e22e">getBirthday</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span> <span style="color:#66d9ef">implements</span> Person {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> SimpleDateFormat DATE_FORMAT <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> SimpleDateFormat(<span style="color:#e6db74">&#34;dd.MM.yyyy&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> String name;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Date birthday;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Student</span>(String name, String birthday) <span style="color:#66d9ef">throws</span> ParseException {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">birthday</span> <span style="color:#f92672">=</span> DATE_FORMAT.<span style="color:#a6e22e">parse</span>(birthday);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getName</span>() { <span style="color:#66d9ef">return</span> name; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Date <span style="color:#a6e22e">getBirthday</span>() { <span style="color:#66d9ef">return</span> birthday; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Schreiben Sie die Klasse <code>Student</code> in eine Record-Klasse um. Was müssen Sie zusätzlich noch tun,
damit die aktuelle API erhalten bleibt?</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_LernJava'>[LernJava] <a href='https://dev.java/learn/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Learn Java</strong></a><br>Oracle Corporation, 2022.<br><em>Tutorials \> Using Record to Model Immutable Data</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Optional</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Häufig hat man in Methoden den Fall, dass es keinen Wert gibt, und man liefert dann
<code>null</code> als &quot;kein Wert vorhanden&quot; zurück. Dies führt dazu, dass die Aufrufer eine
entsprechende <code>null</code>-Prüfung für die Rückgabewerte durchführen müssen, bevor sie
das Ergebnis nutzen können.</p>
<p><code>Optional</code> schließt elegant den Fall &quot;kein Wert vorhanden&quot; ein: Es kann mit der Methode
<code>Optional.ofNullable()</code> das Argument in ein Optional verpacken (Argument != <code>null</code>)
oder ein <code>Optional.empty()</code> zurückliefern (&quot;leeres&quot; Optional, wenn Argument == <code>null</code>).</p>
<p>Man kann Optionals prüfen mit <code>isEmpty()</code> und <code>ifPresent()</code> und dann direkt mit
<code>ifPresent()</code>, <code>orElse()</code> und <code>orElseThrow()</code> auf den verpackten Wert zugreifen.
Besser ist aber der Zugriff über die Stream-API von <code>Optional</code>: <code>map()</code>, <code>filter</code>,
<code>flatMap()</code>, ...</p>
<p><code>Optional</code> ist vor allem für Rückgabewerte gedacht, die den Fall &quot;kein Wert vorhanden&quot;
einschließen sollen. Attribute, Parameter und Sammlungen sollten nicht <code>Optional</code>-Referenzen
speichern, sondern &quot;richtige&quot; (unverpackte) Werte (und eben zur Not <code>null</code>). <code>Optional</code>
ist kein Ersatz für <code>null</code>-Prüfung von Methoden-Parametern (nutzen Sie hier beispielsweise
passende Annotationen). <code>Optional</code> ist auch kein Ersatz für vernünftiges Exception-Handling
im Fall, dass etwas Unerwartetes passiert ist. Liefern Sie <strong>niemals</strong> <code>null</code> zurück, wenn
der Rückgabetyp der Methode ein <code>Optional</code> ist!</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/JDG_hUSBfSA' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Optional</a></li> <li><a href='https://youtu.be/vL2c0iB4uSk' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Optional</a></li> <li><a href='https://youtu.be/vyN-vOV9_CU' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Optional: Beispiel aus der Praxis im PM-Dungeon</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/b62e544bff3a9a25982052bd761b9971f7e67caca90e3ed66c2b794b95d35c2c479f8d72189159345ac018e34ec55866c5558a256ce63b5e9c43a30fc8787d1b' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Optional</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Optionals sind kein Ersatz für <code>null</code>-Prüfung!</li> <li>(K2) Optionals sollen nicht für Attribute oder Parameter genutzt werden</li> <li>(K2) Es darf kein <code>null</code> zurückgeliefert werden, wenn der Rückgabetyp ein Optional ist</li> <li>(K2) Optionals und <code>null</code> sind kein Ersatz für Exception-Handling</li> <li>(K3) Einsatz von <code>Optional</code> in Rückgabewerten</li> <li>(K3) Erzeugen von Optionals mit <code>Optional.ofNullable()</code></li> <li>(K3) Zugriff auf Optionals entweder direkt oder per Stream-API</li></ul>
  </div>
</div>




    <h2 id="motivation">Motivation</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSF</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Set<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Studi <span style="color:#a6e22e">getBestStudi</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sl <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;  <span style="color:#75715e">// Fehler: Es gibt noch keine Sammlung</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Studi best <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Studi s : sl) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (best <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) best <span style="color:#f92672">=</span> s;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (best.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&lt;</span> s.<span style="color:#a6e22e">credits</span>()) best <span style="color:#f92672">=</span> s;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> best;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>    LSF lsf <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> LSF();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Studi best <span style="color:#f92672">=</span> lsf.<span style="color:#a6e22e">getBestStudi</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (best <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>        String name <span style="color:#f92672">=</span> best.<span style="color:#a6e22e">name</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (name <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// mach was mit dem Namen ...</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="problem-null-wird-an-zu-vielen-stellen-genutzt">Problem: <code>null</code> wird an (zu) vielen Stellen genutzt</h3>
<ul>
<li>Es gibt keinen Wert (&quot;not found&quot;)</li>
<li>Felder wurden (noch) nicht initialisiert</li>
<li>Es ist ein Problem oder etwas Unerwartetes aufgetreten</li>
</ul>
<p>=&gt; Parameter und Rückgabewerte müssen stets auf <code>null</code> geprüft werden
(oder Annotationen wie <code>@NotNull</code> eingesetzt werden ...)</p>
<h3 id="lösung">Lösung</h3>
<ul>
<li><code>Optional&lt;T&gt;</code> für Rückgabewerte, die &quot;kein Wert vorhanden&quot; mit einschließen
(statt <code>null</code> bei Abwesenheit von Werten)</li>
<li><code>@NotNull</code>/<code>@Nullable</code> für Parameter einsetzen (oder separate Prüfung)</li>
<li>Exceptions werfen in Fällen, wo ein Problem aufgetreten ist</li>
</ul>
<h3 id="anmerkungen">Anmerkungen</h3>
<ul>
<li>Verwendung von <code>null</code> auf Attribut-Ebene (Klassen-interne Verwendung) ist okay!</li>
<li><code>Optional&lt;T&gt;</code> ist <strong>kein</strong> Ersatz für <code>null</code>-Checks!</li>
<li><code>null</code> ist <strong>kein</strong> Ersatz für vernünftiges Error-Handling!
Das häufig zu beobachtende &quot;Irgendwas Unerwartetes ist passiert, hier ist <code>null</code>&quot;
ist ein <strong>Anti-Pattern</strong>!</li>
</ul>
<h3 id="beispiel-aus-der-praxis-im-pm-dungeon">Beispiel aus der Praxis im PM-Dungeon</h3>
<p>Schauen Sie sich einmal das Review zu den <code>ecs.components.ai.AITools</code> in
<a href="https://github.com/Dungeon-CampusMinden/Dungeon/pull/128#pullrequestreview-1254025874" rel="external" target="_blank">https://github.com/Dungeon-CampusMinden/Dungeon/pull/128#pullrequestreview-1254025874</a>
an.</p>
<p><a href="#R-image-f190821d0cb4b2093c7aacded1962940" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review1.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f190821d0cb4b2093c7aacded1962940"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review1.png?width=auto&height=auto"></a></p>
<p>Die Methode <code>AITools#calculateNewPath</code> soll in der Umgebung einer als Parameter
übergebenen Entität nach einem Feld (<code>Tile</code>) suchen, welches für die Entität
betretbar ist und einen Pfad von der Position der Entität zu diesem Feld an den
Aufrufer zurückliefern.</p>
<p>Zunächst wird in der Entität nach einer <code>PositionComponent</code> und einer <code>VelocityComponent</code>
gesucht. Wenn es (eine) diese(r) Components nicht in der Entität gibt, wird der Wert
<code>null</code> an den Aufrufer von <code>AITools#calculateNewPath</code> zurückgeliefert.
(<em>Anmerkung</em>: Interessanterweise wird in der Methode nicht mit der <code>VelocityComponent</code>
gearbeitet.)</p>
<p>Dann wird in der <code>PositionComponent</code> die Position der Entität im aktuellen Level
abgerufen. In einer Schleife werden alle Felder im gegebenen Radius in eine Liste
gespeichert.
(<em>Anmerkung</em>: Da dies über die <code>float</code>-Werte passiert und nicht über die Feld-Indizes
wird ein <code>Tile</code> u.U. recht oft in der Liste abgelegt. Können Sie sich hier einfache
Verbesserungen überlegen?)</p>
<p>Da <code>level.getTileAt()</code> offenbar als Antwort auch <code>null</code> zurückliefern kann, werden
nun zunächst per <code>tiles.removeIf(Objects::isNull);</code> all diese <code>null</code>-Werte wieder aus
der Liste entfernt. Danach erfolgt die Prüfung, ob die verbleibenden Felder betretbar
sind und nicht-betretbare Felder werden entfernt.</p>
<p>Aus den verbleibenden (betretbaren) Feldern in der Liste wird nun eines zufällig
ausgewählt und per <code>level.findPath()</code> ein Pfad von der Position der Entität zu diesem
Feld berechnet und zurückgeliefert.
(<em>Anmerkung</em>: Hier wird ein zufälliges Tile in der Liste der umgebenden Felder gewählt,
von diesem die Koordinaten bestimmt, und dann noch einmal aus dem Level das dazugehörige
Feld geholt - dabei hatte man die Referenz auf das Feld bereits in der Liste. Können
Sie sich hier eine einfache Verbesserung überlegen?)</p>
<p>Zusammengefasst:</p>
<ul>
<li>Die als Parameter <code>entity</code> übergebene Referenz darf offenbar <em>nicht</em> <code>null</code> sein.
Die ersten beiden Statements in der Methode rufen auf dieser Referenz Methoden
auf, was bei einer <code>null</code>-Referenz zu einer <code>NullPointer</code>-Exception führen
würde. Hier wäre <code>null</code> ein Fehlerzustand.</li>
<li><code>entity.getComponent()</code> kann offenbar <code>null</code> zurückliefern, wenn die gesuchte
Component nicht vorhanden ist. Hier wird <code>null</code> als &quot;kein Wert vorhanden&quot;
genutzt, was dann nachfolgende <code>null</code>-Checks notwendig macht.</li>
<li>Wenn es die gewünschten Components nicht gibt, wird dem Aufrufer der Methode
<code>null</code> zurückgeliefert. Hier ist nicht ganz klar, ob das einfach nur &quot;kein
Wert vorhanden&quot; ist oder eigentlich ein Fehlerzustand?</li>
<li><code>level.getTileAt()</code> kann offenbar <code>null</code> zurückliefern, wenn kein Feld an der
Position vorhanden ist. Hier wird <code>null</code> wieder als &quot;kein Wert vorhanden&quot;
genutzt, was dann nachfolgende <code>null</code>-Checks notwendig macht (Entfernen aller
<code>null</code>-Referenzen aus der Liste).</li>
<li><code>level.findPath()</code> kann auch wieder <code>null</code> zurückliefern, wenn kein Pfad berechnet
werden konnte. Hier ist wieder nicht ganz klar, ob das einfach nur &quot;kein Wert
vorhanden&quot; ist oder eigentlich ein Fehlerzustand? Man könnte beispielsweise in
diesem Fall ein anderes Feld probieren?</li>
</ul>
<p>Der Aufrufer bekommt also eine <code>NullPointer</code>-Exception, wenn der übergebene Parameter
<code>entity</code> nicht vorhanden ist oder den Wert <code>null</code>, wenn in der Methode etwas schief
lief oder schlicht kein Pfad berechnet werden konnte oder tatsächlich einen Pfad.
Damit wird der Aufrufer gezwungen, den Rückgabewert vor der Verwendung zu untersuchen.</p>
<p><strong>Allein in dieser einen kurzen Methode macht <code>null</code> so viele extra Prüfungen notwendig
und den Code dadurch schwerer lesbar und fehleranfälliger! <code>null</code> wird als (unvollständige)
Initialisierung und als Rückgabewert und für den Fehlerfall genutzt, zusätzlich ist
die Semantik von <code>null</code> nicht immer klar.</strong>
(<em>Anmerkung</em>: Der Gebrauch von <code>null</code> hat nicht wirklich etwas mit &quot;der Natur eines ECS&quot;
zu tun. Die Methode wurde mittlerweile komplett überarbeitet und ist in der hier gezeigten
Form glücklicherweise nicht mehr zu finden.)</p>
<p>Entsprechend hat sich in diesem <a href="https://github.com/Dungeon-CampusMinden/Dungeon/pull/128#pullrequestreview-1254025874" rel="external" target="_blank">Review</a>
die nachfolgende Diskussion ergeben:</p>
<p><a href="#R-image-200ea855f32b3ec7d0a6c637a8015581" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review2.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-200ea855f32b3ec7d0a6c637a8015581"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review2.png?width=auto&height=auto"></a></p>
<p><a href="#R-image-57f4e292d4919ebd55499eb849ed58fa" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review3.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-57f4e292d4919ebd55499eb849ed58fa"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional/screenshot_review3.png?width=auto&height=auto"></a></p>
<h2 id="erzeugen-von-optional-objekten">Erzeugen von <em>Optional</em>-Objekten</h2>
<p>Konstruktor ist <code>private</code> ...</p>
<ul>
<li>
<p>&quot;Kein Wert&quot;: <code>Optional.empty()</code></p>
</li>
<li>
<p>Verpacken eines non-<code>null</code> Elements: <code>Optional.of()</code>
(<code>NullPointerException</code> wenn Argument <code>null</code>!)</p>
</li>
<li>
<p>Verpacken eines &quot;unsicheren&quot;/beliebigen Elements: <code>Optional.ofNullable()</code></p>
<ul>
<li>Liefert verpacktes Element, oder</li>
<li><code>Optional.empty()</code>, falls Element <code>null</code> war</li>
</ul>
</li>
</ul>
<p>Es sollte in der Praxis eigentlich nur wenige Fälle geben, wo ein Aufruf von
<code>Optional.of()</code> sinnvoll ist. Ebenso ist <code>Optional.empty()</code> nur selten sinnvoll.</p>
<p>Stattdessen sollte stets <code>Optional.ofNullable()</code> verwendet werden.</p>
<p><strong><code>null</code> kann nicht nicht in <code>Optional&lt;T&gt;</code> verpackt werden!</strong>
(Das wäre dann eben <code>Optional.empty()</code>.)</p>
<h2 id="lsf-liefert-jetzt-optional-zurück">LSF liefert jetzt <em>Optional</em> zurück</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSF</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Set<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> sl;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Optional<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getBestStudi</span>() <span style="color:#66d9ef">throws</span> NullPointerException {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Fehler: Es gibt noch keine Sammlung</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sl <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> NullPointerException(<span style="color:#e6db74">&#34;There ain&#39;t any collection&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Studi best <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Studi s : sl) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (best <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) best <span style="color:#f92672">=</span> s;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (best.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&lt;</span> s.<span style="color:#a6e22e">credits</span>()) best <span style="color:#f92672">=</span> s;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Entweder Optional.empty() (wenn best==null) oder Optional.of(best) sonst</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Optional.<span style="color:#a6e22e">ofNullable</span>(best);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Das Beispiel soll verdeutlichen, dass man im Fehlerfall nicht einfach <code>null</code> oder
<code>Optional.empty()</code> zurückliefern soll, sondern eine passende Exception werfen soll.</p>
<p>Wenn die Liste aber leer ist, stellt dies keinen Fehler dar! Es handelt sich um den
Fall &quot;kein Wert vorhanden&quot;. In diesem Fall wird statt <code>null</code> nun ein <code>Optional.empty()</code>
zurückgeliefert, also ein Objekt, auf dem der Aufrufer die üblichen Methoden aufrufen
kann.</p>
<h2 id="zugriff-auf-optional-objekte">Zugriff auf <em>Optional</em>-Objekte</h2>
<p>In der funktionalen Programmierung gibt es schon lange das Konzept von <code>Optional</code>,
in Haskell ist dies beispielsweise die Monade <code>Maybe</code>. Allerdings ist die Einbettung
in die Sprache von vornherein mit berücksichtigt worden, insbesondere kann man hier
sehr gut mit <em>Pattern Matching</em> in der Funktionsdefinition auf den verpackten Inhalt
reagieren.</p>
<p>In Java gibt es die Methode <code>Optional#isEmpty()</code>, die einen Boolean zurückliefert und
prüft, ob es sich um ein leeres <code>Optional</code> handelt oder ob hier ein Wert &quot;verpackt&quot; ist.</p>
<p>Für den direkten Zugriff auf die Werte gibt es die Methoden <code>Optional#orElseThrow()</code>
und <code>Optional#orElse()</code>. Damit kann man auf den verpackten Wert zugreifen, oder es
wird eine Exception geworfen bzw. ein Ersatzwert geliefert.</p>
<p>Zusätzlich gibt es <code>Optional#isPresent()</code>, die als Parameter ein <code>java.util.function.Consumer</code>
erwartet, also ein funktionales Interface mit einer Methode <code>void accept(T)</code>, die das
Objekt verarbeitet.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Studi best;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Testen und dann verwenden</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>lsf.<span style="color:#a6e22e">getBestStudi</span>().<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>    best <span style="color:#f92672">=</span> lsf.<span style="color:#a6e22e">getBestStudi</span>().<span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// mach was mit dem Studi ...</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Arbeite mit Consumer</span>
</span></span><span style="display:flex;"><span>lsf.<span style="color:#a6e22e">getBestStudi</span>().<span style="color:#a6e22e">ifPresent</span>(studi <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// mach was mit dem Studi ...</span>
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Studi oder Alternative (wenn Optional.empty())</span>
</span></span><span style="display:flex;"><span>best <span style="color:#f92672">=</span> lsf.<span style="color:#a6e22e">getBestStudi</span>().<span style="color:#a6e22e">orElse</span>(anne);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Studi oder NoSuchElementException (wenn Optional.empty())</span>
</span></span><span style="display:flex;"><span>best <span style="color:#f92672">=</span> lsf.<span style="color:#a6e22e">getBestStudi</span>().<span style="color:#a6e22e">orElseThrow</span>();</span></span></code></pre></div>
<p>Es gibt noch eine Methode <code>get()</code>, die so verhält wie <code>orElseThrow()</code>. Da man diese
Methode vom Namen her schnell mit einem Getter verwechselt, ist sie mittlerweile
<em>deprecated</em>.</p>
<p><em>Anmerkung</em>: Da <code>getBestStudi()</code> eine <code>NullPointerException</code> werfen kann, sollte der
Aufruf möglicherweise in ein <code>try/catch</code> verpackt werden. Dito für <code>orElseThrow()</code>.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/optional/traditional/Demo.java" target="_blank"><span class="title">Beispiel: optional.traditional.Demo</span></a></span></div>
<h2 id="einsatz-mit-stream-api">Einsatz mit Stream-API</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSF</span> {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Optional<span style="color:#f92672">&lt;</span>Studi<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">getBestStudi</span>() <span style="color:#66d9ef">throws</span> NullPointerException {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (sl <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> NullPointerException(<span style="color:#e6db74">&#34;There ain&#39;t any collection&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> sl.<span style="color:#a6e22e">stream</span>()
</span></span><span style="display:flex;"><span>                 .<span style="color:#a6e22e">sorted</span>((s1, s2) <span style="color:#f92672">-&gt;</span> s2.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">-</span> s1.<span style="color:#a6e22e">credits</span>())
</span></span><span style="display:flex;"><span>                 .<span style="color:#a6e22e">findFirst</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    String name <span style="color:#f92672">=</span> lsf.<span style="color:#a6e22e">getBestStudi</span>()
</span></span><span style="display:flex;"><span>                     .<span style="color:#a6e22e">map</span>(Studi::name)
</span></span><span style="display:flex;"><span>                     .<span style="color:#a6e22e">orElseThrow</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/optional/streams/Demo.java" target="_blank"><span class="title">Beispiel: optional.streams.Demo</span></a></span></div>
<p>Im Beispiel wird in <code>getBestStudi()</code> die Sammlung als Stream betrachtet, über die
Methode <code>sorted()</code> und den Lamda-Ausdruck für den <code>Comparator</code> sortiert (&quot;falsch&quot;
herum: absteigend in den Credits der Studis in der Sammlung), und <code>findFirst()</code>
ist die terminale Operation auf dem Stream, die ein <code>Optional&lt;Studi&gt;</code> zurückliefert:
entweder den Studi mit den meisten Credits (verpackt in <code>Optional&lt;Studi&gt;</code>) oder
<code>Optional.empty()</code>, wenn es überhaupt keine Studis in der Sammlung gab.</p>
<p>In <code>main()</code> wird dieses <code>Optional&lt;Studi&gt;</code> mit den Stream-Methoden von <code>Optional&lt;T&gt;</code>
bearbeitet, zunächst mit <code>Optional#map()</code>. Man braucht nicht selbst prüfen, ob das
von <code>getBestStudi()</code> erhaltene Objekt leer ist oder nicht, da dies von <code>Optional#map()</code>
erledigt wird: Es wendet die Methodenreferenz auf den verpackten Wert an (sofern
dieser vorhanden ist) und liefert damit den Namen des Studis als <code>Optional&lt;String&gt;</code>
verpackt zurück. Wenn es keinen Wert, also nur <code>Optional.empty()</code> von <code>getBestStudi()</code>
gab, dann ist der Rückgabewert von <code>Optional#map()</code> ein <code>Optional.empty()</code>. Wenn
der Name, also der Rückgabewert von <code>Studi::name</code>, <code>null</code> war, dann wird ebenfalls
ein <code>Optional.empty()</code> zurückgeliefert. Dadurch wirft <code>orElseThrow()</code> dann eine
<code>NoSuchElementException</code>. Man kann also direkt mit dem String <code>name</code> weiterarbeiten
ohne extra <code>null</code>-Prüfung - allerdings will man noch ein Exception-Handling einbauen
(dies fehlt im obigen Beispiel aus Gründen der Übersicht) ...</p>
<h2 id="weitere-optionals">Weitere <em>Optionals</em></h2>
<p>Für die drei primitiven Datentypen <code>int</code>, <code>long</code> und <code>double</code> gibt es passende
Wrapper-Klassen von <code>Optional&lt;T&gt;</code>: <code>OptionalInt</code>, <code>OptionalLong</code> und <code>OptionalDouble</code>.</p>
<p>Diese verhalten sich analog zu <code>Optional&lt;T&gt;</code>, haben aber keine Methode <code>ofNullable()</code>,
da dies hier keinen Sinn ergeben würde: Die drei primitiven Datentypen repräsentieren
Werte - diese können nicht <code>null</code> sein.</p>
<h2 id="regeln-für-optional">Regeln für <em>Optional</em></h2>
<ol>
<li>
<p>Nutze <code>Optional</code> nur als Rückgabe für &quot;kein Wert vorhanden&quot;</p>
<p><code>Optional</code> ist nicht als Ersatz für eine <code>null</code>-Prüfung o.ä.
gedacht, sondern als Repräsentation, um auch ein &quot;kein Wert
vorhanden&quot; zurückliefern zu können.</p>
</li>
<li>
<p>Nutze nie <code>null</code> für eine <code>Optional</code>-Variable oder einen <code>Optional</code>-Rückgabewert</p>
<p>Wenn man ein <code>Optional</code> als Rückgabe bekommt, sollte das
niemals selbst eine <code>null</code>-Referenz sein. Das macht das
gesamte Konzept kaputt!</p>
<p>Nutzen Sie stattdessen <code>Optional.empty()</code>.</p>
</li>
<li>
<p>Nutze <code>Optional.ofNullable()</code> zum Erzeugen eines <code>Optional</code></p>
<p>Diese Methode verhält sich &quot;freundlich&quot; und erzeugt automatisch
ein <code>Optional.empty()</code>, wenn das Argument <code>null</code> ist. Es gibt
also keinen Grund, dies mit einer Fallunterscheidung selbst
erledigen zu wollen.</p>
<p>Bevorzugen Sie <code>Optional.ofNullable()</code> vor einer manuellen
Fallunterscheidung und dem entsprechenden Einsatz von
<code>Optional.of()</code> und <code>Optional.empty()</code>.</p>
</li>
<li>
<p>Erzeuge keine <code>Optional</code> als Ersatz für die Prüfung auf <code>null</code></p>
<p>Wenn Sie auf <code>null</code> prüfen müssen, müssen Sie auf <code>null</code> prüfen.
Der ersatzweise Einsatz von <code>Optional</code> macht es nur komplexer -
prüfen müssen Sie hinterher ja immer noch.</p>
</li>
<li>
<p>Nutze <code>Optional</code> nicht in Attributen, Methoden-Parametern und Sammlungen</p>
<p>Nutzen Sie <code>Optional</code> vor allem für Rückgabewerte.</p>
<p>Attribute sollten immer direkt einen Wert haben oder <code>null</code>,
analog Parameter von Methoden o.ä. ... Hier hilft <code>Optional</code>
nicht, Sie müssten ja trotzdem eine <code>null</code>-Prüfung machen,
nur eben dann über den <code>Optional</code>, wodurch dies komplexer und
schlechter lesbar wird.</p>
<p>Aus einem ähnlichen Grund sollten Sie auch in Sammlungen
keine <code>Optional</code> speichern!</p>
</li>
<li>
<p>Vermeide den direkten Zugriff (<code>ifPresent()</code>, <code>orElseThrow()</code> ...)</p>
<p>Der direkte Zugriff auf ein <code>Optional</code> entspricht dem
Prüfen auf <code>null</code> und dann dem Auspacken. Dies ist nicht
nur Overhead, sondern auch schlechter lesbar.</p>
<p>Vermeiden Sie den direkten Zugriff und nutzen Sie <code>Optional</code>
mit den Stream-Methoden. So ist dies von den Designern
gedacht.</p>
</li>
</ol>
<h2 id="interessante-links">Interessante Links</h2>
<ul>
<li><a href="https://dev.java/learn/api/streams/optionals/" rel="external" target="_blank">&quot;Using Optionals&quot;</a></li>
<li><a href="https://medium.com/javarevisited/what-you-might-not-know-about-optional-7238e3c05f63" rel="external" target="_blank">&quot;What You Might Not Know About Optional&quot;</a></li>
<li><a href="https://medium.com/javarevisited/experienced-developers-use-these-7-java-optional-tips-to-remove-code-clutter-6e8b1a639861" rel="external" target="_blank">&quot;Experienced Developers Use These 7 Java Optional Tips to Remove Code Clutter&quot;</a></li>
<li><a href="https://blog.jetbrains.com/idea/2017/08/code-smells-null/" rel="external" target="_blank">&quot;Code Smells: Null&quot;</a></li>
<li><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" rel="external" target="_blank">&quot;Class Optional&quot;</a></li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<p><code>Optional</code> als Rückgabe für &quot;kein Wert vorhanden&quot;</p>
<ul>
<li>
<p><code>Optional.ofNullable()</code>: Erzeugen eines <code>Optional</code></p>
<ul>
<li>Entweder Objekt &quot;verpackt&quot; (Argument != <code>null</code>)</li>
<li>Oder <code>Optional.empty()</code> (Argument == <code>null</code>)</li>
</ul>
</li>
<li>
<p>Prüfen mit <code>isEmpty()</code> und <code>ifPresent()</code></p>
</li>
<li>
<p>Direkter Zugriff mit <code>ifPresent()</code>, <code>orElse()</code> und <code>orElseThrow()</code></p>
</li>
<li>
<p>Stream-API: <code>map()</code>, <code>filter()</code>, <code>flatMap()</code>, ...</p>
</li>
<li>
<p>Attribute, Parameter und Sammlungen: nicht <code>Optional</code> nutzen</p>
</li>
<li>
<p>Kein Ersatz für <code>null</code>-Prüfung!</p>
</li>
</ul>
<p>Schöne Doku: <a href="https://dev.java/learn/api/streams/optionals/" rel="external" target="_blank">&quot;Using Optionals&quot;</a>.</p>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106526&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Optional (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>String-Handling</strong></p>
<p>Können Sie den folgenden Code so umschreiben, dass Sie statt der <code>if</code>-Abfragen und der einzelnen direkten Methodenaufrufe
die Stream-API und <code>Optional&lt;T&gt;</code> nutzen?</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>String <span style="color:#a6e22e">format</span>(<span style="color:#66d9ef">final</span> String text, String replacement) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (text.<span style="color:#a6e22e">isEmpty</span>()) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> String trimmed <span style="color:#f92672">=</span> text.<span style="color:#a6e22e">trim</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> String withSpacesReplaced <span style="color:#f92672">=</span> trimmed.<span style="color:#a6e22e">replaceAll</span>(<span style="color:#e6db74">&#34; +&#34;</span>, replacement);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> replacement <span style="color:#f92672">+</span> withSpacesReplaced <span style="color:#f92672">+</span> replacement;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Ein Aufruf <code>format(&quot; Hello World ... &quot;, &quot;_&quot;);</code> liefert den String &quot;<code>_Hello_World_..._</code>&quot;.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_LernJava'>[LernJava] <a href='https://dev.java/learn/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Learn Java</strong></a><br>Oracle Corporation, 2022.<br><em>Tutorials \> The Stream API \> Using Optionals</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kap. 12.6: Optional ist keine Nullnummer</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Interfaces: Default-Methoden</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Seit Java8 können Methoden in Interfaces auch fertig implementiert sein: Sogenannte
<strong>Default-Methoden</strong>.</p>
<p>Dazu werden die Methoden mit dem neuen Schlüsselwort <code>default</code> gekennzeichnet. Die
Implementierung wird an die das Interface implementierenden Klassen (oder Interfaces)
vererbt und kann bei Bedarf überschrieben werden.</p>
<p>Da eine Klasse von einer anderen Klasse erben darf, aber mehrere Interfaces implementieren
kann, könnte es zu einer Mehrfachvererbung einer Methode kommen: Eine Methode könnte
beispielsweise in verschiedenen Interfaces als Default-Methode angeboten werden, und wenn
eine Klasse diese Interfaces implementiert, steht eine Methode mit der selben Signatur
auf einmal mehrfach zur Verfügung. Dies muss (u.U. manuell) aufgelöst werden.</p>
<p>Auflösung von Mehrfachvererbung:</p>
<ul>
<li>Regel 1: Klassen gewinnen</li>
<li>Regel 2: Sub-Interfaces gewinnen</li>
<li>Regel 3: Methode explizit auswählen</li>
</ul>
<p>Aktuell ist der Unterschied zu abstrakten Klassen: Interfaces können <strong>keinen Zustand</strong>
haben, d.h. keine Attribute/Felder.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/qQ8BPkL9X5o' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Default-Methoden</a></li> <li><a href='https://youtu.be/gm6ttKlAEJc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Regel 1</a></li> <li><a href='https://youtu.be/3j9i7iMVmMM' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Regel 2</a></li> <li><a href='https://youtu.be/J3gJnwz8Rf0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Regel 3</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/a86bc2fc9d692f6ca307cfabd09c7860c06b8fd53b60e281586c8b51414b7139d061328b2160a988045952f92fc13a921b6148c0dd2f790ea7324634c491006e' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Default-Methoden</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Interfaces mit Default-Methoden, Unterschied zu abstrakten Klassen</li> <li>(K2) Problem der Mehrfachvererbung</li> <li>(K3) Erstellen von Interfaces mit Default-Methoden</li> <li>(K3) Regeln zum Auflösen der Mehrfachvererbung</li></ul>
  </div>
</div>




    <h2 id="problem-etablierte-api-interfaces-erweitern">Problem: Etablierte API (Interfaces) erweitern</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Klausur</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">anmelden</span>(Studi s);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">abmelden</span>(Studi s);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>=&gt; Nachträglich noch <code>void schreiben(Studi s);</code> ergänzen?</p>
<p>Wenn ein Interface nachträglich erweitert wird, müssen alle Kunden (also
alle Klassen, die das Interface implementieren) auf die neuen Signaturen
angepasst werden. Dies kann viel Aufwand verursachen und API-Änderungen
damit unmöglich machen.</p>
<h2 id="default-methoden-interfaces-mit-implementierung">Default-Methoden: Interfaces mit Implementierung</h2>
<p>Seit Java8 können Interfaces auch Methoden implementieren.
Es gibt zwei Varianten: Default-Methoden und statische Methoden.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Klausur</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">anmelden</span>(Studi s);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">abmelden</span>(Studi s);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">schreiben</span>(Studi s) {
</span></span><span style="display:flex;"><span>        ...     <span style="color:#75715e">// Default-Implementierung</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">wuppie</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> java.<span style="color:#a6e22e">lang</span>.<span style="color:#a6e22e">UnsupportedOperationException</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Methoden können in Interfaces seit Java8 implementiert werden. Für Default-Methoden
muss das Schlüsselwort <code>default</code> vor die Signatur gesetzt werden. Klassen, die das
Interface implementieren, können diese Default-Implementierung erben oder selbst
neu implementieren (überschreiben). Alternativ kann die Klasse eine Default-Methode
neu <em>deklarieren</em> und wird damit zur abstrakten Klasse.</p>
<p>Dies ähnelt abstrakten Klassen. Allerdings kann in abstrakten Klassen neben dem
Verhalten (implementierten Methoden) auch Zustand über die Attribute gespeichert werden.</p>
<h2 id="problem-mehrfachvererbung">Problem: Mehrfachvererbung</h2>
<p>Drei Regeln zum Auflösen bei Konflikten:</p>
<ol>
<li><strong>Klassen gewinnen</strong>:
Methoden aus Klasse oder Superklasse haben höhere Priorität als Default-Methoden</li>
<li><strong>Sub-Interfaces gewinnen</strong>:
Methode aus am meisten spezialisiertem Interface mit Default-Methode wird gewählt
Beispiel: Wenn <code>B extends A</code> dann ist <code>B</code> spezialisierter als <code>A</code></li>
<li>Sonst: Klasse muss <strong>Methode explizit auswählen</strong>:
Methode überschreiben und gewünschte (geerbte) Variante aufrufen:
<code>X.super.m(...)</code> (<code>X</code> ist das gewünschte Interface)</li>
</ol>
<p>Auf den folgenden Folien wird dies anhand kleiner Beispiele verdeutlicht.</p>
<h2 id="auflösung-mehrfachvererbung-1-klassen-gewinnen">Auflösung Mehrfachvererbung: 1. Klassen gewinnen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">A</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;A&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">C</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;C&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">E</span> <span style="color:#66d9ef">extends</span> C <span style="color:#66d9ef">implements</span> A {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/** Mehrfachvererbung: 1. Klassen gewinnen */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DefaultTest1</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        String e <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> E().<span style="color:#a6e22e">hello</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/defaultmethods/rule1/DefaultTest1.java" target="_blank"><span class="title">Demo: defaultmethods.rule1.DefaultTest1</span></a></span></div>
<p>Die Klasse <code>E</code> erbt sowohl von Klasse <code>C</code> als auch vom Interface <code>A</code> die Methode <code>hello()</code>
(Mehrfachvererbung). In diesem Fall &quot;gewinnt&quot; die Implementierung aus Klasse <code>C</code>.</p>
<p><strong>1. Regel</strong>: Klassen gewinnen immer. Deklarationen einer Methode in einer Klasse oder
einer Oberklasse haben Vorrang von allen Default-Methoden.</p>
<h2 id="auflösung-mehrfachvererbung-2-sub-interfaces-gewinnen">Auflösung Mehrfachvererbung: 2. Sub-Interfaces gewinnen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">A</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;A&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">B</span> <span style="color:#66d9ef">extends</span> A {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;B&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">D</span> <span style="color:#66d9ef">implements</span> A, B {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/** Mehrfachvererbung: 2. Sub-Interfaces gewinnen */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DefaultTest2</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        String e <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> D().<span style="color:#a6e22e">hello</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/defaultmethods/rule2/DefaultTest2.java" target="_blank"><span class="title">Demo: defaultmethods.rule2.DefaultTest2</span></a></span></div>
<p>Die Klasse <code>D</code> erbt sowohl vom Interface <code>A</code> als auch vom Interface <code>B</code> die Methode <code>hello()</code>
(Mehrfachvererbung). In diesem Fall &quot;gewinnt&quot; die Implementierung aus Klasse <code>B</code>: Interface
<code>B</code> ist spezialisierter als <code>A</code>.</p>
<p><strong>2. Regel</strong>: Falls Regel 1 nicht zutrifft, gewinnt die Default-Methode, die am meisten
spezialisiert ist.</p>
<h2 id="auflösung-mehrfachvererbung-3-methode-explizit-auswählen">Auflösung Mehrfachvererbung: 3. Methode explizit auswählen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">A</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;A&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">B</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;B&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">D</span> <span style="color:#66d9ef">implements</span> A, B {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> A.<span style="color:#a6e22e">super</span>.<span style="color:#a6e22e">hello</span>(); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/** Mehrfachvererbung: 3. Methode explizit auswählen */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DefaultTest3</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        String e <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> D().<span style="color:#a6e22e">hello</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/defaultmethods/rule3/DefaultTest3.java" target="_blank"><span class="title">Demo: defaultmethods.rule3.DefaultTest3</span></a></span></div>
<p>Die Klasse <code>D</code> erbt sowohl vom Interface <code>A</code> als auch vom Interface <code>B</code> die Methode <code>hello()</code>
(Mehrfachvererbung). In diesem Fall <em>muss</em> zur Auflösung die Methode in <code>D</code> neu implementiert
werden und die gewünschte geerbte Methode explizit aufgerufen werden. (Wenn dies unterlassen
wird, führt das selbst bei Nicht-Nutzung der Methode <code>hello()</code> zu einem Compiler-Fehler!)</p>
<p><em>Achtung</em>: Der Aufruf der Default-Methode aus Interface <code>A</code> erfolgt mit <code>A.super.hello();</code>
(nicht einfach durch <code>A.hello();</code>)!</p>
<p><strong>3. Regel</strong>: Falls weder Regel 1 noch 2 zutreffen bzw. die Auflösung noch uneindeutig ist,
muss man manuell durch die explizite Angabe der gewünschten Methode auflösen.</p>
<h2 id="quiz-was-kommt-hier-raus">Quiz: Was kommt hier raus?</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">A</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;A&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">B</span> <span style="color:#66d9ef">extends</span> A {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">default</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;B&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">C</span> <span style="color:#66d9ef">implements</span> B {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">hello</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;C&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">D</span> <span style="color:#66d9ef">extends</span> C <span style="color:#66d9ef">implements</span> A, B {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/** Quiz Mehrfachvererbung */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DefaultTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        String e <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> D().<span style="color:#a6e22e">hello</span>(); <span style="color:#75715e">// ???</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Die Klasse <code>D</code> erbt sowohl von Klasse <code>C</code> als auch von den Interfaces <code>A</code> und <code>B</code> die Methode
<code>hello()</code> (Mehrfachvererbung). In diesem Fall &quot;gewinnt&quot; die Implementierung aus Klasse <code>C</code>: Klassen
gewinnen immer (Regel 1).</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/modern-java/src/defaultmethods/quiz/DefaultTest.java" target="_blank"><span class="title">Beispiel: defaultmethods.quiz.DefaultTest</span></a></span></div>
<h2 id="statische-methoden-in-interfaces">Statische Methoden in Interfaces</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Collection</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> Iterable<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">add</span>(E e);
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Collections</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">Collections</span>() { }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">addAll</span>(Collection<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">super</span> T<span style="color:#f92672">&gt;</span> c, T... elements) {...}
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Typisches Pattern in Java: Interface plus Utility-Klasse (Companion-Klasse) mit statischen Hilfsmethoden
zum einfacheren Umgang mit Instanzen des Interfaces (mit Objekten, deren Klasse das Interface implementiert).
Beispiel: <code>Collections</code> ist eine Hilfs-Klasse zum Umgang mit <code>Collection</code>-Objekten.</p>
<p>Seit Java8 können in Interfaces neben Default-Methoden auch statische Methoden implementiert werden.</p>
<p>Die Hilfsmethoden können jetzt ins Interface wandern =&gt; Utility-Klassen werden obsolet ... Aus
Kompatibilitätsgründen würde man die bisherige Companion-Klasse weiterhin anbieten, wobei die Implementierungen
auf die statischen Methoden im Interface verweisen (<em>SKIZZE, nicht real!</em>):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">CollectionX</span><span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> Iterable<span style="color:#f92672">&lt;</span>E<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">add</span>(E e);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">addAll</span>(CollectionX<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">super</span> T<span style="color:#f92672">&gt;</span> c, T... elements) { ... }
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CollectionsX</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">addAll</span>(CollectionX<span style="color:#f92672">&lt;?</span> <span style="color:#66d9ef">super</span> T<span style="color:#f92672">&gt;</span> c, T... elements) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> CollectionX.<span style="color:#a6e22e">addAll</span>(c, elements);  <span style="color:#75715e">// Verweis auf Interface</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="interfaces-vs-abstrakte-klassen">Interfaces vs. Abstrakte Klassen</h2>
<ul>
<li>
<p><strong>Abstrakte Klassen</strong>: Schnittstelle und Verhalten und Zustand</p>
</li>
<li>
<p><strong>Interfaces</strong>:</p>
<ul>
<li>vor Java 8 nur Schnittstelle</li>
<li>ab Java 8 Schnittstelle und Verhalten</li>
</ul>
<p>Unterschied zu abstrakten Klassen: Kein Zustand, d.h. keine Attribute</p>
</li>
<li>
<p>Design:</p>
<ul>
<li>Interfaces sind beinahe wie abstrakte Klassen, nur ohne Zustand</li>
<li>Klassen können nur von <strong>einer</strong> (abstrakten) Klasse erben, aber
<strong>viele</strong> Interfaces implementieren</li>
</ul>
</li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Seit Java8: Interfaces mit Implementierung: <strong>Default-Methoden</strong></p>
<ul>
<li>Methoden mit dem Schlüsselwort <code>default</code> können Implementierung im Interface haben</li>
<li>Die Implementierung wird vererbt und kann bei Bedarf überschrieben werden</li>
<li>Auflösung von Mehrfachvererbung:
<ul>
<li>Regel 1: Klassen gewinnen</li>
<li>Regel 2: Sub-Interfaces gewinnen</li>
<li>Regel 3: Methode explizit auswählen</li>
</ul>
</li>
<li>Unterschied zu abstrakten Klassen: <strong>Kein Zustand</strong></li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106522&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Default-Methoden (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>
Erklären Sie die Code-Schnipsel in der
<a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/modern-java/src/challenges/defaults" rel="external" target="_blank">Vorgabe</a>
und die jeweils entstehenden Ausgaben.
  </div>
</div>



    




    




    
    
        
        

        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Urma2014'>[Urma2014] <strong>Java 8 in Action: Lambdas, Streams, and Functional-Style Programming</strong><br>Urma, R.-G. und Fusco, M. und Mycroft, A., Manning Publications, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9199-9' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9199-9</a>.<br><em>Kapitel 9: Default Methods</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
          <article class="default">
            <header class="headline">
            </header>

<h1 id="programmiermethoden-und-clean-code">Programmiermethoden und Clean Code</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/javadoc.html">Javadoc</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/logging.html">Logging</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/smells.html">Code Smells</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/codingrules.html">Coding Conventions und Metriken</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/refactoring.html">Refactoring</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Programmiermethoden und Clean Code</h1>
<article class="default">
<h1>Javadoc</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Mit Javadoc kann aus speziell markierten Block-Kommentaren eine externe Dokumentation im HTML-Format
erzeugt werden. Die Block-Kommentare, auf die das im JDK enthaltene Programm <code>javadoc</code> reagiert,
beginnen mit <code>/**</code> (also einem zusätzlichen Stern, der für den Java-Compiler nur das erste Kommentarzeichen
ist).</p>
<p>Die erste Zeile eines Javadoc-Kommentars ist eine &quot;Zusammenfassung&quot; und an fast allen Stellen der
generierten Doku sichtbar. Diese Summary sollte kurz gehalten werden und eine Idee vermitteln, was
die Klasse oder die Methode oder das Attribut macht.</p>
<p>Für die Dokumentation von Parametern, Rückgabetypen, Exceptions und veralteten Elementen existieren
spezielle Annotationen: <code>@param</code>, <code>@return</code>, <code>@throws</code> und <code>@deprecated</code>.</p>
<p>Als Faustregel gilt: Es werden <strong>alle</strong> <code>public</code> und <code>protected</code> Elemente (Klassen, Methoden, Attribute)
mit Javadoc kommentiert. Alle nicht-öffentlichen Elemente bekommen normale Java-Kommentare (Zeilen- oder
Blockkommentare).</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/Qo2TTD593eQ' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Javadoc</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/15984eacd03de989ab2bce322ace5d74da962a911ae45afbb60958714ed6b16c72c962aec4b60acda9419ef15d26c5a5265129245f26beb0f905af9a7176b9fa' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Javadoc</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Ziel der Javadoc-Dokumentation verstehen</li> <li>(K2) Typischen Aufgabe von Javadoc-Kommentaren verstehen</li> <li>(K3) Dokumentation öffentlich sichtbarer Elemente mit Javadoc</li> <li>(K3) Schreiben einer sinnvollen Summary</li> <li>(K3) Einsatz von Annotationen zur Dokumentation von Parametern, Rückgabetypen, Exceptions, veralteten Elementen</li></ul>
  </div>
</div>




    <h2 id="dokumentation-mit-javadoc">Dokumentation mit Javadoc</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Beschreibung Beschreibung (Summary).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * &lt;p&gt;Hier kommt dann ein laengerer Text, der die Dinge
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * bei Bedarf etwas ausfuehrlicher erklaert.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">wuppie</span>() {}</span></span></code></pre></div>
<p>Javadoc-Kommentare sind (aus Java-Sicht) normale Block-Kommentare, wobei der Beginn mit
<code>/**</code> eingeleitet wird. Dieser Beginn ist für das Tool <code>javadoc</code> (Bestandteil des JDK,
genau wie <code>java</code> und <code>javac</code>) das Signal, dass hier ein Kommentar anfängt, den das
Tool in eine HTML-Dokumentation übersetzen soll.</p>
<p>Typischerweise wird am Anfang jeder Kommentarzeile ein <code>*</code> eingefügt; dieser wird von
Javadoc ignoriert.</p>
<p>Sie können neben normalem Text und speziellen Annotationen auch HTML-Elemente wie <code>&lt;p&gt;</code>
und <code>&lt;code&gt;</code> oder <code>&lt;ul&gt;</code> nutzen.</p>
<p>Mit <code>javadoc *.java</code> können Sie in der Konsole aus den Java-Dateien die Dokumentation
generieren lassen. Oder Sie geben das in Ihrer IDE in Auftrag ... (die dann diesen
Aufruf gern für Sie tätigt).</p>
<h2 id="standard-aufbau">Standard-Aufbau</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Beschreibung Beschreibung (Summary).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * &lt;p&gt; Hier kommt dann ein laengerer Text, der die Dinge
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * bei Bedarf etwas ausfuehrlicher erklaert.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @param   date  Tag, Wert zw. 1 .. 31
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @return  Anzahl der Sekunden seit 1.1.1970
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @throws  NumberFormatException
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @deprecated As of JDK version 1.1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">setDate</span>(<span style="color:#66d9ef">int</span> date) {
</span></span><span style="display:flex;"><span>    setField(Calendar.<span style="color:#a6e22e">DATE</span>, date);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ul>
<li>Erste Zeile bei Methoden/Attributen geht in die generierte &quot;Summary&quot; in der Übersicht,
der Rest in die &quot;Details&quot;
<ul>
<li>Die &quot;Summary&quot; sollte kein kompletter Satz sein, wird aber wie ein Satz geschrieben
(Groß beginnen, mit Punkt beenden). Es sollte nicht beginnen mit &quot;Diese Methode
macht ...&quot; oder &quot;Diese Klasse ist ...&quot;. Ein gutes Beispiel wäre &quot;Berechnet die
Steuerrückerstattung.&quot;</li>
<li>Danach kommen die Details, die in der generierten Dokumentation erst durch
Aufklappen der Elemente sichtbar sind. Erklären Sie, wieso der Code was machen
soll und welche Designentscheidungen getroffen wurden (und warum).</li>
</ul>
</li>
<li>Leerzeilen gliedern den Text in Absätze. Neue Absätze werden mit einem <code>&lt;p&gt;</code> eingeleitet.
(Ausnahmen: Wenn der Text mit <code>&lt;ul&gt;</code> o.ä. beginnt oder der Absatz mit den Block-Tags.)</li>
<li>Die &quot;Block-Tags&quot; <code>@param</code>, <code>@return</code>, <code>@throws</code>, <code>@deprecated</code> werden durch einen
Absatz von der restlichen Beschreibung getrennt und tauchen in exakt dieser Reihenfolge
auf. Die Beschreibung dieser Tags ist nicht leer - anderenfalls lässt man das Tag weg.
Falls die Zeile für die Beschreibung nicht reicht, wird umgebrochen und die Folgezeile
mit vier Leerzeichen (beginnend mit dem <code>@</code>) eingerückt.
<ul>
<li>Mit <code>@param</code> erklären Sie die Bedeutung eines Parameters (von links nach rechts) einer
Methode. Beispiel: <code>@param   date   Tag, Wert zw. 1 .. 31</code>. Wiederholen Sie dies für
jeden Parameter.</li>
<li>Mit <code>@return</code> beschreiben Sie den Rückgabetyp/-wert. Beispiel:
<code>@return  Anzahl der Sekunden seit 1.1.1970</code>.
Bei Rückgabe von <code>void</code> wird diese Beschreibung weggelassen (die Beschreibung wäre
dann ja leer).</li>
<li>Mit <code>@throws</code> geben Sie an, welche &quot;checked&quot; Exceptions die Methode wirft.</li>
<li>Mit <code>@deprecated</code> können Sie im Kommentar sagen, dass ein Element veraltet ist und
möglicherweise mit der nächsten Version o.ä. entfernt wird. (siehe nächste Folie)</li>
</ul>
</li>
</ul>
<p>=&gt; Dies sind die Basis-Regeln aus dem populären Google-Java-Style <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/javadoc.html#id_googlestyleguide">[googlestyleguide]</a>.</p>
<h2 id="veraltete-elemente">Veraltete Elemente</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Beschreibung Beschreibung Beschreibung.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @deprecated As of v102, replaced by &lt;code&gt;Foo.fluppie()&lt;/code&gt;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Deprecated</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">wuppie</span>() {}</span></span></code></pre></div>
<ul>
<li>Annotation zum Markieren als &quot;veraltet&quot; (in der generierten Dokumentation): <code>@deprecated</code></li>
<li>Für Sichtbarkeit zur Laufzeit bzw. im Tooling/IDE: normale Code-Annotation <code>@Deprecated</code></li>
</ul>
<p>Dies ist ein guter Weg, um Elemente einer öffentlichen API als &quot;veraltet&quot; zu
kennzeichnen. Üblicherweise wird diese Kennzeichnung für einige wenige Releases
beibehalten und danach das veraltete Element aus der API entfernt.</p>
<h2 id="autoren-versionen-">Autoren, Versionen, ...</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Beschreibung Beschreibung Beschreibung.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @author  Dagobert Duck
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @version V1
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * @since   schon immer
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span></span></span></code></pre></div>
<ul>
<li>Annotationen für Autoren und Version: <code>@author</code>, <code>@version</code>, <code>@since</code></li>
</ul>
<p>Diese Annotationen finden Sie vor allem in Kommentaren zu Packages oder Klassen.</p>
<h2 id="was-muss-kommentiert-werden">Was muss kommentiert werden?</h2>
<ul>
<li>
<p>Alle <code>public</code> Klassen</p>
</li>
<li>
<p>Alle <code>public</code> und <code>protected</code> Elemente der Klassen</p>
</li>
<li>
<p>Ausnahme: <code>@Override</code> (An diesen Methoden <em>kann</em>, aber <em>muss</em> nicht kommentiert werden.)</p>
</li>
</ul>
<p>Alle anderen Elemente bei Bedarf mit <em>normalen</em> Kommentaren versehen.</p>
<h3 id="beispiel-aus-dem-jdk-arraylist">Beispiel aus dem JDK: ArrayList</h3>
<p>Schauen Sie sich gern mal Klassen aus der Java-API an, beispielsweise eine <code>java.util.ArrayList</code>:</p>
<ul>
<li>Generierte Dokumentation:
<a href="https://docs.oracle.com/javase/8/docs/api/index.html?java/util/package-summary.html" rel="external" target="_blank">zu &quot;ArrayList&quot; runterscrollen</a>
bzw. <a href="https://docs.oracle.com/javase/8/docs/api/java/util/ArrayList.html" rel="external" target="_blank">direkt</a></li>
<li>Quellcode: <a href="https://hg.openjdk.java.net/jdk8/jdk8/jdk/file/tip/src/share/classes/java/util/ArrayList.java" rel="external" target="_blank">ArrayList.java</a></li>
</ul>
<h3 id="best-practices-was-beschreibe-ich-eigentlich">Best Practices: Was beschreibe ich eigentlich?</h3>
<p>Unter <a href="https://github.com/google/styleguide/blob/gh-pages/docguide/best_practices.md#documentation-is-the-story-of-your-code" rel="external" target="_blank">Documentation Best Practices</a>
finden Sie eine sehr gute Beschreibung, was das Ziel der Dokumentation sein sollte. Versuchen Sie, dieses zu erreichen!</p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Javadoc-Kommentare sind normale Block-Kommentare beginnend mit <code>/**</code></p>
</li>
<li>
<p>Generierung der HTML-Dokumentation mit <code>javadoc *.java</code></p>
</li>
<li>
<p>Erste Zeile ist eine Zusammenfassung (fast immer sichtbar)</p>
</li>
<li>
<p>Längerer Text danach als &quot;Description&quot; einer Methode/Klasse</p>
</li>
<li>
<p>Annotationen für besondere Elemente: <code>@param</code>, <code>@return</code>, <code>@throws</code>, <code>@deprecated</code></p>
</li>
<li>
<p>Faustregel: Alle <code>public</code> und <code>protected</code> Elemente mit Javadoc kommentieren!</p>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106229&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Javadoc (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachten Sie die Javadoc einiger Klassen im Dungeon-Projekt:
<a href="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/dojo-dungeon/src/dojo/rooms/LevelRoom.java" rel="external" target="_blank">dojo.rooms.LevelRoom</a>,
<a href="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/dojo-dungeon/src/dojo/rooms/MonsterRoom.java" rel="external" target="_blank">dojo.rooms.MonsterRoom</a>, und
<a href="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/dungeon/src/contrib/components/HealthComponent.java" rel="external" target="_blank">contrib.components.HealthComponent</a>.</p>
<p>Stellen Sie sich vor, Sie müssten diese Klassen in einer Übungsaufgabe nutzen (das könnte tatsächlich passieren!) ...</p>
<p>Können Sie anhand der Javadoc verstehen, wozu die drei Klassen dienen und wie Sie diese Klassen benutzen sollten?
Vergleichen Sie die Qualität der Dokumentation.
Was würden Sie gern in der Dokumentation finden?
Was würden Sie ändern?</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_googlestyleguide'>[googlestyleguide] <a href='https://google.github.io/styleguide/javaguide.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Google Java Style Guide</strong></a><br>Google Open Source, 2022.<br><em>Kap. 7 Javadoc</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kap. 23.4: Dokumentationskommentare mit Javadoc</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Logging</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Im Paket <code>java.util.logging</code> findet sich eine einfache Logging-API.</p>
<p>Über die Methode <code>getLogger()</code> der Klasse <code>Logger</code> (<em>Factory-Method-Pattern</em>)
kann ein (neuer) Logger erzeugt werden, dabei wird über den String-Parameter
eine Logger-Hierarchie aufgebaut analog zu den Java-Package-Strukturen. Der
oberste Logger (der &quot;Root-Logger&quot;) hat den leeren Namen.</p>
<p>Jeder Logger kann mit einem Log-Level (Klasse <code>Level</code>) eingestellt werden;
Log-Meldungen unterhalb des eingestellten Levels werden verworfen.</p>
<p>Vom Logger nicht verworfene Log-Meldungen werden an den bzw. die Handler des
Loggers und (per Default) an den Eltern-Logger weiter gereicht. Die Handler
haben ebenfalls ein einstellbares Log-Level und verwerfen alle Nachrichten
unterhalb der eingestellten Schwelle. Zur tatsächlichen Ausgabe gibt man einem
Handler noch einen Formatter mit. Defaultmäßig hat nur der Root-Logger einen
Handler.</p>
<p>Der Root-Logger (leerer String als Name) hat als Default-Level (wie auch sein
Console-Handler) &quot;<code>Info</code>&quot; eingestellt.</p>
<p>Nachrichten, die durch Weiterleitung nach oben empfangen wurden, werden nicht
am Log-Level des empfangenden Loggers gemessen, sondern akzeptiert und an die
Handler des Loggers und (sofern nicht deaktiviert) an den Elternlogger weitergereicht.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/_jYWJzr1rkA' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Logging</a></li> <li><a href='https://youtu.be/fWSc5A_CPL8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Logging (Überblick)</a></li> <li><a href='https://youtu.be/0UUVQCVYNHo' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Log-Level</a></li> <li><a href='https://youtu.be/dYOYA99EfrY' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Logging: Handler und Formatter</a></li> <li><a href='https://youtu.be/19Bki4IglWQ' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Weiterleitung an den Elternlogger</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/a91451640b7833daed3f6fb212fff9490ef6b8885783cc0297603a418055f1a8c2ff7b51f3cb9fb2c4344132eb95bef5af55201f8958f24d767dbd075120bce2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Logging</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Nutzung der Java Logging API im Paket <code>java.util.logging</code></li> <li>(K3) Erstellung eigener Handler und Formatter</li></ul>
  </div>
</div>




    <h2 id="wie-prüfen-sie-die-werte-von-variablenobjekten">Wie prüfen Sie die Werte von Variablen/Objekten?</h2>
<ol>
<li>
<p>Debugging</p>
<ul>
<li>Beeinflusst Code nicht</li>
<li>Kann schnell komplex und umständlich werden</li>
<li>Sitzung transient - nicht wiederholbar</li>
</ul>
</li>
<li>
<p>&quot;Poor-man's-debugging&quot; (Ausgaben mit <code>System.out.println</code>)</p>
<ul>
<li>Müssen irgendwann entfernt werden</li>
<li>Ausgabe nur auf einem Kanal (Konsole)</li>
<li>Keine Filterung nach Problemgrad - keine Unterscheidung
zwischen Warnungen, einfachen Informationen, ...</li>
</ul>
</li>
<li>
<p><strong>Logging</strong></p>
<ul>
<li>Verschiedene (Java-) Frameworks:
<code>java.util.logging</code> (JDK), <em>log4j</em> (Apache), <em>SLF4J</em>, <em>Logback</em>, ...</li>
</ul>
</li>
</ol>
<h2 id="java-logging-api---überblick">Java Logging API - Überblick</h2>
<p>Paket <code>java.util.logging</code></p>
<p><a href="#R-image-136e15aadf76c408e13cc9da12871566" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/logging/logging.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-136e15aadf76c408e13cc9da12871566"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/logging/logging.png?width=80%25&height=auto"></a></p>
<p>Eine Applikation kann verschiedene Logger instanziieren. Die Logger bauen
per Namenskonvention hierarchisch aufeinander auf. Jeder Logger kann selbst
mehrere Handler haben, die eine Log-Nachricht letztlich auf eine bestimmte
Art und Weise an die Außenwelt weitergeben.</p>
<p>Log-Meldungen werden einem Level zugeordnet. Jeder Logger und Handler hat
ein Mindest-Level eingestellt, d.h. Nachrichten mit einem kleineren Level
werden verworfen.</p>
<p>Zusätzlich gibt es noch Filter, mit denen man Nachrichten (zusätzlich zum
Log-Level) nach weiteren Kriterien filtern kann.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/coding/src/logging/LoggingDemo.java" target="_blank"><span class="title">Konsole: logging.LoggingDemo</span></a></span></div>
<h2 id="erzeugen-neuer-logger">Erzeugen neuer Logger</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.logging.Logger;
</span></span><span style="display:flex;"><span>Logger l <span style="color:#f92672">=</span> Logger.<span style="color:#a6e22e">getLogger</span>(MyClass.<span style="color:#a6e22e">class</span>.<span style="color:#a6e22e">getName</span>());</span></span></code></pre></div>
<ul>
<li>
<p><span class='alert'><strong>Factory-Methode</strong></span> der Klasse <code>java.util.logging.Logger</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Logger <span style="color:#a6e22e">getLogger</span>(String name);</span></span></code></pre></div>
<p>=&gt; Methode liefert bereits <strong>vorhandenen Logger</strong> mit diesem Namen (sonst neuen Logger)</p>
</li>
<li>
<p><span class='alert'><strong>Best Practice</strong></span>:
Nutzung des voll-qualifizierten Klassennamen: <code>MyClass.class.getName()</code></p>
<ul>
<li>Leicht zu implementieren</li>
<li>Leicht zu erklären</li>
<li>Spiegelt modulares Design</li>
<li>Ausgaben enthalten automatisch Hinweis auf Herkunft (Lokalität) der Meldung</li>
<li><strong>Alternativen</strong>: Funktionale Namen wie &quot;XML&quot;, &quot;DB&quot;, &quot;Security&quot;</li>
</ul>
</li>
</ul>
<h2 id="ausgabe-von-logmeldungen">Ausgabe von Logmeldungen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">log</span>(Level level, String msg);</span></span></code></pre></div>
<ul>
<li>
<p>Diverse Convenience-Methoden (Auswahl):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">warning</span>(String msg)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">info</span>(String msg)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">entering</span>(String srcClass, String srcMethod)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">exiting</span>(String srcClass, String srcMethod)</span></span></code></pre></div>
</li>
<li>
<p>Beispiel</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.logging.Logger;
</span></span><span style="display:flex;"><span>Logger l <span style="color:#f92672">=</span> Logger.<span style="color:#a6e22e">getLogger</span>(MyClass.<span style="color:#a6e22e">class</span>.<span style="color:#a6e22e">getName</span>());
</span></span><span style="display:flex;"><span>l.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">&#34;Hello World :-)&#34;</span>);</span></span></code></pre></div>
</li>
</ul>
<h2 id="wichtigkeit-von-logmeldungen-stufen">Wichtigkeit von Logmeldungen: Stufen</h2>
<ul>
<li>
<p><code>java.util.logger.Level</code> definiert 7 Stufen:</p>
<ul>
<li><code>SEVERE</code>, <code>WARNING</code>, <code>INFO</code>, <code>CONFIG</code>, <code>FINE</code>, <code>FINER</code>, <code>FINEST</code>
(von höchster zu niedrigster Prio)</li>
<li>Zusätzlich <code>ALL</code> und <code>OFF</code></li>
</ul>
</li>
<li>
<p>Nutzung der Log-Level:</p>
<ul>
<li>Logger hat Log-Level: Meldungen mit kleinerem Level werden verworfen</li>
<li>Prüfung mit <code>public boolean isLoggable(Level)</code></li>
<li>Setzen mit <code>public void setLevel(Level)</code></li>
</ul>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/coding/src/logging/LoggingLevel.java" target="_blank"><span class="title">Konsole: logging.LoggingLevel</span></a></span></div>
<p>=&gt; Warum wird im Beispiel nach <code>log.setLevel(Level.ALL);</code> trotzdem nur
ab <code>INFO</code> geloggt? Wer erzeugt eigentlich die Ausgaben?!</p>
<h2 id="jemand-muss-die-arbeit-machen-">Jemand muss die Arbeit machen ...</h2>
<ul>
<li>
<p>Pro Logger <strong>mehrere</strong> Handler möglich</p>
<ul>
<li>Logger übergibt nicht verworfene Nachrichten an Handler</li>
<li>Handler haben selbst ein Log-Level (analog zum Logger)</li>
<li>Handler verarbeiten die Nachrichten, wenn Level ausreichend</li>
</ul>
</li>
<li>
<p>Standard-Handler: <code>StreamHandler</code>, <code>ConsoleHandler</code>, <code>FileHandler</code></p>
</li>
<li>
<p>Handler nutzen zur Formatierung der Ausgabe einen <code>Formatter</code></p>
</li>
<li>
<p>Standard-Formatter: <code>SimpleFormatter</code> und <code>XMLFormatter</code></p>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/coding/src/logging/LoggingHandler.java" target="_blank"><span class="title">Konsole: logging.LoggingHandler</span></a></span></div>
<p>=&gt; Warum wird im Beispiel nach dem Auskommentieren von
<code>log.setUseParentHandlers(false);</code> immer noch eine zusätzliche Ausgabe
angezeigt (ab <code>INFO</code> aufwärts)?!</p>
<h2 id="ich--bin--dein--vater-">Ich ... bin ... Dein ... Vater ...</h2>
<ul>
<li>
<p>Logger bilden <span class='alert'><strong>Hierarchie</strong></span> über Namen</p>
<ul>
<li>Trenner für Namenshierarchie: &quot;<code>.</code>&quot; (analog zu Packages) =&gt; mit jedem &quot;<code>.</code>&quot; wird eine weitere Ebene der Hierarchie aufgemacht ...</li>
<li>Jeder Logger kennt seinen Eltern-Logger: <code>Logger#getParent()</code></li>
<li>Basis-Logger: leerer Name (<code>&quot;&quot;</code>)
<ul>
<li>Voreingestelltes Level des Basis-Loggers: <code>Level.INFO</code> (!)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Weiterleiten von Nachrichten</p>
<ul>
<li>Nicht verworfene Log-Aufrufe werden an Eltern-Logger weitergeleitet (Default)
<ul>
<li>Abschalten mit <code>Logger#setUseParentHandlers(false);</code></li>
</ul>
</li>
<li>Diese leiten an ihre Handler sowie an ihren Eltern-Logger weiter (unabhängig von Log-Level!)</li>
</ul>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/coding/src/logging/LoggingParent.java" target="_blank"><span class="title">Konsole: logging.LoggingParent; Tafel: Skizze Logger-Baum</span></a></span></div>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Java Logging API im Paket <code>java.util.logging</code></p>
</li>
<li>
<p>Neuer Logger über <strong>Factory-Methode</strong> der Klasse <code>Logger</code></p>
<ul>
<li>Einstellbares Log-Level (Klasse <code>Level</code>)</li>
<li>Handler kümmern sich um die Ausgabe, nutzen dazu Formatter</li>
<li>Mehrere Handler je Logger registrierbar</li>
<li>Log-Level auch für Handler einstellbar (!)</li>
<li>Logger (und Handler) &quot;interessieren&quot; sich nur für Meldungen ab
bestimmter Wichtigkeit</li>
<li>Logger reichen nicht verworfene Meldungen defaultmäßig an
Eltern-Logger weiter (rekursiv)</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106228&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Logging (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Logger-Konfiguration</strong></p>
<p>Betrachten Sie den folgenden Java-Code:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> java.util.logging.*;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Logging</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        Logger l <span style="color:#f92672">=</span> Logger.<span style="color:#a6e22e">getLogger</span>(<span style="color:#e6db74">&#34;Logging&#34;</span>);
</span></span><span style="display:flex;"><span>        l.<span style="color:#a6e22e">setLevel</span>(Level.<span style="color:#a6e22e">FINE</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ConsoleHandler myHandler <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ConsoleHandler();
</span></span><span style="display:flex;"><span>        myHandler.<span style="color:#a6e22e">setFormatter</span>(<span style="color:#66d9ef">new</span> SimpleFormatter() {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">format</span>(LogRecord record) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;WUPPIE\n&#34;</span>;
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>        l.<span style="color:#a6e22e">addHandler</span>(myHandler);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        l.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">&#34;A&#34;</span>);
</span></span><span style="display:flex;"><span>        l.<span style="color:#a6e22e">fine</span>(<span style="color:#e6db74">&#34;B&#34;</span>);
</span></span><span style="display:flex;"><span>        l.<span style="color:#a6e22e">finer</span>(<span style="color:#e6db74">&#34;C&#34;</span>);
</span></span><span style="display:flex;"><span>        l.<span style="color:#a6e22e">finest</span>(<span style="color:#e6db74">&#34;D&#34;</span>);
</span></span><span style="display:flex;"><span>        l.<span style="color:#a6e22e">severe</span>(<span style="color:#e6db74">&#34;E&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Welche Ausgaben entstehen durch den obigen Code? Erklären Sie, welche der Logger-Aufrufe zu einer Ausgabe
führen und wieso und wie diese Ausgaben zustande kommen bzw. es keine Ausgabe bei einem Logger-Aufruf gibt.
Gehen Sie dabei auf jeden der fünf Aufrufe ein.</p>
<p><strong>Analyse eines Live-Beispiels aus dem Dungeon</strong></p>
<p>Analysieren Sie die Konfiguration des Loggers im Dungeon-Projekt:
<a href="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/game/src/core/utils/logging/LoggerConfig.java" rel="external" target="_blank">Dungeon-CampusMinden/Dungeon: core/utils/logging/LoggerConfig.java</a>.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_JDK-Doc'>[JDK-Doc] <a href='https://docs.oracle.com/en/java/javase/17/core/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java Core Libraries Developer Guide</strong></a><br>Oracle Corporation, 2022.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Code Smells</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Code entsteht nicht zum Selbstzweck, er muss von anderen Menschen leicht verstanden und
gewartet werden können: Entwickler verbringen einen wesentlichen Teil ihrer Zeit mit dem
<strong>Lesen</strong> von (fremdem) Code. Dabei helfen &quot;Coding Conventions&quot;, die eine gewisse einheitliche
äußerliche Erscheinung des Codes vorgeben (Namen, Einrückungen, ...). Die Beachtung von
grundlegenden Programmierprinzipien hilft ebenso, die Lesbarkeit und Verständlichkeit zu
verbessern.</p>
<p>Code, der diese Konventionen und Regeln verletzt, zeigt sogenannte &quot;<strong>Code Smells</strong>&quot; oder
&quot;Bad Smells&quot;. Das sind Probleme im Code, die noch nicht direkt zu einem Fehler führen, die
aber im Laufe der Zeit die Chance für echte Probleme deutlich erhöht.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/ALDuLxm71tg' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Code Smells</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/9d53c3536ada817eee76c9f6e8f7838bfb2308a79d220b8dab0a3cf339f90c52e28ae25e85a652d6da31c8f38c581463bc1679fa5f9cc376115558f7fee41217' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Code Smells</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Erkennen und Vermeiden von Code Smells</li> <li>(K3) Unterscheiden von leicht lesbarem und schwer lesbarem Code</li> <li>(K3) Programmierprinzipien anwenden, um den Code sauberer zu gestalten</li> <li>(K3) Bessere Kommentare schreiben</li></ul>
  </div>
</div>




    <h2 id="code-smells-ist-das-code-oder-kann-das-weg">Code Smells: Ist das Code oder kann das weg?</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">checker</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">CheckANDDO</span>(DATA1 inp, <span style="color:#66d9ef">int</span> c, FH.<span style="color:#a6e22e">Studi</span>
</span></span><span style="display:flex;"><span>    CustD, <span style="color:#66d9ef">int</span> x, <span style="color:#66d9ef">int</span> y, <span style="color:#66d9ef">int</span> in, <span style="color:#66d9ef">int</span> out,<span style="color:#66d9ef">int</span> c1, <span style="color:#66d9ef">int</span> c2, <span style="color:#66d9ef">int</span> c3 <span style="color:#f92672">=</span> 4)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// neues i</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span>(i<span style="color:#f92672">=</span>0;i<span style="color:#f92672">&lt;</span>10;i<span style="color:#f92672">++</span>) <span style="color:#75715e">// fuer alle i</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>        inp.<span style="color:#a6e22e">kurs</span><span style="color:#f92672">[</span>0<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> 10; inp.<span style="color:#a6e22e">kurs</span><span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> CustD.<span style="color:#a6e22e">cred</span><span style="color:#f92672">[</span>i<span style="color:#f92672">]/</span>c;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>      SetDataToPlan(  CustD  );
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">double</span> myI <span style="color:#f92672">=</span> in<span style="color:#f92672">*</span>2.<span style="color:#a6e22e">5</span>; <span style="color:#75715e">// myI=in*2.5</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (c1)
</span></span><span style="display:flex;"><span>        out <span style="color:#f92672">=</span> myI; <span style="color:#75715e">//OK</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span>(  c3 <span style="color:#f92672">==</span> 4  )
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        myI <span style="color:#f92672">=</span> c2 <span style="color:#f92672">*</span> myI;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (c3 <span style="color:#f92672">!=</span> 4 <span style="color:#f92672">||</span> <span style="color:#66d9ef">true</span> ) { <span style="color:#75715e">// unbedingt beachten!</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//System.out.println(&#34;x:&#34;+(x++));</span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;x:&#34;</span><span style="color:#f92672">+</span>(x<span style="color:#f92672">++</span>)); <span style="color:#75715e">// x++</span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;out: &#34;</span><span style="color:#f92672">+</span>out);
</span></span><span style="display:flex;"><span>    } }}   }</span></span></code></pre></div>
<p>Der Code im obigen Beispiel lässt sich möglicherweise kompilieren. Und
möglicherweise tut er sogar das, was er tun soll.</p>
<p>Dennoch: <span class='alert'><strong>Der Code &quot;stinkt&quot;</strong></span> (zeigt <strong>Code Smells</strong>):</p>
<ul>
<li>Nichtbeachtung üblicher Konventionen (Coding Rules)</li>
<li>Schlechte Kommentare</li>
<li>Auskommentierter Code</li>
<li>Fehlende Datenkapselung</li>
<li>Zweifelhafte Namen</li>
<li>Duplizierter Code</li>
<li>&quot;Langer&quot; Code: Lange Methoden, Klassen, Parameterlisten, tief
verschachtelte <code>if/then</code>-Bedingungen, ...</li>
<li>Feature Neid</li>
<li><code>switch/case</code> oder <code>if/else</code> statt Polymorphie</li>
<li>Globale Variablen, lokale Variablen als Attribut</li>
<li>Magic Numbers</li>
</ul>
<p>Diese Liste enthält die häufigsten &quot;Smells&quot; und ließe sich noch beliebig fortsetzen.
Schauen Sie mal in die unten angegebene Literatur :-)</p>
<p><strong>Stinkender Code führt zu möglichen (späteren) Problemen.</strong></p>
<h2 id="was-ist-guter-sauberer-code-clean-code">Was ist guter (&quot;sauberer&quot;) Code (&quot;Clean Code&quot;)?</h2>
<p>Im Grunde bezeichnet &quot;sauberer Code&quot; (&quot;Clean Code&quot;) die Abwesenheit von Smells. D.h. man
könnte Code als &quot;sauberen&quot; Code bezeichnen, wenn die folgenden Eigenschaften erfüllt sind
(keine vollständige Aufzählung!):</p>
<ul>
<li>Gut (&quot;angenehm&quot;) lesbar</li>
<li>Schnell verständlich: Geeignete Abstraktionen</li>
<li>Konzentriert sich auf <strong>eine</strong> Aufgabe</li>
<li>So einfach und direkt wie möglich</li>
<li>Ist gut getestet</li>
</ul>
<p>In <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/smells.html#id_Martin2009">[Martin2009]</a> lässt der Autor Robert Martin verschiedene Ikonen der SW-Entwicklung
zu diesem Thema zu Wort kommen - eine sehr lesenswerte Lektüre!</p>
<p>=&gt; Jemand kümmert sich um den Code; solides Handwerk</p>
<h2 id="warum-ist-guter-sauberer-code-so-wichtig">Warum ist guter (&quot;sauberer&quot;) Code so wichtig?</h2>
<blockquote>
<p>Any fool can write code that a computer can understand.
Good programmers write code that humans can understand.</p>
<p> <span class='origin'>Quelle: <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/smells.html#id_Fowler2011">[Fowler2011, p. 15]</a></span></p>
</blockquote>
<p>Auch wenn das zunächst seltsam klingt, aber Code muss auch von Menschen gelesen und
verstanden werden können. Klar, der Code muss inhaltlich korrekt sein und die jeweilige
Aufgabe erfüllen, er muss kompilieren etc. ... aber er muss auch von anderen Personen
weiter entwickelt werden und dazu gelesen und verstanden werden. Guter Code ist nicht
einfach nur inhaltlich korrekt, sondern kann auch einfach verstanden werden.</p>
<p>Code, der nicht einfach lesbar ist oder nur schwer verständlich ist, wird oft in der
Praxis später nicht gut gepflegt: Andere Entwickler haben (die berechtigte) Angst, etwas
kaputt zu machen und arbeiten &quot;um den Code herum&quot;. Nur leider wird das Konstrukt dann
nur noch schwerer verständlich ...</p>
<h3 id="code-smells">Code Smells</h3>
<p>Verstöße gegen die Prinzipien von <em>Clean Code</em> nennt man auch <em>Code Smells</em>: Der
Code &quot;stinkt&quot; gewissermaßen. Dies bedeutet nicht unbedingt, dass der Code nicht
funktioniert (d.h. er kann dennoch compilieren und die Anforderungen erfüllen).
Er ist nur nicht sauber formuliert, schwer verständlich, enthält Doppelungen etc.,
was im Laufe der Zeit die Chance für tatsächliche Probleme deutlich erhöht.</p>
<p>Und weil es so wichtig ist, hier gleich noch einmal:</p>
<div class='center'>
<p><span class='alert'><strong>Stinkender Code führt zu möglichen (späteren) Problemen.</strong></span></p>
</div>
<h3 id="broken-windows-phänomen">&quot;Broken Windows&quot; Phänomen</h3>
<p>Wenn ein Gebäude leer steht, wird es eine gewisse Zeit lang nur relativ langsam
verfallen: Die Fenster werden nicht mehr geputzt, es sammelt sich Graffiti, Gras
wächst in der Dachrinne, Putz blättert ab ...</p>
<p>Irgendwann wird dann eine Scheibe eingeworfen. Wenn dieser Punkt überschritten
ist, beschleunigt sich der Verfall rasant: Über Nacht werden alle erreichbaren
Scheiben eingeworfen, Türen werden zerstört, es werden sogar Brände gelegt ...</p>
<p>Das passiert auch bei Software! Wenn man als Entwickler das Gefühl bekommt,
die Software ist nicht gepflegt, wird man selbst auch nur relativ schlechte
Arbeit abliefern. Sei es, weil man nicht versteht, was der Code macht und sich
nicht an die Überarbeitung der richtigen Stellen traut und stattdessen die
Änderungen als weiteren &quot;Erker&quot; einfach dran pappt. Seit es, weil man keine Lust
hat, Zeit in ordentliche Arbeit zu investieren, weil der Code ja eh schon
schlecht ist ... Das wird mit der Zeit nicht besser ...</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://en.wikipedia.org/wiki/Broken_windows_theory" target="_blank"><span class="title">&quot;Broken Windows&quot; Phänomen</span></a></span></div>
<h3 id="maßeinheit-für-code-qualität--">Maßeinheit für Code-Qualität ;-)</h3>
<p>Es gibt eine &quot;praxisnahe&quot; (und nicht ganz ernst gemeinte) Maßeinheit für Code-Qualität:
Die &quot;WTF/m&quot; (<em>What the Fuck per minute</em>):
<a href="https://www.osnews.com/story/19266/wtfsm/" rel="external" target="_blank">Thom Holwerda: www.osnews.com/story/19266/WTFs_</a>.</p>
<p>Wenn beim Code-Review durch Kollegen viele &quot;WTF&quot; kommen, ist der Code offenbar nicht
in Ordnung ...</p>
<h2 id="code-smells-nichtbeachtung-von-coding-conventions">Code Smells: Nichtbeachtung von Coding Conventions</h2>
<ul>
<li>
<p>Richtlinien für einheitliches Aussehen
=&gt; Andere Programmierer sollen Code schnell lesen können</p>
<ul>
<li>Namen, Schreibweisen</li>
<li>Kommentare (Ort, Form, Inhalt)</li>
<li>Einrückungen und Spaces vs. Tabs</li>
<li>Zeilenlängen, Leerzeilen</li>
<li>Klammern</li>
</ul>
</li>
<li>
<p>Beispiele: <a href="https://www.oracle.com/technetwork/java/codeconventions-150003.pdf" rel="external" target="_blank">Sun Code Conventions</a>,
<a href="https://google.github.io/styleguide/javaguide.html" rel="external" target="_blank">Google Java Style</a></p>
</li>
<li>
<p><em>Hinweis</em>: Betrifft vor allem die (äußere) Form!</p>
</li>
</ul>
<h2 id="code-smells-schlechte-kommentare-i">Code Smells: Schlechte Kommentare I</h2>
<ul>
<li>
<p>Ratlose Kommentare</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">/* k.A. was das bedeutet, aber wenn man es raus nimmt, geht&#39;s nicht mehr */</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/* TODO: was passiert hier, und warum? */</span></span></span></code></pre></div>
<p>Der Programmierer hat selbst nicht verstanden (und macht sich auch nicht
die Mühe zu verstehen), was er da tut! Fehler sind vorprogrammiert!</p>
</li>
<li>
<p>Redundante Kommentare: Erklären Sie, was der Code <strong>inhaltlich</strong> tun sollte (und warum)!</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> i; <span style="color:#75715e">// neues i</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span>(i<span style="color:#f92672">=</span>0;i<span style="color:#f92672">&lt;</span>10;i<span style="color:#f92672">++</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> fuer alle i</span></span></code></pre></div>
<p>Was würden Sie Ihrem Kollegen erklären (müssen), wenn Sie ihm/ihr den
Code vorstellen?</p>
<p>Wiederholen Sie nicht, was der Code tut (das kann ich ja selbst lesen),
sondern beschreiben Sie, was der Code tun <em>sollte</em> und <em>warum</em>.</p>
<p>Beschreiben Sie dabei auch das Konzept hinter einem Codebaustein.</p>
</li>
</ul>
<h2 id="code-smells-schlechte-kommentare-ii">Code Smells: Schlechte Kommentare II</h2>
<ul>
<li>
<p>Veraltete Kommentare</p>
<p>Hinweis auf unsauberes Arbeiten: Oft wird im Zuge der Überarbeitung von
Code-Stellen vergessen, auch den Kommentar anzupassen! Sollte beim Lesen
extrem misstrauisch machen.</p>
</li>
<li>
<p>Auskommentierter Code</p>
<p>Da ist jemand seiner Sache unsicher bzw. hat eine Überarbeitung nicht
abgeschlossen. Die Chance, dass sich der restliche Code im Laufe der Zeit
so verändert, dass der auskommentierte Code nicht mehr (richtig) läuft, ist
groß! Auskommentierter Code ist gefährlich und dank Versionskontrolle
absolut überflüssig!</p>
</li>
<li>
<p>Kommentare erscheinen zwingend nötig</p>
<p>Häufig ein Hinweis auf ungeeignete Wahl der Namen (Klassen, Methoden,
Attribute) und/oder auf ein ungeeignetes Abstraktionsniveau (beispielsweise
Nichtbeachtung des Prinzips der &quot;<em>Single Responsibility</em>&quot;)!</p>
<p>Der Code soll im <strong>Normalfall</strong> für sich selbst sprechen: <strong>WAS</strong> wird gemacht.
Der Kommentar erklärt im Normalfall, <strong>WARUM</strong> der Code das machen soll.</p>
</li>
<li>
<p>Unangemessene Information, z.B. Änderungshistorien</p>
<p>Hinweise wie &quot;wer hat wann was geändert&quot; gehören in das Versionskontroll-
oder ins Issue-Tracking-System. Die Änderung ist im Code sowieso nicht mehr
sichtbar/nachvollziehbar!</p>
</li>
</ul>
<h2 id="code-smells-schlechte-namen-und-fehlende-kapselung">Code Smells: Schlechte Namen und fehlende Kapselung</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> <span style="color:#66d9ef">extends</span> Person {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String n;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> c;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">prtIf</span>() { ... }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Nach drei Wochen fragen Sie sich, was <code>n</code> oder <code>c</code> oder <code>Studi#prtIf()</code> wohl
sein könnte! (Ein anderer Programmierer fragt sich das schon beim <strong>ersten</strong>
Lesen.) Klassen und Methoden sollten sich erwartungsgemäß verhalten.</p>
<p>Wenn Dinge öffentlich angeboten werden, muss man damit rechnen, dass andere
darauf zugreifen. D.h. man kann nicht mehr so einfach Dinge wie die interne
Repräsentation oder die Art der Berechnung austauschen! Öffentliche Dinge
gehören zur Schnittstelle und damit Teil des &quot;Vertrags&quot; mit den Nutzern!</p>
<ul>
<li>
<p>Programmierprinzip &quot;<strong>Prinzip der minimalen Verwunderung</strong>&quot;</p>
<ul>
<li>Klassen und Methoden sollten sich erwartungsgemäß verhalten</li>
<li>Gute Namen ersparen das Lesen der Dokumentation</li>
</ul>
</li>
<li>
<p>Programmierprinzip &quot;<strong>Kapselung/Information Hiding</strong>&quot;</p>
<ul>
<li>Möglichst schlanke öffentliche Schnittstelle</li>
<li>=&gt; &quot;Vertrag&quot; mit Nutzern der Klasse!</li>
</ul>
</li>
</ul>
<h2 id="code-smells-duplizierter-code">Code Smells: Duplizierter Code</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getName</span>() { <span style="color:#66d9ef">return</span> name; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getAddress</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> strasse<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;, &#34;</span><span style="color:#f92672">+</span>plz<span style="color:#f92672">+</span><span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">+</span>stadt;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getStudiAsString</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> name<span style="color:#f92672">+</span><span style="color:#e6db74">&#34; (&#34;</span><span style="color:#f92672">+</span>strasse<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;, &#34;</span><span style="color:#f92672">+</span>plz<span style="color:#f92672">+</span><span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">+</span>stadt<span style="color:#f92672">+</span><span style="color:#e6db74">&#34;)&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ul>
<li>Programmierprinzip &quot;<strong>DRY</strong>&quot; =&gt; &quot;Don't repeat yourself!&quot;</li>
</ul>
<p>Im Beispiel wird das Formatieren der Adresse mehrfach identisch implementiert,
d.h. duplizierter Code. Auslagern in eigene Methode und aufrufen!</p>
<p>Kopierter/duplizierter Code ist problematisch:</p>
<ul>
<li>Spätere Änderungen müssen an mehreren Stellen vorgenommen werden</li>
<li>Lesbarkeit/Orientierung im Code wird erschwert (Analogie: Reihenhaussiedlung)</li>
<li>Verpasste Gelegenheit für sinnvolle Abstraktion!</li>
</ul>
<h2 id="code-smells-langer-code">Code Smells: Langer Code</h2>
<ul>
<li>
<p>Lange Klassen</p>
<ul>
<li>Faustregel: 5 Bildschirmseiten sind viel</li>
</ul>
</li>
<li>
<p>Lange Methoden</p>
<ul>
<li>Faustregel: 1 Bildschirmseite</li>
<li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/smells.html#id_Martin2009">[Martin2009]</a>: deutlich weniger als 20 Zeilen</li>
</ul>
</li>
<li>
<p>Lange Parameterlisten</p>
<ul>
<li>Faustregel: max. 3 ... 5 Parameter</li>
<li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/smells.html#id_Martin2009">[Martin2009]</a>: 0 Parameter ideal, ab 3 Parameter
gute Begründung nötig</li>
</ul>
</li>
<li>
<p>Tief verschachtelte <code>if/then</code>-Bedingungen</p>
<ul>
<li>Faustregel: 2 ... 3 Einrückungsebenen sind viel</li>
</ul>
</li>
<li>
<p>Programmierprinzip &quot;<strong>Single Responsibility</strong>&quot;</p>
<p>Jede Klasse ist für genau <span class='alert'>einen Aspekt</span> des Gesamtsystems verantwortlich</p>
</li>
</ul>
<h3 id="lesbarkeit-und-übersichtlichkeit-leiden">Lesbarkeit und Übersichtlichkeit leiden</h3>
<ul>
<li>Der Mensch kann sich nur begrenzt viele Dinge im Kurzzeitgedächtnis merken</li>
<li>Klassen, die länger als 5 Bildschirmseiten sind, erfordern viel Hin- und
Her-Scrollen, dito für lange Methoden</li>
<li>Lange Methoden sind schwer verständlich (erledigen viele Dinge?)</li>
<li>Mehr als 3 Parameter kann sich kaum jemand merken, vor allem beim
Aufruf von Methoden</li>
<li>Die Testbarkeit wird bei zu komplexen Methoden/Klassen und vielen Parametern
sehr erschwert</li>
<li>Große Dateien verleiten (auch mangels Übersichtlichkeit) dazu, neuen
Code ebenfalls schluderig zu gliedern</li>
</ul>
<h3 id="langer-code-deutet-auch-auf-eine-verletzung-des-prinzips-der-single-responsibility-hin">Langer Code deutet auch auf eine Verletzung des Prinzips der Single Responsibility hin</h3>
<ul>
<li>
<p>Klassen fassen evtl. nicht zusammengehörende Dinge zusammen</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Student</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String name;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String phoneAreaCode;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String phoneNumber;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printStudentInfo</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;name:    &#34;</span> <span style="color:#f92672">+</span> name);
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;contact: &#34;</span> <span style="color:#f92672">+</span> phoneAreaCode <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/&#34;</span> <span style="color:#f92672">+</span> phoneNumber);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Warum sollte sich die Klasse <code>Student</code> um die Einzelheiten des Aufbaus einer
Telefonnummer kümmern? Das Prinzip der &quot;<em>Single Responsibility</em>&quot; wird hier
verletzt!</p>
</li>
<li>
<p>Methoden erledigen vermutlich mehr als nur eine Aufgabe</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">credits</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (Student s : students) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (s.<span style="color:#a6e22e">hasSemesterFinished</span>()) {
</span></span><span style="display:flex;"><span>            ECTS c <span style="color:#f92672">=</span> calculateEcts(s);
</span></span><span style="display:flex;"><span>            s.<span style="color:#a6e22e">setEctsSum</span>(c);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> Diese Methode erledigt 4 Dinge: Iteration, Abfrage, Berechnung, Setzen ...</span></span></code></pre></div>
<p>=&gt; Erklären Sie die Methode jemandem. Wenn dabei das Wort &quot;und&quot;
vorkommt, macht die Methode höchstwahrscheinlich zu viel!</p>
</li>
<li>
<p>Viele Parameter bedeuten oft fehlende Datenabstraktion</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Circle <span style="color:#a6e22e">makeCircle</span>(<span style="color:#66d9ef">int</span> x, <span style="color:#66d9ef">int</span> y, <span style="color:#66d9ef">int</span> radius);
</span></span><span style="display:flex;"><span>Circle <span style="color:#a6e22e">makeCircle</span>(Point center, <span style="color:#66d9ef">int</span> radius);  <span style="color:#f92672">//</span> besser<span style="color:#f92672">!</span></span></span></code></pre></div>
</li>
</ul>
<h2 id="code-smells-feature-neid">Code Smells: Feature Neid</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CreditsCalculator</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> ECTS <span style="color:#a6e22e">calculateEcts</span>(Student s) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> semester <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">getSemester</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> workload <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">getCurrentWorkload</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> nrModuls <span style="color:#f92672">=</span> s.<span style="color:#a6e22e">getNumberOfModuls</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> total <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">min</span>(30, workload);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> extra <span style="color:#f92672">=</span> Math.<span style="color:#a6e22e">max</span>(0, total <span style="color:#f92672">-</span> 30);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (semester <span style="color:#f92672">&lt;</span> 5) {
</span></span><span style="display:flex;"><span>             extra <span style="color:#f92672">=</span> extra <span style="color:#f92672">*</span> nrModuls;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> ECTS(total <span style="color:#f92672">+</span> extra);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ul>
<li>Zugriff auf (viele) Interna der anderen Klasse! =&gt; Hohe Kopplung der Klassen!</li>
<li>Methode <code>CreditsCalculator#calculateEcts()</code> &quot;möchte&quot; eigentlich in
<code>Student</code> sein ...</li>
</ul>
<h2 id="weiterführende-links">Weiterführende Links</h2>
<ul>
<li><a href="https://www.theodinproject.com/lessons/foundations-clean-code" rel="external" target="_blank">&quot;Foundations: Clean Code&quot; (The Odin Project)</a></li>
<li><a href="https://github.com/google/styleguide/blob/gh-pages/docguide/best_practices.md" rel="external" target="_blank">&quot;Documentation Best Practices&quot; (Google Styleguide)</a></li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Code entsteht nicht zum Selbstzweck =&gt; Lesbarkeit ist wichtig</p>
</li>
<li>
<p>Code Smells: Code führt zu möglichen (späteren) Problemen</p>
<ul>
<li>
<p>Richtiges Kommentieren und Dokumentieren</p>
<p>In dieser Sitzung haben wir vor allem auf Kommentare geschaut. Zum Thema Dokumentieren
siehe die Einheit zu <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/javadoc.html">&ldquo;Javadoc&rdquo;</a>.</p>
</li>
<li>
<p>Einhalten von Coding Conventions</p>
<ul>
<li>Regeln zu Schreibweisen und Layout</li>
<li>Leerzeichen, Einrückung, Klammern</li>
<li>Zeilenlänge, Umbrüche</li>
<li>Kommentare</li>
</ul>
</li>
<li>
<p>Einhalten von Prinzipien des objektorientierten Programmierens</p>
<ul>
<li>Jede Klasse ist für genau <strong>einen</strong> Aspekt des Systems verantwortlich.
(<em>Single Responsibility</em>)</li>
<li>Keine Code-Duplizierung! (<em>DRY</em> - Don't repeat yourself)</li>
<li>Klassen und Methoden sollten sich erwartungsgemäß verhalten</li>
<li>Kapselung: Möglichst wenig öffentlich zugänglich machen</li>
</ul>
</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106230&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Code Smells (ILIAS)</a></li></ul>
  </div>
</div>



    



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Fowler2011'>[Fowler2011] <strong>Refactoring</strong><br>Fowler, M., Addison-Wesley, 2011. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-201-48567-7' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-201-48567-7</a>.</li> <li id='id_Inden2013'>[Inden2013] <strong>Der Weg zum Java-Profi</strong><br>Inden, M., dpunkt.verlag, 2013. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8649-1245-0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8649-1245-0</a>.<br><em>Kapitel 10: Bad Smells</em></li> <li id='id_Martin2009'>[Martin2009] <strong>Clean Code</strong><br>Martin, R., mitp, 2009. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8266-5548-7' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8266-5548-7</a>.</li> <li id='id_Passig2013'>[Passig2013] <strong>Weniger schlecht programmieren</strong><br>Passig, K. und Jander, J., O'Reilly, 2013. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-89721-567-2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-89721-567-2</a>.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Coding Conventions und Metriken</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Code entsteht nicht zum Selbstzweck, er muss von anderen Menschen leicht verstanden und
gewartet werden können: Entwickler verbringen einen wesentlichen Teil ihrer Zeit mit dem
<strong>Lesen</strong> von (fremdem) Code.</p>
<p>Dabei helfen &quot;Coding Conventions&quot;, die eine gewisse einheitliche äußerliche Erscheinung
des Codes vorgeben (Namen, Einrückungen, ...). Im Java-Umfeld ist der &quot;Google Java Style&quot;
bzw. der recht ähnliche &quot;AOSP Java Code Style for Contributors&quot; häufig anzutreffen.
Coding Conventions beinhalten typischerweise Regeln zu</p>
<ul>
<li>Schreibweisen und Layout</li>
<li>Leerzeichen, Einrückung, Klammern</li>
<li>Zeilenlänge, Umbrüche</li>
<li>Kommentare</li>
</ul>
<p>Die Beachtung von grundlegenden Programmierprinzipien hilft ebenso, die Lesbarkeit und
Verständlichkeit zu verbessern.</p>
<p>Metriken sind Kennzahlen, die aus dem Code berechnet werden, und können zur Überwachung
der Einhaltung von Coding Conventions und anderen Regeln genutzt werden. Nützliche
Metriken sind dabei NCSS (<em>Non Commenting Source Statements</em>), McCabe (<em>Cyclomatic Complexity</em>),
BEC (<em>Boolean Expression Complexity</em>) und DAC (<em>Class Data Abstraction Coupling</em>).</p>
<p>Für die Formatierung des Codes kann man die IDE nutzen, muss dort dann aber die Regeln
detailliert manuell einstellen. Das Tool <strong>Spotless</strong> lässt sich dagegen in den Build-Prozess
einbinden und kann die Konfiguration über ein vordefiniertes Regelset passend zum Google
Java Style/AOSP automatisiert vornehmen.</p>
<p>Die Prüfung der Coding Conventions und Metriken kann durch das Tool <strong>Checkstyle</strong> erfolgen.
Dieses kann beispielsweise als Plugin in der IDE oder direkt in den Build-Prozess eingebunden
werden und wird mit Hilfe einer XML-Datei konfiguriert.</p>
<p>Um typische Anti-Pattern zu vermeiden, kann man den Code mit sogenannten <em>Lintern</em> prüfen.
Ein Beispiel für die Java-Entwicklung ist <strong>SpotBugs</strong>, welches sich in den Build-Prozess
einbinden lässt und über 400 typische problematische Muster im Code erkennt.</p>
<p>Für die Praktika in der Veranstaltung Programmiermethoden wird der Google Java Style oder
AOSP genutzt. Für die passende Checkstyle-Konfiguration wird eine minimale
<a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/coding/src/checkstyle.xml" rel="external" target="_blank">checkstyle.xml</a>
bereitgestellt (vgl. Folie &quot;Konfiguration für das PM-Praktikum&quot;).</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/nLAEak6Fwfk' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Coding Conventions</a></li> <li><a href='https://youtu.be/oCMwyDrPkFI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Formatter und Spotless</a></li> <li><a href='https://youtu.be/NR070ZimbH4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Checkstyle</a></li> <li><a href='https://youtu.be/0ny6e6CNTF8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Checkstyle: Konfiguration mit Eclipse-CS</a></li> <li><a href='https://youtu.be/tSczcf_EOwI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo SpotBugs</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/31a425902a7d01e5fd4b3b082259d9d71bcff55030eb4564c98bb044c554162088d7ab02edbf50aff0503232dfd4c3bed43341ec058e272a0cd6f9a388584d84' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Coding Conventions</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Erklären verschiedener Coding Conventions</li> <li>(K2) Erklären wichtiger Grundregeln des objektorientierten Programmierens</li> <li>(K2) Erklären der Metriken NCSS, McCabe, BEC, DAC</li> <li>(K3) Einhalten der wichtigsten Grundregeln des objektorientierten Programmierens</li> <li>(K3) Einhalten der wichtigsten Coding Conventions (Formatierung, Namen, Metriken)</li> <li>(K3) Nutzung des Tools Spotless (Formatierung des Codes)</li> <li>(K3) Nutzung des Tools Checkstyle (Coding Conventions und Metriken)</li> <li>(K3) Nutzung des Tools SpotBugs (Vermeiden von Anti-Pattern)</li></ul>
  </div>
</div>




    <h2 id="coding-conventions-richtlinien-für-einheitliches-aussehen-von-code">Coding Conventions: Richtlinien für einheitliches Aussehen von Code</h2>
<p>=&gt; Ziel: Andere Programmierer sollen Code schnell lesen können</p>
<ul>
<li><strong>Namen, Schreibweisen</strong>: UpperCamelCase vs. lowerCamelCase vs. UPPER_SNAKE_CASE</li>
<li><strong>Kommentare</strong> (Ort, Form, Inhalt): Javadoc an allen <code>public</code> und <code>protected</code> Elementen</li>
<li><strong>Einrückungen und Spaces vs. Tabs</strong>: 4 Spaces</li>
<li><strong>Zeilenlängen</strong>: 100 Zeichen</li>
<li><strong>Leerzeilen</strong>: Leerzeilen für Gliederung</li>
<li><strong>Klammern</strong>: Auf selber Zeile wie Code</li>
</ul>
<p>Beispiele: <a href="https://www.oracle.com/technetwork/java/codeconventions-150003.pdf" rel="external" target="_blank">Sun Code Conventions</a>,
<a href="https://google.github.io/styleguide/javaguide.html" rel="external" target="_blank">Google Java Style</a>,
<a href="https://source.android.com/docs/setup/contribute/code-style" rel="external" target="_blank">AOSP Java Code Style for Contributors</a></p>
<h2 id="beispiel-nach-google-java-styleaosp-formatiert">Beispiel nach Google Java Style/AOSP formatiert</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> wuppie.deeplearning.strategy;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> * Demonstriert den Einsatz von AOSP/Google Java Style ................. Umbruch nach 100 Zeichen |
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyWuppieStudi</span> <span style="color:#66d9ef">implements</span> Comparable<span style="color:#f92672">&lt;</span>MyWuppieStudi<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> String lastName;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> MyWuppieStudi studi;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">MyWuppieStudi</span>() {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/** Erzeugt ein neues Exemplar der MyWuppieStudi-Spezies (max. 40 Zeilen) */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> MyWuppieStudi <span style="color:#a6e22e">getMyWuppieStudi</span>(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (studi <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>            studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> MyWuppieStudi();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (lastName <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) lastName <span style="color:#f92672">=</span> name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> studi;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">compareTo</span>(MyWuppieStudi o) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> lastName.<span style="color:#a6e22e">compareTo</span>(lastName);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Dieses Beispiel wurde nach Google Java Style/AOSP formatiert.</p>
<p>Die Zeilenlänge beträgt max. 100 Zeichen. Pro Methode werden max. 40 Zeilen genutzt. Zwischen Attributen,
Methoden und Importen wird jeweils eine Leerzeile eingesetzt (zwischen den einzelnen Attributen <em>muss</em>
aber keine Leerzeile genutzt werden). Zur logischen Gliederung können innerhalb von Methoden weitere
Leerzeilen eingesetzt werden, aber immer nur eine.</p>
<p>Klassennamen sind UpperCamelCase, Attribute und Methoden und Parameter lowerCamelCase, Konstanten (im
Beispiel nicht vorhanden) UPPER_SNAKE_CASE. Klassen sind Substantive, Methoden Verben.</p>
<p>Alle <code>public</code> und <code>protected</code> Elemente werden mit einem Javadoc-Kommentar versehen. Überschriebene Methoden
müssen nicht mit Javadoc kommentiert werden, müssen aber mit <code>@Override</code> markiert werden.</p>
<p>Geschweifte Klammern starten immer auf der selben Codezeile. Wenn bei einem <code>if</code> nur ein Statement vorhanden
ist und dieses auf die selbe Zeile passt, kann auf die umschließenden geschweiften Klammern ausnahmsweise
verzichtet werden.</p>
<p>Es wird mit Leerzeichen eingerückt. <a href="https://google.github.io/styleguide/javaguide.html#s4.2-block-indentation" rel="external" target="_blank">Google Java Style</a>
arbeitet mit 2 Leerzeichen, während <a href="https://source.android.com/docs/setup/contribute/code-style#use-spaces-for-indentation" rel="external" target="_blank">AOSP</a>
hier 4 Leerzeichen vorschreibt. Im Beispiel wurde nach AOSP eingerückt.</p>
<p>Darüber hinaus gibt es vielfältige weitere Regeln für das Aussehen des Codes. Lesen Sie dazu entsprechend
auf <a href="https://google.github.io/styleguide/javaguide.html" rel="external" target="_blank">Google Java Style</a> und auch auf
<a href="https://source.android.com/docs/setup/contribute/code-style" rel="external" target="_blank">AOSP</a> nach.</p>
<h2 id="formatieren-sie-ihren-code-mit-der-ide">Formatieren Sie Ihren Code (mit der IDE)</h2>
<p>Sie können den Code manuell formatieren, oder aber (sinnvollerweise) über Tools
formatieren lassen. Hier einige Möglichkeiten:</p>
<ul>
<li>
<p>IDE: Code-Style einstellen und zum Formatieren nutzen</p>
</li>
<li>
<p><a href="https://github.com/google/google-java-format" rel="external" target="_blank">google-java-format</a>:
<code>java -jar google-java-format.jar --replace *.java</code>
(auch als IDE-Plugin)</p>
</li>
<li>
<p><a href="https://github.com/diffplug/spotless" rel="external" target="_blank"><strong>Spotless</strong></a> in Gradle:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-groovy" data-lang="groovy"><span style="display:flex;"><span>plugins <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    id <span style="color:#e6db74">&#34;java&#34;</span>
</span></span><span style="display:flex;"><span>    id <span style="color:#e6db74">&#34;com.diffplug.spotless&#34;</span> version <span style="color:#e6db74">&#34;6.5.0&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>spotless <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    java <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// googleJavaFormat()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        googleJavaFormat<span style="color:#f92672">().</span><span style="color:#a6e22e">aosp</span><span style="color:#f92672">()</span>  <span style="color:#75715e">// indent w/ 4 spaces
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div>
<p>Prüfen mit <code>./gradlew spotlessCheck</code> (Teil von <code>./gradlew check</code>)
und Formatieren mit <code>./gradlew spotlessApply</code></p>
</li>
</ul>
<h3 id="einstellungen-der-ides">Einstellungen der IDE's</h3>
<ul>
<li>Eclipse:
<ul>
<li><code>Project &gt; Properties &gt; Java Code Style &gt; Formatter</code>: Coding-Style einstellen/einrichten</li>
<li>Code markieren, <code>Source &gt; Format</code></li>
<li>Komplettes Aufräumen: <code>Source &gt; Clean Up</code> (Formatierung, Importe, Annotationen, ...)
Kann auch so eingestellt werden, dass ein &quot;Clean Up&quot; immer beim Speichern ausgeführt wird!</li>
</ul>
</li>
<li>IntelliJ verfügt über ähnliche Fähigkeiten:
<ul>
<li>Einstellen über <code>Preferences &gt; Editor &gt; Code Style &gt; Java</code></li>
<li>Formatieren mit <code>Code &gt; Reformat Code</code> oder <code>Code &gt; Reformat File</code></li>
</ul>
</li>
</ul>
<p>Die Details kann/muss man einzeln einstellen. Für die &quot;bekannten&quot; Styles (Google Java Style)
bringen die IDE's oft aber schon eine Gesamtkonfiguration mit.</p>
<p><strong>Achtung</strong>: Zumindest in Eclipse gibt es mehrere Stellen, wo ein Code-Style eingestellt werden
kann (&quot;Clean Up&quot;, &quot;Formatter&quot;, ...). Diese sollten dann jeweils auf den selben Style eingestellt
werden, sonst gibt es unter Umständen lustige Effekte, da beim Speichern ein anderer Style
angewendet wird als beim &quot;Clean Up&quot; oder beim &quot;Format Source&quot; ...</p>
<p>Analog sollte man bei der Verwendung von Checkstyle auch in der IDE im Formatter die entsprechenden
Checkstyle-Regeln (s.u.) passend einstellen, sonst bekommt man durch Checkstyle Warnungen angezeigt,
die man durch ein automatisches Formatieren <em>nicht</em> beheben kann.</p>
<h3 id="google-java-style-und-google-java-format">Google Java Style und google-java-format</h3>
<p>Wer direkt den <a href="https://google.github.io/styleguide/javaguide.html" rel="external" target="_blank">Google Java Style</a> nutzt,
kann auch den dazu passenden Formatter von Google einsetzen:
<a href="https://github.com/google/google-java-format" rel="external" target="_blank">google-java-format</a>.
Diesen kann man entweder als Plugin für IntelliJ/Eclipse einsetzen oder als Stand-alone-Tool
(Kommandozeile oder Build-Skripte) aufrufen. Wenn man sich noch einen entsprechenden
Git-Hook definiert, wird vor jedem Commit der Code entsprechend den Richtlinien formatiert :)</p>
<h3 id="spotless-und-google-java-format-in-gradle">Spotless und google-java-format in Gradle</h3>
<p><em>Hinweis</em>: Bei Spotless in Gradle müssen je nach den Versionen von Spotless/google-java-format
bzw. des JDK noch Optionen in der Datei <code>gradle.properties</code> eingestellt werden (siehe
<a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/coding/src/formatter/" rel="external" target="_blank">Demo</a> und
<a href="https://github.com/diffplug/spotless/tree/main/plugin-gradle#google-java-format" rel="external" target="_blank">Spotless &gt; google-java-format (Web)</a>).</p>
<p><strong>Tipp</strong>: Die Formatierung über die IDE ist angenehm, aber in der Praxis leider oft etwas
hakelig: Man muss alle Regeln selbst einstellen (und es gibt <em>einige</em> dieser Einstellungen),
und gerade IntelliJ &quot;greift&quot; manchmal nicht alle Code-Stellen beim Formatieren. Nutzen Sie
Spotless und bauen Sie die Konfiguration in Ihr Build-Skript ein und konfigurieren Sie über
den Build-Prozess.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/coding/src/formatter/" target="_blank"><span class="title">Demo: Konfiguration Formatter (IDE), Spotless/Gradle</span></a></span></div>
<h2 id="metriken-kennzahlen-für-verschiedene-aspekte-zum-code">Metriken: Kennzahlen für verschiedene Aspekte zum Code</h2>
<p>Metriken messen verschiedene Aspekte zum Code und liefern eine Zahl zurück. Mit Metriken kann
man beispielsweise die Einhaltung der Coding Rules (Formate, ...) prüfen, aber auch die Einhaltung
verschiedener Regeln des objektorientierten Programmierens.</p>
<h3 id="beispiele-für-wichtige-metriken-jeweils-max-werte-für-pm">Beispiele für wichtige Metriken (jeweils Max-Werte für PM)</h3>
<p>Die folgenden Metriken und deren Maximal-Werte sind gute Erfahrungswerte aus der Praxis und helfen,
den Code Smell &quot;Langer Code&quot; (vgl. <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/smells.html">&ldquo;Code Smells&rdquo;</a>) zu
erkennen und damit zu vermeiden. Über die Metriken <em>BEC</em>, <em>McCabe</em> und <em>DAC</em> wird auch die Einhaltung
elementarer Programmierregeln gemessen.</p>
<ul>
<li><strong>NCSS</strong> (<em>Non Commenting Source Statements</em>)
<ul>
<li>Zeilen pro Methode: 40; pro Klasse: 250; pro Datei: 300
<em>Annahme</em>: Eine Anweisung je Zeile ...</li>
</ul>
</li>
<li><strong>Anzahl der Methoden</strong> pro Klasse: 10</li>
<li><strong>Parameter</strong> pro Methode: 3</li>
<li><strong>BEC</strong> (<em>Boolean Expression Complexity</em>)
Anzahl boolescher Ausdrücke in <code>if</code> etc.: 3</li>
<li><strong>McCabe</strong> (<em>Cyclomatic Complexity</em>)
<ul>
<li>Anzahl der möglichen Verzweigungen (Pfade) pro Methode + 1</li>
<li>1-4 gut, 5-7 noch OK</li>
</ul>
</li>
<li><strong>DAC</strong> (<em>Class Data Abstraction Coupling</em>)
<ul>
<li>Anzahl der genutzten (instantiierten) &quot;Fremdklassen&quot;</li>
<li>Werte kleiner 7 werden i.A. als normal betrachtet</li>
</ul>
</li>
</ul>
<p>Die obigen Grenzwerte sind typische Standardwerte, die sich in der Praxis allgemein bewährt haben
(vergleiche u.a. <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/codingrules.html#id_Martin2009">[Martin2009]</a> oder auch in
<a href="https://source.android.com/docs/setup/contribute/code-style#write-short-methods" rel="external" target="_blank">AOSP: Write short methods</a>
und <a href="https://source.android.com/docs/setup/contribute/code-style#limit-line-length" rel="external" target="_blank">AOSP: Limit line length</a>).</p>
<p>Dennoch sind das keine absoluten Werte an sich. Ein Übertreten der Grenzen ist ein
<strong>Hinweis</strong> darauf, dass <strong>höchstwahrscheinlich</strong> etwas nicht stimmt, muss aber im
konkreten Fall hinterfragt und diskutiert und begründet werden!</p>
<h3 id="metriken-im-beispiel-von-oben">Metriken im Beispiel von oben</h3>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> String lastName;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> MyWuppieStudi studi;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> MyWuppieStudi <span style="color:#a6e22e">getMyWuppieStudi</span>(String name) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (studi <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>            studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> MyWuppieStudi();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (lastName <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) lastName <span style="color:#f92672">=</span> name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> studi;
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<ul>
<li>BEC: 1 (nur ein boolescher Ausdruck im <code>if</code>)</li>
<li>McCabe: 3 (es gibt zwei mögliche Verzweigungen in der Methode plus die Methode selbst)</li>
<li>DAC: 1 (eine &quot;Fremdklasse&quot;: <code>String</code>)</li>
</ul>
<p><em>Anmerkung</em>: In Checkstyle werden für einige häufig verwendete Standard-Klassen Ausnahmen definiert,
d.h. <code>String</code> würde im obigen Beispiel <em>nicht</em> bei DAC mitgezählt/angezeigt.</p>
<p>=&gt; Verweis auf LV Softwareengineering</p>
<h2 id="tool-support-checkstyle">Tool-Support: Checkstyle</h2>
<p>Metriken und die Einhaltung von Coding-Conventions werden sinnvollerweise nicht manuell,
sondern durch diverse Tools erfasst, etwa im Java-Bereich mit Hilfe von
<a href="https://github.com/checkstyle" rel="external" target="_blank"><strong>Checkstyle</strong></a>.</p>
<p>Das Tool lässt sich <a href="https://checkstyle.org/cmdline.html" rel="external" target="_blank">Standalone über CLI</a> nutzen
oder als Plugin für IDE's (<a href="https://checkstyle.org/eclipse-cs" rel="external" target="_blank">Eclipse</a> oder
<a href="https://github.com/jshiell/checkstyle-idea" rel="external" target="_blank">IntelliJ</a>) einsetzen. Gradle bringt ein
eigenes <a href="https://docs.gradle.org/current/userguide/checkstyle_plugin.html" rel="external" target="_blank">Plugin</a> mit.</p>
<ul>
<li>
<p>IDE: diverse <a href="https://checkstyle.org/index.html#Related_Tools" rel="external" target="_blank">Plugins</a>:
<a href="https://checkstyle.org/eclipse-cs" rel="external" target="_blank">Eclipse-CS</a>,
<a href="https://github.com/jshiell/checkstyle-idea" rel="external" target="_blank">CheckStyle-IDEA</a></p>
</li>
<li>
<p><a href="https://checkstyle.org/cmdline.html" rel="external" target="_blank">CLI</a>:
<code>java -jar checkstyle-10.2-all.jar -c google_checks.xml *.java</code></p>
</li>
<li>
<p><a href="https://docs.gradle.org/current/userguide/checkstyle_plugin.html" rel="external" target="_blank">Plugin &quot;<strong>checkstyle</strong>&quot;</a>
in Gradle:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-groovy" data-lang="groovy"><span style="display:flex;"><span>plugins <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    id <span style="color:#e6db74">&#34;java&#34;</span>
</span></span><span style="display:flex;"><span>    id <span style="color:#e6db74">&#34;checkstyle&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>checkstyle <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    configFile <span style="color:#a6e22e">file</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#39;checkstyle.xml&#39;</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    toolVersion <span style="color:#e6db74">&#39;10.19.0&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div>
<ul>
<li>Aufruf: Prüfen mit <code>./gradlew checkstyleMain</code> (Teil von <code>./gradlew check</code>)</li>
<li>Konfiguration: <code>&lt;projectDir&gt;/config/checkstyle/checkstyle.xml</code> (Default)
bzw. mit der obigen Konfiguration direkt im Projektordner</li>
<li>Report: <code>&lt;projectDir&gt;/build/reports/checkstyle/main.html</code></li>
</ul>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/coding/src/checkstyle/" target="_blank"><span class="title">Demo: IntelliJ, Checkstyle/Gradle</span></a></span></div>
<h2 id="checkstyle-konfiguration">Checkstyle: Konfiguration</h2>
<p>Die auszuführenden Checks lassen sich über eine <a href="https://checkstyle.org/config.html" rel="external" target="_blank">XML-Datei</a>
konfigurieren. In <a href="https://checkstyle.org/eclipse-cs" rel="external" target="_blank">Eclipse-CS</a> kann man die Konfiguration
auch in einer GUI bearbeiten.</p>
<p>Das Checkstyle-Projekt stellt eine passende Konfiguration für den
<a href="https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/google_checks.xml" rel="external" target="_blank">Google Java Style</a>
bereit. Diese ist auch in den entsprechenden Plugins oft bereits enthalten und kann direkt
ausgewählt oder als Startpunkt für eigene Konfigurationen genutzt werden.</p>
<p>Der Startpunkt für die Konfigurationsdatei ist immer das Modul &quot;Checker&quot;. Darin können sich
&quot;FileSetChecks&quot; (Module, die auf einer Menge von Dateien Checks ausführen), &quot;Filters&quot; (Module,
die Events bei der Prüfung von Regeln filtern) und &quot;AuditListeners&quot; (Module, die akzeptierte
Events in einen Report überführen) befinden. Der &quot;TreeWalker&quot; ist mit der wichtigste Vertreter
der FileSetChecks-Module und transformiert die zu prüfenden Java-Sourcen in einen
<em>Abstract Syntax Tree</em>, also eine Baumstruktur, die dem jeweiligen Code unter der Java-Grammatik
entspricht. Darauf können dann wiederum die meisten Low-Level-Module arbeiten.</p>
<p>Eine Reihe von <a href="https://checkstyle.org/checks.html" rel="external" target="_blank">Standard-Checks</a> sind bereits in Checkstyle
implementiert und benötigen keine weitere externe Abhängigkeiten. Man kann aber zusätzliche Regeln
aus anderen Projekten beziehen (etwa via Gradle/Maven) oder sich eigene zusätzliche Regeln in Java
schreiben. Die einzelnen Checks werden in der Regel als &quot;Modul&quot; dem &quot;TreeWalker&quot; hinzugefügt und
über die jeweiligen Properties näher konfiguriert.</p>
<p>Sie finden in der <a href="https://checkstyle.org/checks.html" rel="external" target="_blank">Doku</a> zu jedem Check das entsprechende Modul,
das Eltern-Modul (also wo müssen Sie das Modul im XML-Baum einfügen) und auch die möglichen
Properties und deren Default-Einstellungen.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Checker&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;LineLength&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;max&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;TreeWalker&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;AvoidStarImport&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;MethodCount&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;maxPublic&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;maxTotal&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;40&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/module&gt;</span></span></span></code></pre></div>
<p>Alternativen/Ergänzungen: beispielsweise <a href="https://github.com/BasLeijdekkers/MetricsReloaded" rel="external" target="_blank">MetricsReloaded</a>.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://youtu.be/0ny6e6CNTF8" target="_blank"><span class="title">Demo: Konfiguration mit Eclipse-CS, Hinweis auf Formatter</span></a></span></div>
<h2 id="spotbugs-finde-anti-pattern-und-potentielle-bugs-linter">SpotBugs: Finde Anti-Pattern und potentielle Bugs (Linter)</h2>
<ul>
<li>
<p><a href="https://github.com/spotbugs/spotbugs" rel="external" target="_blank"><strong>SpotBugs</strong></a> sucht nach über 400 potentiellen Bugs im Code</p>
<ul>
<li>Anti-Pattern (schlechte Praxis, &quot;dodgy&quot; Code)</li>
<li>Sicherheitsprobleme</li>
<li>Korrektheit</li>
</ul>
</li>
<li>
<p>CLI: <code>java -jar spotbugs.jar options ...</code></p>
</li>
<li>
<p>IDE: <a href="https://github.com/JetBrains/spotbugs-intellij-plugin" rel="external" target="_blank">IntelliJ SpotBugs plugin</a>,
<a href="https://spotbugs.readthedocs.io/en/latest/eclipse.html" rel="external" target="_blank">SpotBugs Eclipse plugin</a></p>
</li>
<li>
<p>Gradle: <a href="https://github.com/spotbugs/spotbugs-gradle-plugin" rel="external" target="_blank">SpotBugs Gradle Plugin</a></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-groovy" data-lang="groovy"><span style="display:flex;"><span>plugins <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    id <span style="color:#e6db74">&#34;java&#34;</span>
</span></span><span style="display:flex;"><span>    id <span style="color:#e6db74">&#34;com.github.spotbugs&#34;</span> version <span style="color:#e6db74">&#34;5.0.6&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>spotbugs <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    ignoreFailures <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    showStackTraces <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div>
<p>Prüfen mit <code>./gradlew spotbugsMain</code> (in <code>./gradlew check</code>)</p>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/coding/src/spotbugs/" target="_blank"><span class="title">Demo: SpotBugs/Gradle</span></a></span></div>
<h2 id="konfiguration-für-das-pm-praktikum-format-metriken-checkstyle-spotbugs">Konfiguration für das PM-Praktikum (Format, Metriken, Checkstyle, SpotBugs)</h2>
<p>Im PM-Praktikum beachten wir die obigen Coding Conventions und Metriken mit den dort definierten
Grenzwerten. Diese sind bereits in der bereit gestellten Minimal-Konfiguration für Checkstyle
(s.u.) konfiguriert.</p>
<h3 id="formatierung">Formatierung</h3>
<ul>
<li>Google Java Style/AOSP: <strong>Spotless</strong></li>
</ul>
<p>Zusätzlich wenden wir den <a href="https://google.github.io/styleguide/javaguide.html" rel="external" target="_blank">Google Java Style</a>
an. Statt der dort vorgeschriebenen Einrückung mit 2 Leerzeichen (und 4+ Leerzeichen bei Zeilenumbruch
in einem Statement) können Sie auch mit 4 Leerzeichen einrücken (8 Leerzeichen bei Zeilenumbruch)
(<a href="https://source.android.com/docs/setup/contribute/code-style" rel="external" target="_blank">AOSP</a>). Halten Sie sich in Ihrem
Team an eine einheitliche Einrückung (Google Java Style <em>oder</em> AOSP).</p>
<p>Formatieren Sie Ihren Code vor den Commits mit <strong>Spotless</strong> (über Gradle) oder stellen Sie den
Formatter Ihrer IDE entsprechend ein.</p>
<h3 id="checkstyle">Checkstyle</h3>
<ul>
<li>Minimal-Konfiguration für <strong>Checkstyle</strong> (Coding Conventions, Metriken)</li>
</ul>
<p>Nutzen Sie die folgende <strong>Minimal-Konfiguration</strong> für <strong>Checkstyle</strong> für Ihre
Praktikumsaufgaben. Diese beinhaltet die Prüfung der wichtigsten Formate nach
Google Java Style/AOSP sowie der obigen Metriken. Halten Sie diese Regeln
ein.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE module PUBLIC &#34;-//Checkstyle//DTD Checkstyle Configuration 1.3//EN&#34; &#34;https://checkstyle.org/dtds/configuration_1_3.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Checker&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;severity&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;warning&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;TreeWalker&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;JavaNCSS&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;methodMaximum&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;40&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;classMaximum&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;250&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;fileMaximum&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;300&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;BooleanExpressionComplexity&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;CyclomaticComplexity&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;max&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;7&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;ClassDataAbstractionCoupling&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;max&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;6&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;MethodCount&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;maxTotal&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;maxPrivate&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;maxPackage&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;maxProtected&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;maxPublic&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;10&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;ParameterNumber&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;max&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;3&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;MethodLength&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;max&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;40&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Indentation&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;basicOffset&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;4&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;lineWrappingIndentation&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;8&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;caseIndent&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;4&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;throwsIndent&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;4&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;arrayInitIndent&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;4&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;TypeName&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;MethodName&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;MemberName&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;ParameterName&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;ConstantName&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;OneStatementPerLine&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;MultipleVariableDeclarations&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;MissingOverride&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;MissingJavadocMethod&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;AvoidStarImport&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;LineLength&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;max&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;100&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;FileTabCharacter&#34;</span><span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;property</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;eachLine&#34;</span> <span style="color:#a6e22e">value=</span><span style="color:#e6db74">&#34;true&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;/module&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;module</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;NewlineAtEndOfFile&#34;</span><span style="color:#f92672">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/module&gt;</span></span></span></code></pre></div>
<p>Sie können diese Basis-Einstellungen auch aus dem Programmiermethoden-CampusMinden/Prog2-Lecture-Repo direkt herunterladen:
<a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/coding/src/checkstyle.xml" rel="external" target="_blank">checkstyle.xml</a>.</p>
<p>Sie können zusätzlich gern noch die weiteren (und strengeren) Regeln aus der vom Checkstyle-Projekt
bereitgestellten Konfigurationsdatei für den
<a href="https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/google_checks.xml" rel="external" target="_blank">Google Java Style</a>
nutzen. <em>Hinweis</em>: Einige der dort konfigurierten Checkstyle-Regeln gehen allerdings über den
Google Java Style hinaus.</p>
<h3 id="linter-spotbugs">Linter: SpotBugs</h3>
<ul>
<li>Vermeiden von Anti-Pattern mit <strong>SpotBugs</strong></li>
</ul>
<p>Setzen Sie zusätzlich <strong>SpotBugs</strong> mit ein. Ihre Lösungen dürfen keine Warnungen oder
Fehler beinhalten, die SpotBugs melden würde.</p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Code entsteht nicht zum Selbstzweck =&gt; Regeln nötig!</p>
<ul>
<li>
<p>Coding Conventions</p>
<ul>
<li>Regeln zu Schreibweisen und Layout</li>
<li>Leerzeichen, Einrückung, Klammern</li>
<li>Zeilenlänge, Umbrüche</li>
<li>Kommentare</li>
</ul>
</li>
<li>
<p>Formatieren mit <strong>Spotless</strong></p>
</li>
<li>
<p>Prinzipien des objektorientierten Programmierens (vgl. <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/smells.html">&ldquo;Code Smells&rdquo;</a>)</p>
<ul>
<li>Jede Klasse ist für genau <strong>einen</strong> Aspekt des Systems verantwortlich.
(<em>Single Responsibility</em>)</li>
<li>Keine Code-Duplizierung! (<em>DRY</em> - Don't repeat yourself)</li>
<li>Klassen und Methoden sollten sich erwartungsgemäß verhalten</li>
<li>Kapselung: Möglichst wenig öffentlich zugänglich machen</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Metriken: Einhaltung von Regeln in Zahlen ausdrücken</p>
</li>
<li>
<p>Prüfung manuell durch Code Reviews oder durch Tools wie <strong>Checkstyle</strong> oder <strong>SpotBugs</strong></p>
</li>
<li>
<p>Definition des <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/coding/src/checkstyle.xml" rel="external" target="_blank">&quot;PM-Styles&quot;</a>
(siehe Folie &quot;Konfiguration für das PM-Praktikum&quot;)</p>
</li>
</ul>


    



    



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_googlestyleguide'>[googlestyleguide] <a href='https://google.github.io/styleguide/javaguide.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Google Java Style Guide</strong></a><br>Google Open Source, 2022.</li> <li id='id_Inden2013'>[Inden2013] <strong>Der Weg zum Java-Profi</strong><br>Inden, M., dpunkt.verlag, 2013. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8649-1245-0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8649-1245-0</a>.<br><em>Kapitel 13: Programmierstil und Coding Conventions</em></li> <li id='id_Martin2009'>[Martin2009] <strong>Clean Code</strong><br>Martin, R., mitp, 2009. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8266-5548-7' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8266-5548-7</a>.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Refactoring</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Refactoring bedeutet Änderung der inneren Struktur des Codes ohne Beeinflussung äußeren Verhaltens.</p>
<p>Mit Hilfe von Refactoring kann man Code Smells beheben, und Lesbarkeit, Verständlichkeit und Wartbarkeit
von Software verbessern.</p>
<p>Es ist wichtig, immer nur einzelne Schritte zu machen und anschließend die Testsuite laufen zu lassen,
damit nicht versehentlich Fehler oder Verhaltensänderungen beim Refactoring eingebaut werden.</p>
<p>Prinzipiell kann man Refactoring manuell mit Search&amp;Replace durchführen, aber es bietet sich an, hier
die IDE-Unterstützung zu nutzen. Es stehen verschiedene Methoden zur Verfügung, die nicht unbedingt
einheitlich benannt sein müssen oder in jeder IDE vorkommen. Zu den häufig genutzten Methoden zählen
<em>Rename</em>, <em>Extract</em>, <em>Move</em> und <em>Push Up/Pull Down</em>.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/n0RaQ_Qve0Y' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Refactoring</a></li> <li><a href='https://youtu.be/zZ2RGKRBVz4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Refactoring: Rename</a></li> <li><a href='https://youtu.be/PR4mEjBl_No' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Refactoring: Encapsulate</a></li> <li><a href='https://youtu.be/4VbxgqZ68ng' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Refactoring: Extract Method</a></li> <li><a href='https://youtu.be/Wr92Oboh05E' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Refactoring: Move Method</a></li> <li><a href='https://youtu.be/t24c88RshL8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Refactoring: Pull up</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/36389f8fe4befc6370c28cda4475690224942c00c854e6dfc953b60c26acdf62093345ae1ee0698f71dc0a7f02739253d4ba29b7c05b69036cbb09fb1e361549' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Refactoring</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Begriff, Notwendigkeit und Vorgehen des/beim Refactoring</li> <li>(K2) Bedeutung kleiner Schritte beim Refactoring</li> <li>(K2) Bedeutung einer sinnvollen Testsuite beim Refactoring</li> <li>(K2) Refactoring: Nur innere Struktur ändern, nicht äußeres Verhalten!</li> <li>(K3) Anwendung der wichtigsten Refactoring-Methoden: <em>Rename</em>, <em>Extract</em>, <em>Move</em>, <em>Push Up/Pull Down</em></li></ul>
  </div>
</div>




    <h2 id="was-ist-refactoring">Was ist Refactoring?</h2>
<blockquote>
<p>Refactoring ist, wenn einem auffällt, daß der Funktionsname <code>foobar</code>
ziemlich bescheuert ist, und man die Funktion in <code>sinus</code> umbenennt.</p>
<p> <span class='origin'>Quelle: <a href="http://altlasten.lutz.donnerhacke.de/mitarb/lutz/usenet/Fachbegriffe.der.Informatik.html#356" rel="external" target="_blank">&quot;356: Refactoring&quot;</a> by <a href="mailto:andreas@andreas.org" rel="external" target="_blank">Andreas Bogk</a> on Lutz Donnerhacke: &quot;Fachbegriffe der Informatik&quot;</span></p>
</blockquote>
<blockquote>
<p>Refactoring (noun): a change made to the internal structure of software to make
it easier to understand and cheaper to modify without changing its observable
behaviour.</p>
<p> <span class='origin'>Quelle: <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/refactoring.html#id_Fowler2011">[Fowler2011, p. 53]</a></span></p>
</blockquote>
<p><strong>Refactoring:</strong> Änderungen an der <span class='alert'><strong>inneren Struktur</strong></span> einer Software</p>
<ul>
<li>Beobachtbares (äußeres) Verhalten ändert sich dabei <strong>nicht</strong>
<ul>
<li>Keine neuen Features einführen</li>
<li>Keine Bugs fixen</li>
<li>Keine öffentliche Schnittstelle ändern (<em>Anmerkung</em>: Bis auf Umbenennungen
oder Verschiebungen von Elementen innerhalb der Software)</li>
</ul>
</li>
<li>Ziel: Verbesserung von Verständlichkeit und Änderbarkeit</li>
</ul>
<h2 id="anzeichen-dass-refactoring-jetzt-eine-gute-idee-wäre">Anzeichen, dass Refactoring jetzt eine gute Idee wäre</h2>
<ul>
<li>
<p>Code &quot;stinkt&quot; (zeigt/enthält <em>Code Smells</em>)</p>
<p>Code Smells sind strukturelle Probleme, die im Laufe der Zeit zu
Problemen führen können. Refactoring ändert die innere Struktur
des Codes und kann entsprechend genutzt werden, um die Smells zu
beheben.</p>
</li>
<li>
<p>Schwer erklärbarer Code</p>
<p>Könnten Sie Ihren Code ohne Vorbereitung in der Abgabe erklären?
In einer Minute? In fünf Minuten? In zehn? Gar nicht?</p>
<p>In den letzten beiden Fällen sollten Sie definitiv über eine
Vereinfachung der Strukturen nachdenken.</p>
</li>
<li>
<p>Verständnisprobleme, Erweiterungen</p>
<p>Sie grübeln in der Abgabe, was Ihr Code machen sollte?</p>
<p>Sie überlegen, was Ihr Code bedeutet, um herauszufinden, wo Sie
die neue Funktionalität anbauen können?</p>
<p>Sie suchen nach Codeteilen, finden diese aber nicht, da die sich
in anderen (falschen?) Stellen/Klassen befinden?</p>
<p>Nutzen Sie die (neuen) Erkenntnisse, um den Code leichter
verständlich zu gestalten.</p>
</li>
</ul>
<div class='center'>
<blockquote>
<p>&quot;Three strikes and you refactor.&quot;</p>
<p> <span class='origin'>Quelle: <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/refactoring.html#id_Fowler2011">[Fowler2011, p. 58]</a>: &quot;The Rule of Three&quot;</span></p>
</blockquote>
</div>
<p>Wenn Sie sich zum dritten Mal über eine suboptimale Lösung ärgern, dann
werden Sie sich vermutlich noch öfter darüber ärgern. Jetzt ist der
Zeitpunkt für eine Verbesserung.</p>
<p>Schauen Sie sich die entsprechenden Kapitel in <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/refactoring.html#id_Passig2013">[Passig2013]</a> und <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/coding/refactoring.html#id_Fowler2011">[Fowler2011]</a>
an, dort finden Sie noch viele weitere Anhaltspunkte, ob und wann Refactoring
sinnvoll ist.</p>
<h2 id="bevor-sie-loslegen-">Bevor Sie loslegen ...</h2>
<ol>
<li>
<p><strong>Unit Tests</strong> schreiben</p>
<ul>
<li>Normale und ungültige Eingaben</li>
<li>Rand- und Spezialfälle</li>
</ul>
</li>
<li>
<p><strong>Coding Conventions</strong> einhalten</p>
<ul>
<li>Sourcecode formatieren (lassen)</li>
</ul>
</li>
<li>
<p>Haben Sie die <span class='alert'>fragliche Codestelle auch wirklich verstanden</span>?!</p>
</li>
</ol>
<h2 id="vorgehen-beim-refactoring">Vorgehen beim Refactoring</h2>
<h3 id="überblick-über-die-methoden-des-refactorings">Überblick über die Methoden des Refactorings</h3>
<p>Die Refactoring-Methoden sind nicht einheitlich definiert, es existiert ein großer
und uneinheitlicher &quot;Katalog&quot; an möglichen Schritten. Teilweise benennt jede IDE
die Schritte etwas anders, teilweise werden unterschiedliche Möglichkeiten angeboten.</p>
<p>Zu den am häufigsten genutzten Methoden zählen</p>
<ul>
<li>Rename Method/Class/Field</li>
<li>Encapsulate Field</li>
<li>Extract Method/Class</li>
<li>Move Method</li>
<li>Pull Up, Push Down (Field, Method)</li>
</ul>
<h3 id="best-practice">Best Practice</h3>
<p>Eine Best Practice (oder nennen Sie es einfach eine wichtige Erfahrung) ist,
beim Refactoring langsam und gründlich vorzugehen. Sie ändern die Struktur
der Software und können dabei leicht Fehler oder echte Probleme einbauen.
Gehen Sie also langsam und sorgsam vor, machen Sie einen Schritt nach dem
anderen und sichern Sie sich durch eine gute Testsuite ab, die Sie nach jedem
Schritt erneut ausführen: Das Verhalten der Software soll sich ja nicht
ändern, d.h. die Tests müssen nach jedem einzelnen Refactoring-Schritt immer
grün sein (oder Sie haben einen Fehler gemacht).</p>
<ul>
<li>
<p>Kleine Schritte: immer nur <strong>eine</strong> Änderung zu einer Zeit</p>
</li>
<li>
<p>Nach <strong>jedem</strong> Refactoring-Schritt <strong>Testsuite</strong> laufen lassen</p>
<p>=&gt; Nächster Refactoring-Schritt erst, wenn alle Tests wieder &quot;grün&quot;</p>
</li>
<li>
<p>Versionskontrolle nutzen: <strong>Jeden</strong> Schritt <strong>einzeln</strong> committen</p>
</li>
</ul>
<h2 id="refactoring-methode-rename-methodclassfield">Refactoring-Methode: Rename Method/Class/Field</h2>
<h3 id="motivation">Motivation</h3>
<p>Name einer Methode/Klasse/Attributs erklärt nicht ihren Zweck.</p>
<h3 id="durchführung">Durchführung</h3>
<p>Name selektieren, &quot;<code>Refactor &gt; Rename</code>&quot;</p>
<h3 id="anschließend-ggf-prüfen">Anschließend ggf. prüfen</h3>
<p>Aufrufer? Superklassen?</p>
<h3 id="beispiel">Beispiel</h3>
<p><strong>Vorher</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getTeN</span>() {}</span></span></code></pre></div>
<p><strong>Nachher</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getTelefonNummer</span>() {}</span></span></code></pre></div>
<h2 id="refactoring-methode-encapsulate-field">Refactoring-Methode: Encapsulate Field</h2>
<h3 id="motivation-1">Motivation</h3>
<p>Sichtbarkeit von Attributen reduzieren.</p>
<h3 id="durchführung-1">Durchführung</h3>
<p>Attribut selektieren, &quot;<code>Refactor &gt; Encapsulate Field</code>&quot;</p>
<h3 id="anschließend-ggf-prüfen-1">Anschließend ggf. prüfen</h3>
<p>Superklassen? Referenzen? (Neue) JUnit-Tests?</p>
<h3 id="beispiel-1">Beispiel</h3>
<p><strong>Vorher</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">int</span> cps;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printDetails</span>() {
</span></span><span style="display:flex;"><span>    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Credits: &#34;</span> <span style="color:#f92672">+</span> cps);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><strong>Nachher</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> cps;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getCps</span>() { <span style="color:#66d9ef">return</span> cps; }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setCps</span>(<span style="color:#66d9ef">int</span> cps) {  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">cps</span> <span style="color:#f92672">=</span> cps;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printDetails</span>() {
</span></span><span style="display:flex;"><span>    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;credits: &#34;</span> <span style="color:#f92672">+</span> getCps());
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="refactoring-methode-extract-methodclass">Refactoring-Methode: Extract Method/Class</h2>
<h3 id="motivation-2">Motivation</h3>
<ul>
<li>Codefragment stellt eigenständige Methode dar</li>
<li>&quot;Überschriften-Code&quot;</li>
<li>Code-Duplizierung</li>
<li>Code ist zu &quot;groß&quot;</li>
<li>Klasse oder Methode erfüllt unterschiedliche Aufgaben</li>
</ul>
<h3 id="durchführung-2">Durchführung</h3>
<p>Codefragment selektieren, &quot;<code>Refactor &gt; Extract Method</code>&quot; bzw. &quot;<code>Refactor &gt; Extract Class</code>&quot;</p>
<h3 id="anschließend-ggf-prüfen-2">Anschließend ggf. prüfen</h3>
<ul>
<li>Aufruf der neuen Methode? Nutzung der neuen Klasse?</li>
<li>Neue JUnit-Tests nötig? Veränderung bestehender Tests nötig?</li>
<li>Speziell bei Methoden:
<ul>
<li>Nutzung lokaler Variablen: Übergabe als Parameter!</li>
<li>Veränderung lokaler Variablen: Rückgabewert in neuer Methode
und Zuweisung bei Aufruf; evtl. neue Typen nötig!</li>
</ul>
</li>
</ul>
<h3 id="beispiel-2">Beispiel</h3>
<p><strong>Vorher</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printInfos</span>() {
</span></span><span style="display:flex;"><span>    printHeader();
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Details ausgeben</span>
</span></span><span style="display:flex;"><span>    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;name:    &#34;</span> <span style="color:#f92672">+</span> name);
</span></span><span style="display:flex;"><span>    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;credits: &#34;</span> <span style="color:#f92672">+</span> cps);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><strong>Nachher</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printInfos</span>() {
</span></span><span style="display:flex;"><span>    printHeader();
</span></span><span style="display:flex;"><span>    printDetails();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printDetails</span>() {
</span></span><span style="display:flex;"><span>    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;name:    &#34;</span> <span style="color:#f92672">+</span> name);
</span></span><span style="display:flex;"><span>    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;credits: &#34;</span> <span style="color:#f92672">+</span> cps);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="refactoring-methode-move-method">Refactoring-Methode: Move Method</h2>
<h3 id="motivation-3">Motivation</h3>
<p>Methode nutzt (oder wird genutzt von) mehr Eigenschaften einer
fremden Klasse als der eigenen Klasse.</p>
<h3 id="durchführung-3">Durchführung</h3>
<p>Methode selektieren, &quot;<code>Refactor &gt; Move</code>&quot;
(ggf. &quot;Keep original method as delegate to moved method&quot; aktivieren)</p>
<h3 id="anschließend-ggf-prüfen-3">Anschließend ggf. prüfen</h3>
<ul>
<li>Aufruf der neuen Methode (Delegation)?</li>
<li>Neue JUnit-Tests nötig? Veränderung bestehender Tests nötig?</li>
<li>Nutzung lokaler Variablen: Übergabe als Parameter!</li>
<li>Veränderung lokaler Variablen: Rückgabewert in neuer Methode
und Zuweisung bei Aufruf; evtl. neue Typen nötig!</li>
</ul>
<h3 id="beispiel-3">Beispiel</h3>
<p><strong>Vorher</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Kurs</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> cps;
</span></span><span style="display:flex;"><span>    String descr;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> <span style="color:#66d9ef">extends</span> Person {
</span></span><span style="display:flex;"><span>    String name;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> cps;
</span></span><span style="display:flex;"><span>    Kurs kurs;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printKursInfos</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Kurs:    &#34;</span> <span style="color:#f92672">+</span> kurs.<span style="color:#a6e22e">descr</span>);
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Credits: &#34;</span> <span style="color:#f92672">+</span> kurs.<span style="color:#a6e22e">cps</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><strong>Nachher</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Kurs</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> cps;
</span></span><span style="display:flex;"><span>    String descr;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printKursInfos</span>() {
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Kurs:    &#34;</span> <span style="color:#f92672">+</span> descr);
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Credits: &#34;</span> <span style="color:#f92672">+</span> cps);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> <span style="color:#66d9ef">extends</span> Person {
</span></span><span style="display:flex;"><span>    String name;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> cps;
</span></span><span style="display:flex;"><span>    Kurs kurs;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printKursInfos</span>() { kurs.<span style="color:#a6e22e">printKursInfos</span>(); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="refactoring-methode-pull-up-push-down-field-method">Refactoring-Methode: Pull Up, Push Down (Field, Method)</h2>
<h3 id="motivation-4">Motivation</h3>
<ul>
<li>Attribut/Methode nur für die Oberklasse relevant: <strong>Pull Up</strong></li>
<li>Subklassen haben identische Attribute/Methoden: <strong>Pull Up</strong></li>
<li>Attribut/Methode nur für eine Subklasse relevant: <strong>Push Down</strong></li>
</ul>
<h3 id="durchführung-4">Durchführung</h3>
<p>Name selektieren, &quot;<code>Refactor &gt; Pull Up</code>&quot; oder &quot;<code>Refactor &gt; Push Down</code>&quot;</p>
<h3 id="anschließend-ggf-prüfen-4">Anschließend ggf. prüfen</h3>
<p>Referenzen/Aufrufer? JUnit-Tests?</p>
<h3 id="beispiel-4">Beispiel</h3>
<p><strong>Vorher</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span> { }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> <span style="color:#66d9ef">extends</span> Person {
</span></span><span style="display:flex;"><span>    String name;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printDetails</span>() { System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;name:    &#34;</span> <span style="color:#f92672">+</span> name); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><strong>Nachher</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Person</span> { <span style="color:#66d9ef">protected</span> String name; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> <span style="color:#66d9ef">extends</span> Person {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">printDetails</span>() { System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;name:    &#34;</span> <span style="color:#f92672">+</span> name); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Behebung von <strong>Bad Smells</strong> durch <strong>Refactoring</strong></p>
<p>=&gt; Änderung der inneren Struktur ohne Beeinflussung des äußeren Verhaltens</p>
<ul>
<li>Verbessert Lesbarkeit, Verständlichkeit, Wartbarkeit</li>
<li>Immer nur kleine Schritte machen</li>
<li>Nach jedem Schritt Testsuite laufen lassen</li>
<li>Katalog von Maßnahmen, beispielsweise <em>Rename</em>, <em>Extract</em>, <em>Move</em>, <em>Push Up/Pull Down</em>, ...</li>
<li>Unterstützung durch IDEs wie Eclipse, Idea, ...</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106231&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Refactoring (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachten Sie das <a href="https://github.com/emilybache/Theatrical-Players-Refactoring-Kata" rel="external" target="_blank">Theatrical Players Refactoring Kata</a>.
Dort finden Sie im Unterordner <a href="https://github.com/emilybache/Theatrical-Players-Refactoring-Kata/tree/main/java" rel="external" target="_blank">java/</a>
einige Klassen mit unübersichtlichem und schlecht strukturierten Code.</p>
<p>Welche <em>Bad Smells</em> können Sie hier identifizieren?</p>
<p>Beheben Sie die Smells durch die <em>schrittweise Anwendung</em> von den aus der Vorlesung
bekannten Refactoring-Methoden. Denken Sie auch daran, dass Refactoring immer durch
eine entsprechende Testsuite abgesichert sein muss - ergänzen Sie ggf. die Testfälle.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Fowler2011'>[Fowler2011] <strong>Refactoring</strong><br>Fowler, M., Addison-Wesley, 2011. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-201-48567-7' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-201-48567-7</a>.</li> <li id='id_Inden2013'>[Inden2013] <strong>Der Weg zum Java-Profi</strong><br>Inden, M., dpunkt.verlag, 2013. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8649-1245-0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8649-1245-0</a>.<br><em>Kapitel 11: Refactorings</em></li> <li id='id_Passig2013'>[Passig2013] <strong>Weniger schlecht programmieren</strong><br>Passig, K. und Jander, J., O'Reilly, 2013. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-89721-567-2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-89721-567-2</a>.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
          <article class="default">
            <header class="headline">
            </header>

<h1 id="umgang-mit-frameworks">Umgang mit Frameworks</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon.html">Frameworks: How-To Dungeon</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Umgang mit Frameworks</h1>
<article class="default">
<h1>Frameworks: How-To Dungeon</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Der PM-Dungeon ist ein Framework zum Entwickeln von Rogue-like Dungeon-Crawlern, also einfachen 2D-Spielen in Java.
Das Framework bietet die wichtigsten benötigten Grundstrukturen für ein Computer-Spiel: Es hat eine Game-Loop, kann
Level generieren und darstellen und hat eine Entity-Component-System-Struktur (ECS), über die die Spielinhalte
erstellt werden können. Im Hintergrund arbeitet die Open-Source-Bibliothek libGDX.</p>
<p>Sie können das Projekt direkt von GitHub clonen und über den im Projekt integrierten Gradle-Wrapper starten. Dazu
brauchen Sie Java 21 LTS (in einer 64-bit Version). Sie können das Projekt als Gradle-Projekt in Ihre IDE laden.</p>
<p>Die Starter-Klassen (z.B. <code>starter.Starter</code> im &quot;dungeon&quot;-Subprojekt, <code>starter.DojoStarter</code> im &quot;dojo-dungeon&quot;-Subprojekt
oder <code>starter.DevDungeon</code> im &quot;devDungeon&quot;-Subprojekt) sind die zentralen Einstiegspunkte. Hier finden Sie &quot;unseren&quot;
Teil der Game-Loop (der in der eigentlichen Game-Loop von libGDX aufgerufen wird), hier finden Sie die Konfiguration
und die <code>main()</code>-Methode.</p>
<p>Im ECS werden die im Spiel befindlichen Elemente als <em>Entitäten</em> modelliert. Diese Entitäten sind lediglich Container
für <em>Components</em>, die dann ihrerseits die entsprechenden Eigenschaften der Entitäten modellieren. Entitäten haben
normalerweise über die Components hinaus keine weiteren Eigenschaften (Attribute, Methoden). Das Game kennt alle zum
aktuellen Zeitpunkt &quot;lebenden&quot; Entitäten.</p>
<p>Components gruppieren Eigenschaften, beispielsweise für Positionen oder Lebenspunkte. Components haben normalerweise
keine Methoden (halten also nur Werte/Attribute). Jede Component-Instanz ist immer einer konkreten Entität zugeordnet
und kann ohne diese nicht existieren.</p>
<p><em>Systeme</em> implementieren das Verhalten im ECS. Das Game kennt alle aktiven Systeme und ruft in jedem Durchlauf der
Game-Loop die <code>execute()</code>-Methode der Systeme auf. Üblicherweise holt sich dann ein System alle Entitäten vom Game und
iteriert darüber und fragt ab, ob die betrachtete Entität die notwendigen Components hat - falls ja, dann kann das
System auf dieser Entität die entsprechenden Operationen ausführen (Animation, Bewegung, ...); falls nein, wird diese
Entität ignoriert und mit der Iteration fortgefahren.</p>
<p>Wir programmieren in dieser Einheit einen einfachen Helden. Der Held ist eine <code>Entity</code> und braucht verschiedene
Components, um im Spiel angezeigt zu werden und bewegt werden zu können.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/kGKDcKIDHok' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL How-To Dungeon: Teil 1 (Überblick)</a></li> <li><a href='https://youtu.be/uPNt7OWpMBs' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL How-To Dungeon: Teil 2 (Hero)</a></li> <li><a href='https://youtu.be/_YVYoFgvU04' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL How-To Dungeon: Teil 3 (Monster und Feuerbälle)</a></li></ul>
  </div>
</div>




    
    
    
    






    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (TIB AV-Portal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://av.tib.eu/media/67783' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL How-To Dungeon: Teil 1 (Überblick)</a></li> <li><a href='https://av.tib.eu/media/67785' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL How-To Dungeon: Teil 2 (Hero)</a></li> <li><a href='https://av.tib.eu/media/67784' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL How-To Dungeon: Teil 3 (Monster und Feuerbälle)</a></li></ul>
  </div>
</div>




    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Überblick über die wichtigsten Strukturen im PM-Dungeon</li> <li>(K2) Aufbau eines ECS: Entitäten, Komponenten, Systeme</li> <li>(K3) Herunterladen und installieren des PM-Dungeon</li> <li>(K3) Laden in der IDE</li> <li>(K3) Erstellen eines Helden mit Animation und Bewegung</li></ul>
  </div>
</div>




    <h2 id="how-to-dungeon">How-To Dungeon</h2>
<p>In diesem Semester werden Sie im Praktikum schrittweise Erweiterungen in verschiedenen
&quot;fertigen&quot; Rogue-like Computerspielen programmieren und dabei (hoffentlich) die Methoden aus
der Vorlesung einsetzen können.</p>
<p>Das Projekt &quot;PM-Dungeon&quot; stellt wichtige Bausteine für das Spiel bereit, beispielsweise eine
Game-Loop und eine API für das Generieren und Benutzen von Leveln und vieles andere mehr. Im
Hintergrund werkelt das etablierte Open-Source-Spieleframework <a href="https://libgdx.com" rel="external" target="_blank">libGDX</a>.</p>
<p>Wir werden uns in diesem How-To einen Überblick verschaffen und einen ersten Einstieg
versuchen: Wir programmieren einen einfachen Helden.</p>
<h2 id="projekt-pm-dungeon">Projekt PM-Dungeon</h2>
<p>Das Projekt PM-Dungeon entstand in verschiedenen Forschungsprojekten und wurde (und wird)
aktiv von Studierenden und wissenschaftlichen Mitarbeitern am Campus Minden entwickelt.</p>
<p>Zuletzt lief das Forschungsprojekt &quot;Dungeon&quot;, gefördert durch die <a href="https://stiftung-hochschullehre.de" rel="external" target="_blank">Stiftung für Innovation in
der Hochschullehre</a> im <a href="https://stiftung-hochschullehre.de/foerderung/freiraum2022/" rel="external" target="_blank">&quot;Freiraum
2022&quot;</a>. Dabei sollten diesmal
nicht die Studierenden selbst Code schreiben, sondern die Lehrenden sollen Aufgaben in einer
speziellen (von uns entwickelten) Programmiersprache schreiben (können), woraus dann ein
fertiges Dungeon-Spiel generiert wird (mit der Aufgabe als Quest o.ä. im Dungeon eingebettet)
und die Studierenden können durch das Spielen die Aufgaben lösen.</p>
<p>Sie werden merken, dass trotz klarer Richtlinien und Ideen die Entwicklung in der Praxis doch
nicht so einfach ist und dass viele Dinge immer wieder geübt und erinnert werden müssen: Namen
von Klassen und Methoden, sinnvolles Javadoc, Dokumentation jenseits des Javadoc, aber auch
Commit-Messages und PR-Summaries.</p>
<h2 id="installation-des-frameworks">Installation des Frameworks</h2>
<p>Sie finden das Projekt auf GitHub:
<a href="https://github.com/Dungeon-CampusMinden/Dungeon" rel="external" target="_blank">github.com/Dungeon-CampusMinden/Dungeon</a>.</p>
<p><a href="#R-image-ecfa054662f2cfc85bcad8bb2920e713" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon/screenshot_dungeon_clone.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-ecfa054662f2cfc85bcad8bb2920e713"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon/screenshot_dungeon_clone.png?width=auto&height=auto"></a></p>
<p>Laden Sie sich den Quellcode herunter, um damit in der IDE arbeiten zu können. Prinzipiell
gibt es viele verschiedene Wege, in diesem Tutorial laden wir es per Git in der Konsole
herunter:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>git clone git@github.com:Dungeon-CampusMinden/Dungeon.git pm-dungeon</span></span></code></pre></div>
<p>Dabei entsteht der Ordner <code>pm-dungeon/</code> mit dem Dungeon-Projekt als Inhalt.</p>
<p><span class='alert'><strong>WICHTIG</strong>: Achten Sie bitte darauf, dass im Projektpfad <strong>keine Leerzeichen</strong> und keine
Sonderzeichen (Umlaute o.ä.) vorkommen! Dies kann zu seltsamen Fehler führen. Bitte auch
darauf achten, dass Sie als JDK ein <strong>Java SE 21 (LTS)</strong> verwenden.</span></p>
<h2 id="java-java-se-21-lts">Java: Java SE 21 (LTS)</h2>
<p>Wir benutzen im Dungeon-Projekt die aktuelle LTS-Version des JDK, d.h. <strong>Java SE 21 (LTS)</strong>.
Sie können sich das JDK bei <a href="https://www.oracle.com/java/technologies/downloads/" rel="external" target="_blank">Oracle</a>
herunterladen oder
<a href="https://code.visualstudio.com/docs/languages/java#_install-a-java-development-kit-jdk" rel="external" target="_blank">Alternativen</a>
ausprobieren. Bitte unbedingt die jeweilige 64-bit Version nutzen!</p>
<p>In der Konsole sollte</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>java -version</span></span></code></pre></div>
<p>ungefähr diese Ausgabe erzeugen (ignorieren Sie die Minor-Version, wichtig ist Major-Version:
21 bzw. &quot;LTS&quot;):</p>
<pre><code>java version &quot;21.0.3&quot; 2024-04-16 LTS
Java(TM) SE Runtime Environment (build 21.0.3+7-LTS-152)
Java HotSpot(TM) 64-Bit Server VM (build 21.0.3+7-LTS-152, mixed mode, sharing)
</code></pre>
<h2 id="erster-test">Erster Test</h2>
<p>Für einen ersten Test gehen Sie in der Konsole in den vorhin erzeugten neuen Ordner
<code>pm-dungeon/</code> und führen Sie dort den Befehl</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>./gradlew game:runBasicStarter</span></span></code></pre></div>
<p>aus. Dabei sollte das (mitgelieferte) Build-Tool <a href="https://gradle.org/" rel="external" target="_blank">Gradle</a> starten und die
benötigten Java-Bibliotheken herunterladen und schließlich das Spiel in einer Minimalversion
starten - Sie sollten also ein Level sehen.</p>
<p><a href="#R-image-ee7d5e606069cf5ecba101366632a200" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon/screenshot_dungeon_defaultlevel.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-ee7d5e606069cf5ecba101366632a200"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon/screenshot_dungeon_defaultlevel.png?width=80%25&height=auto"></a></p>
<p>Dies dauert je nach Internetanbindung etwas - beim nächsten Start geht es dann aber deutlich
schneller, weil ja bereits alles da ist.</p>
<h2 id="import-in-der-ide">Import in der IDE</h2>
<p>Importieren Sie das Projekt als Gradle-basiertes Projekt, dann übernimmt die IDE die
Konfiguration für Sie.</p>
<p><a href="#R-image-722389715a038bdc3f4754719a01c0cf" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon/screenshot_dungeon_import_intellij.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-722389715a038bdc3f4754719a01c0cf"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon/screenshot_dungeon_import_intellij.png?width=80%25&height=auto"></a></p>
<p><a href="#R-image-79fa22af1d4c007d53d2715d4a37efad" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon/screenshot_dungeon_import_intellij_asgradle.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-79fa22af1d4c007d53d2715d4a37efad"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon/screenshot_dungeon_import_intellij_asgradle.png?width=40%25&height=auto"></a></p>
<p>Über das Gradle-Menü können Sie nun in der IDE den &quot;runBasicStarter&quot;-Task (Menüpunkt &quot;game&quot;)
starten, und es erscheint wieder ein minimales Level.</p>
<h2 id="überblick-über-die-sub--projekte">Überblick über die (Sub-) Projekte</h2>
<p>Sie finden im Package-Explorer eine Reihe von Unterprojekten (Gradle-Subprojekte). Für PR2
sind eigentlich nur die Subprojekte
<a href="https://github.com/Dungeon-CampusMinden/Dungeon/tree/master/dojo-dungeon" rel="external" target="_blank">&quot;dojo-dungeon&quot;</a> und
<a href="https://github.com/Dungeon-CampusMinden/dev-dungeon/tree/master/devDungeon" rel="external" target="_blank">&quot;devDungeon&quot;</a>
relevant sowie die Dokumentation in den verschiedenen <code>doc/</code>-Ordnern (die derzeit leider noch
eine ziemliche Baustelle ist).</p>
<p><a href="#R-image-e6a12ec5fe713002ef7be500d8df1cb9" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon/screenshot_dungeon_intellij_gradle.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-e6a12ec5fe713002ef7be500d8df1cb9"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/frameworks/dungeon/screenshot_dungeon_intellij_gradle.png?width=auto&height=auto"></a></p>
<p>Dojo-Dungeon und DevDungeon stellen zwei verschiedene (mehr oder weniger fertige) Spiele dar,
die von Studierenden erstellt wurden (Dojo-Dungeon: <a href="https://github.com/Denniso3" rel="external" target="_blank">@Denniso3</a>,
<a href="https://github.com/tgrothe" rel="external" target="_blank">@tgrothe</a> und <a href="https://github.com/JudiTeller" rel="external" target="_blank">@JudiTeller</a>;
DevDungeon: <a href="https://github.com/Flamtky" rel="external" target="_blank">@Flamtky</a>). Diese Spiele nutzen wir an einigen
Stellen im Praktikum.</p>
<p>Die Basis für die beiden Spiele stellt das Dungeon-Framework dar, welches in den
Gradle-Subprojekten <a href="https://github.com/Dungeon-CampusMinden/Dungeon/tree/master/game" rel="external" target="_blank">&quot;game&quot;</a>
und <a href="https://github.com/Dungeon-CampusMinden/Dungeon/tree/master/dungeon" rel="external" target="_blank">&quot;dungeon&quot;</a> zu finden
ist. Game stellt dabei eine Art minimale Basis zum Programmieren eigener Spiele dar (alle
Klassen im Package <code>core</code>), und Dungeon erweitert diese Basis und fügt einige häufig benötigte
Elemente und weitere Texturen (Package <code>contrib</code>) hinzu. Zusätzlich gibt es hier noch einige
Klassen für die DSL, was für PR2 aber nicht relevant ist.</p>
<p>Das Subprojekt
<a href="https://github.com/Dungeon-CampusMinden/Dungeon/tree/master/blockly" rel="external" target="_blank">&quot;blockly&quot;</a> ist die
Einbindung einer blockbasierten Programmiersprache in das Dungeon-Framework und spielt für PR2
ebenfalls keine Rolle.</p>
<p>Die Strukturen in allen Sub-Projekten ist ähnlich: Sie finden unter <code>&lt;subproject&gt;/src/</code> die
Java-Packages und in <code>&lt;subproject&gt;/assets/</code> vordefinierte Texturen und Soundfiles sowie
Crafting-Rezepte (beispielsweise für Boden, Wände und den Hero). Alle Sourcen sind (mehr oder
weniger) mit Javadoc dokumentiert, zusätzlich gibt es jeweils in <code>&lt;subproject&gt;/doc/</code> weitere
Anleitungen und Hinweise.</p>
<p>Für die Aufgaben im Praktikum starten Sie am besten zunächst beim relevanten Code in den
Sub-Projekten Dojo-Dungeon und DevDungeon. Schauen Sie sich die für die Aufgabe benutzten
Klassen und deren Javadoc an. In der Regel nutzen diese auch Klassen aus Dungeon und Game,
deren Aufbau und Javadoc Sie sich ebenfalls anschauen sollten. Zusätzlich gibt es für Game und
Dungeon noch weitere Dokumentation in den <code>doc/</code>-Ordnern.</p>
<h2 id="überblick-über-die-java-strukturen">Überblick über die Java-Strukturen</h2>
<p><a href="#R-image-9be2eb874b7e0fa3fbb3c33df33e3e59" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/game/doc/img/gameloop.png?raw=true?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-9be2eb874b7e0fa3fbb3c33df33e3e59"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/game/doc/img/gameloop.png?raw=true?width=auto&height=auto"></a></p>
<p>Jedes Spiel besteht aus einer Game-Loop, die je nach Konfiguration 30 Mal oder 60 Mal pro
Sekunde ausgeführt wird. Diese Game-Loop wird mit Hilfe der <code>Game#run()</code>-Methode gestartet und
die Kontrolle geht dabei vollständig an libGDX über. Im Wesentlichen werden pro Durchlauf
(&quot;Frame&quot;) die Aktionen berechnet und das Spielfeld neu gezeichnet. Alle Aktionen im Spiel,
etwa das Bewegen von Spielelementen oder das Berechnen von Angriffen o.ä., werden über
sogenannte Systeme berechnet. Diese werden einmal pro Frame aufgerufen und bestimmen den neuen
Zustand (Position, Animation, Stats, ...) der Spielelemente, die dann beim nächsten Rendern im
Spiel angezeigt werden.</p>
<p><a href="#R-image-6c4042db3f127a05118795f3caeda0fb" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/game/doc/img/ecs.png?raw=true?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-6c4042db3f127a05118795f3caeda0fb"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/game/doc/img/ecs.png?raw=true?width=auto&height=auto"></a></p>
<p>Die Klasse <code>core.Game</code> ist der zentrale Einstiegspunkt. Hier werden alle wichtigen Dinge
konfiguriert, und es gibt die <code>Game#run()</code>-Methode, die das Spiel startet. Zusätzlich gibt es
weitere Methoden, die für Sie relevant sind:</p>
<ul>
<li><code>Game#userOnSetup()</code>: Diese Methode wird einmal beim Start des Spiels aufgerufen und kann
für die Konfiguration und Initialisierung der verschiedenen Systeme genutzt werden. Hier
wird beispielsweise u.a. auch das erste Level geladen.</li>
<li><code>Game#userOnFrame()</code>: Diese Methode wird zu Beginn eines jeden Frame aufgerufen, noch
bevor die <code>execute()</code>-Methode der verschiedenen Systeme aufgerufen wird.</li>
<li><code>Game#userOnLevelLoad()</code>: Diese Methode wird aufgerufen, wenn ein Level geladen wird. Hier
können Sie später die Entitäten erstellen, die initial im Level verteilt werden sollen.</li>
</ul>
<p>Es gibt noch eine ganze Reihe von Packages, beispielsweise <code>core.Component</code> mit verschiedenen
wichtigen Components oder <code>core.level</code> mit Klassen zum Generieren zufälliger neuer Level und
zum Laden und zum Zugriff (wo bin ich und warum?) oder <code>core.systems</code> mit den Systemen, die
bestimmte Dinge im Spiel managen. Die Gliederung in Entitäten (<em>entities</em>), Komponenten
(<em>components</em>) und Systeme (<em>systems</em>) nennt sich auch &quot;ECS-Architektur&quot; (zu ECS später mehr).</p>
<p>Sie finden im <a href="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/game/doc/quickstart.md" rel="external" target="_blank">&quot;Quickstart: How to
Dungeon&quot;</a>
eine gute Anleitung, die auf die Strukturen tiefer eingeht.</p>
<h2 id="mein-held">Mein Held</h2>
<p>Um einen besseren Blick in das System zu bekommen, erstellen wir schrittweise einen eigenen
einfachen Helden.</p>
<p>Legen Sie sich im <code>starter</code>-Package eine neue Klasse an, mit der Sie das Spiel konfigurieren
und starten können:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">package</span> starter;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> core.Game;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Start the game loop</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>In IntelliJ können Sie nun die <code>main()</code>-Funktion direkt ausführen, dazu wird im Hintergrund
die vorhandene Gradle-Konfiguration genutzt. Mit anderen IDEs funktioniert das vielleicht
nicht direkt, dann erweitern Sie einfach die Gradle-Konfiguration um einen entsprechenden
Task:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-groovy" data-lang="groovy"><span style="display:flex;"><span>tasks<span style="color:#f92672">.</span><span style="color:#a6e22e">register</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#39;run&#39;</span><span style="color:#f92672">,</span> JavaExec<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    mainClass <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;starter.Main&#39;</span>
</span></span><span style="display:flex;"><span>    classpath <span style="color:#f92672">=</span> sourceSets<span style="color:#f92672">.</span><span style="color:#a6e22e">main</span><span style="color:#f92672">.</span><span style="color:#a6e22e">runtimeClasspath</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div>
<h2 id="einschub-ecs-oder-entities-components-und-systems">Einschub: ECS oder Entities, Components und Systems</h2>
<p>Der Held ist ein Element im Spiel. Diese Struktur muss geeignet modelliert werden.</p>
<p>Unser Dungeon implementiert dabei eine Variante eines <a href="https://en.wikipedia.org/wiki/Entity_component_system" rel="external" target="_blank">Entity Component System
(<em>ECS</em>)</a> und folgt damit &quot;großen
Vorbildern&quot; wie beispielsweise
<a href="https://learn.unity.com/tutorial/entity-component-system" rel="external" target="_blank">Unity</a>.</p>
<p>Neben verschiedenen Hilfsstrukturen gibt es dabei nur <strong>Entitäten</strong>, <strong>Komponenten</strong> und
<strong>Systeme</strong>. Hier werden sämtliche Informationen und Verhalten modelliert.</p>
<h3 id="entity">Entity</h3>
<p>Die Idee dahinter ist: Alle Elemente im Spiel werden als <em>Entität</em> realisiert, d.h. der Held
und die Monster und die Items, die man so finden kann, sind alles Entitäten. Sogar Feuerbälle
sind letztlich Entitäten. (Im Prinzip könnten sogar die Boden- und Wandkacheln Entitäten
sein - sind es aus Effizienzgründen aktuell aber nicht.)</p>
<p>Eine Entität an sich kann erst einmal nichts und dient nur als Container für <em>Components</em>.</p>
<p>Das Spiel kennt alle zu einem Zeitpunkt vorhandenen Entitäten, diese müssen per <code>Game#add</code>
registriert werden. Man kann die Entitäten über die API abrufen (<code>Game#allEntities</code>,
<code>Game#find</code> und <code>Game#hero</code>).</p>
<p>Unsere Basisklasse für Entitäten ist aktuell <code>core.Entity</code>.</p>
<h3 id="component">Component</h3>
<p>Components bündeln bestimmte Werte einer Entität für bestimmte Zwecke, d.h. statt der
Attribute in einer Klasse (Entität) nutzen wir hier eine weitere Kapselung.</p>
<p>Beispielsweise könnte man die Lebenspunkte u.ä. in einer <code>HealthComponent</code> verpacken und dann
in einer Entität speichern. Oder man könnte in einer <code>VelocityComponent</code> hinterlegen, wie
schnell eine Entität in x- und in y-Richtung bewegt werden kann (Wände würden dabei einfach
den Wert 0 bekommen). Oder man könnte in einer <code>PositionComponent</code> speichern, wo die Entität
gerade ist. Schauen Sie einfach mal in die Packages <code>core.components</code> und
<code>contrib.components</code>.</p>
<p>Wichtig ist: Eine Instanz einer Component ist immer an eine Entität gekoppelt, eine Component
ohne (Bindung an eine) Entität ist sinnfrei. Andersherum kann eine Entität immer nur eine
einzige Instanz einer bestimmten Component (eines Component-Typs) haben, also beispielsweise
nicht zwei Objekte vom Typ <code>PositionComponent</code>.</p>
<p>Components speichern vor allem Werte und haben nur in Ausnahmefällen eigenes Verhalten.</p>
<p>Das Basisinterface für Components ist derzeit <code>core.Component</code>.</p>
<h3 id="system">System</h3>
<p>Mit Entitäten und passenden Components, über die wir die Eigenschaften ausdrücken, können wir
bereits Spielelemente im Dungeon repräsentieren.</p>
<p>Für die Bewegung und Interaktion sorgen nun passende Systeme. Das Spiel kennt alle Systeme
(diese werden einmal beim Start im Spiel per <code>Game#add</code> registriert) und ruft in der Game-Loop
pro Frame deren <code>execute()</code>-Methode auf. In der Regel iterieren die Systeme beim Ausführen der
<code>execute()</code>-Methode über die Entitäten des Spiels (via <code>Game#allEntities</code>), suchen sich
Entitäten mit bestimmten Components heraus und bearbeiten den Zustand dieser Components.</p>
<p>Dabei könnte beispielsweise ein <code>HealthSystem</code> sich alle Entitäten filtern, deren
<code>HealthComponent</code> unterhalb einer kritischen Schwelle liegen und diese rot anmalen lassen,
d.h. in der <code>DrawComponent</code> wird die Textur (&quot;Animation&quot;) ausgetauscht. Oder ein
<code>PlayerSystem</code> könnte dafür sorgen, dass die Eingaben auf der Tastatur geeignet an den Helden
weitergegeben werden und (über andere Systeme) in eine Bewegung oder Kampf o.ä. umgewandelt
werden.</p>
<p>Sie finden unsere Systeme in den Packages <code>core.systems</code> und <code>contrib.systems</code>, und die
Basisklasse ist derzeit <code>core.System</code> - falls Sie einmal eigene Systeme implementieren wollen.
(<a href="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/game/doc/create_own_content.md" rel="external" target="_blank">vgl. auch
Doku</a>)</p>
<h2 id="nun-aber-helden">Nun aber Helden!</h2>
<h3 id="ein-held-ist-eine-entität">Ein Held ist eine Entität</h3>
<p>Also legen wir nun endlich einen neuen Helden als Instanz von <code>core.Entity</code> an und
registrieren diese Entität im Spiel:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Add some one-time configuration</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnSetup</span>(
</span></span><span style="display:flex;"><span>                () <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>                    Entity hero <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Entity(<span style="color:#e6db74">&#34;Hero&#34;</span>);
</span></span><span style="display:flex;"><span>                    Game.<span style="color:#a6e22e">add</span>(hero);
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Start the game loop</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Der in der Methode <code>Game#userOnSetup</code> übergebene Lamda-Ausdruck wird (später) einmalig beim
Start der Game-Loop von libGDX aufgerufen. Auf diese Weise können wir unseren Helden ins Spiel
bekommen. (Alle anderen Entitäten sollten Sie besser über die Methode <code>Game#onLevelLoad</code>
anlegen, also beim Laden eines neuen Levels.)</p>
<p>Prinzipiell haben Sie damit alles, um das Spiel starten zu können. In der Praxis sehen Sie
aber keinen Helden: Der hat nämlich weder eine Position noch eine Textur, kann also gar nicht
angezeigt werden.</p>
<h3 id="wo-bin-ich-grad">Wo bin ich grad?</h3>
<p>Der Held braucht eine Position. Dazu gibt es <code>core.components.PositionComponent</code>. Fügen wir
diese einfach dem Helden hinzu:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Add some one-time configuration</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnSetup</span>(
</span></span><span style="display:flex;"><span>                () <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>                    Entity hero <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Entity(<span style="color:#e6db74">&#34;Hero&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    hero.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> PositionComponent());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    Game.<span style="color:#a6e22e">add</span>(hero);
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Start the game loop</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Wenn man keine Position mitgibt, wird einfach eine zufällige Position im Level genutzt.
Alternativ kann man eine eigene Position mitgeben.</p>
<p>Im Dungeon existieren aktuell zwei Koordinatensysteme: <code>core.level.utils.Coordinate</code>
(Integer-basiert) und <code>core.utils.Point</code> (Float-basiert). Die Level werden als Matrix von
<code>Tile</code> (Boden, Wand, Loch, ...) gespeichert. Die Position dieser <code>Tile</code> wird als <code>Coordinate</code>
gespeichert, was dem Index des Tiles in der Matrix entspricht. Entitäten können aktuell aber
auch zwischen zwei Tiles oder schräg-links-oben auf einem Tile stehen, dafür gibt es die
Positionen als <code>Point</code>. Entsprechend könnte man den neuen Helden bei <code>(0,0)</code> in das Level
setzen: <code>new PositionComponent(new Point(0, 0))</code> bzw. kurz <code>new PositionComponent(0f, 0f)</code>
(wobei diese Position möglicherweise nicht spielbar ist, da hier eine Wand oder sogar nichts
ist).</p>
<p>Wenn Sie jetzt das Spiel starten, sehen Sie - immer noch nichts (außer den Wänden). Hmmm.</p>
<h3 id="animateure">Animateure</h3>
<p>Um den Held zeichnen zu können, brauchen wir eine Animation - also eine <code>DrawComponent</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Add some one-time configuration</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnSetup</span>(
</span></span><span style="display:flex;"><span>                () <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>                    Entity hero <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Entity(<span style="color:#e6db74">&#34;Hero&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    hero.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> PositionComponent());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                        hero.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> DrawComponent(<span style="color:#66d9ef">new</span> SimpleIPath(<span style="color:#e6db74">&#34;character/knight&#34;</span>)));
</span></span><span style="display:flex;"><span>                    } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>                        System.<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Could not load textures for hero.&#34;</span>);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> RuntimeException(e);
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    hero.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> CameraComponent());
</span></span><span style="display:flex;"><span>                    hero.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> PlayerComponent());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    Game.<span style="color:#a6e22e">add</span>(hero);
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Start the game loop</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>In den Asset-Ordnern der Sub-Projekte Game und Dungeon gibt es bereits vordefinierte Texturen.
Im Beispiel wird (nur) im Sub-Projekt &quot;game&quot; gesucht (weil unsere <code>Main</code>-Klasse dort liegt),
und zwar in <code>&lt;game&gt;/assets/character/knight/</code>. Dort finden sich Unterordner für verschiedene
Zustände des Ritters, und darin jeweils einige Texturen (einfache kleine .png-Dateien), die
als Animation in einem bestimmten Zustand nacheinander abgespielt werden. Über den angegebenen
(Teil-) Pfad werden in <code>DrawComponent</code> automatisch die entsprechenden Animationen erzeugt und
geladen. Die Asset-Ordner sind in der Gradle-Konfiguration definiert. (Wenn Sie Ihre
<code>Main</code>-Klasse in Dungeon ansiedeln, stehen Ihnen automatisch die Texturen aus Dungeon plus aus
Game zur Verfügung.)</p>
<p>Da es passieren kann, dass der übergebene Pfad nicht gefunden wird, muss hier mit
Exception-Handling gearbeitet werden. Wir geben hier erstmal eine Fehlermeldung aus und
propagieren eine neue <code>RuntimeException</code>, die letztlich dafür sorgt, dass das Spiel
abgebrochen würde.</p>
<p>Zusätzlich brauchen wir für den Helden noch eine <code>CameraComponent</code>. Das
<code>core.systems.CameraSystem</code> wird dafür sorgen, dass die Entität mit dieser Component immer im
Fokus der Kamera ist. Da wir den Held später noch manuell steuern wollen, bekommt er auch
gleich noch eine <code>PlayerComponent</code>.</p>
<p>Jetzt wackelt der Held auf der Stelle herum ...</p>
<h3 id="bewege-mich">Bewege mich</h3>
<p>Für die Bewegung ist das <code>VelocitySystem</code> zuständig. Dieses fragt in allen Entitäten die
<code>VelocityComponent</code> sowie die <code>PositionComponent</code> ab, berechnet die nächste neue Position und
speichert diese in der <code>PositionComponent</code>, und setzt bei tatsächlicher Bewegung auch eine
passende Bewegungsanimation in der <code>DrawComponent</code>.</p>
<p>Das <code>PlayerSystem</code> und die <code>PlayerComponent</code> sorgen im Zusammenspiel für eine Reaktion auf die
Tastatureingaben.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Add some one-time configuration</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnSetup</span>(
</span></span><span style="display:flex;"><span>                () <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>                    Entity hero <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Entity(<span style="color:#e6db74">&#34;Hero&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    hero.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> PositionComponent());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                        hero.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> DrawComponent(<span style="color:#66d9ef">new</span> SimpleIPath(<span style="color:#e6db74">&#34;character/knight&#34;</span>)));
</span></span><span style="display:flex;"><span>                    } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>                        System.<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Could not load textures for hero.&#34;</span>);
</span></span><span style="display:flex;"><span>                        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> RuntimeException(e);
</span></span><span style="display:flex;"><span>                    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    hero.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> CameraComponent());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    hero.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> VelocityComponent(5f, 5f));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    PlayerComponent pc <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PlayerComponent();
</span></span><span style="display:flex;"><span>                    pc.<span style="color:#a6e22e">registerCallback</span>(
</span></span><span style="display:flex;"><span>                            KeyboardConfig.<span style="color:#a6e22e">MOVEMENT_UP</span>.<span style="color:#a6e22e">value</span>(),
</span></span><span style="display:flex;"><span>                            entity <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>                                VelocityComponent vc <span style="color:#f92672">=</span> entity.<span style="color:#a6e22e">fetch</span>(VelocityComponent.<span style="color:#a6e22e">class</span>).<span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>                                vc.<span style="color:#a6e22e">currentYVelocity</span>(vc.<span style="color:#a6e22e">yVelocity</span>());
</span></span><span style="display:flex;"><span>                            });
</span></span><span style="display:flex;"><span>                    hero.<span style="color:#a6e22e">add</span>(pc);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                    Game.<span style="color:#a6e22e">add</span>(hero);
</span></span><span style="display:flex;"><span>                });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Start the game loop</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Die <code>VelocityComponent</code> wird im Konstruktor mit einer (maximalen) Geschwindigkeit in x- und
y-Richtung erzeugt. Nutzen Sie hier nicht zu große Werte - unter Umständen reicht dann ein
einziger Tastendruck, um einmal über das Spielfeld geschleudert zu werden.</p>
<p>Über die Methoden <code>VelocityComponent#xVelocity</code> und <code>VelocityComponent#yVelocity</code> können Sie
die Maximalgeschwindigkeit abfragen und auch setzen. Mit <code>VelocityComponent#currentXVelocity</code>
bzw. <code>VelocityComponent#currentYVelocity</code> holen und setzen Sie dagegen die <em>aktuelle</em>
Geschwindigkeit, die vom <code>VelocitySystem</code> zur Berechnung der nächsten Position genutzt wird
(wobei die Maximalgeschwindigkeit als Obergrenze verwendet wird).</p>
<p>Im Beispiel wird in der <code>PlayerComponent</code> des Helden der Taste &quot;W&quot; ein Lambda-Ausdruck
zugeordnet, der die <code>VelocityComponent</code> der Entität (also des Helden) holt, die maximale
Geschwindigkeit in y-Richtung ausliest und diese als aktuelle Geschwindigkeit in y-Richtung
setzt. Damit kann mit der Taste &quot;W&quot; der Held nach oben laufen.</p>
<p><em>Anmerkung</em>: Das <code>entity.fetch(VelocityComponent.class)</code> liefert nicht direkt ein
<code>VelocityComponent</code>-Objekt zurück, sondern ein <code>Optional&lt;VelocityComponent&gt;</code>. Darüber sprechen
wir (später) noch in der Lektion <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/modern-java/optional.html">&ldquo;Optional&rdquo;</a>. Für jetzt soll es
zunächst genügen, dass Sie das gewünschte &quot;verpackte&quot; Objekt mit der Methode <code>get()</code> aus dem
<code>Optional</code> wieder herausbekommen.</p>
<p><em>Anmerkung</em>: Das gezeigte Schema ist insofern typisch, als dass verschiedene Systeme aus der
Maximalgeschwindigkeit und weiteren Parametern die aktuelle Geschwindigkeit berechnen und in
der <code>VelocityComponent</code> einer Entität setzen. Das <code>VelocitySystem</code> nutzt dann die aktuelle
Geschwindigkeit für die tatsächliche Bewegung. Sie sollten in der Praxis also die Methoden
<code>VelocityComponent#currentXVelocity</code> bzw. <code>VelocityComponent#currentYVelocity</code> eher nicht
selbst aufrufen, sondern dies den Systemen überlassen. Wenn Sie einen Geschwindigkeitsboost
haben wollen, würde es bei der obigen Konfiguration ausreichen, <code>VelocityComponent#xVelocity</code>
und/oder <code>VelocityComponent#yVelocity</code> zu setzen/zu erhöhen - den Rest übernehmen dann das
<code>PlayerSystem</code> und vor allem das <code>VelocitySystem</code> ...</p>
<p>Nun sollten Sie Ihren Helden (nach oben) bewegen können. (Tipp: Probieren Sie &quot;W&quot;.)</p>
<p><em>Hinweis</em>: Üblicherweise bearbeiten die Systeme bei der Iteration über alle Entitäten nur
diejenigen Entitäten, die alle benötigten Components aufweisen.</p>
<h2 id="walking-mit-system">Walking mit System</h2>
<h3 id="neue-monster">Neue Monster</h3>
<p>Wie kann ich ein Monster beim Laden des Levels erzeugen?</p>
<p>Beim Laden eines Levels wird der mit <code>Game#userOnLevelLoad</code> registrierte Lambda-Ausdruck
ausgeführt. Hier kann man beispielsweise ein neues Monster erzeugen (lassen):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Add some one-time configuration</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnSetup</span>( ... );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Create a new monster in every new level</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnLevelLoad</span>(first <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>            Entity fb <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Entity(<span style="color:#e6db74">&#34;HUGO&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            fb.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> PositionComponent(Game.<span style="color:#a6e22e">hero</span>().<span style="color:#a6e22e">get</span>().<span style="color:#a6e22e">fetch</span>(PositionComponent.<span style="color:#a6e22e">class</span>).<span style="color:#a6e22e">get</span>().<span style="color:#a6e22e">position</span>()));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                fb.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> DrawComponent(<span style="color:#66d9ef">new</span> SimpleIPath(<span style="color:#e6db74">&#34;character/knight&#34;</span>)));
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>                System.<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Could not load textures for HUGO.&#34;</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> RuntimeException(e);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            VelocityComponent vc <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> VelocityComponent(10f, 10f);
</span></span><span style="display:flex;"><span>            vc.<span style="color:#a6e22e">currentYVelocity</span>(vc.<span style="color:#a6e22e">yVelocity</span>());
</span></span><span style="display:flex;"><span>            fb.<span style="color:#a6e22e">add</span>(vc);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            Game.<span style="color:#a6e22e">add</span>(fb);
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Start the game loop</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Im Lambda-Ausdruck erzeugen wir hier einfach eine neue Entität und fügen dieser wie vorhin
beim Hero eine <code>DrawComponent</code> für die Anzeige sowie eine <code>PositionComponent</code> und eine
<code>VelocityComponent</code> für die Position und Bewegung hinzu, und am Ende registrieren wir die
Entität beim Spiel.</p>
<p>Wenn man das Spiel jetzt startet, wird an der Position des Helden eine neue Entität sichtbar
(mit der selben Textur).</p>
<p>Aber warum bewegt die neue Figur sich nicht? Wir haben doch eine <code>VelocityComponent</code>
hinzugefügt und eine aktuelle Geschwindigkeit gesetzt?!</p>
<p>Wenn man in <code>VelocitySystem#execute</code> (bzw. die dort aufgerufene Methode
<code>VelocitySystem#updatePosition</code>) schaut, wird klar, dass die aktuelle Geschwindigkeit zwar neu
berechnet und gesetzt wird, aber dass ein &quot;Reibungsfaktor&quot; (abhängig vom Feld, auf dem die
Figur steht) eingerechnet wird und somit die aktuelle Geschwindigkeit schnell auf Null geht.
Der Hintergrund ist einfach: Normalerweise soll eine Entität nicht einmal angeschubst werden
und dann &quot;ewig&quot; laufen, insbesondere bei Reaktion auf Tastatureingaben. Deshalb werden die
Entitäten kurz bewegt und bremsen dann wieder ab. Das Aufrechterhalten der Bewegung erfolgt
normalerweise über Systeme ...</p>
<h3 id="systems-für-das-selbstständige-laufen">Systems für das selbstständige Laufen</h3>
<p>Wir brauchen ein System, welches die aktuelle Geschwindigkeit einer Entität in jedem Frame
wieder auf den alten Wert setzt. Dazu leiten wir von <code>core.System</code> ab. (Achtung: Es gibt auch
eine Klasse <code>System</code> im JDK - hier müssen Sie genau hinschauen!)</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> core.System;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WalkerSystem</span> <span style="color:#66d9ef">extends</span> System {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">execute</span>() {
</span></span><span style="display:flex;"><span>        entityStream().<span style="color:#a6e22e">forEach</span>(e <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>                VelocityComponent vc <span style="color:#f92672">=</span> e.<span style="color:#a6e22e">fetch</span>(VelocityComponent.<span style="color:#a6e22e">class</span>).<span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>                vc.<span style="color:#a6e22e">currentXVelocity</span>(vc.<span style="color:#a6e22e">xVelocity</span>());
</span></span><span style="display:flex;"><span>                vc.<span style="color:#a6e22e">currentYVelocity</span>(vc.<span style="color:#a6e22e">yVelocity</span>());
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Add some one-time configuration</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnSetup</span>( ... );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Create a new monster in every new level</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnLevelLoad</span>( ... );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Register our new system</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> WalkerSystem());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Start the game loop</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Wir leiten also von <code>core.System</code> ab und implementieren die <code>execute</code>-Methode. Wir holen uns
dabei von jeder Entität die <code>VelocityComponent</code> und setzen die aktuelle Geschwindigkeit neu
auf die maximale Geschwindigkeit. Zusätzlich registrieren wir das neue System im Spiel, damit
es in jedem Frame einmal aufgerufen wird.</p>
<p>Nun läuft das neue Monster los (bis es gegen eine Wand läuft).</p>
<p>Aber der Held bewegt sich nun ebenfalls dauerhaft :(</p>
<h3 id="components-für-das-selbstständige-laufen">Components für das selbstständige Laufen</h3>
<p>Das Problem ist, dass unser neues <code>WalkerSystem</code> <strong>alle</strong> Entitäten automatisch bewegt. (Ein
weiteres Problem ist, dass das <code>WalkerSystem</code> davon ausgeht, dass es immer eine
<code>VelocityComponent</code> gibt, was nicht unbedingt erfüllt ist!)</p>
<p>Wir brauchen also noch eine Component, mit der wir die zu bewegenden Entitäten markieren
können.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> core.System;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> core.Component;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WalkerComponent</span> <span style="color:#66d9ef">implements</span> Component {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WalkerSystem</span> <span style="color:#66d9ef">extends</span> System {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">WalkerSystem</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">super</span>(WalkerComponent.<span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">execute</span>() {
</span></span><span style="display:flex;"><span>        entityStream().<span style="color:#a6e22e">forEach</span>(e <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (e.<span style="color:#a6e22e">isPresent</span>(WalkerComponent.<span style="color:#a6e22e">class</span>)) {
</span></span><span style="display:flex;"><span>                VelocityComponent vc <span style="color:#f92672">=</span> e.<span style="color:#a6e22e">fetch</span>(VelocityComponent.<span style="color:#a6e22e">class</span>).<span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>                vc.<span style="color:#a6e22e">currentXVelocity</span>(vc.<span style="color:#a6e22e">xVelocity</span>());
</span></span><span style="display:flex;"><span>                vc.<span style="color:#a6e22e">currentYVelocity</span>(vc.<span style="color:#a6e22e">yVelocity</span>());
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Add some one-time configuration</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnSetup</span>( ... );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Create a new monster in every new level</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnLevelLoad</span>(first <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>            Entity fb <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Entity(<span style="color:#e6db74">&#34;HUGO&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            fb.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> WalkerComponent());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            Game.<span style="color:#a6e22e">add</span>(fb);
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Register our new system</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> WalkerSystem());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Start the game loop</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Die neue Component (<code>WalkerComponent</code>) ist einfach eine leere Klasse, die von <code>core.Component</code>
erbt. Wir brauchen keine Werte o.ä., die wir hier ablegen wollen - eine leere Klasse reicht
für das Beispiel. Dem neuen Monster geben wir diese neue Component nun mit.</p>
<p>Das <code>WalkerSystem</code> wird auch etwas ergänzt: Im Konstruktor rufen wir den Super-Konstruktor auf
und übergeben die <code>WalkerComponent</code>-Klasse - dies ist die Component, für die sich das System
interessiert. Zusätzlich legen wir noch eine <code>if</code>-Abfrage um das Aktualisieren der aktuellen
Geschwindigkeit: Der Block soll nur dann ausgeführt werden, wenn die im aktuellen
Schleifendurchlauf gerade betrachtete Entität eine <code>WalkerComponent</code> hat.</p>
<p>Nun läuft nur das neue Monster automatisch, der Held bleibt stehen und reagiert erst auf
Tastendrücke. Prima!</p>
<p>Auf diese Weise können Sie beispielsweise den Monstern einen Gesundheitszustand geben und
diese bei zu schlechter Gesundheit &quot;sterben&quot; lassen (aus dem Spiel entfernen). Sie könnten
aber auch komplexere Dinge wie die Kollision zwischen zwei Entitäten realisieren.</p>
<p>Tatsächlich gibt es im Sub-Projekt &quot;dungeon&quot; (Package <code>contrib</code>) bereits eine Vielzahl an
Components und passenden Systems, die solche typischen Aufgaben bereits realisieren.</p>
<h2 id="kämpfe-wie-ein-npc">Kämpfe wie ein NPC</h2>
<p>Wir haben beim Hero über das <code>PlayerComponent</code> eine Reaktion auf Tastatureingaben
implementiert. Hier könnte man einer Taste auch den Start einer neuen Entität zuordnen, die
sich dann automatisch bewegt. Man könnte also Feuerbälle schleudern ...</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Main</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Add some one-time configuration</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnSetup</span>( () <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>            Entity hero <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Entity(<span style="color:#e6db74">&#34;Hero&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            PlayerComponent pc <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PlayerComponent();
</span></span><span style="display:flex;"><span>            pc.<span style="color:#a6e22e">registerCallback</span>(KeyboardConfig.<span style="color:#a6e22e">FIRST_SKILL</span>.<span style="color:#a6e22e">value</span>(), entity <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>                Entity fb <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Entity(<span style="color:#e6db74">&#34;Fireball&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                fb.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> PositionComponent(entity.<span style="color:#a6e22e">fetch</span>(PositionComponent.<span style="color:#a6e22e">class</span>).<span style="color:#a6e22e">get</span>().<span style="color:#a6e22e">position</span>()));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>                    fb.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> DrawComponent(<span style="color:#66d9ef">new</span> SimpleIPath(<span style="color:#e6db74">&#34;character/knight&#34;</span>)));
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>                    System.<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Could not load textures for fireball.&#34;</span>);
</span></span><span style="display:flex;"><span>                    <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> RuntimeException(e);
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                fb.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> VelocityComponent(2f, 2f));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                fb.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> WalkerComponent());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                Game.<span style="color:#a6e22e">add</span>(fb);
</span></span><span style="display:flex;"><span>            }, <span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            Game.<span style="color:#a6e22e">add</span>(hero);
</span></span><span style="display:flex;"><span>        });
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Create a new monster in every new level</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">userOnLevelLoad</span>( ... );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Register our new system</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> WalkerSystem());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Start the game loop</span>
</span></span><span style="display:flex;"><span>        Game.<span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Wir registrieren einfach die Taste <code>FIRST_SKILL</code> (das ist ein &quot;Q&quot;) in der <code>PlayerComponent</code>.
Im hinterlegten Lamda-Ausdruck wird eine neue Entität erzeugt mit einer <code>WalkerComponent</code>,
also ganz analog zu dem neuen Monster vorhin beim Laden eines neuen Levels. Zusätzlich wird
hier noch ein dritter Parameter mit dem Wert <code>false</code> mitgegeben: Die <code>PlayerComponent</code> wird in
<em>jedem</em> Frame ausgewertet - wenn die Taste &quot;Q&quot; also über mehrere Frames hinweg gedrückt ist
(was sehr wahrscheinlich ist), würde in jedem dieser Frames je eine neue Entität erzeugt und
losgeschickt. Über diesen dritten Parameter können wir steuern, dass genau das nicht passiert.
Man muss also die Taste &quot;Q&quot; zunächst wieder loslassen und dann erneut drücken, um noch einen
Feuerball zu erzeugen und auf den Weg zu schicken. Als Textur habe ich einfach die im
Sub-Projekt &quot;game&quot; vorhandene Textur für die Heros genommen - im Sub-Projekt &quot;dungeon&quot; gibt es
dagegen auch Feuerbälle u.ä., aber dann müsste die Klasse auch in dieses Sub-Projekt umgezogen
werden.</p>
<p>Unser Feuerball kann leider nichts, außer sich automatisch zu bewegen. Man könnte nun noch ein
<code>CollisionSystem</code> entwickeln, welches Entitäten immer paarweise auf ihre Positionen vergleicht
und eine Kollision feststellt, wenn sich die Entitäten zu nah kommen und diese Information in
einer <code>CollisionComponent</code> speichern (wer mit wem und wann). Dann könnte man noch ein
<code>HealthSystem</code> bauen, welches eine <code>HealthComponent</code> aktualisiert. Zusätzlich könnte man ein
<code>FightSystem</code> schreiben, welches bei einer Kollision der getroffenen Entität (zufälligen?)
Schaden zufügt, also die Werte in ihrer <code>HealthComponent</code> reduziert. (Alternativ könnte das
<code>CollisionSystem</code> bei Kollision einen in der <code>CollisionComponent</code> gespeicherten
Lambda-Ausdruck ausführen.) ... Die einzelnen Klassen interagieren also nicht direkt
miteinander, sondern immer über den Umweg der Systems und Components.</p>
<p>All diese (und viele weitere) Components und Systems gibt es bereits im Package <code>contrib</code> im
Sub-Projekt <a href="https://github.com/Dungeon-CampusMinden/Dungeon/tree/master/dungeon" rel="external" target="_blank">&quot;dungeon&quot;</a>.</p>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Damit endet der kurze Ausflug in den Dungeon.</p>
<p>In einem ECS haben wir Entities, Components und Systems.</p>
<ul>
<li>Die Entitäten sind nur Hüllen und gruppieren verschiedene Components.</li>
<li>In diesen Components werden die Werte für die jeweiligen Zustände gehalten.</li>
<li>Die Systems werden in jedem Durchlauf der Game-Loop aufgerufen und führen dabei ihre
<code>execute()</code>-Methode aus. Typischerweise iterieren die Systeme dabei über alle Entitäten
und verändern die Components der Entitäten.</li>
</ul>
<p>Denken Sie daran, dass alles in einer Game-Loop läuft, die 30x oder 60x pro Sekunde aufgerufen
wird. Sie können in der Regel keine direkte Interaktion zwischen verschiedenen Objekten
realisieren, sondern müssen immer den Weg über die Systems gehen.</p>
<p>Schauen Sie gern in die vorhandenen Klassen und Packages und in die Dokumentation hinein:</p>
<ul>
<li>Klassen in <code>game/src/</code> und <code>dungeon/src</code></li>
<li>Dokumentation unter <code>game/doc/</code> und <code>dungeon/doc/</code></li>
</ul>
<p>Die Javadoc-Kommentare sollten Ihnen erste Ideen zur Funktionsweise geben (auch wenn für das
angestrebte Ideal noch einiges an Arbeit notwendig ist). Schauen Sie gern die Dokumentation
unter <code>game/doc/</code> und <code>dungeon/doc/</code> an, die im Laufe des Semesters schrittweise weiter
wachsen wird.</p>
<p>Anregungen für <strong>Spielideen</strong> können Sie beispielsweise in den folgenden Videos
finden:</p>
<ul>
<li><a href="https://youtu.be/qoc_tDN0QC4" rel="external" target="_blank">Shattered Pixel Dungeon Rogue Beginners Guide Playthrough</a></li>
<li><a href="https://youtu.be/LgSjUWjQg0s" rel="external" target="_blank">Shattered Pixel Dungeon Duelist Update!</a></li>
</ul>
<p>Viel Spass im PM-Dungeon!</p>


    



    



    




    







<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
          <article class="default">
            <header class="headline">
            </header>

<h1 id="testen-mit-junit-und-mockito">Testen mit JUnit und Mockito</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro.html">Einführung Softwaretest</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics.html">Testen mit JUnit (JUnit-Basics)</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases.html">Testfallermittlung: Wie viel und was muss man testen?</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/mockito.html">Mocking mit Mockito</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Testen mit JUnit und Mockito</h1>
<article class="default">
<h1>Einführung Softwaretest</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Fehler schleichen sich durch Zeitdruck und hohe Komplexität schnell in ein Softwareprodukt ein. Die
Folgen können von &quot;ärgerlich&quot; über &quot;teuer&quot; bis hin zu (potentiell) &quot;tödlich&quot; reichen. Richtiges
Testen ist also ein wichtiger Aspekt bei der Softwareentwicklung!</p>
<p>JUnit ist ein Java-Framework, mit dem Unit-Tests (aber auch andere Teststufen) implementiert werden
können. In JUnit 4 und 5 zeichnet man eine Testmethode mit Hilfe der Annotation <code>@Test</code> an der
entsprechenden Methode aus. Dadurch kann man Produktiv- und Test-Code prinzipiell mischen; Best
Practice ist aber das Anlegen eines weiteren Ordners <code>test/</code> und das Spiegeln der Package-Strukturen.
Für die zu testende Klasse wird eine korrespondierende Testklasse mit dem Suffix &quot;Test&quot; (Konvention)
angelegt und dort die Testmethoden implementiert. Der IDE muss der neue <code>test/</code>-Ordner noch als
Ordner für Sourcen bzw. Tests bekannt gemacht werden. In den Testmethoden baut man den Test auf,
führt schließlich den Testschritt durch (beispielsweise konkreter Aufruf der zu testenden Methode)
und prüft anschließend mit einem <code>assert*()</code>, ob das erzielte Ergebnis dem erwarteten Ergebnis
entspricht. Ist alles OK, ist der Test &quot;grün&quot;, sonst &quot;rot&quot;.</p>
<p>Da ein fehlschlagendes <code>assert*()</code> den Test abbricht, werden eventuell danach folgende Prüfungen
<strong>nicht</strong> mehr durchgeführt und damit ggf. weitere Fehler maskiert. Deshalb ist es gute Praxis, in
einer Testmethode nur einen Testfall zu implementieren und i.d.R. auch nur ein (oder wenige) Aufrufe
von <code>assert*()</code> pro Testmethode zu haben.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/WGd83crqu4I' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Einführung Softwaretest</a></li> <li><a href='https://youtu.be/xcogVwHUo5o' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Anlegen von Testfällen mit JUnit</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/87e2aa545269a6d4c0502a18a3e800c82bc767de66612f488f17e0ff60c3a66097884212745aff556c2b76eee7a0fd8a8225d912c3a39c274020fd5b8055bb10' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Einführung Softwaretest</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Ursachen von Softwarefehlern</li> <li>(K3) Aufbauen von Tests mit JUnit 4 und 5 unter Nutzung der Annotation <code>@Test</code></li></ul>
  </div>
</div>




    <h2 id="software-fehler-und-ihre-folgen">Software-Fehler und ihre Folgen</h2>
<p><a href="#R-image-4fb12ca9ecdc22d878ed69a2b869cb73" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/swfehler.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-4fb12ca9ecdc22d878ed69a2b869cb73"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/swfehler.png?width=80%25&height=auto"></a></p>
<h2 id="einige-ursachen-für-fehler">(Einige) Ursachen für Fehler</h2>
<ul>
<li>Zeit- und Kostendruck</li>
<li>Mangelhafte Anforderungsanalyse</li>
<li>Hohe Komplexität</li>
<li>Mangelhafte Kommunikation</li>
<li>Keine/schlechte Teststrategie</li>
<li>Mangelhafte Beherrschung der Technologie</li>
<li>...</li>
</ul>
<h2 id="irgendjemand-muss-mit-deinen-bugs-leben">Irgendjemand muss mit Deinen Bugs leben!</h2>
<p>Leider gibt es im Allgemeinen keinen Weg zu zeigen, dass eine Software korrekt ist.
Man kann (neben formalen Beweisansätzen) eine Software nur unter möglichst vielen
Bedingungen ausprobieren, um zu schauen, wie sie sich verhält, und um die dabei zu
Tage tretenden Bugs zu fixen.</p>
<p>Mal abgesehen von der verbesserten <em>User-Experience</em> führt weniger fehlerbehaftete
Software auch dazu, dass man seltener mitten in der Nacht geweckt wird, weil irgendwo
wieder ein Server gecrasht ist ... Weniger fehlerbehaftete Software ist auch leichter
zu ändern und zu pflegen! In realen Projekten macht Maintenance den größten Teil an der
Softwareentwicklung aus ... Während Ihre Praktikumsprojekte vermutlich nach der Abgabe
nie wieder angeschaut werden, können echte Projekte viele Jahre bis Jahrzehnte leben!
D.h. irgendwer muss sich dann mit Ihren Bugs herumärgern - vermutlich sogar Sie selbst ;)</p>
<blockquote>
<p>Always code as if the guy who ends up maintaining your code will be a
violent psychopath who knows where you live. Code for readability.</p>
<p>-- <a href="https://groups.google.com/g/comp.lang.c++/c/rYCO5yn4lXw/m/oITtSkZOtoUJ" rel="external" target="_blank">John F. Woods</a></p>
</blockquote>
<p>Dieses Zitat taucht immer mal wieder auf, beispielsweise auf der <a href="https://twitter.com/andypiper/status/490952891058757632" rel="external" target="_blank">OSCON 2014</a> ...
Es scheint aber tatsächlich, dass <a href="https://groups.google.com/g/comp.lang.c++/c/rYCO5yn4lXw/m/oITtSkZOtoUJ" rel="external" target="_blank">John F. Woods</a>
die ursprüngliche Quelle war (vgl. <a href="https://stackoverflow.com/questions/876089/who-wrote-this-programing-saying-always-code-as-if-the-guy-who-ends-up-maintai#878436" rel="external" target="_blank">Stackoverflow: 876089</a>).</p>
<p>Da wir nur wenig Zeit haben und zudem vergesslich sind und obendrein die Komplexität
eines Projekts mit der Anzahl der Code-Zeilen i.d.R. nicht-linear ansteigt, müssen wir
das Testen automatisieren. Und hier kommt JUnit ins Spiel :)</p>
<h2 id="was-wann-testen-wichtigste-teststufen">Was wann testen? Wichtigste Teststufen</h2>
<ul>
<li>
<p><strong>Modultest</strong></p>
<ul>
<li>Testen einer Klasse und ihrer Methoden</li>
<li>Test auf gewünschtes Verhalten (Parameter, Schleifen, ...)</li>
</ul>
</li>
<li>
<p><strong>Integrationstest</strong></p>
<ul>
<li>Test des korrekten Zusammenspiels mehrerer Komponenten</li>
<li>Konzentration auf Schnittstellentests</li>
</ul>
</li>
<li>
<p><strong>Systemtest</strong></p>
<ul>
<li>Test des kompletten Systems unter produktiven Bedingungen</li>
<li>Orientiert sich an den aufgestellten Use Cases</li>
<li>Funktionale und nichtfunktionale Anforderungen testen</li>
</ul>
</li>
</ul>
<p>=&gt; Verweis auf Wahlfach &quot;Softwarequalität&quot;</p>
<h2 id="junit-test-framework-für-java">JUnit: Test-Framework für Java</h2>
<p><strong>JUnit</strong> --- Open Source Java Test-Framework zur Erstellung und
Durchführung wiederholbarer Tests</p>
<ul>
<li>
<p>JUnit 3</p>
<ul>
<li>Tests müssen in eigenen Testklassen stehen</li>
<li>Testklassen müssen von Klasse <code>TestCase</code> erben</li>
<li>Testmethoden müssen mit dem Präfix &quot;<code>test</code>&quot; beginnen</li>
</ul>
</li>
<li>
<p><strong>JUnit 4</strong></p>
<ul>
<li>Annotation <code>@Test</code> für Testmethoden</li>
<li>Kein Zwang zu spezialisierten Testklassen (insbesondere kein Zwang mehr zur Ableitung von <code>TestCase</code>)</li>
<li>Freie Namenswahl für Testmethoden (benötigen nicht mehr Präfix &quot;<code>test</code>&quot;)</li>
</ul>
<p>Damit können prinzipiell auch direkt im Source-Code Methoden als
JUnit-Testmethoden ausgezeichnet werden ... (das empfiehlt sich in der
Regel aber nicht)</p>
</li>
<li>
<p><em>JUnit 5 = JUnit Platform + JUnit Jupiter + JUnit Vintage</em></p>
<ul>
<li>Erweiterung um mächtigere Annotationen</li>
<li>Aufteilung in spezialisierte Teilprojekte</li>
</ul>
<p>Das Teilprojekt &quot;JUnit Platform&quot; ist die Grundlage für das JUnit-Framework. Es bietet
u.a. einen Console-Launcher, um Testsuiten manuell in der Konsole zu starten oder über
Builder wie Ant oder Gradle.</p>
<p>Das Teilprojekt &quot;JUnit Jupiter&quot; ist das neue Programmiermodell zum Schreiben von Tests
in JUnit 5. Es beinhaltet eine TestEngine zum Ausführen der in Jupiter geschriebenen
Tests.</p>
<p>Das Teilprojekt &quot;JUnit Vintage&quot; beinhaltet eine TestEngine zum Ausführen von Tests,
die in JUnit 3 oder JUnit 4 geschrieben sind.</p>
</li>
</ul>
<p><em>Anmerkung</em>: Wie der Name schon sagt, ist das Framework für Modultests
(&quot;Unit-Tests&quot;) gedacht. Man kann damit aber auch auf anderen Teststufen
arbeiten!</p>
<p><em>Anmerkung</em>: Im Folgenden besprechen wir JUnit am Beispiel <strong>JUnit 4</strong>, da diese Version
des Frameworks besonders stark verbreitet ist und JUnit 5 (trotz offiziellem Release) immer
noch stellenweise unfertig wirkt. Auf Unterschiede zu JUnit 5 wird an geeigneter Stelle
hingewiesen (abgesehen von Import-Statements). Mit JUnit 3 sollte nicht mehr aktiv
gearbeitet werden, d.h. insbesondere keine neuen Tests mehr erstellt werden, da diese
Version nicht mehr weiterentwickelt wird.</p>
<h2 id="anlegen-und-organisation-der-tests-mit-junit">Anlegen und Organisation der Tests mit JUnit</h2>
<div class='columns'>
<div class='column'>
<ul>
<li>
<p>Anlegen neuer Tests: Klasse auswählen, Kontextmenü <code>New &gt; JUnit Test Case</code></p>
</li>
<li>
<p><strong>Best Practice</strong>:  <span class='alert'>Spiegeln der Paket-Hierarchie</span></p>
<ul>
<li>Toplevel-Ordner <code>test</code> (statt <code>src</code>)</li>
<li>Package-Strukturen spiegeln</li>
<li>Testklassen mit Suffix &quot;<code>Test</code>&quot;</li>
</ul>
</li>
</ul>
</div>
<div class='column'>
<p><a href="#R-image-402c82c382002aa25690298d89803a6b" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/newJUnit.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-402c82c382002aa25690298d89803a6b"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/newJUnit.png?width=40%25&height=auto"></a></p>
</div>
</div>
<p>Vorteile dieses Vorgehens:</p>
<ul>
<li>Die Testklassen sind aus Java-Sicht im selben Package wie die Source-Klassen,
d.h. Zugriff auf Package-sichtbare Methoden etc. ist gewährleistet</li>
<li>Durch die Spiegelung der Packages in einem separaten Testordner erhält man
eine gute getrennte Übersicht über jeweils die Tests und die Sourcen</li>
<li>Die Wiederverwendung des Klassennamens mit dem Anhang &quot;Test&quot; erlaubt die
schnelle Erkennung, welche Tests hier vorliegen</li>
</ul>
<p>In der Paketansicht liegen dann die Source- und die Testklassen immer direkt
hintereinander (da sie im selben Paket sind und mit dem selben Namen anfangen)
=&gt; besserer Überblick!</p>
<h2 id="anmerkung-die-richtige-junit-bibliothek-muss-im-classpath-liegen">Anmerkung: Die (richtige) JUnit-Bibliothek muss im Classpath liegen!</h2>
<p>Eclipse bringt für JUnit 4 und JUnit 5 die nötigen Jar-Dateien mit und fragt beim
erstmaligen Anlegen einer neuen Testklasse, ob die für die ausgewählte Version
<strong>passenden JUnit-Jars zum Build-Path hinzugefügt</strong> werden sollen.</p>
<p>IntelliJ bringt ebenfalls eine JUnit 4 Bibliothek mit, die zum Projekt als Abhängigkeit
hinzugefügt werden muss. Für JUnit 5 bietet IntelliJ an, die Jar-Dateien herunterzuladen
und in einem passenden Ordner abzulegen.</p>
<p>Alternativ lädt man die Bibliotheken entsprechend der Anleitung unter <a href="https://junit.org/" rel="external" target="_blank">junit.org</a>
herunter und bindet sie in das Projekt ein.</p>
<h2 id="junit-45-definition-von-tests">JUnit 4+5: Definition von Tests</h2>
<p>Annotation <code>@Test</code> vor Testmethode schreiben</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.junit.Test;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import static</span> org.junit.Assert.*;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FactoryBeispielTest4</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testGetTicket</span>() {
</span></span><span style="display:flex;"><span>        fail(<span style="color:#e6db74">&#34;not implemented&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Für JUnit 5 muss statt <code>org.junit.Test</code> entsprechend <code>org.junit.jupiter.api.Test</code> importiert werden.</p>
<p>Während in JUnit 4 die Testmethoden mit der Sichtbarkeit <code>public</code> versehen sein müssen und keine
Parameter haben (dürfen), spielt die Sichtbarkeit in JUnit 5 keine Rolle (und die Testmethoden dürfen Parameter
aufweisen =&gt; vgl. Abschnitt &quot;Dependency Injection for Constructors and Methods&quot; in der JUnit-Doku).</p>
<h2 id="junit-4-ergebnis-prüfen">JUnit 4: Ergebnis prüfen</h2>
<p>Klasse <strong><code>org.junit.Assert</code></strong> enthält diverse <strong>statische</strong> Methoden zum Prüfen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Argument muss true bzw. false sein</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertTrue</span>(<span style="color:#66d9ef">boolean</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertFalse</span>(<span style="color:#66d9ef">boolean</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Gleichheit im Sinne von equals()</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertEquals</span>(Object, Object);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Test sofort fehlschlagen lassen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fail</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<p>Für JUnit 5 finden sich die Assert-Methoden im Package <code>org.junit.jupiter.api.Assertions</code>.</p>
<h2 id="anmerkung-zum-statischen-import">Anmerkung zum statischen Import</h2>
<p>Bei normalem Import der Klasse <code>Assert</code> muss man jeweils den voll qualifizierten Namen
einer statischen Methode nutzen: <code>Assert.fail()</code>.</p>
<p>Alternative statischer Import: <code>import static org.junit.Assert.fail;</code>
=&gt; <em>Statische Member</em> der importierten Klasse (oder Interface)
werden über ihre <em>unqualifizierten Namen</em> zugreifbar.
<span class='alert'>Achtung:</span> Namenskollisionen möglich!</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// nur bestimmtes Member importieren</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import static</span> packageName.className.staticMemberName;
</span></span><span style="display:flex;"><span><span style="color:#75715e">// alle statischen Member importieren</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import static</span> packageName.className.*;</span></span></code></pre></div>
<ul>
<li>
<p>Beispiel normaler Import:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.junit.Assert;
</span></span><span style="display:flex;"><span>Assert.<span style="color:#a6e22e">fail</span>(<span style="color:#e6db74">&#34;message&#34;</span>);</span></span></code></pre></div>
</li>
<li>
<p>Beispiel statischer Import:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import static</span> org.junit.Assert.fail;
</span></span><span style="display:flex;"><span>fail(<span style="color:#e6db74">&#34;message&#34;</span>);</span></span></code></pre></div>
</li>
</ul>
<h2 id="mögliche-testausgänge-bei-junit">Mögliche Testausgänge bei JUnit</h2>
<div class='columns'>
<div class='column'>
<p><a href="#R-image-5eb1f89bcbc1e747b16f3ae3e76bdde2" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/junitErgebnis.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-5eb1f89bcbc1e747b16f3ae3e76bdde2"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testing-intro/junitErgebnis.png?width=40%25&height=auto"></a></p>
</div>
<div class='column'>
<ol>
<li>
<p><strong>Error</strong>: Fehler im Programm (Test)</p>
<ul>
<li>Unbehandelte Exception</li>
<li>Abbruch (Timeout)</li>
</ul>
</li>
<li>
<p><strong>Failure</strong>: Testausgang negativ</p>
<ul>
<li>Assert fehlgeschlagen</li>
<li><code>Assert.fail()</code> aufgerufen</li>
</ul>
</li>
<li>
<p><strong>OK</strong></p>
</li>
</ol>
</div>
</div>
<h2 id="anmerkungen-zu-assert">Anmerkungen zu Assert</h2>
<ul>
<li>Pro Testmethode möglichst nur <strong>ein</strong> Assert verwenden!</li>
<li>Anderenfalls: Schlägt ein Assert fehl, wird der Rest nicht mehr überprüft ...</li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Testen ist genauso wichtig wie Coden</p>
</li>
<li>
<p>Richtiges Testen spart Geld, Zeit, ...</p>
</li>
<li>
<p>Tests auf verschiedenen Abstraktionsstufen</p>
</li>
<li>
<p>JUnit als Framework für (Unit-) Tests; hier JUnit 4 (mit Ausblick auf JUnit 5)</p>
<ul>
<li>Testmethoden mit Annotation <code>@Test</code></li>
<li>Testergebnis mit <code>assert*</code> prüfen</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106545&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz JUnit-Basics - nur erster Teil (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Einfache JUnit-Tests</strong></p>
<p>Betrachten Sie die folgende einfache (und nicht besonders sinnvolle)
Klasse <code>MyList&lt;T&gt;</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyList</span><span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">final</span> List<span style="color:#f92672">&lt;</span>T<span style="color:#f92672">&gt;</span> list <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">add</span>(T element) { <span style="color:#66d9ef">return</span> list.<span style="color:#a6e22e">add</span>(element); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">size</span>() { <span style="color:#66d9ef">return</span> list.<span style="color:#a6e22e">size</span>(); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Schreiben Sie mit Hilfe von JUnit (4.x oder 5.x) einige Unit-Tests für
die beiden Methoden <code>MyList&lt;T&gt;#add</code> und <code>MyList&lt;T&gt;#size</code>.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
                    
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_fernunihagenJunit'>[fernunihagenJunit] <a href='https://wiki.fernuni-hagen.de/eclipse/index.php/Einführung_in_JUnit' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Einführung in JUnit</strong></a><br>Thies, A. und Noelke, C. und Ungerc, Fernuniversität in Hagen.</li> <li id='id_junit4'>[junit4] <a href='https://junit.org/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5</strong></a><br>The JUnit Team, 2022.</li> <li id='id_Kleuker2019'>[Kleuker2019] <strong>Qualitätssicherung durch Softwaretests</strong><br>Kleuker, S., Springer Vieweg, 2019. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-658-24886-4</a>. DOI <a href='https://doi.org/10.1007/978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>10.1007/978-3-658-24886-4</a>.</li> <li id='id_Osherove2014'>[Osherove2014] <strong>The Art of Unit Testing</strong><br>Osherove, R., Manning, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9089-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9089-3</a>.</li> <li id='id_Spillner2012'>[Spillner2012] <strong>Basiswissen Softwaretest</strong><br>Spillner, A. und Linz, T., dpunkt, 2012. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-86490-024-2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-86490-024-2</a>.</li> <li id='id_vogellaJUnit'>[vogellaJUnit] <a href='https://www.vogella.com/tutorials/JUnit/article.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5 tutorial - Learn how to write unit tests</strong></a><br>vogella GmbH, 2021.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Testen mit JUnit (JUnit-Basics)</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>In JUnit 4 und 5 werden Testmethoden mit Hilfe der Annotation <code>@Test</code> ausgezeichnet. Über die
verschiedenen <code>assert*()</code>-Methoden kann das Testergebnis mit dem erwarteten Ergebnis verglichen
werden und entsprechend ist der Test &quot;grün&quot; oder &quot;rot&quot;. Mit den verschiedenen <code>assume*()</code>-Methoden
kann dagegen geprüft werden, ob eventuelle Vorbedingungen für das Ausführen eines Testfalls
erfüllt sind - anderenfalls wird der Testfall dann übersprungen.</p>
<p>Mit Hilfe von <code>@Before</code> und <code>@After</code> können Methoden gekennzeichnet werden, die jeweils vor jeder
Testmethode und nach jeder Testmethode aufgerufen werden. Damit kann man seine Testumgebung auf-
und auch wieder abbauen (JUnit 4).</p>
<p>Erwartete Exceptions lassen sich in JUnit 4 mit einem Parameter <code>expected</code> in der Annotation <code>@Test</code>
automatisch prüfen: <code>@Test(expected=package.Exception.class)</code>. In JUnit 4 besteht die Möglichkeit,
Testklassen zu Testsuiten zusammenzufassen und gemeinsam laufen zu lassen.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/2SC40rO0ZOE' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL JUnit Basics</a></li> <li><a href='https://youtu.be/j3FK9iTHuDk' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo assume() vs. assert()</a></li> <li><a href='https://youtu.be/KsFydUSBDTc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Parametrisierte Tests mit JUnit4</a></li> <li><a href='https://youtu.be/0H-OCICktS0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Parametrisierte Tests mit JUnit5</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/e10dd378f9b18ba4a42ffbb2c13bfb83685b60fd39a221dba8658b8edcb0df032c2dcf9a1dcd44cf59aa6b483a00a19195cb5a8d117a6fbda52cfcfcf9efe5da' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL JUnit Basics</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Steuern von Tests (ignorieren, zeitliche Begrenzung)</li> <li>(K3) Prüfung von Exceptions</li> <li>(K3) Aufbau von Testsuiten mit JUnit</li></ul>
  </div>
</div>




    <h2 id="junit-ergebnis-prüfen">JUnit: Ergebnis prüfen</h2>
<p>Klasse <strong><code>org.junit.Assert</code></strong> enthält diverse <strong>statische</strong> Methoden zum Prüfen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Argument muss true bzw. false sein</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertTrue</span>(<span style="color:#66d9ef">boolean</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertFalse</span>(<span style="color:#66d9ef">boolean</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Gleichheit im Sinne von equals()</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">assertEquals</span>(Object, Object);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Test sofort fehlschlagen lassen</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">fail</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>...</span></span></code></pre></div>
<h2 id="to-assert-or-to-assume">To &quot;assert&quot; or to &quot;assume&quot;?</h2>
<ul>
<li>
<p>Mit <code>assert*</code> werden Testergebnisse geprüft</p>
<ul>
<li>Test wird ausgeführt</li>
<li>Ergebnis: OK, Failure, Error</li>
</ul>
</li>
<li>
<p>Mit <code>assume*</code> werden Annahmen über den Zustand geprüft</p>
<ul>
<li>Test wird abgebrochen, wenn Annahme nicht erfüllt</li>
<li>Prüfen von Vorbedingungen: Ist der Test hier ausführbar/anwendbar?</li>
</ul>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/junit4/TestAssume.java" target="_blank"><span class="title">Beispiel: junit4.TestAssume</span></a></span></div>
<h2 id="setup-und-teardown-testübergreifende-konfiguration">Setup und Teardown: Testübergreifende Konfiguration</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> Studi x;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() { x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testToString</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Studi x = new Studi();</span>
</span></span><span style="display:flex;"><span>    assertEquals(x.<span style="color:#a6e22e">toString</span>(), <span style="color:#e6db74">&#34;Heinz (15cps)&#34;</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<dl>
<dt><strong><code>@Before</code></strong></dt>
<dd>wird <strong>vor jeder</strong> Testmethode aufgerufen</dd>
<dt><strong><code>@BeforeClass</code></strong></dt>
<dd>wird <strong>einmalig</strong> vor allen Tests aufgerufen (<code>static</code>!)</dd>
<dt><strong><code>@After</code></strong></dt>
<dd>wird <strong>nach jeder</strong> Testmethode aufgerufen</dd>
<dt><strong><code>@AfterClass</code></strong></dt>
<dd>wird <strong>einmalig</strong> nach allen Tests aufgerufen (<code>static</code>!)</dd>
</dl>
<p>In JUnit 5 wurden die Namen dieser Annotationen leicht geändert:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">JUnit 4</th>
          <th style="text-align: left">JUnit 5</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>@Before</code></td>
          <td style="text-align: left"><code>@BeforeEach</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>@After</code></td>
          <td style="text-align: left"><code>@AfterEach</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>@BeforeClass</code></td>
          <td style="text-align: left"><code>@BeforeAll</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>@AfterClass</code></td>
          <td style="text-align: left"><code>@AfterAll</code></td>
      </tr>
  </tbody>
</table>
<h2 id="beispiel-für-den-einsatz-von-before">Beispiel für den Einsatz von <code>@Before</code></h2>
<p>Annahme: <strong>alle/viele</strong> Testmethoden brauchen <strong>neues</strong> Objekt <code>x</code> vom Typ <code>Studi</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> Studi x;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() {
</span></span><span style="display:flex;"><span>    x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Heinz&#34;</span>, 15);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testToString</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Studi x = new Studi(&#34;Heinz&#34;, 15);</span>
</span></span><span style="display:flex;"><span>    assertEquals(x.<span style="color:#a6e22e">toString</span>(), <span style="color:#e6db74">&#34;Name: Heinz, credits: 15&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testGetName</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Studi x = new Studi(&#34;Heinz&#34;, 15);</span>
</span></span><span style="display:flex;"><span>    assertEquals(x.<span style="color:#a6e22e">getName</span>(), <span style="color:#e6db74">&#34;Heinz&#34;</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="ignorieren-von-tests">Ignorieren von Tests</h2>
<ul>
<li>Hinzufügen der Annotation <code>@Ignore</code></li>
<li>Alternativ mit Kommentar: <code>@Ignore(&quot;Erst im nächsten Release&quot;)</code></li>
</ul>
<div class='columns'>
<div class='column'>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Ignore</span>(<span style="color:#e6db74">&#34;Warum ignoriert&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testBsp</span>() {
</span></span><span style="display:flex;"><span>    Bsp x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Bsp();
</span></span><span style="display:flex;"><span>    assertTrue(x.<span style="color:#a6e22e">isTrue</span>());
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
<div class='column'>
<p><a href="#R-image-a05749b322c6a6ae64001db33715d478" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics/junitIgnore.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-a05749b322c6a6ae64001db33715d478"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics/junitIgnore.png?width=40%25&height=auto"></a></p>
</div>
</div>
<p>In JUnit 5 wird statt der Annotation <code>@Ignore</code> die Annotation <code>@Disabled</code> mit
der selben Bedeutung verwendet. Auch hier lässt sich als Parameter ein String
mit dem Grund für das Ignorieren des Tests hinterlegen.</p>
<h2 id="vermeidung-von-endlosschleifen-timeout">Vermeidung von Endlosschleifen: Timeout</h2>
<ul>
<li>Testfälle werden nacheinander ausgeführt</li>
<li>Test mit Endlosschleife würde restliche Tests blockieren</li>
<li>Erweitern der <code>@Test</code>-Annotation mit Parameter &quot;<code>timeout</code>&quot;:
=&gt; <code>@Test(timeout=2000)</code> (Zeitangabe in Millisekunden)</li>
</ul>
<div class='columns'>
<div class='column'>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>(timeout <span style="color:#f92672">=</span> 2000)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testTestDauerlaeufer</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) { ; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
<div class='column'>
<p><a href="#R-image-fe75f3ad59af9ff80f27cf21ff4d288a" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics/junitIgnore.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-fe75f3ad59af9ff80f27cf21ff4d288a"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics/junitIgnore.png?width=40%25&height=auto"></a></p>
</div>
</div>
<p>In JUnit 5 hat die Annotation <code>@Test</code> keinen <code>timeout</code>-Parameter mehr.
Als Alternative bietet sich der Einsatz von <code>org.junit.jupiter.api.Assertions.assertTimeout</code>
an. Dabei benötigt man allerdings <em>Lambda-Ausdrücke</em> (Verweis auf spätere VL):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testTestDauerlaeufer</span>() {
</span></span><span style="display:flex;"><span>    assertTimeout(ofMillis(2000), () <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) { ; }
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>(Beispiel von oben mit Hilfe von JUnit 5 formuliert)</p>
<h2 id="test-von-exceptions-expected">Test von Exceptions: Expected</h2>
<p>Traditionelles Testen von Exceptions mit <code>try</code> und <code>catch</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testExceptTradit</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>        fail(<span style="color:#e6db74">&#34;keine ArithmeticException ausgeloest&#34;</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (ArithmeticException aex) {
</span></span><span style="display:flex;"><span>        assertNotNull(aex.<span style="color:#a6e22e">getMessage</span>());
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>        fail(<span style="color:#e6db74">&#34;falsche Exception geworfen&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Der <code>expected</code>-Parameter für die <code>@Test</code>-Annotation in JUnit 4 macht
dies deutlich einfacher: <code>@Test(expected = MyException.class)</code>
=&gt; Test scheitert, wenn diese Exception <strong>nicht</strong> geworfen wird</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>(expected <span style="color:#f92672">=</span> java.<span style="color:#a6e22e">lang</span>.<span style="color:#a6e22e">ArithmeticException</span>.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testExceptAnnot</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>In JUnit 5 hat die Annotation <code>@Test</code> keinen <code>expected</code>-Parameter mehr.
Als Alternative bietet sich der Einsatz von <code>org.junit.jupiter.api.Assertions.assertThrows</code>
an. Dabei benötigt man allerdings <em>Lambda-Ausdrücke</em> (Verweis auf spätere VL):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testExceptAnnot</span>() {
</span></span><span style="display:flex;"><span>    assertThrows(java.<span style="color:#a6e22e">lang</span>.<span style="color:#a6e22e">ArithmeticException</span>.<span style="color:#a6e22e">class</span>, () <span style="color:#f92672">-&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 0 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>(Beispiel von oben mit Hilfe von JUnit 5 formuliert)</p>
<h2 id="parametrisierte-tests">Parametrisierte Tests</h2>
<p>Manchmal möchte man den selben Testfall mehrfach mit anderen Werten (Parametern)
durchführen.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Sum</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">sum</span>(<span style="color:#66d9ef">int</span> i, <span style="color:#66d9ef">int</span> j) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> i <span style="color:#f92672">+</span> j;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SumTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSum</span>() {
</span></span><span style="display:flex;"><span>        Sum s <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Sum();
</span></span><span style="display:flex;"><span>        assertEquals(s.<span style="color:#a6e22e">sum</span>(1, 1), 2);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// und mit (2,2, 4), (2,2, 5), ...????</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Prinzipiell könnte man dafür entweder in einem Testfall eine Schleife schreiben,
die über die verschiedenen Parameter iteriert. In der Schleife würde dann
jeweils der Aufruf der zu testenden Methode und das gewünschte Assert passieren.
Alternativ könnte man den Testfall entsprechend oft duplizieren mit jeweils den
gewünschten Werten.</p>
<p>Beide Vorgehensweisen haben Probleme: Im ersten Fall würde die Schleife bei
einem Fehler oder unerwarteten Ergebnis abbrechen, ohne dass die restlichen
Tests (Werte) noch durchgeführt würden. Im zweiten Fall bekommt man eine
unnötig große Anzahl an Testmethoden, die bis auf die jeweiligen Werte identisch
sind (Code-Duplizierung).</p>
<h3 id="parametrisierte-tests-mit-junit-4">Parametrisierte Tests mit JUnit 4</h3>
<p>JUnit 4 bietet für dieses Problem sogenannte &quot;parametrisierte Tests&quot; an. Dafür
muss eine Testklasse in JUnit 4 folgende Bedingungen erfüllen:</p>
<ol>
<li>Die Testklasse wird mit der Annotation <code>@RunWith(Parameterized.class)</code>
ausgezeichnet.</li>
<li>Es muss eine öffentliche statische Methode geben mit der Annotation
<code>@Parameters</code>. Diese Methode liefert eine Collection zurück, wobei jedes
Element dieser Collection ein Array mit den Parametern für einen
Durchlauf der Testmethoden ist.</li>
<li>Die Parameter müssen gesetzt werden. Dafür gibt es zwei Varianten:
<ul>
<li>(A) Für jeden Parameter gibt es ein öffentliches Attribut. Diese Attribute
müssen mit der Annotation <code>@Parameter</code> markiert sein und können in den
Testmethoden normal genutzt werden. JUnit sorgt dafür, dass für jeden
Eintrag in der Collection aus der statischen <code>@Parameters</code>-Methode
diese Felder gesetzt werden und die Testmethoden aufgerufen werden.</li>
<li>(B) Alternativ gibt es einen Konstruktor, der diese Werte setzt. Die Anzahl
der Parameter im Konstruktor muss dabei exakt der Anzahl (und
Reihenfolge) der Werte in jedem Array in der von der statischen
<code>@Parameters</code>-Methode gelieferten Collection entsprechen. Der
Konstruktor wird für jeden Parametersatz einmal aufgerufen und die
Testmethoden einmal durchgeführt.</li>
</ul>
</li>
</ol>
<p>Letztlich wird damit das Kreuzprodukt aus Testmethoden und Testdaten durchgeführt.</p>
<h4 id="a-parametrisierte-tests-konstruktor-junit-4">(A) Parametrisierte Tests: Konstruktor (JUnit 4)</h4>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span>(Parameterized.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SumTestConstructor</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> s1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> s2;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> erg;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">SumTestConstructor</span>(<span style="color:#66d9ef">int</span> p1, <span style="color:#66d9ef">int</span> p2, <span style="color:#66d9ef">int</span> p3) { s1 <span style="color:#f92672">=</span> p1;  s2 <span style="color:#f92672">=</span> p2;  erg <span style="color:#f92672">=</span> p3; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Parameters</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Collection<span style="color:#f92672">&lt;</span>Object<span style="color:#f92672">[]&gt;</span> <span style="color:#a6e22e">values</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#66d9ef">new</span> Object<span style="color:#f92672">[][]</span> { { 1, 1, 2 }, { 2, 2, 4 }, { 2, 2, 5 } });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSum</span>() {
</span></span><span style="display:flex;"><span>        assertEquals(Sum.<span style="color:#a6e22e">sum</span>(s1, s2), erg);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h4 id="b-parametrisierte-tests-parameter-junit-4">(B) Parametrisierte Tests: Parameter (JUnit 4)</h4>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span>(Parameterized.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SumTestParameters</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Parameter</span>(0)  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> s1;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Parameter</span>(1)  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> s2;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Parameter</span>(2)  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> erg;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Parameters</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Collection<span style="color:#f92672">&lt;</span>Object<span style="color:#f92672">[]&gt;</span> <span style="color:#a6e22e">values</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#66d9ef">new</span> Object<span style="color:#f92672">[][]</span> { { 1, 1, 2 }, { 2, 2, 4 }, { 2, 2, 5 } });
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSum</span>() {
</span></span><span style="display:flex;"><span>        assertEquals(Sum.<span style="color:#a6e22e">sum</span>(s1, s2), erg);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/junit4/" target="_blank"><span class="title">Beispiel: junit4.SumTestConstructor, junit4.SumTestParameters</span></a></span></div>
<h3 id="parametrisierte-tests-mit-junit-5">Parametrisierte Tests mit JUnit 5</h3>
<p>In JUnit 5 werden <a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests" rel="external" target="_blank">parametrisierte Tests</a> mit der Annotation <a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.params/org/junit/jupiter/params/ParameterizedTest.html" rel="external" target="_blank"><code>@ParameterizedTest</code></a>
gekennzeichnet (statt mit <code>@Test</code>).</p>
<p>Mit Hilfe von <a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.params/org/junit/jupiter/params/provider/ValueSource.html" rel="external" target="_blank"><code>@ValueSource</code></a> kann man ein einfaches Array von Werten (Strings oder primitive
Datentypen) angeben, mit denen der Test ausgeführt wird. Dazu bekommt die Testmethode einen
entsprechenden passenden Parameter:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@ParameterizedTest</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@ValueSource</span>(strings <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;wuppie&#34;</span>, <span style="color:#e6db74">&#34;fluppie&#34;</span>, <span style="color:#e6db74">&#34;foo&#34;</span>})
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testWuppie</span>(String candidate) {
</span></span><span style="display:flex;"><span>    assertTrue(candidate.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;wuppie&#34;</span>));
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Alternativ lassen sich als Parameterquelle u.a. Aufzählungen (<a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.params/org/junit/jupiter/params/provider/EnumSource.html" rel="external" target="_blank"><code>@EnumSource</code></a>) oder Methoden
(<a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.params/org/junit/jupiter/params/provider/MethodSource.html" rel="external" target="_blank"><code>@MethodSource</code></a>) oder auch Komma-separierte Daten (<a href="https://junit.org/junit5/docs/current/api/org.junit.jupiter.params/org/junit/jupiter/params/provider/CsvSource.html" rel="external" target="_blank"><code>@CsvSource</code></a>) angeben.</p>
<p>Das obige Beispiel aus JUnit 4.x könnte mit Hilfe von <code>@CsvSource</code> so in JUnit 5.x umgesetzt
werden:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SumTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@ParameterizedTest</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@CsvSource</span>(textBlock <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            # s1,  s2,  s1+s2
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            0,     0,   0
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            10,    0,   10
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            0,     11,  11
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            -2,    10,  8
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testSum</span>(<span style="color:#66d9ef">int</span> s1, <span style="color:#66d9ef">int</span> s2, <span style="color:#66d9ef">int</span> erg) {
</span></span><span style="display:flex;"><span>        assertEquals(Sum.<span style="color:#a6e22e">sum</span>(s1, s2), erg);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/junit5/" target="_blank"><span class="title">Beispiel: junit5.TestValueSource, junit5.TestMethodSource</span></a></span></div>
<h2 id="testsuiten-tests-gemeinsam-ausführen-junit-4">Testsuiten: Tests gemeinsam ausführen (JUnit 4)</h2>
<p>Eclipse: <code>New &gt; Other &gt; Java &gt; JUnit &gt; JUnit Test Suite</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#f92672">import</span> org.junit.runner.RunWith;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.junit.runners.Suite;
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> org.junit.runners.Suite.SuiteClasses;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span>(Suite.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@SuiteClasses</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Hier kommen alle Testklassen rein</span>
</span></span><span style="display:flex;"><span>    PersonTest.<span style="color:#a6e22e">class</span>,
</span></span><span style="display:flex;"><span>    StudiTest.<span style="color:#a6e22e">class</span>
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyTestSuite</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// bleibt leer!!!</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="testsuiten-mit-junit-5">Testsuiten mit JUnit 5</h2>
<p>In JUnit 5 gibt es zwei Möglichkeiten, Testsuiten zu erstellen:</p>
<ul>
<li><code>@SelectPackages</code>: Angabe der Packages, die für die Testsuite zusammengefasst werden sollen</li>
<li><code>@SelectClasses</code>: Angabe der Klassen, die für die Testsuite zusammengefasst werden sollen</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span>(JUnitPlatform.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@SelectClasses</span>({StudiTest5.<span style="color:#a6e22e">class</span>, WuppieTest5.<span style="color:#a6e22e">class</span>})
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyTestSuite5</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// bleibt leer!!!</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Zusätzlich kann man beispielsweise mit <code>@IncludeTags</code> oder <code>@ExcludeTags</code> Testmethoden mit bestimmten Tags
einbinden oder ausschließen. Beispiel: Schließe alle Tests mit Tag &quot;develop&quot; aus: <code>@ExcludeTags(&quot;develop&quot;)</code>.
Dabei wird an den Testmethoden zusätzlich das Tag <code>@Tag</code> verwendet, etwas <code>@Tag(&quot;develop&quot;)</code>.</p>
<p><strong>Achtung</strong>: Laut der offiziellen Dokumentation
<a href="https://junit.org/junit5/docs/current/user-guide/#running-tests-junit-platform-runner-test-suite" rel="external" target="_blank">(Abschnitt &quot;4.4.4. Test Suite&quot;)</a>
gilt zumindest bei der Selection über <code>@SelectPackages</code> der Zwang zu einer Namenskonvention:
Es werden dabei nur Klassen gefunden, deren Name mit <code>Test</code> beginnt oder endet!
Weiterhin werden Testsuites mit der Annotation <code>@RunWith(JUnitPlatform.class)</code> <strong>nicht</strong>
auf der &quot;JUnit 5&quot;-Plattform ausgeführt, sondern mit der JUnit 4-Infrastuktur!</p>
<h2 id="best-practices">Best Practices</h2>
<ol>
<li>
<p>Ein Testfall behandelt exakt eine Idee/ein Szenario. Das bedeutet auch, dass man in der
Regel nur ein bis wenige <code>assert*</code> pro Testmethode benutzt.</p>
<p>(Wenn man verschiedene Ideen in eine Testmethode kombiniert, wird der Testfall
unübersichtlicher und auch auch schwerer zu warten.</p>
<p>Außerdem können so leichter versteckte Fehler auftreten: Das erste oder zweite oder dritte
<code>assert*</code> schlägt fehl - und alle dahinter kommenden <code>assert*</code> werden nicht mehr
ausgewertet!)</p>
</li>
<li>
<p>Wenn die selbe Testidee mehrfach wiederholt wird, sollte man diese Tests zu einem
parametrisierten Test zusammenfassen.</p>
<p>(Das erhöht die Lesbarkeit drastisch - und man läuft auch nicht in das Problem der
Benennung der Testmethoden.)</p>
</li>
<li>
<p>Es wird nur das Verhalten der öffentlichen Schnittstelle getestet, nicht die inneren
Strukturen einer Klasse oder Methode.</p>
<p>(Es ist verlockend, auch private Methoden zu testen und in den Tests auch die
Datenstrukturen o.ä. im Blick zu behalten und zu testen. Das führt aber zu sehr
&quot;zerbrechlichen&quot; (<em>brittle</em>) Tests: Sobald sich etwas an der inneren Struktur ändert, ohne
dass sich das von außen beobachtbare Verhalten ändert und also die Klasse/Methode immer
noch ordnungsgemäß funktioniert, gehen all diese &quot;internen&quot; Tests kaputt. Nicht ohne
Grund wird in der objektorientierten Programmierung mit Kapselung (Klassen, Methoden, ...)
gearbeitet.)</p>
</li>
<li>
<p>Von Setup- und Teardown-Methoden sollte eher sparsam Gebrauch gemacht werden.</p>
<p>(Normalerweise folgen wir in der objektorientierten Programmierung dem DRY-Prinzip (<a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" rel="external" target="_blank">Don't
repeat yourself</a>). Entsprechend
liegt es nahe, häufig benötigte Elemente in einer Setup-Methode zentral zu initialisieren
und ggf. in einer Teardown-Methode wieder freizugeben.</p>
<p>Das führt aber speziell bei Unit-Tests dazu, dass die einzelnen Testmethoden schwerer
lesbar werden: Sie hängen von einer gemeinsamen, zentralen Konfiguration ab, die man
üblicherweise nicht gleichzeitig mit dem Code der Testmethode sehen kann (begrenzter Platz
auf der Bildschirmseite).</p>
<p>Wenn nun in einem oder vielleicht mehreren Testfällen der Wunsch nach einer leicht anderen
Konfiguration auftaucht, muss man die gemeinsame Konfiguration entsprechend anpassen bzw.
erweitern. Dabei muss man dann aber <em>alle</em> anderen Testmethoden mit bedenken, die ja
ebenfalls von dieser Konfiguration abhängen! Das führt in der Praxis dann häufig dazu,
dass die gemeinsame Konfiguration sehr schnell sehr groß und verschachtelt und
entsprechend unübersichtlich wird.</p>
<p>Jede Änderung an dieser Konfiguration kann leicht einen oder mehrere Testfälle kaputt
machen (man hat ja i.d.R. nie alle Testfälle gleichzeitig im Blick), weshalb man hier
unbedingt mit passenden <code>assume*</code> arbeiten muss - aber dann kann man eigentlich auch
stattdessen die Konfiguration direkt passend für den jeweiligen Testfall in der jeweiligen
Testmethode erledigen!)</p>
</li>
<li>
<p>Wie immer sollten auch die Namen der Testmethoden klar über ihren Zweck Auskunft geben.</p>
<p>(Der Präfix &quot;test&quot; wird seit JUnit 4.x nicht mehr benötigt, aber dennoch ist es in vielen
Projekten Praxis, diesen Präfix beizubehalten - damit kann man in der Package-Ansicht in
der IDE leichter zwischen den &quot;normalen&quot; und den Testmethoden unterscheiden.)</p>
</li>
</ol>
<p>Diese Erfahrungen werden ausführlich in <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/junit-basics.html#id_SWEGoogle">[SWEGoogle, pp. 231-256]</a> diskutiert.</p>
<h2 id="wrap-up">Wrap-Up</h2>
<p>JUnit als Framework für (Unit-) Tests; hier JUnit 4 (mit Ausblick auf JUnit 5)</p>
<ul>
<li>Testmethoden mit Annotation <code>@Test</code></li>
<li><code>assert</code> (Testergebnis) vs. <code>assume</code> (Testvorbedingung)</li>
<li>Aufbau der Testumgebung <code>@Before</code></li>
<li>Abbau der Testumgebung <code>@After</code></li>
<li>Steuern von Tests mit <code>@Ignore</code> oder <code>@Test(timout=XXX)</code></li>
<li>Exceptions einfordern mit <code>@Test(expected=package.Exception.class)</code></li>
<li>Tests zusammenfassen zu Testsuiten</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106545&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz JUnit-Basics (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Setup und Teardown</strong></p>
<p>Sie haben in den Challenges in &quot;Intro SW-Test&quot; erste JUnit-Tests für
die Klasse <code>MyList&lt;T&gt;</code> implementiert.</p>
<p>Wie müssten Sie Ihre JUnit-Tests anpassen, wenn Sie im obigen Szenario
Setup- und Teardown-Methoden einsetzen würden?</p>
<p><strong>Parametrisierte Tests</strong></p>
<p>Betrachten Sie die folgende einfache Klasse <code>MyMath</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyMath</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">add</span>(String s, <span style="color:#66d9ef">int</span> c) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> s.<span style="color:#a6e22e">repeat</span>(c);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Beim Testen der Methode <code>MyMath#add</code> fällt auf, dass man hier immer
wieder den selben Testfall mit lediglich anderen Werten ausführt - ein
Fall für parametrisierte Tests.</p>
<p>Schreiben Sie mit Hilfe von JUnit (4.x oder 5.x) einige parametrisierte
Unit-Tests für die Methode <code>MyMath#add</code>.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
                    
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_fernunihagenJunit'>[fernunihagenJunit] <a href='https://wiki.fernuni-hagen.de/eclipse/index.php/Einführung_in_JUnit' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Einführung in JUnit</strong></a><br>Thies, A. und Noelke, C. und Ungerc, Fernuniversität in Hagen.</li> <li id='id_junit4'>[junit4] <a href='https://junit.org/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5</strong></a><br>The JUnit Team, 2022.</li> <li id='id_Kleuker2019'>[Kleuker2019] <strong>Qualitätssicherung durch Softwaretests</strong><br>Kleuker, S., Springer Vieweg, 2019. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-658-24886-4</a>. DOI <a href='https://doi.org/10.1007/978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>10.1007/978-3-658-24886-4</a>.</li> <li id='id_Osherove2014'>[Osherove2014] <strong>The Art of Unit Testing</strong><br>Osherove, R., Manning, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9089-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9089-3</a>.</li> <li id='id_Spillner2012'>[Spillner2012] <strong>Basiswissen Softwaretest</strong><br>Spillner, A. und Linz, T., dpunkt, 2012. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-86490-024-2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-86490-024-2</a>.</li> <li id='id_SWEGoogle'>[SWEGoogle] <strong>Software Engineering at Google: Lessons Learned from Programming Over Time</strong><br>Winters, T. und Manshreck, T. und Wright, H., O'Reilly, 2020. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-49208-279-8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-49208-279-8</a>.</li> <li id='id_vogellaJUnit'>[vogellaJUnit] <a href='https://www.vogella.com/tutorials/JUnit/article.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5 tutorial - Learn how to write unit tests</strong></a><br>vogella GmbH, 2021.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Testfallermittlung: Wie viel und was muss man testen?</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Mit Hilfe der Äquivalenzklassenbildung kann man Testfälle bestimmen. Dabei wird der Eingabebereich
für jeden Parameter einer Methode in Bereiche mit gleichem Verhalten der Methode eingeteilt (die
sogenannten &quot;Äquivalenzklassen&quot;). Dabei können einige Äquivalenzklassen (ÄK) gültigen Eingabebereichen
entsprechen (&quot;gültige ÄK&quot;), also erlaubten/erwarteten Eingaben (die zum gewünschten Verhalten führen),
und die restlichen ÄK entsprechen dann ungültigen Eingabebereichen (&quot;ungültige ÄK&quot;), also nicht
erlaubten Eingaben, die von der Methode zurückgewiesen werden sollten. Jede dieser ÄK muss in mindestens
einem Testfall vorkommen, d.h. man bestimmt einen oder mehrere zufällige Werte in den ÄK. Dabei können
über mehrere Parameter hinweg verschiedene gültige ÄK in einem Testfall kombiniert werden. Bei den
ungültigen ÄK kann dagegen immer nur ein Parameter eine ungültige ÄK haben, für die restlichen Parameter
müssen gültige ÄK genutzt werden, und diese werden dabei als durch diesen Testfall &quot;nicht getestet&quot;
betrachtet.</p>
<p>Zusätzlich entstehen häufig Fehler bei den Grenzen der Bereiche, etwa in Schleifen. Deshalb führt
man zusätzlich noch eine Grenzwertanalyse durch und bestimmt für jede ÄK den unteren und den oberen
Grenzwert und erzeugt aus diesen Werten zusätzliche Testfälle.</p>
<p>Wenn in der getesteten Methode der Zustand des Objekts eine Rolle spielt, wird dieser wie ein weiterer
Eingabeparameter für die Methode betrachtet und entsprechend in die ÄK-Bildung bzw. GW-Analyse einbezogen.</p>
<p>Wenn ein Testfall sich aus den gültigen ÄK/GW speist, spricht man auch von einem &quot;Positiv-Test&quot;; wenn
ungültige ÄK/GW genutzt werden, spricht man auch von einem &quot;Negativ-Test&quot;.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/AR1WWt4AFqI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Testfallermittlung</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/6719b852fd1ce5516a7110089ca465626826ef1e6d35ab62e8ef0ca5a71e2daab68631e2ff891d9562552ba7fa1ec97033e3d6c2ac65cf22b62377d2ceb4ea37' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Testfallermittlung</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Merkmale schlecht testbaren Codes erklären</li> <li>(K2) Merkmale guter Unit-Tests erklären</li> <li>(K3) Erstellen von Testfällen mittels Äquivalenzklassenbildung und Grenzwertanalyse</li></ul>
  </div>
</div>




    <h2 id="hands-on-10-minuten-wieviel-und-was-muss-man-testen">Hands-On (10 Minuten): Wieviel und was muss man testen?</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> credits <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">addToCredits</span>(<span style="color:#66d9ef">int</span> credits) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (credits <span style="color:#f92672">&lt;</span> 0) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException(<span style="color:#e6db74">&#34;Negative Credits!&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">+</span> credits <span style="color:#f92672">&gt;</span> 210) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException(<span style="color:#e6db74">&#34;Mehr als 210 Credits!&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">+=</span> credits;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="jede-methode-mindestens-testen-mitauf"><em>JEDE</em> Methode mindestens testen mit/auf:</h3>
<ul>
<li>Positive Tests: Gutfall (Normalfall) =&gt; &quot;gültige ÄK/GW&quot;</li>
<li>Negativ-Tests (Fehlbedienung, ungültige Werte) =&gt; &quot;ungültige ÄK/GW&quot;</li>
<li>Rand- bzw. Extremwerte =&gt; GW</li>
<li>Exceptions</li>
</ul>
<p>=&gt; Anforderungen abgedeckt (Black-Box)?</p>
<p>=&gt; Wichtige Pfade im Code abgedeckt (White-Box)?</p>
<h3 id="praxis">Praxis</h3>
<ul>
<li>Je kritischer eine Klasse/Methode/Artefakt ist, um so intensiver testen!</li>
<li>Suche nach Kompromissen: Testkosten vs. Kosten von Folgefehlern;
beispielsweise kein Test generierter Methoden</li>
</ul>
<p>=&gt; &quot;Erzeugen&quot; der Testfälle über die Äquivalenzklassenbildung und
Grenzwertanalyse (siehe nächste Folien). Mehr dann später im Wahlfach &quot;Softwarequalität&quot; ...</p>
<h2 id="äquivalenzklassenbildung">Äquivalenzklassenbildung</h2>
<p>Beispiel: Zu testende Methode mit Eingabewert <em>x</em>, der zw. 10 und 100 liegen soll</p>
<p><a href="#R-image-0e68ff46958f0d8f955bb4ef2e454806" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases/aequivalenzklassen.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-0e68ff46958f0d8f955bb4ef2e454806"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases/aequivalenzklassen.png?width=40%25&height=auto"></a></p>
<ul>
<li>
<p>Zerlegung der Definitionsbereiche in Äquivalenzklassen (ÄK):</p>
<ul>
<li>Disjunkte Teilmengen, wobei</li>
<li>Werte <em>einer</em> ÄK führen zu <em>gleichartigem</em> Verhalten</li>
</ul>
</li>
<li>
<p>Annahme: Eingabeparameter sind untereinander unabhängig</p>
</li>
<li>
<p>Unterscheidung gültige und ungültige ÄK</p>
</li>
</ul>
<h3 id="bemerkungen">Bemerkungen</h3>
<p>Hintergrund: Da die Werte einer ÄK zu gleichartigem Verhalten führen, ist es
egal, <em>welchen</em> Wert man aus einer ÄK für den Test nimmt.</p>
<p>Formal hat man <em>eine</em> ungültige ÄK (d.h. die Menge aller ungültigen Werte). In
der Programmierpraxis macht es aber einen Unterschied, ob es sich um Werte
unterhalb oder oberhalb des erlaubten Wertebereichs handelt (Fallunterscheidung).
Beispiel: Eine Funktion soll Werte zwischen 10 und 100 verarbeiten. Dann sind
alle Werte kleiner 10 oder größer 100 mathematisch gesehen in der selben ÄK
&quot;ungültig&quot;. Praktisch macht es aber Sinn, eine ungültige ÄK für &quot;kleiner 10&quot;
und eine weitere ungültige ÄK für &quot;größer 100&quot; zu betrachten ...</p>
<p>Traditionell betrachtet man nur die Eingabeparameter. Es kann aber Sinn machen,
auch die Ausgabeseite zu berücksichtigen (ist aber u.U. nur schwierig zu
realisieren).</p>
<h3 id="faustregeln-bei-der-bildung-von-äk">Faustregeln bei der Bildung von ÄK</h3>
<ul>
<li>
<p>Falls eine Beschränkung einen Wertebereich spezifiziert:
Aufteilung in eine gültige und zwei ungültige ÄK</p>
<p>Beispiel: Eingabewert <em>x</em> soll zw. 10 und 100 liegen</p>
<ul>
<li>Gültige ÄK: <span class="math align-center">$[10, 100]$</span></li>
<li>Ungültige ÄKs: <span class="math align-center">$x < 10$</span> und <span class="math align-center">$100 < x$</span></li>
</ul>
</li>
<li>
<p>Falls eine Beschränkung eine minimale und maximale Anzahl von Werten
spezifiziert:
Aufteilung in eine gültige und zwei ungültige ÄK</p>
<p>Beispiel: Jeder Studi muss pro Semester an mindestens einer LV teilnehmen,
maximal sind 5 LVs erlaubt.</p>
<ul>
<li>Gültige ÄK: <span class="math align-center">$1 \le x \le 5$</span></li>
<li>Ungültige ÄKs: <span class="math align-center">$x = 0$</span> (keine Teilnahme) und <span class="math align-center">$5 < x$</span> (mehr als 5 Kurse)</li>
</ul>
</li>
<li>
<p>Falls eine Beschränkung eine Menge von Werten spezifiziert, die
möglicherweise unterschiedlich behandelt werden:
Für jeden Wert dieser Menge eine eigene gültige ÄK erstellen und zusätzlich
insgesamt eine ungültige ÄK</p>
<p>Beispiel: Das Hotel am Urlaubsort ermöglicht verschiedene Freizeitaktivitäten:
Segway-fahren, Tauchen, Tennis, Golf</p>
<ul>
<li>Gültige ÄKs:
<ul>
<li>Segway-fahren</li>
<li>Tauchen</li>
<li>Tennis</li>
<li>Golf</li>
</ul>
</li>
<li>Ungültige ÄK: &quot;alles andere&quot;</li>
</ul>
</li>
<li>
<p>Falls eine Beschränkung eine Situation spezifiziert, die zwingend erfüllt sein muss:
Aufteilung in eine gültige und eine ungültige ÄK</p>
</li>
</ul>
<p><em>Hinweis</em>: Werden Werte einer ÄK vermutlich nicht gleichwertig behandelt, dann
erfolgt die Aufspaltung der ÄK in kleinere ÄKs. Das ist im Grunde die analoge
Überlegung zu mehreren ungültigen ÄKs.</p>
<p>ÄKs sollten für die weitere Arbeit einheitlich und eindeutig benannt werden.
Typisches Namensschema: &quot;gÄKn&quot; und &quot;uÄKn&quot; für gültige bzw. ungültige ÄKs mit
der laufenden Nummer <span class="math align-center">$n$</span>.</p>
<h2 id="äk-erstellung-der-testfälle">ÄK: Erstellung der Testfälle</h2>
<ul>
<li>
<p>Jede ÄK durch <em>mindestens</em> <strong>einen TF</strong> abdecken</p>
</li>
<li>
<p>Dabei pro Testfall</p>
<ul>
<li><em>mehrere gültige ÄKs</em> kombinieren, oder</li>
<li>genau <em>eine ungültige ÄK</em> untersuchen
(restl. Werte aus gültigen ÄK auffüllen; diese gelten dann aber
nicht als getestet!)</li>
</ul>
</li>
</ul>
<p>Im Prinzip muss man zur Erstellung der Testfälle (TF) eine paarweise vollständige Kombination über
die ÄK bilden, d.h. jede ÄK kommt mit jeder anderen ÄK in einem TF zur Ausführung.</p>
<p><em>Erinnerung</em>: Annahme: Eingabeparameter sind untereinander unabhängig! =&gt; Es reicht, wenn <em>jede</em>
gültige ÄK <em>einmal</em> in einem TF zur Ausführung kommt. =&gt; Kombination verschiedener gültiger ÄK
in <em>einem TF</em>.</p>
<p><strong>Achtung</strong>: Dies gilt nur für die <strong>gültigen</strong> ÄK! Bei den ungültigen ÄKs dürfen diese nicht
miteinander in einem TF kombiniert werden! Bei gleichzeitiger Behandlung verschiedener ungültiger
ÄK bleiben u.U. Fehler unentdeckt, da sich die Wirkungen der ungültigen ÄK überlagern!</p>
<p><strong>Für jeden Testfall (TF) wird aus den zu kombinierenden ÄK ein zufälliger Repräsentant ausgewählt.</strong></p>
<h2 id="äk-beispiel-eingabewert-x-soll-zw-10-und-100-liegen">ÄK: Beispiel: Eingabewert <em>x</em> soll zw. 10 und 100 liegen</h2>
<h3 id="äquivalenzklassen">Äquivalenzklassen</h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Eingabe</th>
          <th style="text-align: left">gültige ÄK</th>
          <th style="text-align: left">ungültige ÄK</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><em>x</em></td>
          <td style="text-align: left">gÄK1: <span class="math align-center">$[10, 100]$</span></td>
          <td style="text-align: left">uÄK2: <span class="math align-center">$x < 10$</span></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left">uÄK3: <span class="math align-center">$100 < x$</span></td>
      </tr>
  </tbody>
</table>
<h3 id="tests">Tests</h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Testnummer</th>
          <th style="text-align: left">1</th>
          <th style="text-align: left">2</th>
          <th style="text-align: left">3</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">geprüfte ÄK</td>
          <td style="text-align: left">gÄK1</td>
          <td style="text-align: left">uÄK2</td>
          <td style="text-align: left">uÄK3</td>
      </tr>
      <tr>
          <td style="text-align: left"><em>x</em></td>
          <td style="text-align: left">42</td>
          <td style="text-align: left">7</td>
          <td style="text-align: left">120</td>
      </tr>
      <tr>
          <td style="text-align: left">Erwartetes Ergebnis</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">Exception</td>
          <td style="text-align: left">Exception</td>
      </tr>
  </tbody>
</table>
<h2 id="grenzwertanalyse">Grenzwertanalyse</h2>
<p><a href="#R-image-85af308647770a191c710dbd425f71a7" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases/grenzwerte.png?width=40%25&height=auto" style=" height: auto; width: 40%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-85af308647770a191c710dbd425f71a7"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases/grenzwerte.png?width=40%25&height=auto"></a></p>
<p>Beobachtung: Grenzen in Verzweigungen/Schleifen kritisch</p>
<ul>
<li>Grenzen der ÄK (kleinste und größte Werte) <strong>zusätzlich</strong> testen
<ul>
<li>&quot;gültige Grenzwerte&quot; (<em>gGW</em>): Grenzwerte von gültigen ÄK</li>
<li>&quot;ungültige Grenzwerte&quot; (<em>uGW</em>): Grenzwerte von ungültigen ÄK</li>
</ul>
</li>
</ul>
<p>Zusätzlich sinnvoll: Weitere grenznahe Werte, d.h. weitere Werte &quot;rechts&quot; und &quot;links&quot;
der Grenze nutzen.</p>
<p>Bildung der Testfälle:</p>
<ul>
<li>Jeder GW muss in mind. einem TF vorkommen</li>
</ul>
<p><strong>Pro TF darf ein GW (gültig oder ungültig) verwendet werden, die restlichen Parameter
werden (mit zufälligen Werten) aus gültigen ÄK aufgefüllt, um mögliche Grenzwertprobleme
nicht zu überlagern.</strong></p>
<h2 id="gw-beispiel-eingabewert-x-soll-zw-10-und-100-liegen">GW: Beispiel: Eingabewert <em>x</em> soll zw. 10 und 100 liegen</h2>
<h3 id="äquivalenzklassen-1">Äquivalenzklassen</h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Eingabe</th>
          <th style="text-align: left">gültige ÄK</th>
          <th style="text-align: left">ungültige ÄK</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><em>x</em></td>
          <td style="text-align: left">gÄK1: <span class="math align-center">$[10, 100]$</span></td>
          <td style="text-align: left">uÄK2: <span class="math align-center">$x < 10$</span></td>
      </tr>
      <tr>
          <td style="text-align: left"></td>
          <td style="text-align: left"></td>
          <td style="text-align: left">uÄK3: <span class="math align-center">$100 < x$</span></td>
      </tr>
  </tbody>
</table>
<h3 id="grenzwertanalyse-1">Grenzwertanalyse</h3>
<p>Zusätzliche Testdaten: 9 (uÄK2o) und 10 (gÄK1u) sowie 100 (gÄK1o) und 101 (uÄK3u)</p>
<h3 id="tests-1">Tests</h3>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Testnummer</th>
          <th style="text-align: left">4</th>
          <th style="text-align: left">5</th>
          <th style="text-align: left">6</th>
          <th style="text-align: left">7</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">geprüfter GW</td>
          <td style="text-align: left">gÄK1u</td>
          <td style="text-align: left">gÄK1o</td>
          <td style="text-align: left">uÄK2o</td>
          <td style="text-align: left">uÄK3u</td>
      </tr>
      <tr>
          <td style="text-align: left"><em>x</em></td>
          <td style="text-align: left">10</td>
          <td style="text-align: left">100</td>
          <td style="text-align: left">9</td>
          <td style="text-align: left">101</td>
      </tr>
      <tr>
          <td style="text-align: left">Erwartetes Ergebnis</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">Exception</td>
          <td style="text-align: left">Exception</td>
      </tr>
  </tbody>
</table>
<p><strong>Hinweis</strong>: Die Ergebnisse der GW-Analyse werden <strong>zusätzlich</strong> zu den Werten aus der ÄK-Analyse
eingesetzt. Für das obige Beispiel würde man also folgende Tests aus der kombinierten ÄK- und
GW-Analyse erhalten:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Testnummer</th>
          <th style="text-align: left">1</th>
          <th style="text-align: left">2</th>
          <th style="text-align: left">3</th>
          <th style="text-align: left">4</th>
          <th style="text-align: left">5</th>
          <th style="text-align: left">6</th>
          <th style="text-align: left">7</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">geprüfte(r) ÄK/GW</td>
          <td style="text-align: left">gÄK1</td>
          <td style="text-align: left">uÄK2</td>
          <td style="text-align: left">uÄK3</td>
          <td style="text-align: left">gÄK1u</td>
          <td style="text-align: left">gÄK1o</td>
          <td style="text-align: left">uÄK2o</td>
          <td style="text-align: left">uÄK3u</td>
      </tr>
      <tr>
          <td style="text-align: left"><em>x</em></td>
          <td style="text-align: left">42</td>
          <td style="text-align: left">7</td>
          <td style="text-align: left">120</td>
          <td style="text-align: left">10</td>
          <td style="text-align: left">100</td>
          <td style="text-align: left">9</td>
          <td style="text-align: left">101</td>
      </tr>
      <tr>
          <td style="text-align: left">Erwartetes Ergebnis</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">Exception</td>
          <td style="text-align: left">Exception</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">OK</td>
          <td style="text-align: left">Exception</td>
          <td style="text-align: left">Exception</td>
      </tr>
  </tbody>
</table>
<h2 id="anmerkung-analyse-abhängiger-parameter">Anmerkung: Analyse abhängiger Parameter</h2>
<p>Wenn das Ergebnis von der Kombination der Eingabewerte abhängt, dann
sollte man dies bei der Äquivalenzklassenbildung berücksichtigen: Die
ÄK sind in diesem Fall in Bezug auf die Kombinationen zu bilden!</p>
<p>Schauen Sie sich dazu das Beispiel im <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases.html#id_Kleuker2019">[Kleuker2019]</a>, Abschnitt
&quot;4.3 Analyse abhängiger Parameter&quot; an.</p>
<p>Die einfache ÄK-Bildung würde in diesem Fall versagen, da die Eingabewerte
nicht unabhängig sind. Leider ist die Betrachtung der möglichen Kombinationen
u.U. eine sehr komplexe Aufgabe ...</p>
<p>Analoge Überlegungen gelten auch für die ÄK-Bildung im Zusammenhang mit
objektorientierter Programmierung. Die Eingabewerte und der Objektzustand
müssen dann <em>gemeinsam</em> bei der ÄK-Bildung betrachtet werden!</p>
<p>Vergleiche <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/testing/testcases.html#id_Kleuker2019">[Kleuker2019]</a>, Abschnitt &quot;4.4 Äquivalenzklassen und Objektorientierung&quot;.</p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>Gründliches Testen ist ebenso viel Aufwand wie Coden</li>
<li>Äquivalenzklassenbildung und Grenzwertanalyse</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106546&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Testfallermittlung (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>ÄK/GW: RSV Flotte Speiche</strong></p>
<p>Der RSV Flotte Speiche hat in seiner Mitgliederverwaltung (<code>MitgliederVerwaltung</code>) die Methode
<code>testBeitritt</code> implementiert. Mit dieser Methode wird geprüft, ob neue Mitglieder in den Radsportverein
aufgenommen werden können.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MitgliederVerwaltung</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/**
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * Testet, ob ein Mitglied in den Verein aufgenommen werden kann.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * &lt;p&gt;Interessierte Personen müssen mindestens 16 Jahre alt sein, um aufgenommen
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * werden zu können. Die Motivation darf nicht zu niedrig und auch nicht zu hoch
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * sein und muss zwischen 4 und 7 (inklusive) liegen, sonst wird der Antrag
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * abgelehnt.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * &lt;p&gt;Der Wertebereich beim Alter umfasst die natürlichen Zahlen zwischen 0 und 99
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * (inklusive), bei der Motivation sind die natürlichen Zahlen zwischen 0 und 10
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * (inklusive) erlaubt.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * &lt;p&gt;Bei Verletzung der zulässigen Wertebereiche der Parameter wird eine
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * &lt;code&gt;IllegalArgumentException&lt;/code&gt; geworfen.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * @param alter       Alter in Lebensjahren, Bereich [0, 99]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * @param motivation  Motivation auf einer Scala von 0 bis 10
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * @return &lt;code&gt;true&lt;/code&gt;, wenn das Mitglied aufgenommen werden kann,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *         sonst &lt;code&gt;false&lt;/code&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     * @throws &lt;code&gt;IllegalArgumentException&lt;/code&gt;, wenn Parameter außerhalb
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     *                                                der zulässigen Wertebereiche
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">testBeitritt</span>(<span style="color:#66d9ef">int</span> alter, <span style="color:#66d9ef">int</span> motivation) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Implementierung versteckt</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ol>
<li>
<p>Führen Sie eine Äquivalenzklassenbildung durch und geben Sie die gefundenen Äquivalenzklassen (<em>ÄK</em>)
an: laufende Nummer, Definition (Wertebereiche o.ä.), kurze Beschreibung (gültige/ungültige ÄK,
Bedeutung).</p>
</li>
<li>
<p>Führen Sie zusätzlich eine Grenzwertanalyse durch und geben Sie die jeweiligen Grenzwerte (<em>GW</em>) an.</p>
</li>
<li>
<p>Erstellen Sie aus den ÄK und GW wie in der Vorlesung diskutiert Testfälle. Geben Sie pro Testfall (<em>TF</em>)
an, welche ÄK und/oder GW abgedeckt sind, welche Eingaben Sie vorsehen und welche Ausgabe Sie erwarten.</p>
<p><em>Hinweis</em>: Erstellen Sie separate (zusätzliche) TF für die GW, d.h. integrieren Sie diese <em>nicht</em> in die
ÄK-TF.</p>
</li>
<li>
<p>Implementieren Sie die Testfälle in JUnit (JUnit 4 oder 5).</p>
<ul>
<li>Fassen Sie die Testfälle der gültigen ÄK in einem parametrisierten Test zusammen.</li>
<li>Für die ungültigen ÄKs erstellen Sie jeweils eine eigene JUnit-Testmethode. Beachten
Sie, dass Sie auch die Exceptions testen müssen.</li>
</ul>
</li>
</ol>
<p><strong>ÄK/GW: LSF</strong></p>
<p>Das LSF bestimmt mit der Methode <code>LSF#checkStudentCPS</code>, ob ein Studierender bereits zur
Bachelorarbeit oder Praxisphase zugelassen werden kann:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSF</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Status <span style="color:#a6e22e">checkStudentCPS</span>(Student student) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (student.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&gt;=</span> Status.<span style="color:#a6e22e">BACHELOR</span>.<span style="color:#a6e22e">credits</span>) <span style="color:#66d9ef">return</span> Status.<span style="color:#a6e22e">BACHELOR</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (student.<span style="color:#a6e22e">credits</span>() <span style="color:#f92672">&gt;=</span> Status.<span style="color:#a6e22e">PRAXIS</span>.<span style="color:#a6e22e">credits</span>) <span style="color:#66d9ef">return</span> Status.<span style="color:#a6e22e">PRAXIS</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">return</span> Status.<span style="color:#a6e22e">NONE</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">record</span> <span style="color:#a6e22e">Student</span>(String name, <span style="color:#66d9ef">int</span> credits, <span style="color:#66d9ef">int</span> semester) { }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">enum</span> Status {
</span></span><span style="display:flex;"><span>    NONE(0), PRAXIS(110), BACHELOR(190);  <span style="color:#75715e">// min: 0, max: 210</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> credits;
</span></span><span style="display:flex;"><span>    Status(<span style="color:#66d9ef">int</span> credits) { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">credits</span> <span style="color:#f92672">=</span> credits; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ol>
<li>Führen Sie eine Äquivalenzklassenbildung für die Methode <code>LSF#checkStudentCPS</code> durch.</li>
<li>Führen Sie zusätzlich eine Grenzwertanalyse für die Methode <code>LSF#checkStudentCPS</code> durch.</li>
<li>Erstellen Sie aus den ÄK und GW wie in der Vorlesung diskutiert Testfälle.</li>
<li>Implementieren Sie die Testfälle in JUnit (JUnit 4 oder 5).
<ul>
<li>Fassen Sie die Testfälle der gültigen ÄK in einem parametrisierten Test zusammen.</li>
<li>Für die ungültigen ÄKs erstellen Sie jeweils eine eigene JUnit-Testmethode. Beachten
Sie, dass Sie auch die Exceptions testen müssen.</li>
</ul>
</li>
</ol>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
                    
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_fernunihagenJunit'>[fernunihagenJunit] <a href='https://wiki.fernuni-hagen.de/eclipse/index.php/Einführung_in_JUnit' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Einführung in JUnit</strong></a><br>Thies, A. und Noelke, C. und Ungerc, Fernuniversität in Hagen.</li> <li id='id_junit4'>[junit4] <a href='https://junit.org/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5</strong></a><br>The JUnit Team, 2022.</li> <li id='id_Kleuker2019'>[Kleuker2019] <strong>Qualitätssicherung durch Softwaretests</strong><br>Kleuker, S., Springer Vieweg, 2019. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-658-24886-4</a>. DOI <a href='https://doi.org/10.1007/978-3-658-24886-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>10.1007/978-3-658-24886-4</a>.</li> <li id='id_Osherove2014'>[Osherove2014] <strong>The Art of Unit Testing</strong><br>Osherove, R., Manning, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9089-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9089-3</a>.</li> <li id='id_Spillner2012'>[Spillner2012] <strong>Basiswissen Softwaretest</strong><br>Spillner, A. und Linz, T., dpunkt, 2012. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-86490-024-2' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-86490-024-2</a>.</li> <li id='id_vogellaJUnit'>[vogellaJUnit] <a href='https://www.vogella.com/tutorials/JUnit/article.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>JUnit 5 tutorial - Learn how to write unit tests</strong></a><br>vogella GmbH, 2021.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Mocking mit Mockito</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Häufig hat man es in Softwaretests mit dem Problem zu tun, dass die zu testenden Klassen von
anderen, noch nicht implementierten Klassen oder von zufälligen oder langsamen Operationen
abhängen.</p>
<p>In solchen Situationen kann man auf &quot;Platzhalter&quot; für diese Abhängigkeiten zurückgreifen. Dies
können einfache Stubs sein, also Objekte, die einfach einen festen Wert bei einem Methodenaufruf
zurückliefern oder Mocks, wo man auf die Argumente eines Methodenaufrufs reagieren kann und
passende unterschiedliche Rückgabewerte zurückgeben kann.</p>
<p>Mockito ist eine Java-Bibliothek, die zusammen mit JUnit das Mocking von Klassen in Java
erlaubt. Man kann hier zusätzlich auch die Interaktion mit dem gemockten Objekt überprüfen und
testen, ob eine bestimmte Methode mit bestimmten Argumenten aufgerufen wurde und wie oft.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/8deFZKtjXSk' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Mocking</a></li> <li><a href='https://youtu.be/WNEedC7PrVQ' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Stubs</a></li> <li><a href='https://youtu.be/avUyYVePFCI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Mocks</a></li> <li><a href='https://youtu.be/dj3pmOZfS_A' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Spy</a></li> <li><a href='https://youtu.be/CPGqhyC8BjU' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: verify()</a></li> <li><a href='https://youtu.be/JNouzOd0s-w' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mocking: Matcher</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/9531e04dd11458ea45915269aca452ba6b9978ef7b1b3a777a424d673573f75724a3fbedd0a2bec5e4d14de4025ea92ae4a966f95ee312e9f6ecca4fde4c98ef' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Mocking</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Begriffe: Mocking, Mock, Stub, Spy</li> <li>(K3) Erzeugen eines Mocks in Mockito</li> <li>(K3) Erzeugen eines Spies in Mockito</li> <li>(K3) Prüfen von Interaktion mit <em>verify()</em></li> <li>(K3) Einsatz von <em>ArgumentMatcher</em></li></ul>
  </div>
</div>




    <h2 id="motivation-entwicklung-einer-studi-prüfungsverwaltung">Motivation: Entwicklung einer Studi-/Prüfungsverwaltung</h2>
<h3 id="szenario">Szenario</h3>
<p>Zwei Teams entwickeln eine neue Studi-/Prüfungsverwaltung für die Hochschule. Ein Team modelliert dabei
die Studierenden, ein anderes Team modelliert die Prüfungsverwaltung LSF.</p>
<ul>
<li>
<p>Team A:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    String name;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Studi</span>(String name, LSF lsf) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> name;  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">lsf</span> <span style="color:#f92672">=</span> lsf;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">anmelden</span>(String modul) { <span style="color:#66d9ef">return</span> lsf.<span style="color:#a6e22e">anmelden</span>(name, modul); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">einsicht</span>(String modul) { <span style="color:#66d9ef">return</span> lsf.<span style="color:#a6e22e">ergebnis</span>(name, modul) <span style="color:#f92672">&gt;</span> 50; }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
<li>
<p>Team B:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LSF</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">anmelden</span>(String name, String modul) { <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> UnsupportedOperationException(); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">ergebnis</span>(String name, String modul) { <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> UnsupportedOperationException(); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
</ul>
<p>Team B kommt nicht so recht vorwärts, Team A ist fertig und will schon testen.</p>
<p>Wie kann Team A seinen Code testen?</p>
<p><strong>Optionen</strong>:</p>
<ul>
<li>Gar nicht testen?!</li>
<li>Das LSF selbst implementieren? Wer pflegt das dann? =&gt; manuell implementierte Stubs</li>
<li>Das LSF durch einen Mock ersetzen =&gt; Einsatz der Bibliothek &quot;mockito&quot;</li>
</ul>
<h3 id="motivation-mocking-und-mockito">Motivation Mocking und Mockito</h3>
<p><a href="https://github.com/mockito/mockito" rel="external" target="_blank">Mockito</a> ist ein Mocking-Framework für JUnit. Es
simuliert das Verhalten eines realen Objektes oder einer realen Methode.</p>
<p>Wofür brauchen wir denn jetzt so ein Mocking-Framework überhaupt?</p>
<p>Wir wollen die Funktionalität einer Klasse isoliert vom Rest testen können.
Dabei stören uns aber bisher so ein paar Dinge:</p>
<ul>
<li>Arbeiten mit den echten Objekten ist langsam (zum Beispiel aufgrund von
Datenbankenzugriffen)</li>
<li>Objekte beinhalten oft komplexe Abhängigkeiten, die in Tests schwer abzudecken
sind</li>
<li>Manchmal existiert der zu testende Teil einer Applikation auch noch gar nicht,
sondern es gibt nur die Interfaces.</li>
<li>Oder es gibt unschöne Seiteneffekte beim Arbeiten mit den realen Objekten. Zum
Beispiel könnte es sein, das immer eine E-Mail versendet wird, wenn wir mit
einem Objekt interagieren.</li>
</ul>
<p>In solchen Situationen wollen wir eine Möglichkeit haben, das Verhalten eines
realen Objektes bzw. der Methoden zu simulieren, ohne dabei die originalen
Methoden aufrufen zu müssen. (Manchmal möchte man das dennoch, aber dazu später
mehr...)</p>
<p>Und genau hier kommt Mockito ins Spiel. Mockito hilft uns dabei, uns von den
externen Abhängigkeiten zu lösen, indem es sogenannte Mocks, Stubs oder Spies
anbietet, mit denen sich das Verhalten der realen Objekte simulieren/überwachen
und testen lässt.</p>
<h3 id="aber-was-genau-ist-denn-jetzt-eigentlich-mocking">Aber was genau ist denn jetzt eigentlich Mocking?</h3>
<p>Ein Mock-Objekt (&quot;etwas vortäuschen&quot;) ist im Software-Test ein Objekt, das als Platzhalter
(Attrappe) für das echte Objekt verwendet wird.</p>
<p>Mocks sind in JUnit-Tests immer dann nützlich, wenn man externe Abhängigkeiten
hat, auf die der eigene Code zugreift. Das können zum Beispiel externe APIs sein
oder Datenbanken etc. ... Mocks helfen einem beim Testen nun dabei, sich von diesen
externen Abhängigkeiten zu lösen und seine Softwarefunktionalität dennoch
schnell und effizient testen zu können ohne evtl. auftretende Verbindungsfehler
oder andere mögliche Seiteneffekte der externen Abhängigkeiten auszulösen.</p>
<p>Dabei simulieren Mocks die Funktionalität der externen APIs oder Datenbankzugriffe.
Auf diese Weise ist es möglich Softwaretests zu schreiben, die scheinbar die gleichen
Methoden aufrufen, die sie auch im regulären Softwarebetrieb nutzen würden, allerdings
werden diese wie oben erwähnt allerdings für die Tests nur simuliert.</p>
<p>Mocking ist also eine Technik, die in Softwaretests verwendet wird, in denen die
gemockten Objekte anstatt der realen Objekte zu Testzwecken genutzt werden. Die
gemockten Objekte liefern dabei bei einem vom Programmierer bestimmten (Dummy-) Input,
einen dazu passenden gelieferten (Dummy-) Output, der durch seine vorhersagbare
Funktionalität dann in den eigentlichen Testobjekten gut für den Test nutzbar ist.</p>
<p>Dabei ist es von Vorteil die drei Grundbegriffe &quot;Mock&quot;, &quot;Stub&quot; oder &quot;Spy&quot;, auf die wir
in der Vorlesung noch häufiger treffen werden, voneinander abgrenzen und
unterscheiden zu können.</p>
<h3 id="dabei-bezeichnet-ein">Dabei bezeichnet ein</h3>
<ul>
<li><strong>Stub</strong>: Ein Stub ist ein Objekt, dessen Methoden nur mit einer minimalen Logik
für den Test implementiert wurden. Häufig werden dabei einfach feste (konstante)
Werte zurückgeliefert, d.h. beim Aufruf einer Methode wird unabhängig von der konkreten
Eingabe immer die selbe Ausgabe zurückgeliefert.</li>
<li><strong>Mock</strong>: Ein Mock ist ein Objekt, welches im Gegensatz zum Stub bei vorher definierten
Funktionsaufrufen mit vorher definierten Argumente eine definierte Rückgabe liefert.</li>
<li><strong>Spy</strong>: Ein Spy ist ein Objekt, welches Aufrufe und übergebene Werte protokolliert und
abfragbar macht. Es ist also eine Art Wrapper um einen Stub oder einen Mock.</li>
</ul>
<h3 id="mockito-setup">Mockito Setup</h3>
<ul>
<li>
<p>Gradle: <code>build.gradle</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-groovy" data-lang="groovy"><span style="display:flex;"><span>dependencies <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    implementation <span style="color:#e6db74">&#39;junit:junit:4.13.2&#39;</span>
</span></span><span style="display:flex;"><span>    implementation <span style="color:#e6db74">&#39;org.mockito:mockito-core:4.5.1&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span></span></span></code></pre></div>
</li>
<li>
<p>Maven: <code>pom.xml</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#f92672">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;groupId&gt;</span>junit<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;artifactId&gt;</span>junit<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;version&gt;</span>4.13.2<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;groupId&gt;</span>org.mockito<span style="color:#f92672">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;artifactId&gt;</span>mockito-core<span style="color:#f92672">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">&lt;version&gt;</span>4.5.1<span style="color:#f92672">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">&lt;/dependencies&gt;</span></span></span></code></pre></div>
</li>
</ul>
<h2 id="manuell-stubs-implementieren">Manuell Stubs implementieren</h2>
<p>Team A könnte manuell das LSF rudimentär implementieren (nur für die Tests, einfach mit
festen Rückgabewerten): <strong>Stubs</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StudiStubTest</span> {
</span></span><span style="display:flex;"><span>    Studi studi;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() { lsf <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> LsfStub();  studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() { assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)); }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsicht</span>() { assertTrue(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Stub für das noch nicht fertige LSF</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LsfStub</span> <span style="color:#66d9ef">extends</span> LSF {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">anmelden</span>(String name, String modul) { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>; }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">ergebnis</span>(String name, String modul) { <span style="color:#66d9ef">return</span> 80; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><strong>Problem</strong>: Wartung der Tests (wenn das richtige LSF fertig ist) und Wartung der Stubs (wenn sich die Schnittstelle
des LSF ändert, muss auch der Stub nachgezogen werden).</p>
<p><strong>Problem</strong>: Der Stub hat nur eine Art minimale Default-Logik (sonst könnte man ja das LSF gleich selbst implementieren).
Wenn man im Test andere Antworten braucht, müsste man einen weiteren Stub anlegen ...</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/StudiStubTest.java" target="_blank"><span class="title">Demo hsbi.StudiStubTest</span></a></span></div>
<h2 id="mockito-mocking-von-ganzen-klassen">Mockito: Mocking von ganzen Klassen</h2>
<p><strong>Lösung</strong>: Mocking der Klasse <code>LSF</code> mit Mockito für den Test von <code>Studi</code>: <code>mock()</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StudiMockTest</span> {
</span></span><span style="display:flex;"><span>    Studi studi;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() { lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);  studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() {
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(anyString(), anyString())).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtI</span>() {
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(80);
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtII</span>() {
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(40);
</span></span><span style="display:flex;"><span>        assertFalse(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Der Aufruf <code>mock(LSF.class)</code> erzeugt einen Mock der Klasse (oder des Interfaces) <code>LSF</code>. Dabei wird ein Objekt
vom Typ <code>LSF</code> erzeugt, mit dem man dann wie mit einem normalen Objekt weiter arbeiten kann. Die Methoden sind
allerdings nicht implementiert ...</p>
<p>Mit Hilfe von <code>when().thenReturn()</code> kann man definieren, was genau beim Aufruf einer bestimmten Methode auf dem
Mock passieren soll, d.h. welcher Rückgabewert entsprechend zurückgegeben werden soll. Hier kann man dann für
bestimmte Argumentwerte andere Rückgabewerte definieren. <code>when(lsf.ergebnis(&quot;Harald&quot;, &quot;PM-Dungeon&quot;)).thenReturn(80)</code>
gibt also für den Aufruf von <code>ergebnis</code> mit den Argumenten <code>&quot;Harald&quot;</code> und <code>&quot;PM-Dungeon&quot;</code> auf dem Mock <code>lsf</code>
den Wert 80 zurück.</p>
<p>Dies kann man in weiten Grenzen flexibel anpassen.</p>
<p>Mit Hilfe der Argument-Matcher <code>anyString()</code> wird jedes String-Argument akzeptiert.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/StudiMockTest.java" target="_blank"><span class="title">Demo hsbi.StudiMockTest</span></a></span></div>
<h2 id="mockito-spy--wrapper-um-ein-objekt">Mockito: Spy = Wrapper um ein Objekt</h2>
<p>Team B hat das <code>LSF</code> nun implementiert und Team A kann es endlich für die Tests benutzen. Aber
das <code>LSF</code> hat eine Zufallskomponente (<code>ergebnis()</code>). Wie kann man nun die Reaktion des Studis
testen (<code>einsicht()</code>)?</p>
<p><strong>Lösung</strong>: Mockito-Spy als partieller Mock einer Klasse (Wrapper um ein Objekt): <code>spy()</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StudiSpyTest</span> {
</span></span><span style="display:flex;"><span>    Studi studi;  LSF lsf;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Before</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setUp</span>() { lsf <span style="color:#f92672">=</span> spy(LSF.<span style="color:#a6e22e">class</span>);  studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() { assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtI</span>() {
</span></span><span style="display:flex;"><span>        doReturn(80).<span style="color:#a6e22e">when</span>(lsf).<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testEinsichtII</span>() {
</span></span><span style="display:flex;"><span>        doReturn(40).<span style="color:#a6e22e">when</span>(lsf).<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        assertFalse(studi.<span style="color:#a6e22e">einsicht</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Der Aufruf <code>spy(LSF.class)</code> erzeugt einen Spy um ein Objekt der Klasse <code>LSF</code>. Dabei bleiben zunächst die Methoden
in <code>LSF</code> erhalten und können aufgerufen werden, sie können aber auch mit einem (partiellen) Mock überlagert werden.
Der Spy zeichnet wie der Mock die Interaktion mit dem Objekt auf.</p>
<p>Mit Hilfe von <code>doReturn().when()</code> kann man definieren, was genau beim Aufruf einer bestimmten Methode auf dem
Spy passieren soll, d.h. welcher Rückgabewert entsprechend zurückgegeben werden soll. Hier kann man analog zum Mock
für bestimmte Argumentwerte andere Rückgabewerte definieren. <code>doReturn(40).when(lsf).ergebnis(&quot;Harald&quot;, &quot;PM-Dungeon&quot;)</code>
gibt also für den Aufruf von <code>ergebnis</code> mit den Argumenten <code>&quot;Harald&quot;</code> und <code>&quot;PM-Dungeon&quot;</code> auf dem Spy <code>lsf</code> den Wert
40 zurück.</p>
<p>Wenn man die Methoden nicht mit einem partiellen Mock überschreibt, dann wird einfach die originale Methode aufgerufen
(Beispiel: In <code>studi.anmelden(&quot;PM-Dungeon&quot;)</code> wird <code>lsf.anmelden(&quot;Harald&quot;, &quot;PM-Dungeon&quot;)</code> aufgerufen.).</p>
<p>Auch hier können Argument-Matcher wie <code>anyString()</code> eingesetzt werden.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/StudiSpyTest.java" target="_blank"><span class="title">Demo hsbi.StudiSpyTest</span></a></span></div>
<h2 id="wurde-eine-methode-aufgerufen">Wurde eine Methode aufgerufen?</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">VerifyTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() {
</span></span><span style="display:flex;"><span>        LSF lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);  Studi studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, atLeast(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        verify(lsf, atMost(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, never()).<span style="color:#a6e22e">ergebnis</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verifyNoMoreInteractions(lsf);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Mit der Methode <code>verify()</code> kann auf einem Mock oder Spy überprüft werden, ob und wie oft und in welcher Reihenfolge
Methoden aufgerufen wurden und mit welchen Argumenten. Auch hier lassen sich wieder Argument-Matcher wie <code>anyString()</code>
einsetzen.</p>
<p>Ein einfaches <code>verify(mock)</code> prüft dabei, ob die entsprechende Methode exakt einmal vorher aufgerufen wurde. Dies
ist äquivalent zu <code>verify(mock, times(1))</code>. Analog kann man mit den Parametern <code>atLeast()</code> oder <code>atMost</code> bestimmte
Unter- oder Obergrenzen für die Aufrufe angeben und mit <code>never()</code> prüfen, ob es gar keinen Aufruf vorher gab.</p>
<p><code>verifyNoMoreInteractions(lsf)</code> ist interessant: Es ist genau dann <code>true</code>, wenn es außer den vorher abgefragten
Interaktionen keinerlei sonstigen Interaktionen mit dem Mock oder Spy gab.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>LSF lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>Studi studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>when(lsf.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>InOrder inOrder <span style="color:#f92672">=</span> inOrder(lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>inOrder.<span style="color:#a6e22e">verify</span>(lsf).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;Wuppie&#34;</span>);
</span></span><span style="display:flex;"><span>inOrder.<span style="color:#a6e22e">verify</span>(lsf).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);</span></span></code></pre></div>
<p>Mit <code>InOrder</code> lassen sich Aufrufe auf einem Mock/Spy oder auch auf verschiedenen Mocks/Spies in eine zeitliche
Reihenfolge bringen und so überprüfen.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/VerifyTest.java" target="_blank"><span class="title">Demo hsbi.VerifyTest</span></a></span></div>
<h2 id="fangen-von-argumenten">Fangen von Argumenten</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MatcherTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testAnmelden</span>() {
</span></span><span style="display:flex;"><span>        LSF lsf <span style="color:#f92672">=</span> mock(LSF.<span style="color:#a6e22e">class</span>);  Studi studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Harald&#34;</span>, lsf);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(anyString(), anyString())).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>        when(lsf.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>)).<span style="color:#a6e22e">thenReturn</span>(<span style="color:#66d9ef">true</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        assertTrue(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>));
</span></span><span style="display:flex;"><span>        assertFalse(studi.<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Wuppie?&#34;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;PM-Dungeon&#34;</span>);
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>, <span style="color:#e6db74">&#34;Wuppie?&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        verify(lsf, times(2)).<span style="color:#a6e22e">anmelden</span>(anyString(), anyString());
</span></span><span style="display:flex;"><span>        verify(lsf, times(1)).<span style="color:#a6e22e">anmelden</span>(eq(<span style="color:#e6db74">&#34;Harald&#34;</span>), eq(<span style="color:#e6db74">&#34;Wuppie?&#34;</span>));
</span></span><span style="display:flex;"><span>        verify(lsf, times(2)).<span style="color:#a6e22e">anmelden</span>(argThat(<span style="color:#66d9ef">new</span> MyHaraldMatcher()), anyString());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyHaraldMatcher</span> <span style="color:#66d9ef">implements</span> ArgumentMatcher<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span>(String s) { <span style="color:#66d9ef">return</span> s.<span style="color:#a6e22e">equals</span>(<span style="color:#e6db74">&#34;Harald&#34;</span>); }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Sie können die konkreten Argumente angeben, für die der Aufruf gelten soll. Alternativ
können Sie mit vordefinierten <code>ArgumentMatchers</code> wie <code>anyString()</code> beispielsweise auf
beliebige Strings reagieren oder selbst einen eigenen <code>ArgumentMatcher&lt;T&gt;</code> für Ihren
Typ <code>T</code> erstellen und nutzen.</p>
<p><strong>Wichtig</strong>: Wenn Sie für einen Parameter einen <code>ArgumentMatcher</code> einsetzen, müssen Sie
für die restlichen Parameter der Methode dies ebenfalls tun. Sie können keine konkreten
Argumente mit <code>ArgumentMatcher</code> mischen.</p>
<p>Sie finden viele weitere vordefinierte Matcher in der Klasse <code>ArgumentMatchers</code>.
Mit der Klasse <code>ArgumentCaptor&lt;T&gt;</code> finden Sie eine alternative Möglichkeit, auf
Argumente in gemockten Methoden zu reagieren. Schauen Sie sich dazu die Javadoc
von <a href="https://javadoc.io/doc/org.mockito/mockito-core/" rel="external" target="_blank">Mockito</a> an.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/testing/src/mockito/src/test/java/hsbi/MatcherTest.java" target="_blank"><span class="title">Demo hsbi.MatcherTest</span></a></span></div>
<h2 id="ausblick-powermock">Ausblick: PowerMock</h2>
<p>Mockito sehr mächtig, aber unterstützt (u.a.) keine</p>
<ul>
<li>Konstruktoren</li>
<li>private Methoden</li>
<li>final Methoden</li>
<li>static Methoden
(ab Version 3.4.0 scheint auch <a href="https://www.baeldung.com/mockito-mock-static-methods" rel="external" target="_blank">Mockito statische Methoden</a> zu unterstützen)</li>
</ul>
<p>=&gt; Lösung: <a href="https://github.com/powermock/powermock" rel="external" target="_blank">PowerMock</a></p>
<h2 id="ausführlicheres-beispiel-wuppiwarenlager">Ausführlicheres Beispiel: WuppiWarenlager</h2>
<p><strong>Credits</strong>: Der Dank für die Erstellung des nachfolgenden Beispiels und Textes geht an
<a href="https://github.com/jedi101" rel="external" target="_blank">@jedi101</a>.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/stub/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.stub)</span></a></span></div>
<p>Bei dem gezeigten Beispiel unseres <code>WuppiStores</code> sieht man, dass dieser
normalerweise von einem fertigen Warenlager die Wuppis beziehen möchte. Da
dieses Lager aber noch nicht existiert, haben wir uns kurzerhand einfach einen
Stub von unserem <code>IWuppiWarenlager</code>-Interface erstellt, in dem wir zu
Testzwecken händisch ein Paar Wuppis ins Lager geräumt haben.</p>
<p>Das funktioniert in diesem Mini-Testbeispiel ganz gut aber, wenn unsere Stores
erst einmal so richtig Fahrt aufnehmen und wir irgendwann weltweit Wuppis
verkaufen, wird der Code des <code>IWuppiWarenlagers</code> wahrscheinlich sehr schnell viel
komplexer werden, was unweigerlich dann zu Maintenance-Problemen unserer
händisch angelegten Tests führt. Wenn wir zum Beispiel einmal eine Methode
hinzufügen wollen, die es uns ermöglicht, nicht immer alle Wuppis aus dem Lager
zu ordern oder vielleicht noch andere Methoden, die Fluppis orderbar machen,
hinzufügen, müssen wir immer dafür sorgen, dass wir die getätigten Änderungen
händisch in den Stub des Warenlagers einpflegen.</p>
<p>Das will eigentlich niemand...</p>
<h3 id="einsatz-von-mockito">Einsatz von Mockito</h3>
<p>Aber es gibt da einen Ausweg. Wenn es komplexer wird, verwenden wir Mocks.</p>
<p>Bislang haben wir noch keinen Gebrauch von Mockito gemacht. Das ändern wir nun.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/mock/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.mock)</span></a></span></div>
<p>Wie in diesem Beispiel gezeigt, müssen wir nun keinen Stub mehr von Hand
erstellen, sondern überlassen dies Mockito.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>IWuppiWarenlager lager <span style="color:#f92672">=</span> mock(IWuppiWarenlager.<span style="color:#a6e22e">class</span>);</span></span></code></pre></div>
<p>Anschließend können wir, ohne die Methode <code>getAllWuppis()</code> implementiert zu haben,
dennoch so tun als, ob die Methode eine Funktionalität hätte.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Erstellen eines imaginären Lagerbestands.</span>
</span></span><span style="display:flex;"><span>List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> wuppisImLager <span style="color:#f92672">=</span> Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#e6db74">&#34;GruenerWuppi&#34;</span>,<span style="color:#e6db74">&#34;RoterWuppi&#34;</span>);
</span></span><span style="display:flex;"><span>when(lager.<span style="color:#a6e22e">getAlleWuppis</span>()).<span style="color:#a6e22e">thenReturn</span>(wuppisImLager);</span></span></code></pre></div>
<p>Wann immer nun die Methode <code>getAlleWuppis()</code> des gemockten Lagers aufgerufen
wird, wird dieser Aufruf von Mockito abgefangen und wie oben definiert
verändert. Das Ergebnis können wir abschließend einfach in unserem Test testen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Erzeugen des WuppiStores.</span>
</span></span><span style="display:flex;"><span>WuppiStore wuppiStore <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> WuppiStore(lager);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Bestelle alle Wuppis aus dem gemockten Lager List&lt;String&gt;</span>
</span></span><span style="display:flex;"><span>bestellteWuppis <span style="color:#f92672">=</span> wuppiStore.<span style="color:#a6e22e">bestelleAlleWuppis</span>(lager);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Hat die Bestellung geklappt?</span>
</span></span><span style="display:flex;"><span>assertEquals(2,bestellteWuppis.<span style="color:#a6e22e">size</span>());</span></span></code></pre></div>
<h3 id="mockito-spies">Mockito Spies</h3>
<p>Manchmal möchten wir allerdings nicht immer gleich ein ganzes Objekt mocken,
aber dennoch Einfluss auf die aufgerufenen Methoden eines Objekts haben, um
diese testen zu können. Vielleicht gibt es dabei ja sogar eine Möglichkeit unsere
JUnit-Tests, mit denen wir normalerweise nur Rückgabewerte von Methoden testen
können, zusätzlich auch das Verhalten also die Interaktionen mit einem Objekt
beobachtbar zu machen. Somit wären diese Interaktionen auch testbar.</p>
<p>Und genau dafür bietet Mockito eine Funktion: der sogenannte &quot;Spy&quot;.</p>
<p>Dieser Spion erlaubt es uns nun zusätzlich das Verhalten zu testen. Das geht in
die Richtung von <a href="https://de.wikipedia.org/wiki/Behavior_Driven_Development" rel="external" target="_blank">BDD - Behavior Driven Development</a>.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/spy/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.spy)</span></a></span></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Spion erstellen, der unser wuppiWarenlager überwacht.</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">wuppiWarenlager</span> <span style="color:#f92672">=</span> spy(WuppiWarenlager.<span style="color:#a6e22e">class</span>);</span></span></code></pre></div>
<p>Hier hatten wir uns einen Spion erzeugt, mit dem sich anschließend das Verhalten
verändern lässt:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>when(wuppiWarenlager.<span style="color:#a6e22e">getAlleWuppis</span>()).<span style="color:#a6e22e">thenReturn</span>(Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#66d9ef">new</span> Wuppi(<span style="color:#e6db74">&#34;Wuppi007&#34;</span>)));</span></span></code></pre></div>
<p>Aber auch der Zugriff lässt sich kontrollieren/testen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>verify(wuppiWarenlager).<span style="color:#a6e22e">addWuppi</span>(normalerWuppi);
</span></span><span style="display:flex;"><span>verifyNoMoreInteractions(wuppiWarenlager);</span></span></code></pre></div>
<p>Die normalen Testmöglichkeiten von JUnit runden unseren Test zudem ab.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>assertEquals(1,wuppiWarenlager.<span style="color:#a6e22e">lager</span>.<span style="color:#a6e22e">size</span>());</span></span></code></pre></div>
<h2 id="mockito-und-annotationen">Mockito und Annotationen</h2>
<p>In Mockito können Sie wie oben gezeigt mit <code>mock()</code> und <code>spy()</code> neue
Mocks bzw. Spies erzeugen und mit <code>verify()</code> die Interaktion überprüfen
und mit <code>ArgumentMatcher&lt;T&gt;</code> bzw. den vordefinierten <code>ArgumentMatchers</code>
auf Argumente zuzugreifen bzw. darauf zu reagieren.</p>
<p>Zusätzlich/alternativ gibt es in Mockito zahlreiche Annotationen, die
<strong>ersatzweise</strong> statt der genannten Methoden genutzt werden können. Hier
ein kleiner Überblick über die wichtigsten in Mockito verwendeten Annotation:</p>
<ul>
<li>
<p><code>@Mock</code> wird zum Markieren des zu mockenden Objekts verwendet.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Mock</span>
</span></span><span style="display:flex;"><span>WuppiWarenlager lager;</span></span></code></pre></div>
</li>
<li>
<p><code>@RunWith(MockitoJUnitRunner.class)</code> ist der entsprechende JUnit-Runner,
wenn Sie Mocks mit <code>@Mock</code> anlegen.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@RunWith</span>(MockitoJUnitRunner.<span style="color:#a6e22e">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ToDoBusinessMock</span> {...}</span></span></code></pre></div>
</li>
<li>
<p><code>@Spy</code> erlaubt das Erstellen von partiell gemockten Objekten. Dabei wird eine
Art Wrapper um das zu mockende Objekt gewickelt, der dafür sorgt, dass alle
Methodenaufrufe des Objekts an den Spy delegiert werden. Diese können über den
Spion dann abgefangen/verändert oder ausgewertet werden.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Spy</span>
</span></span><span style="display:flex;"><span>ArrayList<span style="color:#f92672">&lt;</span>Wuppi<span style="color:#f92672">&gt;</span> arrayListenSpion;</span></span></code></pre></div>
</li>
<li>
<p><code>@InjectMocks</code> erlaubt es, Parameter zu markieren, in denen Mocks und/oder
Spies injiziert werden. Mockito versucht dann (in dieser Reihenfolge) per
Konstruktorinjektion, Setterinjektion oder Propertyinjektion die Mocks zu
injizieren. Weitere Informationen darüber findet man hier:
<a href="https://javadoc.io/static/org.mockito/mockito-core/4.5.1/org/mockito/InjectMocks.html" rel="external" target="_blank">Mockito Dokumentation</a></p>
<p><strong>Anmerkung</strong>: Es ist aber nicht ratsam &quot;Field- oder Setterinjection&quot; zu nutzen,
da man nur bei der Verwendung von &quot;Constructorinjection&quot; sicherstellen kann, das
eine Klasse nicht ohne die eigentlich notwendigen Parameter instanziiert wurde.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@InjectMocks</span>
</span></span><span style="display:flex;"><span>Wuppi fluppi;</span></span></code></pre></div>
</li>
<li>
<p><code>@Captor</code> erlaubt es, die Argumente einer Methode abzufangen/auszuwerten. Im
Zusammenspiel mit Mockitos <code>verify()</code>-Methode kann man somit auch die einer
Methode übergebenen Argumente verifizieren.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Captor</span>
</span></span><span style="display:flex;"><span>ArgumentCaptor<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> argumentCaptor;</span></span></code></pre></div>
</li>
<li>
<p><code>@ExtendWith(MockitoExtension.class)</code> wird in JUnit5 verwendet, um die
Initialisierung von Mocks zu vereinfachen. Damit entfällt zum Beispiel die
noch unter JUnit4 nötige Initialisierung der Mocks durch einen Aufruf der
Methode <code>MockitoAnnotations.openMocks()</code> im Setup des Tests (<code>@Before</code> bzw.
<code>@BeforeEach</code>).</p>
</li>
</ul>
<h3 id="prüfen-der-interaktion-mit-verify">Prüfen der Interaktion mit <em>verify()</em></h3>
<p>Mit Hilfe der umfangreichen <code>verify()</code>-Methoden, die uns Mockito mitliefert, können
wir unseren Code unter anderem auf unerwünschte Seiteneffekte testen. So ist es mit
<code>verify</code> zum Beispiel möglich abzufragen, ob mit einem gemockten Objekt interagiert
wurde, wie damit interagiert wurde, welche Argumente dabei übergeben worden sind und
in welcher Reihenfolge die Interaktionen damit erfolgt sind.</p>
<p>Hier nur eine kurze Übersicht über das Testen des Codes mit Hilfe von Mockitos
<code>verify()</code>-Methoden.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_DasKeineInteraktionMitDerListeStattgefundenHat</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, ob die spezifizierte Interaktion mit der Liste nie stattgefunden hat.</span>
</span></span><span style="display:flex;"><span>    verify(fluppisListe, never()).<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_ReihenfolgeDerInteraktionenMitDerFluppisListe</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, ob die Reihenfolge der spezifizierten Interaktionen mit der Liste eingehalten wurde.</span>
</span></span><span style="display:flex;"><span>    fluppisListe.<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>    InOrder reihenfolge <span style="color:#f92672">=</span> inOrder(fluppisListe);
</span></span><span style="display:flex;"><span>    reihenfolge.<span style="color:#a6e22e">verify</span>(fluppisListe).<span style="color:#a6e22e">add</span>(<span style="color:#e6db74">&#34;Fluppi001&#34;</span>);
</span></span><span style="display:flex;"><span>    reihenfolge.<span style="color:#a6e22e">verify</span>(fluppisListe).<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_FlexibleArgumenteBeimZugriffAufFluppisListe</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, ob schon jemals etwas zu der Liste hinzugefügt wurde.</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Dabei ist es egal welcher String eingegeben wurde.</span>
</span></span><span style="display:flex;"><span>    verify(fluppisListe).<span style="color:#a6e22e">add</span>(anyString());
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">testVerify_InteraktionenMitHilfeDesArgumentCaptor</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Testet, welches Argument beim Methodenaufruf übergeben wurde.</span>
</span></span><span style="display:flex;"><span>    fluppisListe.<span style="color:#a6e22e">addAll</span>(Arrays.<span style="color:#a6e22e">asList</span>(<span style="color:#e6db74">&#34;BobDerBaumeister&#34;</span>));
</span></span><span style="display:flex;"><span>    ArgumentCaptor<span style="color:#f92672">&lt;</span>List<span style="color:#f92672">&gt;</span> argumentMagnet <span style="color:#f92672">=</span> ArgumentCaptor.<span style="color:#a6e22e">forClass</span>(FluppisListe.<span style="color:#a6e22e">class</span>);
</span></span><span style="display:flex;"><span>    verify(fluppisListe).<span style="color:#a6e22e">addAll</span>(argumentMagnet.<span style="color:#a6e22e">capture</span>());
</span></span><span style="display:flex;"><span>    List<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> argumente <span style="color:#f92672">=</span> argumentMagnet.<span style="color:#a6e22e">getValue</span>();
</span></span><span style="display:flex;"><span>    assertEquals(<span style="color:#e6db74">&#34;BobDerBaumeister&#34;</span>, argumente.<span style="color:#a6e22e">get</span>(0));
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/testing/src/mockito/src/test/java/wuppie/verify/" target="_blank"><span class="title">Demo: WuppiWarenlager (wuppie.verify)</span></a></span></div>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Gründliches Testen ist ebenso viel Aufwand wie Coden!</p>
</li>
<li>
<p>Mockito ergänzt JUnit:</p>
<ul>
<li>Mocken ganzer Klassen (<code>mock()</code>, <code>when().thenReturn()</code>)</li>
<li>Wrappen von Objekten (<code>spy()</code>, <code>doReturn().when()</code>)</li>
<li>Auswerten, wie häufig Methoden aufgerufen wurden (<code>verify()</code>)</li>
<li>Auswerten, mit welchen Argumenten Methoden aufgerufen wurden (<code>anyString</code>)</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106547&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Mocking (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Betrachten Sie die drei Klassen <code>Utility.java</code>, <code>Evil.java</code>
und <code>UtilityTest.java</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Utility</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> intResult <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Evil evilClass;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Utility</span>(Evil evilClass) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">evilClass</span> <span style="color:#f92672">=</span> evilClass;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">evilMethod</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 2 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">nonEvilAdd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">evilAdd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>        evilClass.<span style="color:#a6e22e">evilMethod</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> a <span style="color:#f92672">+</span> b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">veryEvilAdd</span>(<span style="color:#66d9ef">int</span> a, <span style="color:#66d9ef">int</span> b) {
</span></span><span style="display:flex;"><span>        evilMethod();
</span></span><span style="display:flex;"><span>        evilClass.<span style="color:#a6e22e">evilMethod</span>();
</span></span><span style="display:flex;"><span>        intResult <span style="color:#f92672">=</span> a <span style="color:#f92672">+</span> b;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getIntResult</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> intResult;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Evil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">evilMethod</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 3 <span style="color:#f92672">/</span> 0;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UtilityTest</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Utility utilityClass;
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Initialisieren Sie die Attribute entsprechend vor jedem Test.</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test_nonEvilAdd</span>() {
</span></span><span style="display:flex;"><span>        Assertions.<span style="color:#a6e22e">assertEquals</span>(10, utilityClass.<span style="color:#a6e22e">nonEvilAdd</span>(9, 1));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test_evilAdd</span>() {
</span></span><span style="display:flex;"><span>        Assertions.<span style="color:#a6e22e">assertEquals</span>(10, utilityClass.<span style="color:#a6e22e">evilAdd</span>(9, 1));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">test_veryEvilAdd</span>() {
</span></span><span style="display:flex;"><span>        utilityClass.<span style="color:#a6e22e">veryEvilAdd</span>(9, 1);
</span></span><span style="display:flex;"><span>        Assertions.<span style="color:#a6e22e">assertEquals</span>(10, utilityClass.<span style="color:#a6e22e">getIntResult</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Testen Sie die Methoden <code>nonEvilAdd</code>, <code>evilAdd</code> und <code>veryEvilAdd</code> der
Klasse <code>Utility.java</code> mit dem <a href="https://junit.org/" rel="external" target="_blank">JUnit-</a> und dem
<a href="https://github.com/mockito/mockito" rel="external" target="_blank">Mockito-Framework</a>.</p>
<p>Vervollständigen Sie dazu die Klasse <code>UtilityTest.java</code> und nutzen Sie
Mocking mit <a href="https://github.com/mockito/mockito" rel="external" target="_blank">Mockito</a>, um die Tests
zum Laufen zu bringen. Die Tests dürfen Sie entsprechend verändern, aber
die Aufrufe aus der Vorgabe müssen erhalten bleiben. Die Klassen <code>Evil.java</code>
und <code>Utility.java</code> dürfen Sie nicht ändern.</p>
<p><em>Hinweis:</em> Die Klasse <code>Evil.java</code> und die Methode <code>evilMethod()</code> aus
<code>Utility.java</code> lösen eine ungewollte bzw. &quot;zufällige&quot; Exception aus,
auf deren Auftreten jedoch <em>nicht</em> getestet werden soll. Stattdessen
sollen diese Klassen bzw. Methoden mit Mockito &quot;weggemockt&quot; werden, so
dass die vorgegebenen Testmethoden (wieder) funktionieren.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Mockito'>[Mockito] <a href='https://github.com/mockito/mockito' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Mockito</strong></a><br>S. Faber and B. Dutheil and R. Winterhalter and T.v.d. Lippe, 2022.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
          <article class="default">
            <header class="headline">
            </header>

<h1 id="entwurfsmuster">Entwurfsmuster</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor.html">Visitor-Pattern</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/observer.html">Observer-Pattern</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/template-method.html">Template-Method-Pattern</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/command.html">Command-Pattern</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Entwurfsmuster</h1>
<article class="default">
<h1>Visitor-Pattern</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Häufig bietet es sich bei Datenstrukturen an, die Traversierung nicht direkt in den Klassen
der Datenstrukturen zu implementieren, sondern in Hilfsklassen zu verlagern. Dies gilt vor
allem dann, wenn die Datenstruktur aus mehreren Klassen besteht (etwa ein Baum mit verschiedenen
Knotentypen) und/oder wenn man nicht nur eine Traversierungsart ermöglichen will oder/und wenn
man immer wieder neue Arten der Traversierung ergänzen will. Das würde nämlich bedeuten, dass
man für jede weitere Form der Traversierung in <em>allen</em> Klassen eine entsprechende neue Methode
implementieren müsste.</p>
<p>Das Visitor-Pattern lagert die Traversierung in eigene Klassenstruktur aus.</p>
<p>Die Klassen der Datenstruktur bekommen nur noch eine <code>accept()</code>-Methode, in der ein Visitor
übergeben wird und rufen auf diesem Visitor einfach dessen <code>visit()</code>-Methode auf (mit einer
Referenz auf sich selbst als Argument).</p>
<p>Der Visitor hat für jede Klasse der Datenstruktur eine Überladung der <code>visit()</code>-Methode. In
diesen kann er je nach Klasse die gewünschte Verarbeitung vornehmen. Üblicherweise gibt es
ein Interface oder eine abstrakte Klasse für die Visitoren, von denen dann konkrete Visitoren
ableiten.</p>
<p>Bei Elementen mit &quot;Kindern&quot; muss man sich entscheiden, wie die Traversierung implementiert
werden soll. Man könnte in der <code>accept()</code>-Methode den Visitor an die Kinder weiter reichen
(also auf den Kindern <code>accept()</code> mit dem Visitor aufrufen), bevor man die <code>visit()</code>-Methode
des Visitors mit sich selbst als Referenz aufruft. Damit ist die Form der Traversierung in
den Klassen der Datenstruktur fest verankert und über den Visitor findet &quot;nur&quot; noch eine
unterschiedliche Form der Verarbeitung statt. Alternativ überlässt man es dem Visitor, die
Traversierung durchzuführen: Hier muss in den <code>visit()</code>-Methoden für die einzelnen Elemente
entsprechend auf mögliche Kinder reagiert werden.</p>
<p>In diesem Pattern findet ein sogenannter &quot;Double-Dispatch&quot; statt: Zur Laufzeit wird ein konkreter
Visitor instantiiert und über <code>accept()</code> an ein Element der Datenstruktur übergeben. Dort ist
zur Compile-Zeit aber nur der Obertyp der Visitoren bekannt, d.h. zur Laufzeit wird hier der
konkrete Typ bestimmt und entsprechend die richtige <code>visit()</code>-Methode auf der &quot;echten&quot; Klasse
des Visitors aufgerufen (erster Dispatch). Da im Visitor die <code>visit()</code>-Methoden für jeden Typ
der Datenstrukur überladen sind, findet nun zur Laufzeit die Auflösung der korrekten Überladung
statt (zweiter Dispatch).</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/zW_2oQmjp8M' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Visitor-Pattern</a></li> <li><a href='https://youtu.be/9dvcufpyQdw' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Visitor-Pattern (Part I: Traversierung ohne Visitor)</a></li> <li><a href='https://youtu.be/4rBRkXKhuN4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Visitor-Pattern (Part II: Traversierung mit Visitor)</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/8a307719da2fd87b9cba54d34c05715a2fdaf115e80feb8ef29e53dcfe45f02e587ae0f76c7700e8d82fe102a234a2922af549aeaa261034dba59cbacfaaa8c3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Visitor-Pattern</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Aufbau des Visitor-Patterns (Besucher-Entwurfsmusters)</li> <li>(K3) Anwendung des Visitor-Patterns auf konkrete Beispiele, etwa den PM-Dungeon</li></ul>
  </div>
</div>




    <h2 id="motivation-parsen-von-543">Motivation: Parsen von &quot;5*4+3&quot;</h2>
<div class='columns'>
<div class='column'>
<p>Zum Parsen von Ausdrücken (<em>Expressions</em>) könnte man diese einfache Grammatik
einsetzen. Ein Ausdruck ist dabei entweder ein einfacher Integer oder eine
Addition oder Multiplikation zweier Ausdrücke.</p>
<div class="highlight wrap-code"><pre tabindex="0"><code class="language-yacc" data-lang="yacc">expr : e1=expr &#39;*&#39; e2=expr      # MUL
     | e1=expr &#39;+&#39; e2=expr      # ADD
     | INT                      # NUM
     ;</code></pre></div>
</div>
<div class='column'>
<p>Beim Parsen von &quot;5*4+3&quot; würde dabei der folgende Parsetree entstehen:</p>
<p><a href="#R-image-b79584323c34c14aefdf30ffa586d867" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/parsetree.png?width=20%25&height=auto" style=" height: auto; width: 20%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-b79584323c34c14aefdf30ffa586d867"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/parsetree.png?width=20%25&height=auto"></a></p>
</div>
</div>
<h2 id="strukturen-für-den-parsetree">Strukturen für den Parsetree</h2>
<p><a href="#R-image-88893fa937acc85d49ae5b9ee2337be1" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/parsetree_classes_uml.png?width=70%25&height=auto" style=" height: auto; width: 70%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-88893fa937acc85d49ae5b9ee2337be1"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/parsetree_classes_uml.png?width=70%25&height=auto"></a></p>
<p>Der Parsetree für diese einfache Grammatik ist ein Binärbaum. Die Regeln
werden auf Knoten im Baum zurückgeführt. Es gibt Knoten mit zwei Kindknoten,
und es gibt Knoten ohne Kindknoten (&quot;Blätter&quot;).</p>
<p>Entsprechend kann man sich einfache Klassen definieren, die die verschiedenen
Knoten in diesem Parsetree repräsentieren. Als Obertyp könnte es ein (noch
leeres) Interface <code>Expr</code> geben.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Expr</span> {}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NumExpr</span> <span style="color:#66d9ef">implements</span> Expr {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> d;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">NumExpr</span>(<span style="color:#66d9ef">int</span> d) { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">d</span> <span style="color:#f92672">=</span> d; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MulExpr</span> <span style="color:#66d9ef">implements</span> Expr {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e2;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">MulExpr</span>(Expr e1, Expr e2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e1</span> <span style="color:#f92672">=</span> e1;  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e2</span> <span style="color:#f92672">=</span> e2;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AddExpr</span> <span style="color:#66d9ef">implements</span> Expr {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e2;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">AddExpr</span>(Expr e1, Expr e2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e1</span> <span style="color:#f92672">=</span> e1;  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e2</span> <span style="color:#f92672">=</span> e2;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DemoExpr</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">final</span> String... args) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 5*4+3</span>
</span></span><span style="display:flex;"><span>        Expr e <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> AddExpr(<span style="color:#66d9ef">new</span> MulExpr(<span style="color:#66d9ef">new</span> NumExpr(5), <span style="color:#66d9ef">new</span> NumExpr(4)), <span style="color:#66d9ef">new</span> NumExpr(3));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="ergänzung-i-ausrechnen-des-ausdrucks">Ergänzung I: Ausrechnen des Ausdrucks</h2>
<p>Es wäre nun schön, wenn man mit dem Parsetree etwas anfangen könnte. Vielleicht
möchte man den Ausdruck ausrechnen?</p>
<p><a href="#R-image-638ace88a89561dd075638215f25c735" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/parsetree_eval_uml.png?width=70%25&height=auto" style=" height: auto; width: 70%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-638ace88a89561dd075638215f25c735"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/parsetree_eval_uml.png?width=70%25&height=auto"></a></p>
<p>Zum Ausrechnen des Ausdrucks könnte man dem Interface eine <code>eval()</code>-Methode
spendieren. Jeder Knoten kann für sich entscheiden, wie die entsprechende
Operation ausgewertet werden soll: Bei einer <code>NumExpr</code> ist dies einfach der
gespeicherte Wert, bei Addition oder Multiplikation entsprechend die Addition
oder Multiplikation der Auswertungsergebnisse der beiden Kindknoten.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Expr</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">eval</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NumExpr</span> <span style="color:#66d9ef">implements</span> Expr {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> d;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">NumExpr</span>(<span style="color:#66d9ef">int</span> d) { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">d</span> <span style="color:#f92672">=</span> d; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">eval</span>() { <span style="color:#66d9ef">return</span> d; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MulExpr</span> <span style="color:#66d9ef">implements</span> Expr {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e2;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">MulExpr</span>(Expr e1, Expr e2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e1</span> <span style="color:#f92672">=</span> e1;  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e2</span> <span style="color:#f92672">=</span> e2;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">eval</span>() { <span style="color:#66d9ef">return</span> e1.<span style="color:#a6e22e">eval</span>() <span style="color:#f92672">*</span> e2.<span style="color:#a6e22e">eval</span>(); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AddExpr</span> <span style="color:#66d9ef">implements</span> Expr {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e2;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">AddExpr</span>(Expr e1, Expr e2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e1</span> <span style="color:#f92672">=</span> e1;  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e2</span> <span style="color:#f92672">=</span> e2;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">eval</span>() { <span style="color:#66d9ef">return</span> e1.<span style="color:#a6e22e">eval</span>() <span style="color:#f92672">+</span> e2.<span style="color:#a6e22e">eval</span>(); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DemoExpr</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">final</span> String... args) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 5*4+3</span>
</span></span><span style="display:flex;"><span>        Expr e <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> AddExpr(<span style="color:#66d9ef">new</span> MulExpr(<span style="color:#66d9ef">new</span> NumExpr(5), <span style="color:#66d9ef">new</span> NumExpr(4)), <span style="color:#66d9ef">new</span> NumExpr(3));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> erg <span style="color:#f92672">=</span> e.<span style="color:#a6e22e">eval</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="ergänzung-ii-pretty-print-des-ausdrucks">Ergänzung II: Pretty-Print des Ausdrucks</h2>
<p>Nachdem das Ausrechnen so gut geklappt hat, will der Chef nun noch flink eine Funktion,
mit der man den Ausdruck hübsch ausgeben kann:</p>
<p><a href="#R-image-f0c149c5dc4bc7b407e9b8f6fad9dd3c" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/parsetree_eval_print_uml.png?width=70%25&height=auto" style=" height: auto; width: 70%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-f0c149c5dc4bc7b407e9b8f6fad9dd3c"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/parsetree_eval_print_uml.png?width=70%25&height=auto"></a></p>
<p>Das fängt an, sich zu wiederholen. Wir implementieren immer wieder ähnliche Strukturen,
mit denen wir diesen Parsetree traversieren ... Und wir müssen für <em>jede</em> Erweiterung
immer <em>alle</em> Expression-Klassen anpassen!</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/pattern/src/visitor/direct/DemoExpr.java" target="_blank"><span class="title">Beispiel: direct.DemoExpr</span></a></span></div>
<p><strong>Das geht besser.</strong></p>
<h2 id="visitor-pattern-besucher-entwurfsmuster">Visitor-Pattern (Besucher-Entwurfsmuster)</h2>
<p><a href="#R-image-78136db0c5bd60b3e3ee16910b3f985a" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/visitor.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-78136db0c5bd60b3e3ee16910b3f985a"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/visitor.png?width=80%25&height=auto"></a></p>
<p>Das Entwurfsmuster &quot;Besucher&quot; (<em>Visitor Pattern</em>) lagert die Aktion beim Besuchen eines
Knotens in eine separate Klasse aus.</p>
<p>Dazu bekommt jeder Knoten im Baum eine neue Methode, die einen Besucher akzeptiert.
Dieser Besucher kümmert sich dann um die entsprechende Verarbeitung des Knotens, also
um das Auswerten oder Ausgeben im obigen Beispiel.</p>
<p>Die Besucher haben eine Methode, die für jeden zu bearbeitenden Knoten überladen wird.
In dieser Methode findet dann die eigentliche Verarbeitung statt: Auswerten des Knotens
oder Ausgeben des Knotens ...</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Expr</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">accept</span>(ExprVisitor v);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">NumExpr</span> <span style="color:#66d9ef">implements</span> Expr {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> d;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">NumExpr</span>(<span style="color:#66d9ef">int</span> d) { <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">d</span> <span style="color:#f92672">=</span> d; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getValue</span>() { <span style="color:#66d9ef">return</span> d; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">accept</span>(ExprVisitor v) { v.<span style="color:#a6e22e">visit</span>(<span style="color:#66d9ef">this</span>); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MulExpr</span> <span style="color:#66d9ef">implements</span> Expr {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e2;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">MulExpr</span>(Expr e1, Expr e2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e1</span> <span style="color:#f92672">=</span> e1;  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e2</span> <span style="color:#f92672">=</span> e2;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Expr <span style="color:#a6e22e">getE1</span>() { <span style="color:#66d9ef">return</span> e1; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Expr <span style="color:#a6e22e">getE2</span>() { <span style="color:#66d9ef">return</span> e2; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">accept</span>(ExprVisitor v) { v.<span style="color:#a6e22e">visit</span>(<span style="color:#66d9ef">this</span>); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">AddExpr</span> <span style="color:#66d9ef">implements</span> Expr {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Expr e2;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">AddExpr</span>(Expr e1, Expr e2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e1</span> <span style="color:#f92672">=</span> e1;  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">e2</span> <span style="color:#f92672">=</span> e2;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Expr <span style="color:#a6e22e">getE1</span>() { <span style="color:#66d9ef">return</span> e1; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Expr <span style="color:#a6e22e">getE2</span>() { <span style="color:#66d9ef">return</span> e2; }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">accept</span>(ExprVisitor v) { v.<span style="color:#a6e22e">visit</span>(<span style="color:#66d9ef">this</span>); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">ExprVisitor</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visit</span>(NumExpr e);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visit</span>(MulExpr e);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visit</span>(AddExpr e);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EvalVisitor</span> <span style="color:#66d9ef">implements</span> ExprVisitor {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Stack<span style="color:#f92672">&lt;</span>Integer<span style="color:#f92672">&gt;</span> erg <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Stack<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visit</span>(NumExpr e) { erg.<span style="color:#a6e22e">push</span>(e.<span style="color:#a6e22e">getValue</span>()); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visit</span>(MulExpr e) {
</span></span><span style="display:flex;"><span>        e.<span style="color:#a6e22e">getE1</span>().<span style="color:#a6e22e">accept</span>(<span style="color:#66d9ef">this</span>);  e.<span style="color:#a6e22e">getE1</span>().<span style="color:#a6e22e">accept</span>(<span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>        erg.<span style="color:#a6e22e">push</span>(erg.<span style="color:#a6e22e">pop</span>() <span style="color:#f92672">*</span> erg.<span style="color:#a6e22e">pop</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visit</span>(AddExpr e) {
</span></span><span style="display:flex;"><span>        e.<span style="color:#a6e22e">getE1</span>().<span style="color:#a6e22e">accept</span>(<span style="color:#66d9ef">this</span>);  e.<span style="color:#a6e22e">getE1</span>().<span style="color:#a6e22e">accept</span>(<span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>        erg.<span style="color:#a6e22e">push</span>(erg.<span style="color:#a6e22e">pop</span>() <span style="color:#f92672">+</span> erg.<span style="color:#a6e22e">pop</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getResult</span>() { <span style="color:#66d9ef">return</span> erg.<span style="color:#a6e22e">peek</span>(); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PrintVisitor</span> <span style="color:#66d9ef">implements</span> ExprVisitor {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Stack<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">&gt;</span> erg <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Stack<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visit</span>(NumExpr e) { erg.<span style="color:#a6e22e">push</span>(<span style="color:#e6db74">&#34;NumExpr(&#34;</span> <span style="color:#f92672">+</span> e.<span style="color:#a6e22e">getValue</span>() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)&#34;</span>); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visit</span>(MulExpr e) {
</span></span><span style="display:flex;"><span>        e.<span style="color:#a6e22e">getE1</span>().<span style="color:#a6e22e">accept</span>(<span style="color:#66d9ef">this</span>);  e.<span style="color:#a6e22e">getE1</span>().<span style="color:#a6e22e">accept</span>(<span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>        erg.<span style="color:#a6e22e">push</span>(<span style="color:#e6db74">&#34;MulExpr(&#34;</span> <span style="color:#f92672">+</span> erg.<span style="color:#a6e22e">pop</span>() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, &#34;</span> <span style="color:#f92672">+</span> erg.<span style="color:#a6e22e">pop</span>() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">visit</span>(AddExpr e) {
</span></span><span style="display:flex;"><span>        e.<span style="color:#a6e22e">getE1</span>().<span style="color:#a6e22e">accept</span>(<span style="color:#66d9ef">this</span>);  e.<span style="color:#a6e22e">getE1</span>().<span style="color:#a6e22e">accept</span>(<span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>        erg.<span style="color:#a6e22e">push</span>(<span style="color:#e6db74">&#34;AddExpr(&#34;</span> <span style="color:#f92672">+</span> erg.<span style="color:#a6e22e">pop</span>() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, &#34;</span> <span style="color:#f92672">+</span> erg.<span style="color:#a6e22e">pop</span>() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getResult</span>() { <span style="color:#66d9ef">return</span> erg.<span style="color:#a6e22e">peek</span>(); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DemoExpr</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">final</span> String... args) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 5*4+3</span>
</span></span><span style="display:flex;"><span>        Expr e <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> AddExpr(<span style="color:#66d9ef">new</span> MulExpr(<span style="color:#66d9ef">new</span> NumExpr(5), <span style="color:#66d9ef">new</span> NumExpr(4)), <span style="color:#66d9ef">new</span> NumExpr(3));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        EvalVisitor v1 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> EvalVisitor();
</span></span><span style="display:flex;"><span>        e.<span style="color:#a6e22e">accept</span>(v1);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> erg <span style="color:#f92672">=</span> v1.<span style="color:#a6e22e">getResult</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        PrintVisitor v2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PrintVisitor();
</span></span><span style="display:flex;"><span>        e.<span style="color:#a6e22e">accept</span>(v2);
</span></span><span style="display:flex;"><span>        String s <span style="color:#f92672">=</span> v2.<span style="color:#a6e22e">getResult</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="implementierungsdetail">Implementierungsdetail</h3>
<p>In den beiden Klasse <code>AddExpr</code> und <code>MulExpr</code> müssen auch die beiden Kindknoten besucht
werden, d.h. hier muss der Baum weiter traversiert werden.</p>
<p>Man kann sich überlegen, diese Traversierung in den Klassen <code>AddExpr</code> und <code>MulExpr</code>
selbst anzustoßen.</p>
<p>Alternativ könnte auch der Visitor die Traversierung vornehmen. Gerade bei der Traversierung
von Datenstrukturen ist diese Variante oft von Vorteil, da man hier unterschiedliche
Traversierungsarten haben möchte (Breitensuche vs. Tiefensuche, Pre-Order vs. Inorder vs.
Post-Order, ...) und diese elegant in den Visitor verlagern kann.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/pattern/src/visitor/visit/intrav/DemoExpr.java" target="_blank"><span class="title">Beispiel Traversierung intern (in den Knotenklassen): visitor.visit.intrav.DemoExpr</span></a></span></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/pattern/src/visitor/visit/extrav/DemoExpr.java" target="_blank"><span class="title">Beispiel Traversierung extern (im Visitor): visitor.visit.extrav.DemoExpr</span></a></span></div>
<h3 id="double--dispatch">(Double-) Dispatch</h3>
<p>Zur Laufzeit wird in <code>accept()</code> der Typ des Visitors aufgelöst und dann in <code>visit()</code> der
Typ der zu besuchenden Klasse. Dies nennt man auch &quot;Double-Dispatch&quot;.</p>
<h3 id="hinweis-i">Hinweis I</h3>
<p>Man könnte versucht sein, die <code>accept()</code>-Methode aus den Knotenklassen in die gemeinsame
Basisklasse zu verlagern: Statt</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">accept</span>(ExprVisitor v) {
</span></span><span style="display:flex;"><span>        v.<span style="color:#a6e22e">visit</span>(<span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<p>in <em>jeder</em> Knotenklasse einzeln zu definieren, könnte man das doch <em>einmalig</em> in der
Basisklasse definieren:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Expr</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">/** Akzeptiere einen Visitor für die Verarbeitung */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">accept</span>(ExprVisitor v) {
</span></span><span style="display:flex;"><span>        v.<span style="color:#a6e22e">visit</span>(<span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Dies wäre tatsächlich schön, weil man so Code-Duplizierung vermeiden könnte. Aber es
funktioniert in Java leider nicht. (Warum?)</p>
<h3 id="hinweis-ii">Hinweis II</h3>
<p>Während die <code>accept()</code>-Methode nicht in die Basisklasse der besuchten Typen (im Bild oben
die Klasse <code>Elem</code> bzw. im Beispiel oben die Klasse <code>Expr</code>) verlagert werden kann, kann man
aber die <code>visit()</code>-Methoden im Interface <code>Visitor</code> durchaus als Default-Methoden im Interface
implementieren.</p>
<h2 id="ausrechnen-des-ausdrucks-mit-einem-visitor">Ausrechnen des Ausdrucks mit einem Visitor</h2>
<p><a href="#R-image-a049719d2800b1fd6f3881fe7ee3ba78" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/parsetree_visitor_uml.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-a049719d2800b1fd6f3881fe7ee3ba78"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/visitor/parsetree_visitor_uml.png?width=auto&height=auto"></a></p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/pattern/src/visitor/visit/extrav/DemoExpr.java" target="_blank"><span class="title">Demo: visitor.visit.extrav.DemoExpr</span></a></span></div>
<h2 id="wrap-up">Wrap-Up</h2>
<p><strong>Visitor-Pattern</strong>: Auslagern der Traversierung in eigene Klassenstruktur</p>
<ul>
<li>
<p>Klassen der Datenstruktur</p>
<ul>
<li>bekommen eine <code>accept()</code>-Methode für einen Visitor</li>
<li>rufen den Visitor mit sich selbst als Argument auf</li>
</ul>
</li>
<li>
<p>Visitor</p>
<ul>
<li>hat für jede Klasse eine Überladung der <code>visit()</code>-Methode</li>
<li>Rückgabewerte schwierig: Intern halten oder per <code>return</code>
(dann aber unterschiedliche <code>visit()</code>-Methoden für die verschiedenen Rückgabetypen!)</li>
</ul>
</li>
<li>
<p>(Double-) Dispatch: Zur Laufzeit wird in <code>accept()</code> der Typ des Visitors
und in <code>visit()</code> der Typ der zu besuchenden Klasse aufgelöst</p>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106543&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Visitor-Pattern (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Visitor-Pattern praktisch (und einfach)</strong></p>
<p>Betrachten Sie den folgenden Code und erklären Sie das Ergebnis:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Fruit</span> { }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Apple</span> <span style="color:#66d9ef">implements</span> Fruit { }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Orange</span> <span style="color:#66d9ef">implements</span> Fruit { }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Banana</span> <span style="color:#66d9ef">implements</span> Fruit { }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span> <span style="color:#66d9ef">extends</span> Apple { }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FruitBasketDirect</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Fruit<span style="color:#f92672">&gt;</span> basket <span style="color:#f92672">=</span> List.<span style="color:#a6e22e">of</span>(<span style="color:#66d9ef">new</span> Apple(), <span style="color:#66d9ef">new</span> Apple(), <span style="color:#66d9ef">new</span> Banana(), <span style="color:#66d9ef">new</span> Foo());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> oranges <span style="color:#f92672">=</span> 0;  <span style="color:#66d9ef">int</span> apples <span style="color:#f92672">=</span> 0;  <span style="color:#66d9ef">int</span> bananas <span style="color:#f92672">=</span> 0;  <span style="color:#66d9ef">int</span> foo <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (Fruit f : basket) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (f <span style="color:#66d9ef">instanceof</span> Apple) apples<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (f <span style="color:#66d9ef">instanceof</span> Orange) oranges<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (f <span style="color:#66d9ef">instanceof</span> Banana) bananas<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (f <span style="color:#66d9ef">instanceof</span> Foo) foo<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Das Verwenden von <code>instanceof</code> ist unschön und fehleranfällig. Schreiben Sie den
Code unter Einsatz des Visitor-Patterns um.</p>
<p>Diskutieren Sie Vor- und Nachteile des Visitor-Patterns.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Eilebrecht2013'>[Eilebrecht2013] <strong>Patterns kompakt</strong><br>Eilebrecht, K. und Starke, G., Springer, 2013. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-6423-4718-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-6423-4718-4</a>.</li> <li id='id_Gamma2011'>[Gamma2011] <strong>Design Patterns</strong><br>Gamma, E. und Helm, R. und Johnson, R. E. und Vlissides, J., Addison-Wesley, 2011. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-2016-3361-0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-2016-3361-0</a>.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Observer-Pattern</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Eine Reihe von Objekten möchte über eine Änderung in einem anderen (&quot;zentralen&quot;) Objekt informiert werden.
Dazu könnte das &quot;zentrale&quot; Objekt eine Zugriffsmethode anbieten, die die anderen Objekte regelmäßig
abrufen (&quot;pollen&quot;).</p>
<p>Mit dem Observer-Pattern kann man das aktive Polling vermeiden. Die interessierten Objekte &quot;registrieren&quot;
sich beim &quot;zentralen&quot; Objekt. Sobald dieses eine Änderung erfährt oder Informationen bereitstehen o.ä.,
wird das &quot;zentrale&quot; Objekt alle registrierten Objekte über den Aufruf einer Methode benachrichtigen. Dazu
müssen diese eine gemeinsame Schnittstelle implementieren.</p>
<p>Das &quot;zentrale&quot; Objekt, welches abgefragt wird, nennt man &quot;<em>Observable</em>&quot; oder &quot;<em>Subject</em>&quot;. Die Objekte, die
die Information abfragen möchten, nennt man &quot;<em>Observer</em>&quot;.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/833lHcoxeog' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Observer-Pattern</a></li> <li><a href='https://youtu.be/0mgB8RfcNuM' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Observer-Pattern</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/e00888ac91978bb3694491a722e61bba5d836d403d7f94e7d3ef6b28c07dae841b5852488bdf8f64e1628a58a2e5f3410dbb08699ded346ec2da34fd877a831f' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Observer-Pattern</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Aufbau des Observer-Patterns (Beobachter-Entwurfsmusters)</li> <li>(K3) Anwendung des Observer-Patterns auf konkrete Beispiele, etwa den PM-Dungeon</li></ul>
  </div>
</div>




    <h2 id="verteilung-der-prüfungsergebnisse">Verteilung der Prüfungsergebnisse</h2>
<p><a href="#R-image-5ffb2c9a516d57637f4d58ac5ab5187c" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/observer/lsf.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-5ffb2c9a516d57637f4d58ac5ab5187c"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/observer/lsf.png?width=80%25&height=auto"></a></p>
<p>Die Studierenden möchten nach einer Prüfung wissen, ob für einen bestimmten Kurs
die/ihre Prüfungsergebnisse im LSF bereit stehen.</p>
<p>Dazu modelliert man eine Klasse <code>LSF</code> und implementiert eine Abfragemethode, die
dann alle Objekte regelmäßig aufrufen können. Dies sieht dann praktisch etwa so
aus:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">final</span> Person<span style="color:#f92672">[]</span> persons <span style="color:#f92672">=</span> { <span style="color:#66d9ef">new</span> Lecturer(<span style="color:#e6db74">&#34;Frau Holle&#34;</span>),
</span></span><span style="display:flex;"><span>                           <span style="color:#66d9ef">new</span> Student(<span style="color:#e6db74">&#34;Heinz&#34;</span>),
</span></span><span style="display:flex;"><span>                           <span style="color:#66d9ef">new</span> Student(<span style="color:#e6db74">&#34;Karla&#34;</span>),
</span></span><span style="display:flex;"><span>                           <span style="color:#66d9ef">new</span> Tutor(<span style="color:#e6db74">&#34;Kolja&#34;</span>),
</span></span><span style="display:flex;"><span>                           <span style="color:#66d9ef">new</span> Student(<span style="color:#e6db74">&#34;Wuppie&#34;</span>) };
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">final</span> LSF lsf <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> LSF();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> (Person p : persons) {
</span></span><span style="display:flex;"><span>    lsf.<span style="color:#a6e22e">getGradings</span>(p, <span style="color:#e6db74">&#34;My Module&#34;</span>);   <span style="color:#75715e">// ???!</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="elegantere-lösung-observer-entwurfsmuster">Elegantere Lösung: Observer-Entwurfsmuster</h2>
<p><a href="#R-image-aec934659261f8513585e314f54d407e" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/observer/observerexample.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-aec934659261f8513585e314f54d407e"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/observer/observerexample.png?width=80%25&height=auto"></a></p>
<p>Sie erstellen im <code>LSF</code> eine Methode <code>register()</code>, mit der sich interessierte Objekte
beim <code>LSF</code> registrieren können.</p>
<p>Zur Benachrichtigung der registrierten Objekte brauchen diese eine geeignete Methode,
die traditionell <code>update()</code> genannt wird.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/pattern/src/observer/" target="_blank"><span class="title">Demo: observer</span></a></span></div>
<h2 id="observer-pattern-verallgemeinert">Observer-Pattern verallgemeinert</h2>
<p><a href="#R-image-07b24a7f40a07a00aba5b12d6baeaef3" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/observer/observer.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-07b24a7f40a07a00aba5b12d6baeaef3"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/observer/observer.png?width=80%25&height=auto"></a></p>
<p>Im vorigen Beispiel wurde die Methode <code>update()</code> einfach der gemeinsamen Basisklasse <code>Person</code>
hinzugefügt. Normalerweise möchte man die Aspekte <code>Person</code> und <code>Observer</code> aber sauber trennen
und definiert sich dazu ein <em>separates</em> Interface <code>Observer</code> mit der Methode <code>update()</code>, die
dann alle &quot;interessierten&quot; Klassen (zusätzlich zur bestehenden Vererbungshierarchie) implementieren.</p>
<p>Die Klasse für das zu beobachtende Objekt benötigt dann eine Methode <code>register()</code>, mit der sich
Observer registrieren können. Die Objektreferenzen werden dabei einfach einer internen Sammlung
hinzugefügt.</p>
<p>Häufig findet sich dann noch eine Methode <code>unregister()</code>, mit der sich bereits registrierte
Beobachter wieder abmelden können. Weiterhin findet man häufig eine Methode <code>notifyObservers()</code>,
die man von außen auf dem beobachteten Objekt aufrufen kann und die dann auf allen registrierten
Beobachtern deren Methoden <code>update()</code> aufruft. (Dieser Vorgang kann aber auch durch eine sonstige
Zustandsänderung im beobachteten Objekt durchgeführt werden.)</p>
<p>In der Standarddefinition des Observer-Patterns nach <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/observer.html#id_Gamma2011">[Gamma2011]</a> werden beim Aufruf der Methode
<code>update()</code> keine Werte an die Beobachter mitgegeben. Der Beobachter muss sich entsprechend eine
eigene Referenz auf das beobachtete Objekt halten, um dort dann weitere Informationen erhalten
zu können. Dies kann vereinfacht werden, indem das beobachtete Objekt beim Aufruf der
<code>update()</code>-Methode die Informationen als Parameter mitgibt, beispielsweise eine Referenz auf sich
selbst o.ä. ... Dies muss dann natürlich im <code>Observer</code>-Interface nachgezogen werden.</p>
<p><strong>Hinweis</strong>: Es gibt in Swing bereits die Interfaces <code>Observer</code> und <code>Observable</code>, die aber als
&quot;deprecated&quot; gekennzeichnet sind. Sinnvollerweise nutzen Sie nicht diese Interfaces aus Swing,
sondern implementieren Ihre eigenen Interfaces, wenn Sie das Observer-Pattern einsetzen wollen!</p>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Observer-Pattern: Benachrichtige registrierte Objekte über Statusänderungen</p>
<ul>
<li>Interface <code>Observer</code> mit Methode <code>update()</code></li>
<li>Interessierte Objekte
<ol>
<li>implementieren das Interface <code>Observer</code></li>
<li>registrieren sich beim zu beobachtenden Objekt (<code>Observable</code>)</li>
</ol>
</li>
<li>Beobachtetes Objekt ruft auf allen registrierten Objekten <code>update()</code> auf</li>
<li><code>update()</code> kann auch Parameter haben</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106535&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Observer-Pattern (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Observer: Restaurant</strong></p>
<p>Stellen Sie sich ein Restaurant vor, in welchem man nicht eine komplette Mahlzeit bestellt, sondern aus
einzelnen Komponenten auswählen kann. Die Kunden bestellen also die gewünschten Komponenten, suchen sich
einen Tisch und warten auf die Fertigstellung ihrer Bestellung. Da die Küche leider nur sehr klein ist,
werden immer alle Bestellungen einer bestimmten Komponente zusammen bearbeitet - also beispielsweise werden
alle bestellten Salate angerichtet oder die alle bestellten Pommes-Portionen zubereitet. Sobald eine solche
Komponente fertig ist, werden alle Kunden aufgerufen, die diese Komponente bestellt haben ...</p>
<p>Modellieren Sie dies in Java. Nutzen Sie dazu das Observer-Pattern, welches Sie ggf. leicht anpassen
müssen.</p>
<p><strong>Observer: Einzel- und Großhandel</strong></p>
<p>In den <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/pattern/src/challenges/observer" rel="external" target="_blank">Vorgaben</a>
finden Sie ein Modell für eine Lieferkette zwischen Großhandel und Einzelhandel.</p>
<p>Wenn beim Einzelhändler eine Bestellung von einem Kunden eingeht (<code>Einzelhandel#bestellen</code>), speichert
dieser den <code>Auftrag</code> zunächst in einer Liste ab. In regelmäßigen Abständen (<code>Einzelhandel#loop</code>) sendet
der Einzelhändler die offenen Bestellungen an seinen Großhändler (<code>Grosshandel#bestellen</code>). Hat der
Großhändler die benötigte Ware vorrätig, sendet er diese an den Einzelhändler (<code>Einzelhandel#empfangen</code>).
Dieser kann dann den Auftrag gegenüber seinem Kunden erfüllen (keine Methode vorgesehen).</p>
<p>Anders als der Einzelhandel speichert der Großhandel keine Aufträge ab. Ist die benötigte Ware bei einer
Bestellung also nicht oder nicht in ausreichender Zahl auf Lager, wird diese nicht geliefert und der
Einzelhandel muss (später) eine neue Bestellung aufgeben.</p>
<p>Der Großhandel bekommt regelmäßig (<code>Grosshandel#loop</code>) neue Ware für die am wenigsten vorrätigen Positionen.</p>
<p>Im aktuellen Modell wird der Einzelhandel nicht über den neuen Lagerbestand des Großhändlers informiert
und kann daher nur &quot;zufällig&quot; neue Bestellanfragen an den Großhändler senden.</p>
<p>Verbessern Sie das Modell, indem Sie das Observer-Pattern integrieren. Wer ist Observer? Wer ist Observable?
Welche Informationen werden bei einem <code>update</code> mitgeliefert?</p>
<p>Bauen Sie in alle Aktionen vom Einzelhändler und vom Großhändler passendes Logging ein.</p>
<p><em>Anmerkung</em>: Sie dürfen nur die Vorgaben-Klassen <code>Einzelhandel</code> und <code>Grosshandel</code> verändern, die anderen
Vorgaben-Klassen dürfen Sie nicht bearbeiten. Sie können zusätzlich benötigte eigene Klassen/Interfaces
implementieren.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Gamma2011'>[Gamma2011] <strong>Design Patterns</strong><br>Gamma, E. und Helm, R. und Johnson, R. E. und Vlissides, J., Addison-Wesley, 2011. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-2016-3361-0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-2016-3361-0</a>.</li> <li id='id_Nystrom2014'>[Nystrom2014] <a href='https://github.com/munificent/game-programming-patterns' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Game Programming Patterns</strong></a><br>Nystrom, R., Genever Benning, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-9905-8290-8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-9905-8290-8</a>.<br><em>Kap. 4: Observer</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Template-Method-Pattern</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Das Template-Method-Pattern ist ein Entwurfsmuster, bei dem ein gewisses Verhalten
in einer Methode implementiert wird, die wie eine Schablone agiert, der sogenannten
&quot;Template-Methode&quot;. Darin werden dann u.a. Hilfsmethoden aufgerufen, die in der
Basisklasse entweder als <code>abstract</code> markiert sind oder mit einem leeren Body
implementiert sind (&quot;Hook-Methoden&quot;). Über diese Template-Methode legt also die
Basisklasse ein gewisses Verhaltensschema fest (&quot;Template&quot;) - daher auch der Name.</p>
<p>In den ableitenden Klassen werden dann die abstrakten Methoden und/oder die Hook-Methoden
implementiert bzw. überschrieben und damit das Verhalten verfeinert.</p>
<p>Zur Laufzeit ruft man auf den Objekten die Template-Methode auf. Dabei wird von der
Laufzeitumgebung der konkrete Typ der Objekte bestimmt (auch wenn man sie unter dem
Typ der Oberklasse führt) und die am tiefsten in der Vererbungshierarchie implementierten
Methoden aufgerufen. D.h. die Aufrufe der Hilfsmethoden in der Template-Methode führen
zu den in der jeweiligen ableitenden Klasse implementierten Varianten.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/EE-n2T6AO-g' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Template-Method-Pattern</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/a368cbd0990f4f58e5ee776bb4d6a1443c0a7cd443177eaa35ba35558e5c01307f689be5c9c239c6ffb41c74d2726397f2ba6be086df30737eec1df17ac4827a' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Template-Method-Pattern</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Template-Method-Entwurfsmuster praktisch anwenden</li></ul>
  </div>
</div>




    <h2 id="motivation-syntax-highlighting-im-tokenizer">Motivation: Syntax-Highlighting im Tokenizer</h2>
<p>In einem Compiler ist meist der erste Arbeitsschritt, den Eingabestrom in einzelne
Token aufzubrechen. Dies sind oft die verschiedenen Schlüsselwörter, Operationen,
Namen von Variablen, Methoden, Klassen etc. ... Aus der Folge von Zeichen (also dem
eingelesenen Programmcode) wird ein Strom von Token, mit dem die nächste Stufe im
Compiler dann weiter arbeiten kann.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Lexer</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> List<span style="color:#f92672">&lt;</span>Token<span style="color:#f92672">&gt;</span> allToken;  <span style="color:#75715e">// alle verfügbaren Token-Klassen</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> List<span style="color:#f92672">&lt;</span>Token<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">tokenize</span>(String string) {
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>Token<span style="color:#f92672">&gt;</span> result <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (string.<span style="color:#a6e22e">length</span>() <span style="color:#f92672">&gt;</span> 0) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (Token t : allToken) {
</span></span><span style="display:flex;"><span>                Token token <span style="color:#f92672">=</span> t.<span style="color:#a6e22e">match</span>(string);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (token <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>                    result.<span style="color:#a6e22e">add</span>(token);
</span></span><span style="display:flex;"><span>                    string <span style="color:#f92672">=</span> string.<span style="color:#a6e22e">substring</span>(token.<span style="color:#a6e22e">getContent</span>().<span style="color:#a6e22e">length</span>(), string.<span style="color:#a6e22e">length</span>());
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> result;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Dazu prüft man jedes Token, ob es auf den aktuellen Anfang des Eingabestroms passt.
Wenn ein Token passt, erzeugt man eine Instanz dieser Token-Klasse und speichert darin
den gematchten Eingabeteil, den man dann vom Eingabestrom entfernt. Danach geht man
in die Schleife und prüft wieder alle Token ... bis irgendwann der Eingabestrom leer
ist und man den gesamten eingelesenen Programmcode in eine dazu passende Folge von
Token umgewandelt hat.</p>
<p><em>Anmerkung</em>: Abgesehen von fehlenden Javadoc etc. hat das obige Code-Beispiel mehrere
Probleme: Man würde im realen Leben nicht mit <code>String</code>, sondern mit einem Zeichenstrom
arbeiten. Außerdem fehlt noch eine Fehlerbehandlung, wenn nämlich keines der Token in
der Liste <code>allToken</code> auf den aktuellen Anfang des Eingabestroms passt.</p>
<h2 id="token-klassen-mit-formatiertem-inhalt">Token-Klassen mit formatiertem Inhalt</h2>
<p>Um den eigenen Tokenizer besser testen zu können, wurde beschlossen, dass jedes Token
seinen Inhalt als formatiertes HTML-Schnipsel zurückliefern soll. Damit kann man dann
alle erkannten Token formatiert ausgeben und erhält eine Art Syntax-Highlighting für
den eingelesenen Programmcode.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Token</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> String content;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">protected</span> String <span style="color:#a6e22e">getHtml</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">KeyWord</span> <span style="color:#66d9ef">extends</span> Token {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> String <span style="color:#a6e22e">getHtml</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&lt;font color=\&#34;red\&#34;&gt;&lt;b&gt;&#34;</span> <span style="color:#f92672">+</span>  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">content</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&lt;/b&gt;&lt;/font&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StringContent</span> <span style="color:#66d9ef">extends</span> Token {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> String <span style="color:#a6e22e">getHtml</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&lt;font color=\&#34;green\&#34;&gt;&#34;</span> <span style="color:#f92672">+</span>  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">content</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;&lt;/font&gt;&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Token t <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> KeyWord();
</span></span><span style="display:flex;"><span>LOG.<span style="color:#a6e22e">info</span>(t.<span style="color:#a6e22e">getHtml</span>());</span></span></code></pre></div>
<p>In der ersten Umsetzung erhält die Basisklasse <code>Token</code> eine weitere abstrakte
Methode, die jede Token-Klasse implementieren muss und in der die Token-Klassen
einen String mit dem Token-Inhalt und einer Formatierung für HTML zurückgeben.</p>
<p>Dabei fällt auf, dass der Aufbau immer gleich ist: Es werden ein oder mehrere
Tags zum Start der Format-Sequenz mit dem Token-Inhalt verbunden, gefolgt mit
einem zum verwendeten startenden HTML-Format-Tag passenden End-Tag.</p>
<p>Auch wenn die Inhalte unterschiedlich sind, sieht das stark nach einer Verletzung
von DRY aus ...</p>
<h2 id="dont-call-us-well-call-you">Don't call us, we'll call you</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Token</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> String content;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> String <span style="color:#a6e22e">getHtml</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> htmlStart() <span style="color:#f92672">+</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">content</span> <span style="color:#f92672">+</span> htmlEnd();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">protected</span> String <span style="color:#a6e22e">htmlStart</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">protected</span> String <span style="color:#a6e22e">htmlEnd</span>();
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">KeyWord</span> <span style="color:#66d9ef">extends</span> Token {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">protected</span> String <span style="color:#a6e22e">htmlStart</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&lt;font color=\&#34;red\&#34;&gt;&lt;b&gt;&#34;</span>; }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">protected</span> String <span style="color:#a6e22e">htmlEnd</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&lt;/b&gt;&lt;/font&gt;&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">StringContent</span> <span style="color:#66d9ef">extends</span> Token {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">protected</span> String <span style="color:#a6e22e">htmlStart</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&lt;font color=\&#34;green\&#34;&gt;&#34;</span>; }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#66d9ef">protected</span> String <span style="color:#a6e22e">htmlEnd</span>() { <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&lt;/font&gt;&#34;</span>; }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Token t <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> KeyWord();
</span></span><span style="display:flex;"><span>LOG.<span style="color:#a6e22e">info</span>(t.<span style="color:#a6e22e">getHtml</span>());</span></span></code></pre></div>
<p>Wir können den Spaß einfach umdrehen (<a href="https://en.wikipedia.org/wiki/Inversion_of_control" rel="external" target="_blank">&quot;inversion of control&quot;</a>)
und die Methode zum Zusammenbasteln des HTML-Strings bereits in der Basisklasse
implementieren. Dazu &quot;rufen&quot; wir dort drei Hilfsmethoden auf, die die jeweiligen
Bestandteile des Strings (Format-Start, Inhalt, Format-Ende) erzeugen und deren
konkrete Implementierung wir in der Basisklasse nicht kennen. Dies ist dann Sache
der ableitenden konkreten Token-Klassen.</p>
<p>Objekte vom Typ <code>KeyWord</code> sind dank der Vererbungsbeziehung auch <code>Token</code> (Vererbung:
<em>is-a-Beziehung</em>). Wenn man nun auf einem <code>Token t</code> die Methode <code>getHtml()</code> aufruft,
wird zur Laufzeit geprüft, welchen Typ <code>t</code> tatsächlich hat (im Beispiel <code>KeyWord</code>).
Methodenaufrufe werden dann mit den am tiefsten in der vorliegenden Vererbungshierarchie
implementierten Methoden durchgeführt: Hier wird also die von <code>Token</code> geerbte Methode
<code>getHtml()</code> in <code>KeyWord</code> aufgerufen, die ihrerseits die Methoden <code>htmlStart()</code> und
<code>htmlEnd()</code> aufruft. Diese sind in <code>KeyWord</code> implementiert und liefern nun die passenden
Ergebnisse.</p>
<p>Die Methode <code>getHtml()</code> wird auch als &quot;<em>Template-Methode</em>&quot; bezeichnet. Die beiden darin
aufgerufenen Methoden <code>htmlStart()</code> und <code>htmlEnd()</code> in <code>Token</code> werden auch als &quot;Hilfsmethoden&quot;
(oder &quot;<em>Helper Methods</em>&quot;) bezeichnet.</p>
<p>Dies ist ein Beispiel für das <strong><a href="https://en.wikipedia.org/wiki/Template_method_pattern" rel="external" target="_blank">Template-Method-Pattern</a></strong>.</p>
<h2 id="template-method-pattern">Template-Method-Pattern</h2>
<p><a href="#R-image-4ed5b36e05c41a6198a740bf7728aba3" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/template-method/template-method.png?width=50%25&height=auto" style=" height: auto; width: 50%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-4ed5b36e05c41a6198a740bf7728aba3"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/template-method/template-method.png?width=50%25&height=auto"></a></p>
<h3 id="aufbau-template-method-pattern">Aufbau Template-Method-Pattern</h3>
<p>In der Basisklasse implementiert man eine Template-Methode (in der Skizze <code>templateMethod</code>),
die sich auf anderen in der Basisklasse deklarierten (Hilfs-) Methoden &quot;abstützt&quot; (diese also
aufruft; in der Skizze <code>method1</code>, <code>method2</code>, <code>method3</code>). Diese Hilfsmethoden können als
<code>abstract</code> markiert werden und müssen dann von den ableitenden Klassen implementiert werden
(in der Skizze <code>method1</code> und <code>method2</code>). Man kann aber auch einige/alle dieser aufgerufenen
Hilfsmethoden in der Basisklasse implementieren (beispielsweise mit einem leeren Body - sogenannte
&quot;Hook&quot;-Methoden) und die ableitenden Klassen <em>können</em> dann diese Methoden überschreiben und das
Verhalten so neu formulieren (in der Skizze <code>method3</code>).</p>
<p>Damit werden Teile des Verhaltens an die ableitenden Klassen ausgelagert.</p>
<h3 id="verwandtschaft-zum-strategy-pattern">Verwandtschaft zum Strategy-Pattern</h3>
<p>Das Template-Method-Pattern hat eine starke Verwandtschaft zum Strategy-Pattern.</p>
<p>Im Strategy-Pattern haben wir Verhalten komplett an andere Objekte <em>delegiert</em>, indem wir in
einer Methode einfach die passende Methode auf dem übergebenen Strategie-Objekt aufgerufen haben.</p>
<p>Im Template-Method-Pattern nutzen wir statt Delegation die Mechanismen Vererbung und dynamische
Polymorphie und definieren in der Basis-Klasse abstrakte oder Hook-Methoden, die wir bereits in
der Template-Methode der Basis-Klasse aufrufen. Damit ist das grobe Verhalten in der Basis-Klasse
festgelegt, wird aber in den ableitenden Klassen durch das dortige Definieren oder Überschreiben
der Hilfsmethoden verfeinert. Zur Laufzeit werden dann durch die dynamische Polymorphie die
tatsächlich implementierten Hilfsmethoden in den ableitenden Klassen aufgerufen. Damit lagert man
im Template-Method-Pattern gewissermaßen nur Teile des Verhaltens an die ableitenden Klassen aus.</p>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Template-Method-Pattern: Verhaltensänderung durch Vererbungsbeziehungen</p>
<ul>
<li>Basis-Klasse:
<ul>
<li>Template-Methode, die Verhalten definiert und Hilfsmethoden aufruft</li>
<li>Hilfsmethoden: Abstrakte Methoden (oder &quot;Hook&quot;: Basis-Implementierung)</li>
</ul>
</li>
<li>Ableitende Klassen: Verfeinern Verhalten durch Implementieren der Hilfsmethoden</li>
<li>Zur Laufzeit: Dynamische Polymorphie: Aufruf der Template-Methode nutzt
die im tatsächlichen Typ des Objekts implementierten Hilfsmethoden</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106538&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Template-Method-Pattern (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Schreiben Sie eine abstrakte Klasse Drucker. Implementieren Sie die Funktion
<code>kopieren</code>, bei der zuerst die Funktion <code>scannen</code> und dann die Funktion <code>drucken</code>
aufgerufen wird. Der Kopiervorgang ist für alle Druckertypen identisch,
das Scannen und Drucken ist abhängig vom Druckertyp.</p>
<p>Implementieren Sie zusätzlich zwei unterschiedliche Druckertypen:</p>
<ul>
<li><code>Tintendrucker extends Drucker</code>
<ul>
<li><code>Tintendrucker#drucken</code> loggt den Text &quot;Drucke das Dokument auf dem Tintendrucker.&quot;</li>
<li><code>Tintendrucker#scannen</code> loggt den Text &quot;Scanne das Dokument mit dem Tintendrucker.&quot;</li>
</ul>
</li>
<li><code>Laserdrucker extends Drucker</code>
<ul>
<li><code>Laserdrucker#drucken</code> loggt den Text &quot;Drucke das Dokument auf dem Laserdrucker.&quot;</li>
<li><code>Laserdrucker#scannen</code> loggt den Text &quot;Scanne das Dokument mit dem Laserdrucker.&quot;</li>
</ul>
</li>
</ul>
<p>Nutzen Sie das Template-Method-Pattern.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Eilebrecht2013'>[Eilebrecht2013] <strong>Patterns kompakt</strong><br>Eilebrecht, K. und Starke, G., Springer, 2013. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-6423-4718-4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-6423-4718-4</a>.</li> <li id='id_Gamma2011'>[Gamma2011] <strong>Design Patterns</strong><br>Gamma, E. und Helm, R. und Johnson, R. E. und Vlissides, J., Addison-Wesley, 2011. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-2016-3361-0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-2016-3361-0</a>.</li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Command-Pattern</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Das <strong>Command-Pattern</strong> ist die objektorientierte Antwort auf Callback-Funktionen: Man
kapselt Befehle in einem Objekt.</p>
<ol>
<li>
<p>Die <code>Command</code>-Objekte haben eine Methode <code>execute()</code> und führen dabei Aktion auf einem
bzw. &quot;ihrem&quot; Receiver aus.</p>
</li>
<li>
<p><code>Receiver</code> sind Objekte, auf denen Aktionen ausgeführt werden, im Dungeon könnten dies
etwa Hero, Monster, ... sein. Receiver müssen keine der anderen Akteure in diesem Pattern
kennen.</p>
</li>
<li>
<p>Damit die <code>Command</code>-Objekte aufgerufen werden, gibt es einen <code>Invoker</code>, der
<code>Command</code>-Objekte hat und zu gegebener Zeit auf diesen die Methode <code>execute()</code> aufruft.
Der Invoker muss dabei die konkreten Kommandos und die Receiver nicht kennen (nur die
<code>Command</code>-Schnittstelle).</p>
</li>
<li>
<p>Zusätzlich gibt es einen <code>Client</code>, der die anderen Akteure kennt und alles zusammen baut.</p>
</li>
</ol>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/F7RJ7YCVMS4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Command-Pattern</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/a0484bfdc0f388075a01b88f20bde97709aae4d4fe34d517e0889407b2d7b095b9b781856870f21d638e4ed4bf35b534717f5bac227ecc17ea4b6e0a195248b9' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Command-Pattern</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Aufbau des Command-Patterns</li> <li>(K3) Anwendung des Command-Patterns auf konkrete Beispiele, etwa den PM-Dungeon</li></ul>
  </div>
</div>




    <h2 id="motivation">Motivation</h2>
<p>Irgendwo im Dungeon wird es ein Objekt einer Klasse ähnlich wie <code>InputHandler</code>
geben mit einer Methode ähnlich zu <code>handleInput()</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InputHandler</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">handleInput</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">switch</span> (keyPressed()) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> BUTTON_W <span style="color:#f92672">-&gt;</span> hero.<span style="color:#a6e22e">jump</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> BUTTON_A <span style="color:#f92672">-&gt;</span> hero.<span style="color:#a6e22e">moveX</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> ...
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">default</span> <span style="color:#f92672">-&gt;</span> { ... }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Diese Methode wird je Frame einmal aufgerufen, um auf eventuelle Benutzereingaben
reagieren zu können. Je nach gedrücktem Button wird auf dem Hero eine bestimmte
Aktion ausgeführt ...</p>
<p>Das funktioniert, ist aber recht unflexibel. Die Aktionen sind den Buttons fest
zugeordnet und erlauben keinerlei Konfiguration.</p>
<h2 id="auflösen-der-starren-zuordnung-über-zwischenobjekte">Auflösen der starren Zuordnung über Zwischenobjekte</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Command</span> { <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">execute</span>(); }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jump</span> <span style="color:#66d9ef">implements</span> Command {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Entity e;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">execute</span>() { e.<span style="color:#a6e22e">jump</span>(); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InputHandler</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Command wbutton <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Jump(hero);  <span style="color:#75715e">// Über Ctor/Methoden setzen!</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Command abutton <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Move(hero);  <span style="color:#75715e">// Über Ctor/Methoden setzen!</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">handleInput</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">switch</span> (keyPressed()) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> BUTTON_W <span style="color:#f92672">-&gt;</span> wbutton.<span style="color:#a6e22e">execute</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> BUTTON_A <span style="color:#f92672">-&gt;</span> abutton.<span style="color:#a6e22e">execute</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> ...
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">default</span> <span style="color:#f92672">-&gt;</span> { ... }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Die starre Zuordnung &quot;Button : Aktion&quot; wird aufgelöst und über Zwischenobjekte konfigurierbar
gemacht.</p>
<p>Für die Zwischenobjekte wird ein Typ <code>Command</code> eingeführt, der nur eine <code>execute()</code>-Methode
hat. Für jede gewünschte Aktion wird eine Klasse davon abgeleitet, diese Klassen können auch
einen Zustand pflegen.</p>
<p>Den Buttons wird nun an geeigneter Stelle (Konstruktor, Methoden, ...) je ein Objekt der
jeweiligen Command-Unterklassen zugeordnet. Wenn ein Button betätigt wird, wird auf dem
Objekt die Methode <code>execute()</code> aufgerufen.</p>
<p>Damit die Kommandos nicht nur auf den Helden wirken können, kann man den Kommando-Objekten
beispielsweise noch eine Entität mitgeben, auf der das Kommando ausgeführt werden soll. Im
Beispiel oben wurde dafür der <code>hero</code> genutzt.</p>
<h2 id="command-objektorientierte-antwort-auf-callback-funktionen">Command: Objektorientierte Antwort auf Callback-Funktionen</h2>
<p><a href="#R-image-a5cf537abe81da12e58e29fbc95b613b" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/command/command.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-a5cf537abe81da12e58e29fbc95b613b"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/pattern/command/command.png?width=80%25&height=auto"></a></p>
<p>Im Command-Pattern gibt es vier beteiligte Parteien: Client, Receiver, Command und Invoker.</p>
<p>Ein Command ist die objektorientierte Abstraktion eines Befehls. Es hat möglicherweise
einen Zustand, und und kennt &quot;seinen&quot; Receiver und kann beim Aufruf der <code>execute()</code>-Methode
eine vorher verabredete Methode auf diesem Receiver-Objekt ausführen.</p>
<p>Ein Receiver ist eine Klasse, die Aktionen durchführen kann. Sie kennt die anderen Akteure
nicht.</p>
<p>Der Invoker (manchmal auch &quot;Caller&quot; genannt) ist eine Klasse, die Commands aggregiert und die
die Commandos &quot;ausführt&quot;, indem hier die <code>execute()</code>-Methode aufgerufen wird. Diese Klasse
kennt nur das <code>Command</code>-Interface und keine spezifischen Kommandos (also keine der Sub-Klassen).
Es kann zusätzlich eine gewisse Buchführung übernehmen, etwa um eine Undo-Funktionalität zu
realisieren.</p>
<p>Der Client ist ein Programmteil, der ein Command-Objekt aufbaut und dabei einen passenden
Receiver übergibt und der das Command-Objekt dann zum Aufruf an den Invoker weiterreicht.</p>
<p>In unserem Beispiel lassen sich die einzelnen Teile so sortieren:</p>
<ul>
<li>Client: Klasse <code>InputHandler</code> (erzeugt neue <code>Command</code>-Objekte im obigen Code) bzw. <code>main()</code>,
wenn man die <code>Command</code>-Objekte dort erstellt und an den Konstruktor von <code>InputHandler</code>
weiterreicht</li>
<li>Receiver: Objekt <code>hero</code> der Klasse <code>Hero</code> (auf diesem wird eine Aktion ausgeführt)</li>
<li>Command: <code>Jump</code> und <code>Move</code></li>
<li>Invoker: <code>InputHandler</code> (in der Methode <code>handleInput()</code>)</li>
</ul>
<h2 id="undo">Undo</h2>
<p>Wir könnten das <code>Command</code>-Interface um ein paar Methoden erweitern:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Command</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">execute</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">undo</span>();
</span></span><span style="display:flex;"><span>    Command <span style="color:#a6e22e">newCommand</span>(Entity e);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Jetzt kann jedes Command-Objekt eine neue Instanz erzeugen mit der
Entity, die dann dieses Kommando empfangen soll:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Move</span> <span style="color:#66d9ef">implements</span> Command {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> Entity e;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> x, y, oldX, oldY;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">execute</span>() { oldX <span style="color:#f92672">=</span> e.<span style="color:#a6e22e">getX</span>();  oldY <span style="color:#f92672">=</span> e.<span style="color:#a6e22e">getY</span>();  x <span style="color:#f92672">=</span> oldX <span style="color:#f92672">+</span> 42;  y <span style="color:#f92672">=</span> oldY;  e.<span style="color:#a6e22e">moveTo</span>(x, y); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">undo</span>() { e.<span style="color:#a6e22e">moveTo</span>(oldX, oldY); }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> Command <span style="color:#a6e22e">newCommand</span>(Entity e) { <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">new</span> Move(e); }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">InputHandler</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Command wbutton;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Command abutton;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> Stack<span style="color:#f92672">&lt;</span>Command<span style="color:#f92672">&gt;</span> s <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Stack<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">handleInput</span>() {
</span></span><span style="display:flex;"><span>        Entity e <span style="color:#f92672">=</span> getSelectedEntity();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">switch</span> (keyPressed()) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> BUTTON_W <span style="color:#f92672">-&gt;</span> { s.<span style="color:#a6e22e">push</span>(wbutton.<span style="color:#a6e22e">newCommand</span>(e)); s.<span style="color:#a6e22e">peek</span>().<span style="color:#a6e22e">execute</span>(); }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> BUTTON_A <span style="color:#f92672">-&gt;</span> { s.<span style="color:#a6e22e">push</span>(abutton.<span style="color:#a6e22e">newCommand</span>(e)); s.<span style="color:#a6e22e">peek</span>().<span style="color:#a6e22e">execute</span>(); }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> BUTTON_U <span style="color:#f92672">-&gt;</span> s.<span style="color:#a6e22e">pop</span>().<span style="color:#a6e22e">undo</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">case</span> ...
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">default</span> <span style="color:#f92672">-&gt;</span> { ... }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Über den Konstruktor von <code>InputHandler</code> (im Beispiel nicht gezeigt) würde man
wie vorher die <code>Command</code>-Objekte für die Buttons setzen. Es würde aber in jedem
Aufruf von <code>handleInput()</code> abgefragt, was gerade die selektierte Entität ist und
für diese eine neue Instanz des zur Tastatureingabe passenden <code>Command</code>-Objekts
erzeugt. Dieses wird nun in einem Stack gespeichert und danach ausgeführt.</p>
<p>Wenn der Button &quot;U&quot; gedrückt wird, wird das letzte <code>Command</code>-Objekt aus dem
Stack genommen (Achtung: Im echten Leben müsste man erst einmal schauen, ob hier
noch was drin ist!) und auf diesem die Methode <code>undo()</code> aufgerufen. Für das
Kommando <code>Move</code> ist hier skizziert, wie ein Undo aussehen könnte: Man muss einfach
bei jedem <code>execute()</code> die alte Position der Entität speichern, dann kann man
sie bei einem <code>undo()</code> wieder auf diese Position verschieben. Da für jeden Move
ein neues Objekt angelegt wird und dieses nur einmal benutzt wird, braucht man
keine weitere Buchhaltung ...</p>
<h2 id="wrap-up">Wrap-Up</h2>
<p><strong>Command-Pattern</strong>: Kapsele Befehle in ein Objekt</p>
<ul>
<li><code>Command</code>-Objekte haben eine Methode <code>execute()</code> und führen darin Aktion auf Receiver aus</li>
<li><code>Receiver</code> sind Objekte, auf denen Aktionen ausgeführt werden (Hero, Monster, ...)</li>
<li><code>Invoker</code> hat <code>Command</code>-Objekte und ruft darauf <code>execute()</code> auf</li>
<li><code>Client</code> kennt alle und baut alles zusammen</li>
</ul>
<p><strong>Objektorientierte Antwort auf Callback-Funktionen</strong></p>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106532&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Command-Pattern (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Schreiben Sie für den <code>Dwarf</code> in den
<a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/pattern/src/challenges/command" rel="external" target="_blank">Vorgaben</a>
einen Controller, welcher das Command-Pattern verwendet.</p>
<ul>
<li>&quot;W&quot; führt Springen aus</li>
<li>&quot;A&quot; bewegt den Zwerg nach links</li>
<li>&quot;D&quot; bewegt den Zwerg nach rechts</li>
<li>&quot;S&quot; führt Ducken aus</li>
</ul>
<p>Schreiben Sie zusätzlich für den <code>Cursor</code> einen Controller, welcher das Command-Pattern mit Historie
erfüllt (ebenfalls über die Tasten &quot;W&quot;, &quot;A&quot;, &quot;S&quot; und &quot;D&quot;).</p>
<p>Schreiben Sie eine Demo, um die Funktionalität Ihres Programmes zu demonstrieren.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Gamma2011'>[Gamma2011] <strong>Design Patterns</strong><br>Gamma, E. und Helm, R. und Johnson, R. E. und Vlissides, J., Addison-Wesley, 2011. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-2016-3361-0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-2016-3361-0</a>.</li> <li id='id_Nystrom2014'>[Nystrom2014] <a href='https://github.com/munificent/game-programming-patterns' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Game Programming Patterns</strong></a><br>Nystrom, R., Genever Benning, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-9905-8290-8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-9905-8290-8</a>.<br><em>Kap. 2: Command</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
          <article class="default">
            <header class="headline">
            </header>

<h1 id="fortgeschrittene-java-themen-und-umgang-mit-jvm">Fortgeschrittene Java-Themen und Umgang mit JVM</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/java-jvm/serialisation.html">Serialisierung von Objekten und Zuständen</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/java-jvm/regexp.html">Reguläre Ausdrücke</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/java-jvm/enums.html">Aufzählungen (Enumerations)</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/java-jvm/configuration.html">Konfiguration eines Programms</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Fortgeschrittene Java-Themen und Umgang mit JVM</h1>
<article class="default">
<h1>Serialisierung von Objekten und Zuständen</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Objekte lassen sich mit der Methode <code>void writeObject(Object)</code> in <code>ObjectOutputStream</code>
einfach in einen Datenstrom schreiben. Dies kann beispielsweise eine Datei o.ä. sein.
Mit Hilfe von <code>Object readObject()</code> in <code>ObjectInputStream</code> lassen sich Objekte aus dem
Datenstrom auch wieder herstellen. Dies nennt man Serialisierung und De-Serialisierung.</p>
<p>Um Objekte einer Klasse serialisieren zu können, muss diese das leere Interface
<code>Serializable</code> implementieren (&quot;Marker-Interface&quot;). Damit wird quasi die Unterstützung
in <code>Object*Stream</code> freigeschaltet.</p>
<p>Wenn ein Objekt serialisiert wird, werden alle Attribute in den Datenstrom geschrieben,
d.h. die Typen der Attribute müssen ihrerseits serialisierbar sein. Dies gilt für alle
primitiven Typen und die meisten eingebauten Typen. Die Serialisierung erfolgt ggf.
rekursiv, Zirkelreferenzen werden erkannt und aufgebrochen.</p>
<p><code>static</code> und <code>transient</code> Attribute werden nicht serialisiert.</p>
<p>Beim De-Serialisieren wird das neue Objekt von der Laufzeitumgebung aus dem Datenstrom
rekonstruiert. Dies geschieht direkt, es wird kein Konstruktor involviert.</p>
<p>Beim Serialisieren wird für die Klasse des zu schreibenden Objekts eine <code>serialVersionUID</code>
berechnet und mit gespeichert. Beim Einlesen wird dann geprüft, ob die serialisierten
Daten zur aktuellen Version der Klasse passen. Da dies relativ empfindlich gegenüber
Änderungen an einer Klasse ist, wird empfohlen, selbst eine <code>serialVersionUID</code> pro
Klasse zu definieren.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/wnwCMtKpXAQ' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Serialisierung</a></li> <li><a href='https://youtu.be/zpWLPIRPTeQ' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Serialisierung</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/ab8df96555932244456b9ac3dc332fbe39c09029605959af2eea790b5bd5966c5212c9c0184700d6e3785b7af8bdc03e3e6b948bad9392fa01e79309677df68a' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Serialisierung</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Was ist ein Marker-Interface und warum ist dies eine der großen Design-Sünden in Java?</li> <li>(K2) Erklären Sie den Prozess der Serialisierung und De-Serialisierung. Worauf müssen Sie achten?</li> <li>(K3) Serialisierung von Objekten und Programmzuständen</li> <li>(K3) Serialisierung eigener Klassen und Typen</li></ul>
  </div>
</div>




    <h2 id="motivation-persistierung-von-objekten-und-spielzuständen">Motivation: Persistierung von Objekten und Spielzuständen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> credits <span style="color:#f92672">=</span> 42;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hilde&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class='center'>
<p>Wie kann ich Objekte speichern und wieder laden?</p>
</div>
<p>Ich möchte ein Spiel (einen Lauf) im Dungeon abspeichern, um es später fortsetzen
zu können. Wie kann ich den aktuellen Zustand (also Level, Monster, Held, Inventar,
XP/Health/...) so speichern, dass ich später das Spiel nach einem Neustart einfach
fortsetzen kann?</p>
<h2 id="serialisierung-von-objekten">Serialisierung von Objekten</h2>
<ul>
<li>
<p>Klassen müssen Marker-Interface <code>Serializable</code> implementieren</p>
<p>&quot;Marker-Interface&quot;: Interface ohne Methoden. Ändert das Verhalten
des Compilers, wenn eine Klasse dieses Interface implementiert:
Weitere Funktionen werden &quot;freigeschaltet&quot;, beispielsweise die
Fähigkeit, Klone zu erstellen (<code>Cloneable</code>) oder bei <code>Serializable</code>
Objekte serialisierbar zu machen.</p>
<p>Das ist in meinen Augen eine &quot;Design-Sünde&quot; in Java (neben der
Einführung von <code>null</code>): Normalerweise definieren Interfaces eine
Schnittstelle, die eine das Interface implementierende Klasse
dann erfüllen muss. Damit agiert das Interface wie ein Typ. Hier
ist das Interface aber leer, es wird also keine Schnittstelle
definiert. Aber es werden damit stattdessen Tooling-Optionen
aktiviert, was Interfaces vom Konzept her eigentlich nicht machen
sollten/dürften - dazu gibt es Annotationen!</p>
</li>
<li>
<p>Schreiben von Objekten (samt Zustand) in Streams</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>ObjectOutputStream: <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">writeObject</span>(Object)</span></span></code></pre></div>
<p>Die Serialisierung erfolgt dabei für alle Attribute
(außer <code>static</code> und <code>transient</code>, s.u.) rekursiv.</p>
<p>Dabei werden auch Zirkelreferenzen automatisch
aufgelöst/unterbrochen.</p>
</li>
<li>
<p>Lesen und &quot;Wiedererwecken&quot; der Objekte aus Streams</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>ObjectInputStream: Object <span style="color:#a6e22e">readObject</span>()</span></span></code></pre></div>
<p>Dabei erfolgt KEIN Konstruktor-Aufruf!</p>
</li>
</ul>
<h2 id="einfaches-beispiel">Einfaches Beispiel</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> <span style="color:#66d9ef">implements</span> Serializable {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> credits <span style="color:#f92672">=</span> 42;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Hilde&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">writeObject</span>(Studi studi, String filename) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> (FileOutputStream fos <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileOutputStream(filename);
</span></span><span style="display:flex;"><span>            ObjectOutputStream oos <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ObjectOutputStream(fos)) {
</span></span><span style="display:flex;"><span>            oos.<span style="color:#a6e22e">writeObject</span>(studi);    oos.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (IOException ex) {}
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Studi <span style="color:#a6e22e">readObject</span>(String filename) {
</span></span><span style="display:flex;"><span>        Studi studi <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> (FileInputStream fis <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> FileInputStream(filename);
</span></span><span style="display:flex;"><span>            ObjectInputStream ois <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ObjectInputStream(fis)) {
</span></span><span style="display:flex;"><span>            studi <span style="color:#f92672">=</span> (Studi) ois.<span style="color:#a6e22e">readObject</span>();    ois.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (IOException <span style="color:#f92672">|</span> ClassNotFoundException ex) {}
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> studi;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="bedingungen-für-objekt-serialisierung">Bedingungen für Objekt-Serialisierung</h2>
<ul>
<li>Klassen implementieren Marker-Interface <code>Serializable</code></li>
<li>Alle Attribute müssen ebenfalls serialisierbar sein (oder Deklaration &quot;<code>transient</code>&quot;)</li>
<li>Alle primitiven Typen sind per Default serialisierbar</li>
<li>Es wird automatisch rekursiv serialisiert, aber jedes Objekt
nur einmal (bei Mehrfachreferenzierung)</li>
<li>Serialisierbarkeit vererbt sich</li>
</ul>
<h2 id="ausnahmen">Ausnahmen</h2>
<ul>
<li>Als <code>static</code> deklarierte Attribute werden nicht serialisiert</li>
<li>Als <code>transient</code> deklarierte Attribute werden nicht serialisiert</li>
<li>Nicht serialisierbare Attribut-Typen führen zu <code>NotSerializableException</code></li>
</ul>
<h2 id="version-uid">Version-UID</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">long</span> serialVersionUID <span style="color:#f92672">=</span> 42L;</span></span></code></pre></div>
<ul>
<li>Dient zum Vergleich der serialisierten Version und der aktuellen Klasse</li>
<li>Über IDE generieren oder manuell vergeben</li>
<li>Wenn das Attribut fehlt, wird eine Art Checksumme von der Runtime-Umgebung
berechnet (basierend auf diversen Eigenschaften der Klasse)</li>
</ul>
<p>Dieser Wert wird beim Einlesen verglichen: Das Objekt wird nur dann wieder de-serialisiert,
wenn die <code>serialVersionUID</code> mit der einzulesenden Klasse übereinstimmt!</p>
<p>Bei automatischer Berechnung der <code>serialVersionUID</code> durch die JVM kann jede kleine Änderung an
der Klasse (beispielsweise Refactoring: Änderung der Methodennamen) eine neue <code>serialVersionUID</code>
zur Folge haben. Das würde bedeuten, dass bereits serialisierte Objekte nicht mehr eingelesen
werden können, auch wenn sich nur Methoden o.ä. verändert haben und die Attribute noch so vorhanden
sind. Deshalb bietet es sich an, hier selbst eine <code>serialVersionUID</code> zu definieren - dann muss
man aber auch selbst darauf achten, diese zu verändern, wenn sich wesentliche strukturelle
Änderungen an der Klasse ergeben!</p>
<h2 id="bemerkungen">Bemerkungen</h2>
<p>Es existieren diverse weitere Fallstricke und Probleme, siehe <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/java-jvm/serialisation.html#id_Bloch2018">[Bloch2018]</a> Kapitel 11 &quot;Serialization&quot;.</p>
<p>Man kann in den <code>ObjectOutputStream</code> nicht nur ein Objekt schreiben, sondern mehrere Objekte und
Variablen schreiben lassen. In dieser Reihenfolge muss man diese dann aber auch wieder aus dem
Stream herauslesen (vgl. <a href="https://docs.oracle.com/javase/tutorial/essential/io/objectstreams.html" rel="external" target="_blank">Object Streams</a>).</p>
<p>Man kann die zu serialisierenden Attribute mit der Annotation <code>@Serial</code> markieren. Dies ist in
der Wirkung ähnlich zu <code>@Override</code>: Der Compiler prüft dann, ob die markierten Attribute wirklich
serialisierbar sind und würde sonst zur Compile-Zeit einen Fehler werfen.</p>
<p>Weitere Links:</p>
<ul>
<li>Tutorials:
<ul>
<li><a href="https://docs.oracle.com/en/java/javase/17/docs/specs/serialization/input.html" rel="external" target="_blank">https://docs.oracle.com/en/java/javase/17/docs/specs/serialization/input.html</a></li>
<li><a href="https://www.baeldung.com/java-serialization" rel="external" target="_blank">https://www.baeldung.com/java-serialization</a></li>
</ul>
</li>
<li>API:
<ul>
<li><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/ObjectOutputStream.html" rel="external" target="_blank">https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/ObjectOutputStream.html</a></li>
<li><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/ObjectInputStream.html" rel="external" target="_blank">https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/ObjectInputStream.html</a></li>
<li><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/Serializable.html" rel="external" target="_blank">https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/Serializable.html</a></li>
</ul>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/src/serial/SerializableStudi.java" target="_blank"><span class="title">Demo: serial.SerializableStudi</span></a></span></div>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Markerinterface <code>Serializable</code> schaltet Serialisierbarkeit frei</p>
</li>
<li>
<p>Objekte schreiben: <code>ObjectOutputStream</code>: <code>void writeObject(Object)</code></p>
</li>
<li>
<p>Objekte lesen: <code>ObjectInputStream</code>: <code>Object readObject()</code></p>
</li>
<li>
<p>Wichtigste Eigenschaften:</p>
<ul>
<li>Attribute müssen serialisierbar sein</li>
<li><code>transient</code> und <code>static</code> Attribute werden nicht serialisiert</li>
<li>De-Serialisierung: KEIN Konstruktor-Aufruf!</li>
<li>Serialisierbarkeit vererbt sich</li>
<li>Objekt-Referenz-Graph wird automatisch beachtet</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106519&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Serialisierung (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Implementieren Sie die beiden Klassen entsprechend dem UML-Diagram:</p>
<p><a href="#R-image-d83d84bb34c57aba5f3f125f7186a043" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/images/uml_serialisierung.png?raw=true?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-d83d84bb34c57aba5f3f125f7186a043"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/images/uml_serialisierung.png?raw=true?width=auto&height=auto"></a></p>
<p>Objekte vom Typ <code>Person</code> sowie <code>Address</code> sollen serialisierbar sein (vgl. Vorlesung).
Dabei soll das Passwort nicht serialisiert bzw. gespeichert werden, alle anderen
Eigenschaften von <code>Person</code> sollen serialisierbar sein.</p>
<p><em>Hinweis</em>: Verwenden Sie zur Umsetzung <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/io/Serializable.html" rel="external" target="_blank">java.io.Serializable</a>.</p>
<p>Erstellen Sie in Ihrem <code>main()</code> einige Instanzen von Person und speichern Sie diese in
serialisierter Form und laden (deserialisieren) Sie diese anschließend in neue Variablen.</p>
<p>Betrachten Sie die ursprünglichen und die wieder deserialisierten Objekte mit Hilfe des
Debuggers. Alternativ können Sie die Objekte auch in übersichtlicher Form über den Logger
ausgeben.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Bloch2018'>[Bloch2018] <strong>Effective Java</strong><br>Bloch, J., Addison-Wesley, 2018. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-0-13-468599-1' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-0-13-468599-1</a>.</li> <li id='id_Java-SE-Tutorial'>[Java-SE-Tutorial] <a href='https://docs.oracle.com/javase/tutorial/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>The Java Tutorials</strong></a><br>Oracle Corporation, 2022.<br><em>Essential Java Classes \> Basic I/O \> Object Streams</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Reguläre Ausdrücke</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Mit Hilfe von regulären Ausdrücken kann man den Aufbau von Zeichenketten formal
beschreiben. Dabei lassen sich direkt die gewünschten Zeichen einsetzen, oder
man nutzt Zeichenklassen oder vordefinierte Ausdrücke. Teilausdrücke lassen sich
gruppieren und über <em>Quantifier</em> kann definiert werden, wie oft ein Teilausdruck
vorkommen soll. Die Quantifier sind per Default <strong>greedy</strong> und versuchen so viel
wie möglich zu matchen.</p>
<p>Auf der Java-Seite stellt man reguläre Ausdrücke zunächst als <code>String</code> dar. Dabei
muss darauf geachtet werden, dass ein Backslash im regulären Ausdruck im Java-String
geschützt (<em>escaped</em>) werden muss, indem jeweils ein weiterer Backslash voran gestellt
wird. Mit Hilfe der Klasse <code>java.util.regex.Pattern</code> lässt sich daraus ein Objekt
mit dem kompilierten regulären Ausdruck erzeugen, was insbesondere bei mehrfacher
Verwendung günstiger in der Laufzeit ist. Dem Pattern-Objekt kann man dann den
Suchstring übergeben und bekommt ein Objekt der Klasse <code>java.util.regex.Matcher</code>
(dort sind regulärer Ausdruck/Pattern und der Suchstring kombiniert). Mit den
Methoden <code>Matcher#find</code> und <code>Matcher#matches</code> kann dann geprüft werden, ob das Pattern
auf den Suchstring passt: <code>find</code> sucht dabei nach dem ersten Vorkommen des Patterns
im Suchstring, <code>match</code> prüft, ob der gesamte String zum Pattern passt.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/K9R1Bwa73uI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL RegExp</a></li> <li><a href='https://youtu.be/j_pTZBI6Z3M' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo StringSplit</a></li> <li><a href='https://youtu.be/LYlPL1C_au8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo MatchFind</a></li> <li><a href='https://youtu.be/xkD9PhCjXyY' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Quantifier</a></li> <li><a href='https://youtu.be/ANLB2MdC_uY' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Groups</a></li> <li><a href='https://youtu.be/SRZyT3EAB94' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Backref</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/35288af40bdf53fe210d0f8c4d25fd38d4c5f4cde5c04ffd49500f815723448b0bc16b305c7b05b0d57d670019d52dd5ff9da5f4a43afc0c85ed870b44f93e00' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL RegExp</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K1) Wichtigste Methoden von <code>java.util.regex.Pattern</code> und <code>java.util.regex.Matcher</code></li> <li>(K2) Unterschied zwischen <code>Matcher#find</code> und <code>Matcher#matches</code></li> <li>(K2) Unterscheidung zwischen greedy und non-greedy Verhalten</li> <li>(K3) Bildung einfacher regulärer Ausdrücke</li> <li>(K3) Nutzung von Zeichenklassen und deren Negation</li> <li>(K3) Nutzung der vordefinierten regulären Ausdrücke</li> <li>(K3) Nutzung von Quantifizierern</li> <li>(K3) Zusammenbauen von komplexen Ausdrücken (u.a. mit Gruppen)</li></ul>
  </div>
</div>




    <h2 id="suchen-in-strings">Suchen in Strings</h2>
<p>Gesucht ist ein Programm zum Extrahieren von Telefonnummern aus E-Mails.</p>
<p>=&gt; <span class='alert'><strong>Wie geht das?</strong></span></p>
<p>Leider gibt es unzählig viele Varianten, wie man eine Telefonnummer (samt
Vorwahl und ggf. Ländervorwahl) aufschreiben kann:</p>
<pre><code>030 - 123 456 789, 030-123456789, 030/123456789,
+49(30)123456-789, +49 (30) 123 456 - 789, ...
</code></pre>
<h2 id="definition-regulärer-ausdruck">Definition Regulärer Ausdruck</h2>
<blockquote>
<p>Ein <strong>regulärer Ausdruck</strong> ist eine Zeichenkette, die zur Beschreibung von
Zeichenketten dient.</p>
</blockquote>
<h3 id="anwendungen">Anwendungen</h3>
<ul>
<li>Finden von Bestandteilen in Zeichenketten</li>
<li>Aufteilen von Strings in Tokens</li>
<li>Validierung von textuellen Eingaben
=&gt; &quot;Eine Postleitzahl besteht aus 5 Ziffern&quot;</li>
<li>Compilerbau: Erkennen von Schlüsselwörtern und Strukturen und Syntaxfehlern</li>
</ul>
<h2 id="einfachste-reguläre-ausdrücke">Einfachste reguläre Ausdrücke</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>Zeichenkette</strong></th>
          <th style="text-align: left"><strong>Beschreibt</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>x</code></td>
          <td style="text-align: left">&quot;x&quot;</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>.</code></td>
          <td style="text-align: left">ein beliebiges Zeichen</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>\t</code></td>
          <td style="text-align: left">Tabulator</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>\n</code></td>
          <td style="text-align: left">Newline</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>\r</code></td>
          <td style="text-align: left">Carriage-return</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>\\</code></td>
          <td style="text-align: left">Backslash</td>
      </tr>
  </tbody>
</table>
<h3 id="beispiel">Beispiel</h3>
<ul>
<li><code>abc</code> =&gt; &quot;abc&quot;</li>
<li><code>A.B</code> =&gt; &quot;AAB&quot; oder &quot;A2B&quot; oder ...</li>
<li><code>a\\bc</code> =&gt; &quot;a\bc&quot;</li>
</ul>
<h3 id="anmerkung">Anmerkung</h3>
<p>In Java-Strings leitet der Backslash eine zu interpretierende Befehlssequenz ein.
Deshalb muss der Backslash i.d.R. geschützt (&quot;escaped&quot;) werden.
=&gt; Statt &quot;<code>\n</code>&quot; müssen Sie im Java-Code &quot;<code>\\n</code>&quot; schreiben!</p>
<h2 id="zeichenklassen">Zeichenklassen</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>Zeichenkette</strong></th>
          <th style="text-align: left"><strong>Beschreibt</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>[abc]</code></td>
          <td style="text-align: left">&quot;a&quot; oder &quot;b&quot; oder &quot;c&quot;</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>[^abc]</code></td>
          <td style="text-align: left">alles außer &quot;a&quot;, &quot;b&quot; oder &quot;c&quot; (Negation)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>[a-zA-Z]</code></td>
          <td style="text-align: left">alle Zeichen von &quot;a&quot; bis &quot;z&quot; und &quot;A&quot; bis &quot;Z&quot; (Range)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>[a-z&amp;&amp;[def]]</code></td>
          <td style="text-align: left">&quot;d&quot;,&quot;e&quot; oder &quot;f&quot; (Schnitt)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>[a-z&amp;&amp;[^bc]]</code></td>
          <td style="text-align: left">&quot;a&quot; bis &quot;z&quot;, außer &quot;b&quot; und &quot;c&quot;: <code>[ad-z]</code> (Subtraktion)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>[a-z&amp;&amp;[^m-p]]</code></td>
          <td style="text-align: left">&quot;a&quot; bis &quot;z&quot;, außer &quot;m&quot; bis &quot;p&quot;: <code>[a-lq-z]</code> (Subtraktion)</td>
      </tr>
  </tbody>
</table>
<h3 id="beispiel-1">Beispiel</h3>
<ul>
<li><code>[abc]</code> =&gt; &quot;a&quot; oder &quot;b&quot; oder &quot;c&quot;</li>
<li><code>[a-c]</code> =&gt; &quot;a&quot; oder &quot;b&quot; oder &quot;c&quot;</li>
<li><code>[a-c][a-c]</code> =&gt; &quot;aa&quot;, &quot;ab&quot;, &quot;ac&quot;, &quot;ba&quot;, &quot;bb&quot;, &quot;bc&quot;, &quot;ca&quot;, &quot;cb&quot; oder &quot;cc&quot;</li>
<li><code>A[a-c]</code> =&gt; &quot;Aa&quot;, &quot;Ab&quot; oder &quot;Ac&quot;</li>
</ul>
<h2 id="vordefinierte-ausdrücke">Vordefinierte Ausdrücke</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>Zeichenkette</strong></th>
          <th style="text-align: left"><strong>Beschreibt</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>^</code></td>
          <td style="text-align: left">Zeilenanfang</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>$</code></td>
          <td style="text-align: left">Zeilenende</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>\d</code></td>
          <td style="text-align: left">eine Ziffer: <code>[0-9]</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>\w</code></td>
          <td style="text-align: left">beliebiges Wortzeichen: <code>[a-zA-Z_0-9]</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>\s</code></td>
          <td style="text-align: left">Whitespace (Leerzeichen, Tabulator, Newline)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>\D</code></td>
          <td style="text-align: left">jedes Zeichen außer Ziffern: <code>[^0-9]</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>\W</code></td>
          <td style="text-align: left">jedes Zeichen außer Wortzeichen: <code>[^\w]</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>\S</code></td>
          <td style="text-align: left">jedes Zeichen außer Whitespaces: <code>[^\s]</code></td>
      </tr>
  </tbody>
</table>
<h3 id="beispiel-2">Beispiel</h3>
<ul>
<li><code>\d\d\d\d\d</code> =&gt; &quot;12345&quot;</li>
<li><code>\w\wA</code> =&gt; &quot;aaA&quot;, &quot;a0A&quot;, &quot;a_A&quot;, ...</li>
</ul>
<h2 id="nutzung-in-java">Nutzung in Java</h2>
<ul>
<li>
<p><code>java.lang.String</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> String<span style="color:#f92672">[]</span> <span style="color:#a6e22e">split</span>(String regex)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span>(String regex)</span></span></code></pre></div>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/src/regexp/StringSplit.java" target="_blank"><span class="title">Demo: regexp.StringSplit</span></a></span></div>
<ul>
<li>
<p><code>java.util.regex.Pattern</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Pattern <span style="color:#a6e22e">compile</span>(String regex)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> Matcher <span style="color:#a6e22e">matcher</span>(CharSequence input)</span></span></code></pre></div>
<ul>
<li>Schritt 1: Ein Pattern compilieren (erzeugen) mit <code>Pattern#compile</code>
=&gt; liefert ein Pattern-Objekt für den regulären Ausdruck zurück</li>
<li>Schritt 2: Dem Pattern-Objekt den zu untersuchenden Zeichenstrom
übergeben mit <code>Pattern#matcher</code> =&gt; liefert ein Matcher-Objekt
zurück, darin gebunden: Pattern (regulärer Ausdruck) und die zu
untersuchende Zeichenkette</li>
</ul>
</li>
<li>
<p><code>java.util.regex.Matcher</code>:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">find</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">matches</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">groupCount</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">group</span>(<span style="color:#66d9ef">int</span> group)</span></span></code></pre></div>
<ul>
<li>
<p>Schritt 3: Mit dem Matcher-Objekt kann man die Ergebnisse der
Anwendung des regulären Ausdrucks auf eine Zeichenkette auswerten</p>
<p>Bedeutung der unterschiedlichen Methoden siehe folgende Folien</p>
<p><code>Matcher#group</code>: Liefert die Sub-Sequenz des Suchstrings zurück, die
erfolgreich gematcht wurde (siehe unten &quot;Fangende Gruppierungen&quot;)</p>
</li>
</ul>
</li>
</ul>
<p><strong>Hinweis</strong>:</p>
<p>In Java-Strings leitet der Backslash eine zu interpretierende Befehlssequenz ein.
Deshalb muss der Backslash i.d.R. extra geschützt (&quot;escaped&quot;) werden.</p>
<p>=&gt; Statt &quot;<code>\n</code>&quot; (regulärer Ausdruck) müssen Sie im Java-String &quot;<code>\\n</code>&quot; schreiben!</p>
<p>=&gt; Statt &quot;<code>a\\bc</code>&quot; (regulärer Ausdruck, passt auf die Zeichenkette &quot;a\bc&quot;) müssen
Sie im Java-String &quot;<code>a\\\\bc</code>&quot; schreiben!</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/src/regexp/MatchFind.java" target="_blank"><span class="title">Demo: regexp.MatchFind</span></a></span></div>
<h2 id="unterschied-zw-finden-und-matchen">Unterschied zw. Finden und Matchen</h2>
<ul>
<li>
<p><code>Matcher#find</code>:</p>
<p>Regulärer Ausdruck muss im Suchstring <strong>enthalten</strong> sein.
=&gt; Suche nach <strong>erstem Vorkommen</strong></p>
</li>
<li>
<p><code>Matcher#matches</code>:</p>
<p>Regulärer Ausdruck muss auf <strong>kompletten</strong> Suchstring passen.</p>
</li>
</ul>
<h3 id="beispiel-3">Beispiel</h3>
<ul>
<li>Regulärer Ausdruck: <code>abc</code>, Suchstring: &quot;blah blah abc blub&quot;
<ul>
<li><code>Matcher#find</code>: erfolgreich</li>
<li><code>Matcher#matches</code>: kein Match - Suchstring entspricht nicht dem Muster</li>
</ul>
</li>
</ul>
<h2 id="quantifizierung">Quantifizierung</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>Zeichenkette</strong></th>
          <th style="text-align: left"><strong>Beschreibt</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>X?</code></td>
          <td style="text-align: left">ein oder kein &quot;X&quot;</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>X*</code></td>
          <td style="text-align: left">beliebig viele &quot;X&quot; (inkl. kein &quot;X&quot;)</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>X+</code></td>
          <td style="text-align: left">mindestens ein &quot;X&quot;, ansonsten beliebig viele &quot;X&quot;</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>X{n}</code></td>
          <td style="text-align: left">exakt <span class="math align-center">$n$</span> Vorkommen von &quot;X&quot;</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>X{n,}</code></td>
          <td style="text-align: left">mindestens <span class="math align-center">$n$</span> Vorkommen von &quot;X&quot;</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>X{n,m}</code></td>
          <td style="text-align: left">zwischen <span class="math align-center">$n$</span> und <span class="math align-center">$m$</span> Vorkommen von &quot;X&quot;</td>
      </tr>
  </tbody>
</table>
<h3 id="beispiel-4">Beispiel</h3>
<ul>
<li><code>\d{5}</code> =&gt; &quot;12345&quot;</li>
<li><code>-?\d+\.\d*</code> =&gt; ???</li>
</ul>
<h2 id="interessante-effekte">Interessante Effekte</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Pattern p <span style="color:#f92672">=</span> Pattern.<span style="color:#a6e22e">compile</span>(<span style="color:#e6db74">&#34;A.*A&#34;</span>);
</span></span><span style="display:flex;"><span>Matcher m <span style="color:#f92672">=</span> p.<span style="color:#a6e22e">matcher</span>(<span style="color:#e6db74">&#34;A 12 A 45 A&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (m.<span style="color:#a6e22e">matches</span>())
</span></span><span style="display:flex;"><span>    String result <span style="color:#f92672">=</span> m.<span style="color:#a6e22e">group</span>(); <span style="color:#f92672">//</span> <span style="color:#f92672">???</span></span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/src/regexp/Quantifier.java" target="_blank"><span class="title">Demo: regexp.Quantifier</span></a></span></div>
<p><code>Matcher#group</code> liefert die Inputsequenz, auf die der Matcher angesprochen hat.
Mit <code>Matcher#start</code> und <code>Matcher#end</code> kann man sich die Indizes des ersten und
letzten Zeichens des Matches im Eingabezeichenstrom geben lassen. D.h. für einen
Matcher <code>m</code> und eine Eingabezeichenkette <code>s</code> ist <code>m.group()</code> und
<code>s.substring(m.start(), m.end())</code> äquivalent.</p>
<p>Da bei <code>Matcher#matches</code> das Pattern immer auf den gesamten Suchstring passen
muss, verwundert das Ergebnis für <code>Matcher#group</code> nicht. Bei <code>Matcher#find</code>
wird im Beispiel allerdings ebenfalls der gesamte Suchstring &quot;gefunden&quot; ...
Dies liegt am &quot;<em>greedy</em>&quot; Verhalten der Quantifizierer.</p>
<h2 id="nicht-gierige-quantifizierung-mit-">Nicht gierige Quantifizierung mit &quot;?&quot;</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>Zeichenkette</strong></th>
          <th style="text-align: left"><strong>Beschreibt</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>X*?</code></td>
          <td style="text-align: left">non-greedy Variante von <code>X*</code></td>
      </tr>
      <tr>
          <td style="text-align: left"><code>X+?</code></td>
          <td style="text-align: left">non-greedy Variante von <code>X+</code></td>
      </tr>
  </tbody>
</table>
<h3 id="beispiel-5">Beispiel</h3>
<ul>
<li>Suchstring &quot;A 12 A 45 A&quot;:
<ul>
<li>
<p><code>A.*A</code> findet/passt auf &quot;A 12 A 45 A&quot;</p>
<p>normale <strong>greedy</strong> Variante</p>
</li>
<li>
<p><code>A.*?A</code></p>
<ul>
<li>findet &quot;A 12 A&quot;</li>
<li>passt auf &quot;A 12 A 45 A&quot; (!)</li>
</ul>
<p><strong>non-greedy</strong> Variante der Quantifizierung;
<code>Matcher#matches</code> muss trotzdem auf den gesamten Suchstring passen!</p>
</li>
</ul>
</li>
</ul>
<h2 id="fangende-gruppierungen">(Fangende) Gruppierungen</h2>
<p><code>Studi{2}</code> passt <span class='alert'>nicht</span> auf &quot;StudiStudi&quot; (!)</p>
<p>Quantifizierung bezieht sich auf das direkt davor stehende Zeichen. Ggf.
Gruppierungen durch Klammern verwenden!</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left"><strong>Zeichenkette</strong></th>
          <th style="text-align: left"><strong>Beschreibt</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left"><code>X|Y</code></td>
          <td style="text-align: left">X oder Y</td>
      </tr>
      <tr>
          <td style="text-align: left"><code>(C)</code></td>
          <td style="text-align: left">Gruppierung</td>
      </tr>
  </tbody>
</table>
<h3 id="beispiel-6">Beispiel</h3>
<ul>
<li><code>(A)(B(C))</code>
<ul>
<li>Gruppe 0: <code>ABC</code></li>
<li>Gruppe 1: <code>A</code></li>
<li>Gruppe 2: <code>BC</code></li>
<li>Gruppe 3: <code>C</code></li>
</ul>
</li>
</ul>
<p>Die Gruppen heißen auch &quot;fangende&quot; Gruppen (engl.: <em>&quot;capturing groups&quot;</em>).</p>
<p>Damit erreicht man eine Segmentierung des gesamten regulären Ausdrucks, der
in seiner Wirkung aber nicht durch die Gruppierungen geändert wird. Durch die
Gruppierungen von Teilen des regulären Ausdrucks erhält man die Möglichkeit,
auf die entsprechenden Teil-Matches (der Unterausdrücke der einzelnen Gruppen)
zuzugreifen:</p>
<ul>
<li>
<p><code>Matcher#groupCount</code>: Anzahl der &quot;fangenden&quot; Gruppen im regulären Ausdruck</p>
</li>
<li>
<p><code>Matcher#group(i)</code>: Liefert die Subsequenz der Eingabezeichenkette zurück,
auf die die jeweilige Gruppe gepasst hat. Dabei wird von links nach rechts
durchgezählt, beginnend bei 1(!).</p>
<p>Konvention: Gruppe 0 ist das gesamte Pattern, d.h. <code>m.group(0) == m.group();</code> ...</p>
</li>
</ul>
<p><em>Hinweis</em>: Damit der Zugriff auf die Gruppen klappt, muss auch erst ein Match gemacht
werden, d.h. das Erzeugen des Matcher-Objekts reicht noch nicht, sondern es muss auch
noch ein <code>matcher.find()</code> oder <code>matcher.matches()</code> ausgeführt werden. Danach kann man
bei Vorliegen eines Matches auf die Gruppen zugreifen.</p>
<p><code>(Studi){2}</code> =&gt; &quot;StudiStudi&quot;</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/src/regexp/Groups.java" target="_blank"><span class="title">Demo: regexp.Groups</span></a></span></div>
<h2 id="gruppen-und-backreferences">Gruppen und Backreferences</h2>
<p>Matche zwei Ziffern, gefolgt von den selben zwei Ziffern</p>
<div class='center'>
<p><code>(\d\d)\1</code></p>
</div>
<ul>
<li>
<p>Verweis auf bereits gematchte Gruppen: <code>\num</code></p>
<p><code>num</code> Nummer der Gruppe (1 ... 9)</p>
<p>=&gt; Verweist nicht auf regulären Ausdruck, sondern auf jeweiligen Match!</p>
<p><em>Anmerkung</em>: Laut Literatur/Doku nur 1 ... 9, in Praxis geht auch mehr per Backreference ...</p>
</li>
<li>
<p>Benennung der Gruppe: <code>(?&lt;name&gt;X)</code></p>
<p><code>X</code> ist regulärer Ausdruck für Gruppe, spitze Klammern wichtig</p>
<p>=&gt; Backreference: <code>\k&lt;name&gt;</code></p>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/src/regexp/Backref.java" target="_blank"><span class="title">Demo: regexp.Backref</span></a></span></div>
<h2 id="beispiel-gruppen-und-backreferences">Beispiel Gruppen und Backreferences</h2>
<p>Regulärer Ausdruck: Namen einer Person matchen, wenn Vor- und Nachname identisch sind.</p>
<p>Lösung: <code>([A-Z][a-zA-Z]*)\s\1</code></p>
<h2 id="umlaute-und-reguläre-ausdrücke">Umlaute und reguläre Ausdrücke</h2>
<ul>
<li>
<p>Keine vordefinierte Abkürzung für Umlaute (wie etwa <code>\d</code>)</p>
</li>
<li>
<p>Umlaute nicht in <code>[a-z]</code> enthalten, aber in <code>[a-ü]</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#e6db74">&#34;helloüA&#34;</span>.<span style="color:#a6e22e">matches</span>(<span style="color:#e6db74">&#34;.*?[ü]A&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;azäöüß&#34;</span>.<span style="color:#a6e22e">matches</span>(<span style="color:#e6db74">&#34;[a-ä]&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;azäöüß&#34;</span>.<span style="color:#a6e22e">matches</span>(<span style="color:#e6db74">&#34;[a-ö]&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;azäöüß&#34;</span>.<span style="color:#a6e22e">matches</span>(<span style="color:#e6db74">&#34;[a-ü]&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;azäöüß&#34;</span>.<span style="color:#a6e22e">matches</span>(<span style="color:#e6db74">&#34;[a-ß]&#34;</span>);</span></span></code></pre></div>
</li>
<li>
<p>Strings sind Unicode-Zeichenketten</p>
<p>=&gt; Nutzung der passenden Unicode Escape Sequence <code>\uFFFF</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;\u0041 :: A&#34;</span>);
</span></span><span style="display:flex;"><span>System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;helloüA&#34;</span>.<span style="color:#a6e22e">matches</span>(<span style="color:#e6db74">&#34;.*?A&#34;</span>));
</span></span><span style="display:flex;"><span>System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;helloüA&#34;</span>.<span style="color:#a6e22e">matches</span>(<span style="color:#e6db74">&#34;.*?\u0041&#34;</span>));
</span></span><span style="display:flex;"><span>System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;helloü\u0041&#34;</span>.<span style="color:#a6e22e">matches</span>(<span style="color:#e6db74">&#34;.*?A&#34;</span>));</span></span></code></pre></div>
</li>
<li>
<p>RegExp vordefinieren und mit Variablen zusammenbauen ala Perl
nicht möglich =&gt; Umweg String-Repräsentation</p>
</li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>RegExp: Zeichenketten, die andere Zeichenketten beschreiben</li>
<li><code>java.util.regex.Pattern</code> und <code>java.util.regex.Matcher</code></li>
<li>Unterschied zwischen <code>Matcher#find</code> und <code>Matcher#matches</code>!</li>
<li>Quantifizierung ist möglich, aber <strong>greedy</strong> (Default)</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106518&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz RegExp (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Schreiben Sie eine Methode, die mit Hilfe von regulären Ausdrücken überprüft, ob der eingegebene String
eine nach dem folgenden Schema gebildete EMail-Adresse ist:</p>
<blockquote>
<p><code>name@firma.domain</code></p>
</blockquote>
<p>Dabei sollen folgende Regeln gelten:</p>
<ul>
<li>Die Bestandteile <code>name</code> und <code>firma</code> können aus Buchstaben, Ziffern, Unter- und Bindestrichen bestehen.</li>
<li>Der Bestandteil <code>name</code> muss mindestens ein Zeichen lang sein.</li>
<li>Der Bestandteil <code>firma</code> kann entfallen, dann entfällt auch der nachfolgende Punkt (<code>.</code>) und der Teil
<code>domain</code> folgt direkt auf das <code>@</code>-Zeichen.</li>
<li>Der Bestandteil <code>domain</code> besteht aus 2 oder 3 Kleinbuchstaben.</li>
</ul>
<p>Hinweis: Sie dürfen keinen Oder-Operator verwenden.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Java-SE-Tutorial'>[Java-SE-Tutorial] <a href='https://docs.oracle.com/javase/tutorial/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>The Java Tutorials</strong></a><br>Oracle Corporation, 2022.<br><em>Essential Java Classes \> Regular Expressions</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Aufzählungen (Enumerations)</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Mit Hilfe von <code>enum</code> lassen sich Aufzählungstypen definieren (der Compiler erzeugt intern
passende Klassen). Dabei wird den Konstanten eine fortlaufende Nummer zugeordnet, auf die
mit <code>ordinal()</code> zugegriffen werden kann. Mit der Methode <code>values()</code> kann über die Konstanten
iteriert werden, und mit <code>name()</code> kann eine Stringrepräsentation einer Konstanten erzeugt
werden. Es sind keine Instanzen von Enum-Klassen erzeugbar, und die Enum-Konstanten sind
implizit <code>final</code> und <code>static</code>.</p>
<p>Es lassen sich auch komplexe Enumerations analog zu Klassendefinition definieren, die eigene
Konstruktoren, Felder und Methoden enthalten.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/qoeT9jVuQZc' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Enumerations</a></li> <li><a href='https://youtu.be/ZCE9AmTluyk' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Enumerations</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/5c9330cb4425a5b33f89b491d007990642765bf0ca7ea9fd6b8b7536f46691b86bba9bde65cdbce308fb467f2d0183391dd0d1247c142e4e28d9b9eaf8c0ff67' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Enumerations</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Vorgänge beim Initialisieren von Enum-Klassen (Hinweis: <code>static</code>)</li> <li>(K3) Erstellung komplexer Enumerationen mit Feldern und Konstruktoren</li> <li>(K3) Nutzung von <code>name()</code>, <code>ordinal()</code> und <code>values()</code> in Enum-Klassen</li></ul>
  </div>
</div>




    <h2 id="motivation">Motivation</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> IFM <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> ELM <span style="color:#f92672">=</span> 1;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> ARC <span style="color:#f92672">=</span> 2;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Studi</span>(String name, <span style="color:#66d9ef">int</span> credits, <span style="color:#66d9ef">int</span> studiengang) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Wert für studiengang muss zwischen 0 und 2 liegen</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Erwünscht: Konstanten nutzen</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>        Studi rainer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Rainer&#34;</span>, 10, Studi.<span style="color:#a6e22e">IFM</span>);
</span></span><span style="display:flex;"><span>        Studi holger <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Holger&#34;</span>, 3, 4);   <span style="color:#75715e">// Laufzeit-Problem!</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p><strong>Probleme</strong>:</p>
<ul>
<li>Keine Typsicherheit</li>
<li>Konstanten gehören zur Klasse <code>Studi</code>, obwohl sie in anderem Kontext
vermutlich auch interessant sind</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/src/enums/v1/Studi.java" target="_blank"><span class="title">Beispiel enums.v1.Studi</span></a></span></div>
<h2 id="verbesserung-einfache-aufzählung">Verbesserung: Einfache Aufzählung</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">enum</span> Fach {
</span></span><span style="display:flex;"><span>    IFM, ELM, ARC
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Studi</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">Studi</span>(String name, <span style="color:#66d9ef">int</span> credits, Fach studiengang) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Typsicherheit für studiengang :-)</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>        Studi rainer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Rainer&#34;</span>, 10, Fach.<span style="color:#a6e22e">IFM</span>);
</span></span><span style="display:flex;"><span>        Studi holger <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Studi(<span style="color:#e6db74">&#34;Holger&#34;</span>, 3, 4);   <span style="color:#75715e">// Syntax-Fehler!</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h2 id="einfache-aufzählungen-eigenschaften">Einfache Aufzählungen: Eigenschaften</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">enum</span> Fach {
</span></span><span style="display:flex;"><span>    IFM, ELM, ARC
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ol>
<li>Enum-Konstanten (<code>IFM</code>, ...) sind implizit <code>static</code> und <code>final</code></li>
<li>Enumerations (<code>Fach</code>) nicht instantiierbar</li>
<li>Enumerations stellen einen neuen Typ dar: hier der Typ <code>Fach</code></li>
<li>Methoden: <code>name()</code>, <code>ordinal()</code>, <code>values()</code>, <code>toString()</code></li>
</ol>
<h3 id="wiederholung-static">Wiederholung <em>static</em></h3>
<p><strong>Attribute</strong>:</p>
<ul>
<li><code>static</code> Attribute sind Eigenschaften/Zustände der <strong>Klasse</strong></li>
<li>Gelten in jedem von der Klasse erzeugten Objekt</li>
<li>Unterschiedliche Lebensdauer:
<ul>
<li>Objektattribute (Instanzvariablen): ab <code>new</code> bis zum Garbage Collector</li>
<li>Statische Variablen: Laufzeitumgebung (JVM) lädt und initialisiert die Klasse
(<code>static</code> Attribute existieren, bis die JVM die Klasse entfernt)</li>
</ul>
</li>
</ul>
<p><strong>Methoden</strong>:</p>
<ul>
<li><code>static</code> deklarierte Methoden sind <strong>Klassenmethoden</strong></li>
<li>Können direkt auf der Klasse aufgerufen werden</li>
<li>Beispiele: <code>Math.max()</code>, <code>Math.sin()</code>, <code>Integer.parseInt()</code></li>
<li><strong>Achtung</strong>: In Klassenmethoden nur Klassenattribute nutzbar (keine Instanzattribute!),
d.h. keine <code>this</code>-Referenz nutzbar</li>
</ul>
<h3 id="wiederholung-final-attributemethodenklassen-nicht-änderbar">Wiederholung <em>final</em>: Attribute/Methoden/Klassen nicht änderbar</h3>
<ul>
<li>
<p>Attribute: <code>final</code> Attribute können nur einmal gesetzt werden</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">foo</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> 2;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> 3;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> k;
</span></span><span style="display:flex;"><span>    i <span style="color:#f92672">=</span> 3;
</span></span><span style="display:flex;"><span>    j <span style="color:#f92672">=</span> 4;  <span style="color:#75715e">// Compilerfehler</span>
</span></span><span style="display:flex;"><span>    k <span style="color:#f92672">=</span> 5;
</span></span><span style="display:flex;"><span>    k <span style="color:#f92672">=</span> 6;  <span style="color:#75715e">// Compilerfehler</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/src/enums/FinalDemo.java" target="_blank"><span class="title">Beispiel enums.FinalDemo</span></a></span></div>
</li>
<li>
<p>Methoden: <code>final</code> deklarierte Methoden können bei Vererbung nicht überschrieben werden</p>
</li>
<li>
<p>Klassen: von <code>final</code> deklarierten Klassen können keine Unterklassen gebildet werden</p>
</li>
</ul>
<h2 id="einfache-aufzählungen-eigenschaften-cnt">Einfache Aufzählungen: Eigenschaften (cnt.)</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Referenzen auf Enum-Objekte können null sein</span>
</span></span><span style="display:flex;"><span>Fach f <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>f <span style="color:#f92672">=</span> Fach.<span style="color:#a6e22e">IFM</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Vergleich mit == möglich</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// equals() unnötig, da Vergleich mit Referenz auf statische Variable</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (f <span style="color:#f92672">==</span> Fach.<span style="color:#a6e22e">IFM</span>) {
</span></span><span style="display:flex;"><span>    System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Richtiges Fach :-)&#34;</span>);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// switch/case</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">switch</span> (f) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">case</span> IFM:   <span style="color:#75715e">// Achtung: *NICHT* Fach.IFM</span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;Richtiges Fach :-)&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">default</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalArgumentException(<span style="color:#e6db74">&#34;FALSCHES FACH: &#34;</span> <span style="color:#f92672">+</span> f);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Außerdem können wir folgende Eigenschaften nutzen (u.a., s.u.):</p>
<ul>
<li>Enumerations haben Methode <code>String toString()</code> für die Konstanten</li>
<li>Enumerations haben Methode <code>final T[] values()</code> für die Iteration über die Konstanten</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/src/enums/v2/Studi.java" target="_blank"><span class="title">Demo: enums.v2.Studi</span></a></span></div>
<h2 id="enum-genauer-betrachtet">Enum: Genauer betrachtet</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">enum</span> Fach {  IFM, ELM, ARC  }</span></span></code></pre></div>
<p><strong>Compiler sieht (<em>in etwa</em>):</strong></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fach</span> <span style="color:#66d9ef">extends</span> Enum {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Fach IFM <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Fach(<span style="color:#e6db74">&#34;IFM&#34;</span>, 0);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Fach ELM <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Fach(<span style="color:#e6db74">&#34;ELM&#34;</span>, 1);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> Fach ARC <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Fach(<span style="color:#e6db74">&#34;ARC&#34;</span>, 2);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">Fach</span>( String s, <span style="color:#66d9ef">int</span> i ) { <span style="color:#66d9ef">super</span>( s, i ); }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>=&gt; <span class='alert'><strong>Singleton-Pattern</strong></span> für Konstanten</p>
<h2 id="enum-klassen-eigenschaften">Enum-Klassen: Eigenschaften</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">enum</span> Fach {
</span></span><span style="display:flex;"><span>    IFM,
</span></span><span style="display:flex;"><span>    ELM(<span style="color:#e6db74">&#34;Elektrotechnik Praxisintegriert&#34;</span>, 1, 30),
</span></span><span style="display:flex;"><span>    ARC(<span style="color:#e6db74">&#34;Architektur&#34;</span>, 4, 40),
</span></span><span style="display:flex;"><span>    PHY(<span style="color:#e6db74">&#34;Physik&#34;</span>, 3, 10);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> String description;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> number;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> capacity;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Fach() { <span style="color:#66d9ef">this</span>(<span style="color:#e6db74">&#34;Informatik Bachelor&#34;</span>, 0, 60); }
</span></span><span style="display:flex;"><span>    Fach(String descr, <span style="color:#66d9ef">int</span> number, <span style="color:#66d9ef">int</span> capacity) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">description</span> <span style="color:#f92672">=</span> descr;  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">number</span> <span style="color:#f92672">=</span> number;  <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">capacity</span> <span style="color:#f92672">=</span> capacity;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String <span style="color:#a6e22e">getDescription</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Konstante: &#34;</span> <span style="color:#f92672">+</span> name() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34; (Beschreibung: &#34;</span> <span style="color:#f92672">+</span> description
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, Kapazitaet: &#34;</span> <span style="color:#f92672">+</span> capacity <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, Nummer: &#34;</span> <span style="color:#f92672">+</span> number
</span></span><span style="display:flex;"><span>                <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;, Ordinal: &#34;</span> <span style="color:#f92672">+</span> ordinal() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;)&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="konstruktoren-und-methoden-für-enum-klassen-definierbar">Konstruktoren und Methoden für Enum-Klassen definierbar</h3>
<ul>
<li>Kein eigener Aufruf von <code>super</code> (!)</li>
<li>Konstruktoren implizit <code>private</code></li>
</ul>
<h3 id="compiler-fügt-automatisch-folgende-methoden-hinzu-auswahl">Compiler fügt automatisch folgende Methoden hinzu (Auswahl):</h3>
<ul>
<li>Strings:
<ul>
<li><code>public final String name()</code> =&gt; Name der Konstanten (<code>final</code>!)</li>
<li><code>public String toString()</code> =&gt; Ruft <code>name()</code> auf, überschreibbar</li>
</ul>
</li>
<li>Konstanten:
<ul>
<li><code>public final T[] values()</code> =&gt; Alle Konstanten der Aufzählung</li>
<li><code>public final int ordinal()</code> =&gt; Interne Nummer der Konstanten
(Reihenfolge des Anlegens der Konstanten!)</li>
<li><code>public static T valueOf(String)</code> =&gt; Zum String passende Konstante
(via <code>name()</code>)</li>
</ul>
</li>
</ul>
<p><strong>Hinweis</strong>: Diese Methoden gibt es auch bei den &quot;einfachen&quot; Enumerationen (s.o.).</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/java-jvm/src/enums/v3/" target="_blank"><span class="title">Demo: enums.v3</span></a></span></div>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>
<p>Aufzählungen mit Hilfe von <code>enum</code> (Compiler erzeugt intern Klassen)</p>
</li>
<li>
<p>Komplexe Enumerations analog zu Klassendefinition: Konstruktoren, Felder und Methoden
(keine Instanzen von Enum-Klassen erzeugbar)</p>
</li>
<li>
<p>Enum-Konstanten sind implizit <code>final</code> und <code>static</code></p>
</li>
<li>
<p>Compiler stellt Methoden <code>name()</code>, <code>ordinal()</code> und <code>values()</code> zur Verfügung</p>
<ul>
<li>Name der Konstanten</li>
<li>Interne Nummer der Konstanten (Reihenfolge des Anlegens)</li>
<li>Array mit allen Konstanten der Enum-Klasse</li>
</ul>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106515&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Enumerations (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p>Im <a href="https://github.com/Dungeon-CampusMinden/Dungeon/blob/master/dungeon/src/contrib/configuration/KeyboardConfig.java" rel="external" target="_blank">Dungeon</a>
sollen Key-Codes aus libGDX (Integer-Werte) als Konstanten zugreifbar sein. Zusätzlich soll es es noch einen String geben, der
beschreibt, wo und wie diese Taste im Spiel eingesetzt wird. Aus historischen Gründen ist dies im Dungeon recht komplex gelöst.</p>
<p>Definieren Sie eine neue Enum-Klasse, die Konstanten für Tasten aufzählt (beispielsweise <code>ESCAPE</code>, <code>W</code>, <code>A</code> oder <code>LEFT</code>). Jede
dieser Konstanten soll den der Taste zugeordneten Integerwert speichern können und einen String haben, der als Hilfestring
verstanden werden könnte (nutzen Sie hier einfach Phantasiewerte). Zeigen Sie in einer kleinen Demo, wie Sie mit diesem Enum
arbeiten würden: Zugriff auf die Konstanten, Zugriff auf den Zahlenwert und/oder den String, Übergabe als Funktionsparameter.</p>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Java-SE-Tutorial'>[Java-SE-Tutorial] <a href='https://docs.oracle.com/javase/tutorial/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>The Java Tutorials</strong></a><br>Oracle Corporation, 2022.<br><em>Trail: Learning the Java Language :: Classes and Objects :: Enum Types</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Abschnitt 6.4.3: Aufzählungstypen, Abschnitt 10.7: Die Spezial-Oberklasse Enum</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Konfiguration eines Programms</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Zu Konfiguration von Programmen kann man beim Aufruf Kommandozeilenparameter mitgeben. Diese
sind in der über den Parameter<code>String[] args</code> in der <code>main(String[] args)</code>-Methode zugreifbar.</p>
<p>Es gibt oft eine Kurzversion (&quot;-x&quot;) und/oder eine Langversion (&quot;--breite&quot;). Zusätzlich können
Parameter noch ein Argument haben (&quot;-x 12&quot; oder &quot;--breite=12&quot;). Parameter können optional oder
verpflichtend sein.</p>
<p>Um dies nicht manuell auswerten zu müssen, kann man beispielsweise die Bibliothkek Apache
Commons CLI benutzen.</p>
<p>Ein anderer Weg zur Konfiguration sind Konfigurationsdateien, die man entsprechend einliest.
Hier findet man häufig das &quot;Ini-Format&quot;, also zeilenweise &quot;Key=Value&quot;-Paare. Diese kann man
mit der Klasse <code>java.util.Properties</code> einlesen, bearbeiten und speichern (auch als XML).</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/ImkyRx4UL9M' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Konfiguration</a></li> <li><a href='https://youtu.be/a3XUfDbD9uo' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Setzen von Kommandozeilenparametern (IDE)</a></li> <li><a href='https://youtu.be/cmMDxdT69ZQ' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Einbinden von Libs in IDE</a></li> <li><a href='https://youtu.be/DwKNQpLX4xI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Apache Commons CLI</a></li> <li><a href='https://youtu.be/or1t_2vld2E' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Properties</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/94963b57dcea201ea1cce6d9d0d61732c823ebc117710448516a259243afd239fdbaf9c10be3bdfa3eb0c0f4e9c4fc3c847eb74b8977bfa8b921d2d02ec325f4' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Konfiguration</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Auswertung von Kommandozeilenparametern in einem Programm</li> <li>(K3) Apache Commons CLI zur Verarbeitung von Kommandozeilenparametern</li> <li>(K3) Laden von Konfigurationsdaten mit <code>java.util.Properties</code></li></ul>
  </div>
</div>




    <h2 id="wie-kann-man-programme-konfigurieren">Wie kann man Programme konfigurieren?</h2>
<ol>
<li>
<p>Parameter beim Start mitgeben: Kommandozeilenparameter (CLI)</p>
</li>
<li>
<p>Konfigurationsdatei einlesen und auswerten</p>
</li>
</ol>
<h2 id="varianten-von-kommandozeilenparameter">Varianten von Kommandozeilenparameter</h2>
<ul>
<li>
<p>Fixe Reihenfolge</p>
<p><code>java MyApp 10 20 hello debug</code></p>
</li>
<li>
<p>Benannte Parameter I</p>
<p><code>java MyApp -x 10 -y 20 -answer hello -d</code></p>
</li>
<li>
<p>Benannte Parameter II</p>
<p><code>java MyApp --breite=10 --hoehe=20 --answer=hello --debug</code></p>
</li>
</ul>
<p>Häufig Mischung von Kurz- und Langformen</p>
<p>Häufig hat man eine Kurzform der Optionen, also etwa &quot;-x&quot;. Dabei ist der Name der Option
in der Regel ein Zeichen lang. Es gibt aber auch Abweichungen von dieser Konvention, denken
Sie beispielsweise an <code>java -version</code>.</p>
<p>In der Langform nutzt man dann einen aussagekräftigen Namen und stellt zwei Bindestriche
voran, also beispielsweise &quot;--breite&quot; (als Alternative für &quot;-x&quot;).</p>
<p>Wenn Optionen Parameter haben, schreibt man in der Kurzform üblicherweise &quot;-x 10&quot; (trennt
also den Parameter mit einem Leerzeichen von der Option) und in der Langform &quot;--breite=10&quot;
(also mit einem &quot;=&quot; zwischen Option und Parameter). Das sind ebenfalls Konventionen, d.h.
man kann prinzipiell auch in der Kurzform das &quot;=&quot; nutzen, also &quot;-x=10&quot;, oder in der Langform
mit einem Leerzeichen trennen, also &quot;--breite 10&quot;.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://youtu.be/a3XUfDbD9uo" target="_blank"><span class="title">Demo IDE und CLI</span></a></span></div>
<p>Hinweis IntelliJ: &quot;<code>Edit Configurations</code>&quot; =&gt; Kommandozeilenparameter unter &quot;<code>Build and run</code>&quot; im entsprechenden Feld eintragen</p>
<p><a href="#R-image-0bbceaa99845d7d1e05f54e2e3d6d111" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/java-jvm/configuration/ide-cli.png?width=auto&height=auto" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-0bbceaa99845d7d1e05f54e2e3d6d111"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/java-jvm/configuration/ide-cli.png?width=auto&height=auto"></a></p>
<h2 id="auswertung-kommandozeilenparameter">Auswertung Kommandozeilenparameter</h2>
<ul>
<li>
<p>Kommandozeilenparameter werden als String-Array an <code>main()</code>-Methode übergeben:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) { }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... argv) { }</span></span></code></pre></div>
<p>=&gt; Müssen &quot;händisch&quot; ausgewertet werden</p>
</li>
</ul>
<p><em>Anmerkung</em>: Nur Parameter! Nicht Programmname als erster Eintrag wie in C ...</p>
<h2 id="beispiel-auswertung-kommandozeilenparameter">Beispiel Auswertung Kommandozeilenparameter</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> x <span style="color:#f92672">=</span> 100;
</span></span><span style="display:flex;"><span>    String answer <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">boolean</span> debug <span style="color:#f92672">=</span> <span style="color:#66d9ef">false</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Parameter: -x=10 -answer=hello -debug</span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// =&gt; args = [&#34;-x=10&#34;, &#34;-answer=hello&#34;, &#34;-debug&#34;]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (String param : args) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (param.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;-x&#34;</span>)) { x <span style="color:#f92672">=</span> Integer.<span style="color:#a6e22e">parseInt</span>(param.<span style="color:#a6e22e">substring</span>(3)); }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (param.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;-a&#34;</span>)) { answer <span style="color:#f92672">=</span> param.<span style="color:#a6e22e">substring</span>(8); }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (param.<span style="color:#a6e22e">startsWith</span>(<span style="color:#e6db74">&#34;-d&#34;</span>)) { debug <span style="color:#f92672">=</span> <span style="color:#66d9ef">true</span>; }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<h3 id="kritik-an-manueller-auswertung-kommandozeilenparameter">Kritik an manueller Auswertung Kommandozeilenparameter</h3>
<ul>
<li>Umständlich und unübersichtlich</li>
<li>Große <code>if-else</code>-Gebilde in <code>main()</code></li>
<li>Kurz- und Langform müssen getrennt realisiert werden</li>
<li>Optionale Parameter müssen anders geprüft werden als Pflichtparameter</li>
<li>Überlappende Parameternamen schwer aufzufinden</li>
<li>Prüfung auf korrekten Typ nötig bei Parametern mit Werten</li>
<li>Hilfe bei Fehlern muss separat realisiert und gepflegt werden</li>
</ul>
<h2 id="apache-commons-cli">Apache Commons: CLI</h2>
<p><span class='alert'><strong>Rad nicht neu erfinden!</strong></span></p>
<ul>
<li>Apache Commons bietet die CLI-Bibliothek zum Umgang mit
Kommandozeilenparametern an:
<a href="https://commons.apache.org/proper/commons-cli/" rel="external" target="_blank">commons.apache.org/cli</a></li>
</ul>
<p>Annäherung an fremde API:</p>
<ul>
<li>Lesen der verfügbaren Doku (PDF, HTML)</li>
<li>Lesen der verfügbaren Javadoc</li>
<li>Herunterladen der Bibliothek</li>
<li>Einbinden ins Projekt</li>
</ul>
<h2 id="exkurs-einbinden-fremder-bibliothekenapis">Exkurs: Einbinden fremder Bibliotheken/APIs</h2>
<h3 id="eclipse">Eclipse</h3>
<ul>
<li>Lib von <a href="https://commons.apache.org/proper/commons-cli/download_cli.cgi" rel="external" target="_blank">commons.apache.org</a>
herunterladen und auspacken</li>
<li>Neuen Unterordner im Projekt anlegen: <code>libs/</code></li>
<li>Bibliothek (<code>.jar</code>-Files) hinein kopieren</li>
<li>Projektexplorer, Kontextmenü auf <code>.jar</code>-File: &quot;<code>Add as Library</code>&quot;</li>
<li>Alternativ Menü-Leiste: &quot;<code>Project &gt; Properties &gt; Java Build Path &gt; Libraries &gt; Add JARs</code>&quot;</li>
</ul>
<h3 id="intellij">IntelliJ</h3>
<ul>
<li>Variante 1:
<ul>
<li>Lib von <a href="https://commons.apache.org/proper/commons-cli/download_cli.cgi" rel="external" target="_blank">commons.apache.org</a>
herunterladen und auspacken</li>
<li>Neuen Unterordner im Projekt anlegen: <code>libs/</code></li>
<li>Bibliothek (<code>.jar</code>-Files) hinein kopieren</li>
<li>Variante 1 (a):Projektexplorer, Kontextmenü auf <code>.jar</code>-File: &quot;<code>Build Path &gt; Add to Build Path</code>&quot;</li>
<li>Variante 1 (b): Projekteigenschaften, Eintrag &quot;Libraries&quot;, &quot;+&quot;, &quot;New Project Library&quot;, &quot;Java&quot; und Jar-File auswählen</li>
</ul>
</li>
<li>Variante 2:
<ul>
<li>Projekteigenschaften, Eintrag &quot;Libraries&quot;, &quot;+&quot;, &quot;New Project Library&quot;, &quot;From Maven&quot; und
&quot;commons-cli:commons-cli:1.5.0&quot; als Suchstring eingeben und die Suche abschließen</li>
</ul>
</li>
</ul>
<h3 id="gradle-oder-ant-oder-maven">Gradle oder Ant oder Maven</h3>
<ul>
<li>Lib auf <a href="https://search.maven.org/" rel="external" target="_blank">Maven Central</a> suchen: &quot;commons-cli:commons-cli&quot; als Suchstring eingeben</li>
<li>Passenden Dependency-Eintrag in das Build-Skript kopieren</li>
</ul>
<h3 id="kommandozeilenaufruf">Kommandozeilenaufruf</h3>
<ul>
<li>
<p>Class-Path bei Aufruf setzen:</p>
<ul>
<li>Unix: <code>java -cp .:&lt;jarfile&gt;:&lt;jarfile&gt; &lt;mainclass&gt;</code></li>
<li>Windows: <code>java -cp .;&lt;jarfile&gt;;&lt;jarfile&gt; &lt;mainclass&gt;</code></li>
</ul>
<p>Achtung: Unter Unix (Linux, MacOS) wird ein Doppelpunkt zum Trennen
der Jar-Files eingesetzt, unter Windows ein Semikolon!</p>
</li>
</ul>
<p>Beispiel: <code>java -classpath .:/home/user/wuppy.jar MyApp</code></p>
<p>Vorgriff auf Build-Skripte (spätere VL): Im hier gezeigten Vorgehen werden die
Abhängigkeiten manuell aufgelöst, d.h. die Jar-Files werden manuell heruntergeladen
(oder selbst kompiliert) und dem Projekt hinzugefügt.</p>
<p>Alle später besprochenen Build-Skripte (Ant, Gradle) beherrschen die automatische
Auflösung von Abhängigkeiten. Dazu muss im Skript die Abhängigkeit auf geeignete
Weise beschrieben werden und wird dann beim Kompilieren des Programms automatisch
von spezialisierten Servern in der im Skript definierten Version heruntergeladen.
Dies funktioniert auch bei rekursiven Abhängigkeiten ...</p>
<h2 id="überblick-umgang-mit-apache-commons-cli">Überblick Umgang mit Apache Commons CLI</h2>
<p><strong>Paket</strong>: <code>org.apache.commons.cli</code></p>
<ol>
<li>Definition der Optionen
<ul>
<li>Je Option eine Instanz der Klasse <code>Option</code></li>
<li>Alle Optionen in Container <code>Options</code> sammeln</li>
</ul>
</li>
<li>Parsen der Eingaben mit <code>DefaultParser</code></li>
<li>Abfragen der Ergebnisse: <code>CommandLine</code></li>
<li>Formatierte Hilfe ausgeben: <code>HelpFormatter</code></li>
</ol>
<p>Die Funktionsweise der einzelnen Klassen wird in der Demo kurz angerissen. Schauen Sie bitte
zusätzlich in die Dokumentation.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/src/cli/Args.java" target="_blank"><span class="title">Demo: Einbinden von Libs, cli.Args</span></a></span></div>
<h2 id="laden-und-speichern-von-konfigurationsdaten">Laden und Speichern von Konfigurationsdaten</h2>
<pre><code>#ola - ein Kommentar
hoehe=2
breite=9
gewicht=12
</code></pre>
<ul>
<li>
<p>Konfigurationsdaten sind i.d.R. Schlüssel-Wert-Paare (<code>String</code>/<code>String</code>)</p>
<p>=&gt; <code>java.util.Properties</code></p>
<p>Tatsächlich verbirgt sich ein <code>Hashtable</code> dahinter:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Properties</span> <span style="color:#66d9ef">extends</span> Hashtable<span style="color:#f92672">&lt;</span>Object,Object<span style="color:#f92672">&gt;</span>;</span></span></code></pre></div>
</li>
</ul>
<h2 id="laden-und-speichern-von-konfigurationsdaten-cnt">Laden und Speichern von Konfigurationsdaten (cnt.)</h2>
<ul>
<li>
<p>Properties anlegen und modifizieren</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>Properties props <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Properties();
</span></span><span style="display:flex;"><span>props.<span style="color:#a6e22e">setProperty</span>(<span style="color:#e6db74">&#34;breite&#34;</span>, <span style="color:#e6db74">&#34;9&#34;</span>);
</span></span><span style="display:flex;"><span>props.<span style="color:#a6e22e">setProperty</span>(<span style="color:#e6db74">&#34;breite&#34;</span>, <span style="color:#e6db74">&#34;99&#34;</span>);
</span></span><span style="display:flex;"><span>String value <span style="color:#f92672">=</span> props.<span style="color:#a6e22e">getProperty</span>(<span style="color:#e6db74">&#34;breite&#34;</span>);</span></span></code></pre></div>
</li>
<li>
<p>Properties speichern: <code>Properties#store</code> und <code>Properties#storeToXML</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">store</span>(Writer writer, String comments)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">store</span>(OutputStream out, String comments)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">storeToXML</span>(OutputStream os, String comment, String encoding)</span></span></code></pre></div>
</li>
<li>
<p>Properties laden: <code>Properties#load</code> und <code>Properties#loadFromXML</code></p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">load</span>(Reader reader)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">load</span>(InputStream inStream)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">loadFromXML</span>(InputStream in)</span></span></code></pre></div>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/java-jvm/src/cli/Props.java" target="_blank"><span class="title">Demo: cli.Props, Hinweis auf &quot;Apache Commons Configuration&quot;</span></a></span></div>
<p><code>java.util.Properties</code> sind eine einfache und im JDK bereits eingebaute Möglichkeit,
mit Konfigurationsdateien zu hantieren. Deutlich umfangreichere Möglichkeiten bieten
aber externe Bibliotheken, beispielsweise &quot;Apache Commons Configuration&quot;
(<a href="https://commons.apache.org/proper/commons-configuration/" rel="external" target="_blank">commons.apache.org/configuration</a>).</p>
<h2 id="wrap-up">Wrap-Up</h2>
<ul>
<li>Kommandozeilenparameter als <code>String[]</code> in <code>main()</code>-Methode</li>
<li>Manuelle Auswertung komplex =&gt; <em>Apache Commons CLI</em></li>
<li>Schlüssel-Wert-Paare mit <code>java.util.Properties</code> aus/in Dateien laden/speichern</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106514&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Konfiguration (ILIAS)</a></li></ul>
  </div>
</div>



    



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Java-SE-Tutorial'>[Java-SE-Tutorial] <a href='https://docs.oracle.com/javase/tutorial/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>The Java Tutorials</strong></a><br>Oracle Corporation, 2022.<br><em>Essential Java Classes \> The Platform Environment \> Configuration Utilities</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
          <article class="default">
            <header class="headline">
            </header>

<h1 id="multi-threading-parallelisierung-von-programmen">Multi-Threading: Parallelisierung von Programmen</h1>

<ul class="children children-li children-sort-">
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-intro.html">Einführung in die nebenläufige Programmierung mit Threads</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-synchronisation.html">Synchronisation: Verteilter Zugriff auf gemeinsame Ressourcen</a></li>
  <li><a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-highlevel.html">High-Level Concurrency</a></li>
</ul>

            <footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

            </footer>
          </article>

          <section>
            <h1 class="a11y-only">Subsections of Multi-Threading: Parallelisierung von Programmen</h1>
<article class="default">
<h1>Einführung in die nebenläufige Programmierung mit Threads</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Threads sind weitere Kontrollflussfäden, die von der Java-VM (oder (selten) vom OS)
verwaltet werden. Damit ist sind sie leichtgewichtiger als der Start neuer Prozesse
direkt auf Betriebssystem-Ebene.</p>
<p>Beim Start eines Java-Programms wird die <code>main()</code>-Methode automatisch in einem
(Haupt-) Thread ausgeführt. Alle Anweisungen in einem Thread werden sequentiell
ausgeführt.</p>
<p>Um einen neuen Thread zu erzeugen, leitet man von <code>Thread</code> ab oder implementiert
das Interface <code>Runnable</code>. Von diesen eigenen Klassen kann man wie üblich ein neues
Objekt anlegen. Die Methode <code>run()</code> enthält dabei den im Thread auszuführenden
Code. Um einen Thread als neuen parallelen Kontrollfluss zu starten, muss man die
geerbte Methode <code>start()</code> auf dem Objekt aufrufen. Im Fall der Implementierung von
<code>Runnable</code> muss man das Objekt zuvor noch in den Konstruktor von <code>Thread</code> stecken
und so ein neues <code>Thread</code>-Objekt erzeugen, auf dem man dann <code>start()</code> aufrufen kann.</p>
<p>Threads haben einen Lebenszyklus: Nach dem Erzeugen der Objekte mit <code>new</code> wird
der Thread noch nicht ausgeführt. Durch den Aufruf der Methode <code>start()</code> gelangt
der Thread in einen Zustand &quot;ausführungsbereit&quot;. Sobald er vom Scheduler eine
Zeitscheibe zugeteilt bekommt, wechselt er in den Zustand &quot;rechnend&quot;. Von hier kann
er nach Ablauf der Zeitscheibe durch den Scheduler wieder nach &quot;ausführungsbereit&quot;
zurück überführt werden. Dieses Wechselspiel passiert automatisch und i.d.R. schnell,
so dass selbst auf Maschinen mit nur einem Prozessor/Kern der Eindruck einer parallelen
Verarbeitung entsteht. Nach Abarbeitung der <code>run()</code>-Methode wird der Thread beendet
und kann nicht wieder neu gestartet werden. Bei Zugriff auf gesperrte Ressourcen
oder durch <code>sleep()</code> oder <code>join()</code> kann ein Thread blockiert werden. Aus diesem
Zustand gelangt er durch Interrupts oder nach Ablauf der Schlafzeit oder durch <code>notify</code>
wieder zurück nach &quot;ausführungsbereit&quot;.</p>
<p>Die Thread-Objekte sind normale Java-Objekte. Man kann hier Attribute und Methoden
haben und diese entsprechend zugreifen/aufrufen. Das klappt auch, wenn der Thread
noch nicht gestartet wurde oder bereits abgearbeitet wurde.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/ClfXbNPRl_8' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Threads Intro</a></li> <li><a href='https://youtu.be/zcVqFAx5D0E' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Threads Intro: Erzeugen von Threads</a></li> <li><a href='https://youtu.be/lQ_JSHBGhdU' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Threads Intro: Arbeiten mit Threads (`join()`)</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/41a885ac4baf0e087d393b0fa9d3d6f38cc86debad5b7e563c46dac15c0ba4f214476650ad6fa288708eb8b1ccf12d19f6ab46a8c5cf7a58b61a4cff39ec727b' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Threads Intro</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Grundsätzlicher Unterschied zw. Threads und Prozessen</li> <li>(K2) Lebenszyklus von Threads</li> <li>(K3) Erzeugen und Starten von Threads</li> <li>(K3) Kommunikation mit Objekten</li></ul>
  </div>
</div>




    <h2 id="42">42</h2>
<p><a href="#R-image-3aac5188fb2a7157d13bafe46a8c7099" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-intro/screenshot_swingworker.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-3aac5188fb2a7157d13bafe46a8c7099"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-intro/screenshot_swingworker.png?width=80%25&height=auto"></a></p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/misc/SwingWorkerDemo.java" target="_blank"><span class="title">Demo: misc.SwingWorkerDemo (GUI ausprobieren)</span></a></span></div>
<h2 id="einführung-in-nebenläufige-programmierung">Einführung in nebenläufige Programmierung</h2>
<h3 id="traditionelle-programmierung">Traditionelle Programmierung</h3>
<ul>
<li>Aufruf einer Methode verlagert Kontrollfluss in diese Methode</li>
<li>Code hinter Methodenaufruf wird erst <strong>nach Beendigung</strong> der Methode ausgeführt</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Traditional</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        Traditional x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Traditional();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;main(): vor run()&#34;</span>);
</span></span><span style="display:flex;"><span>        x.<span style="color:#a6e22e">run</span>();
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;main(): nach run()&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span>() {
</span></span><span style="display:flex;"><span>        IntStream.<span style="color:#a6e22e">range</span>(0, 10).<span style="color:#a6e22e">mapToObj</span>(i <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;in run()&#34;</span>).<span style="color:#a6e22e">forEach</span>(System.<span style="color:#a6e22e">out</span>::println);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/intro/Traditional.java" target="_blank"><span class="title">Demo: intro.Traditional</span></a></span></div>
<h3 id="nebenläufige-programmierung">Nebenläufige Programmierung</h3>
<ul>
<li>Erzeugung eines neuen Kontrollflussfadens (Thread)
<ul>
<li><strong>Läuft (quasi-) parallel zu bisherigem Kontrollfluss</strong></li>
</ul>
</li>
<li>Threads können unabhängig von einander arbeiten</li>
<li>Zustandsverwaltung durch Java-VM (oder Unterstützung durch Betriebssystem)
<ul>
<li>Aufruf einer bestimmten Methode erzeugt neuen Kontrollflussfaden</li>
<li>Der neue Thread arbeitet &quot;parallel&quot; zum bisherigen Thread</li>
<li>Kontrolle kehrt sofort wieder zurück: Code hinter dem Methodenaufruf
wird ausgeführt ohne auf die Beendigung der aufgerufenen Methode zu
warten</li>
<li>Verteilung der Threads auf die vorhandenen Prozessorkerne abhängig
von der Java-VM</li>
</ul>
</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Threaded</span> <span style="color:#66d9ef">extends</span> Thread {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        Threaded x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Threaded();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;main(): vor run()&#34;</span>);
</span></span><span style="display:flex;"><span>        x.<span style="color:#a6e22e">start</span>();
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(<span style="color:#e6db74">&#34;main(): nach run()&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span>() {
</span></span><span style="display:flex;"><span>        IntStream.<span style="color:#a6e22e">range</span>(0, 10).<span style="color:#a6e22e">mapToObj</span>(i <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;in run()&#34;</span>).<span style="color:#a6e22e">forEach</span>(System.<span style="color:#a6e22e">out</span>::println);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/intro/Threaded.java" target="_blank"><span class="title">Demo: intro.Threaded</span></a></span></div>
<h2 id="erzeugen-von-threads">Erzeugen von Threads</h2>
<ul>
<li>
<p>Ableiten von <code>Thread</code> oder Implementierung von <code>Runnable</code></p>
<p><a href="#R-image-65b61f666236474658032d5bb0f8d591" class="lightbox-link"><img class="noborder lazy lightbox noshadow figure-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-intro/ThreadRunnable.png?width=80%25&height=auto" style=" height: auto; width: 80%;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-65b61f666236474658032d5bb0f8d591"><img class="noborder lazy lightbox noshadow lightbox-image" loading="lazy" src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-intro/ThreadRunnable.png?width=80%25&height=auto"></a></p>
</li>
<li>
<p>Methode <code>run()</code> implementieren, aber nicht aufrufen</p>
</li>
<li>
<p>Methode <code>start()</code> aufrufen, aber (i.d.R.) nicht implementieren</p>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/creation/" target="_blank"><span class="title">Demo: creation.*</span></a></span></div>
<h3 id="ableiten-von-thread">Ableiten von <em>Thread</em></h3>
<ul>
<li><code>start()</code> startet den Thread und sorgt für Ausführung von <code>run()</code></li>
<li><code>start()</code> nur einmal aufrufen</li>
</ul>
<h3 id="implementierung-von-runnable">Implementierung von <em>Runnable</em></h3>
<ul>
<li>Ebenfalls <code>run()</code> implementieren</li>
<li>Neues <code>Thread</code>-Objekt erzeugen, Konstruktor das eigene Runnable übergeben</li>
<li>Für Thread-Objekt die Methode <code>start()</code> aufrufen
<ul>
<li>Startet den Thread (das Runnable) und sorgt für Ausführung von <code>run()</code></li>
</ul>
</li>
</ul>
<p>Vorteil von <code>Runnable</code>: Ist ein Interface, d.h. man kann noch von einer anderen Klasse erben</p>
<h2 id="zustandsmodell-von-threads-vereinfacht">Zustandsmodell von Threads (vereinfacht)</h2>
<p>Threads haben einen Lebenszyklus: Nach dem Erzeugen der Objekte mit <code>new</code> wird
der Thread noch nicht ausgeführt. Er ist sozusagen in einem Zustand &quot;erzeugt&quot;.
Man kann bereits mit dem Objekt interagieren, also auf Attribute zugreifen und
Methoden aufrufen.</p>
<p>Durch den Aufruf der Methode <code>start()</code> gelangt der Thread in einen Zustand
&quot;ausführungsbereit&quot;, er läuft also aus Nutzersicht. Allerdings hat er noch keine
Ressourcen zugeteilt (CPU, ...), so dass er tatsächlich noch nicht rechnet. Sobald
er vom Scheduler eine Zeitscheibe zugeteilt bekommt, wechselt er in den Zustand
&quot;rechnend&quot; und führt den Inhalt der <code>run()</code>-Methode aus. Von hier kann er nach
Ablauf der Zeitscheibe durch den Scheduler wieder nach &quot;ausführungsbereit&quot; zurück
überführt werden. Dieses Wechselspiel passiert automatisch und i.d.R. schnell,
so dass selbst auf Maschinen mit nur einem Prozessor/Kern der Eindruck einer parallelen
Verarbeitung entsteht.</p>
<p>Nach der Abarbeitung der <code>run()</code>-Methode oder bei einer nicht gefangenen Exception
wird der Thread beendet und kann nicht wieder neu gestartet werden. Auch wenn der
Thread abgelaufen ist, kann man mit dem Objekt wie üblich interagieren (nur eben
nicht mehr parallel).</p>
<p>Bei Zugriff auf gesperrte Ressourcen oder durch Aufrufe von Methoden wie <code>sleep()</code>
oder <code>join()</code> kann ein Thread blockiert werden. Hier führt der Thread nichts aus,
bekommt durch den Scheduler aber auch keine neue Zeitscheibe zugewiesen. Aus diesem
Zustand gelangt der Thread wieder heraus, etwa durch Interrupts (Aufruf der Methode
<code>interrupt()</code> auf dem Thread-Objekt) oder nach Ablauf der Schlafzeit (in <code>sleep()</code>)
oder durch ein <code>notify</code>, und wird wieder zurück nach &quot;ausführungsbereit&quot; versetzt
und wartet auf die Zuteilung einer Zeitscheibe durch den Scheduler.</p>
<p>Sie finden in <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-intro.html#id_Boles2008">[Boles2008, Kapitel 5.2 &quot;Thread-Zustände&quot;]</a> eine schöne
ausführliche Darstellung.</p>
<h3 id="threads-können-wie-normale-objekte-kommunizieren">Threads können wie normale Objekte kommunizieren</h3>
<ul>
<li>Zugriff auf (<code>public</code>) Attribute (oder eben über Methoden)</li>
<li>Aufruf von Methoden</li>
</ul>
<h3 id="threads-können-noch-mehr">Threads können noch mehr</h3>
<ul>
<li>
<p>Eine Zeitlang schlafen: <code>Thread.sleep(&lt;duration_ms&gt;)</code></p>
<ul>
<li>Statische Methode der Klasse <code>Thread</code> (Klassenmethode)</li>
<li>Aufrufender Thread wird bis zum Ablauf der Zeit oder bis zum Aufruf
der <code>interrupt()</code>-Methode des Threads blockiert</li>
<li>&quot;Moderne&quot; Alternative: <code>TimeUnit</code>, beispielsweise <code>TimeUnit.SECONDS.sleep( 2 );</code></li>
</ul>
</li>
<li>
<p>Prozessor abgeben und hinten in Warteschlange einreihen: <code>yield()</code></p>
</li>
<li>
<p>Andere Threads stören: <code>otherThreadObj.interrupt()</code></p>
<ul>
<li>Die Methoden <code>sleep()</code>, <code>wait()</code> und <code>join()</code> im empfangenden Thread
<code>otherThreadObj</code> lösen eine <code>InterruptedException</code> aus, wenn sie
durch die Methode <code>interrupt()</code> unterbrochen werden. Das heißt,
<code>interrupt()</code> beendet diese Methoden mit der Ausnahme.</li>
<li>Empfangender Thread verlässt ggf. den Zustand &quot;blockiert&quot; und wechselt
in den Zustand &quot;ausführungsbereit&quot;</li>
</ul>
</li>
<li>
<p>Warten auf das Ende anderer Threads: <code>otherThreadObj.join()</code></p>
<ul>
<li>Ausführender Thread wird blockiert (also nicht <code>otherThreadObj</code>!)</li>
<li>Blockade des Aufrufers wird beendet, wenn der andere Thread
(<code>otherThreadObj</code>) beendet wird.</li>
</ul>
</li>
</ul>
<p><em>Hinweis:</em> Ein Thread wird beendet, wenn</p>
<ul>
<li>die <code>run()</code>-Methode normal endet, oder</li>
<li>die <code>run()</code>-Methode durch eine nicht gefangene Exception beendet wird, oder</li>
<li>von außen die Methode <code>stop()</code> aufgerufen wird (Achtung: Deprecated!
Einen richtigen Ersatz gibt es aber auch nicht.).</li>
</ul>
<p><em>Hinweis:</em> Die Methoden <code>wait()</code>, <code>notify()</code>/<code>notifyAll()</code> und die &quot;<code>synchronized</code>-Sperre&quot;
werden in der Sitzung [&quot;Threads: Synchronisation&quot;](threads-intro.
besprochen.</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/intro/Join.java" target="_blank"><span class="title">Demo: intro.Join</span></a></span></div>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Threads sind weitere Kontrollflussfäden, von Java-VM (oder (selten) von OS) verwaltet</p>
<ul>
<li>Ableiten von <code>Thread</code> oder implementieren von <code>Runnable</code></li>
<li>Methode <code>run</code> enthält den auszuführenden Code</li>
<li>Starten des Threads mit <code>start</code> (nie mit <code>run</code>!)</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106529&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Threads Intro (ILIAS)</a></li></ul>
  </div>
</div>



    



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Boles2008'>[Boles2008] <a href='http://www.boles.de/hamster/band3.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Parallele Programmierung spielend gelernt mit dem Java-Hamster-Modell</strong></a><br>Boles, D., Vieweg+Teubne, 2008. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8351-0229-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8351-0229-3</a>.</li> <li id='id_Java-SE-Tutorial'>[Java-SE-Tutorial] <a href='https://docs.oracle.com/javase/tutorial/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>The Java Tutorials</strong></a><br>Oracle Corporation, 2022.<br><em>Trail: Essential Java Classes, Lesson: Concurrency</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kap. 16: Einführung in die nebenläufige Programmierung</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>Synchronisation: Verteilter Zugriff auf gemeinsame Ressourcen</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Bei verteiltem Zugriff auf gemeinsame Ressourcen besteht Synchronisierungsbedarf,
insbesondere sollten nicht mehrere Threads gleichzeitig geteilte Daten modifizieren.
Dazu kommt das Problem, dass ein Thread in einer komplexen Folge von Aktionen die
Zeitscheibe verlieren kann und dann später mit veralteten Daten weiter macht.</p>
<p>Um den Zugriff auf gemeinsame Ressourcen oder den Eintritt in kritische Bereiche
zu schützen und zu synchronisieren, kann man diese Zugriffe oder Bereiche in einen
<code>synchronized</code>-Block legen. Dazu benötigt man noch ein beliebiges (gemeinsam
sichtbares) Objekt, welches als Wächter- oder Sperr-Objekt fungiert. Beim Eintritt
in den geschützten Block muss ein Thread einen Lock auf dem Sperr-Objekt erlangen.
Hat bereits ein anderer Thread den Lock, wird der neue Thread so lange blockiert,
bis der Lock wieder &quot;frei&quot; ist. Beim Eintritt in den Bereich wird dann durch den
Thread auf dem Sperr-Objekt der Lock gesetzt und beim Austritt automatisch wieder
aufgehoben. Dies nennt man auch <strong>mehrseitige Synchronisierung</strong> (mehrere Threads
&quot;stimmen&quot; sich quasi untereinander über den Zugriff auf eine Ressource ab).</p>
<p>Um auf den Eintritt eines Ereignisses oder die Erfüllung einer Bedingung zu warten,
kann man <code>wait</code> und <code>notify</code> nutzen. In einem <code>synchronized</code>-Block prüft man, ob
die Bedingung erfüllt oder ein Ereignis eingetreten ist, und falls ja arbeitet man
damit normal weiter. Falls die Bedingung nicht erfüllt ist oder das Ereignis nicht
eingetreten ist, kann man auf dem im <code>synchronized</code>-Block genutzten Sperr-Objekt
die Methode <code>wait()</code> aufrufen. Damit wird der Thread in die entsprechende Schlange
auf dem Sperr-Objekt eingereiht und blockiert. Zusätzlich wird der Lock auf dem
Sperr-Objekt freigegeben. Zum &quot;Aufwecken&quot; nutzt man an geeigneter Stelle auf dem
<strong>selben Sperr-Objekt</strong> die Methode <code>notify()</code> oder <code>notifyALl()</code> (erstere weckt
einen in der Liste des Sperr-Objekts wartenden Thread, die letztere alle). Nach
dem Aufwachen macht der Thread nach seinem <code>wait()</code> weiter. Es ist also wichtig,
dass die Bedingung, wegen der ursprünglich das <code>wait()</code> aufgerufen wurde, erneut
abgefragt wird und ggf. erneut in das <code>wait()</code> gegangen wird. Dies nennt man
<strong>einseitige Synchronisierung</strong>.</p>
<p>Es gibt darüber hinaus viele weitere Mechanismen und Probleme, die aber den Rahmen
dieser Lehrveranstaltung deutlich übersteigen. Diese werden teilweise in den
Veranstaltungen &quot;Betriebssysteme&quot; und/oder &quot;Verteilte Systeme&quot; besprochen.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/FtVaobn4NqA' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Threads Synchronisation</a></li> <li><a href='https://youtu.be/SB1ngVkQdLM' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Teaser: Falscher Zugriff auf gemeinsame Ressourcen</a></li> <li><a href='https://youtu.be/YTV-oT-vmpE' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mehrseitige Synchronisation (Sperr-Objekt, synchronisierte Methode)</a></li> <li><a href='https://youtu.be/D4B5xHqCZ-0' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Mehrseitige Synchronisation: Deadlock</a></li> <li><a href='https://youtu.be/akCl01ZAaGo' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Einseitige Synchronisation</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/08f819d3002d7658801ff15fdb14cbdba82defee0ae97d929f5c4a03eeb0e3e9b751e90f5e0fe0ac3d55a551a53065c04f505f23a6c9f41d69d504474ea28c04' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL Threads Synchronisation</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
        
        
        
        
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K2) Notwendigkeit zur Synchronisation</li> <li>(K2) Unterscheidung einseitige und mehrseitige Synchronisation</li> <li>(K3) Synchronisation mit <code>synchronized</code>, <code>wait</code>, <code>notify</code> und <code>notifyAll</code></li></ul>
  </div>
</div>




    <h2 id="motivation-verteilter-zugriff-auf-gemeinsame-ressourcen">Motivation: Verteilter Zugriff auf gemeinsame Ressourcen</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Teaser</span> <span style="color:#66d9ef">implements</span> Runnable {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> val <span style="color:#f92672">=</span> 0;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        Teaser x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Teaser();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> Thread(x).<span style="color:#a6e22e">start</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> Thread(x).<span style="color:#a6e22e">start</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">incrVal</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">++</span>val;
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">println</span>(Thread.<span style="color:#a6e22e">currentThread</span>().<span style="color:#a6e22e">getId</span>() <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;: &#34;</span> <span style="color:#f92672">+</span> val);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">run</span>() {
</span></span><span style="display:flex;"><span>        IntStream.<span style="color:#a6e22e">range</span>(0, 5).<span style="color:#a6e22e">forEach</span>(i <span style="color:#f92672">-&gt;</span> incrVal());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/synchronised/Teaser.java" target="_blank"><span class="title">Demo: synchronised.Teaser</span></a></span></div>
<h2 id="zugriff-auf-gemeinsame-ressourcen-mehrseitige-synchronisierung">Zugriff auf gemeinsame Ressourcen: Mehrseitige Synchronisierung</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">synchronized</span> (<span style="color:#f92672">&lt;</span>Object reference<span style="color:#f92672">&gt;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;</span>statements (<span style="color:#66d9ef">synchronized</span>)<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>=&gt; <span class='alert'><strong>&quot;Mehrseitige Synchronisierung&quot;</strong></span></p>
<p>Fallunterscheidung: Thread T1 führt <code>synchronized</code>-Anweisung aus:</p>
<ul>
<li>Sperre im Sperr-Objekt nicht gesetzt:
<ol>
<li>T1 setzt Sperre beim Eintritt,</li>
<li>führt den Block aus, und</li>
<li>löst Sperre beim Verlassen</li>
</ol>
</li>
<li>Sperre durch T1 gesetzt:
<ol>
<li>T1 führt den Block aus, und</li>
<li>löst Sperre beim Verlassen <strong>nicht</strong></li>
</ol>
</li>
<li>Sperre durch T2 gesetzt:
=&gt; T1 wird blockiert, bis T2 die Sperre löst</li>
</ul>
<p><em>Anmerkung</em>: Das für die Synchronisierung genutzte Objekt nennt man &quot;Wächter-Objekt&quot;
oder auch &quot;Sperr-Objekt&quot; oder auch &quot;Synchronisations-Objekt&quot;.</p>
<p>Damit könnte man den relevanten Teil der Methode <code>incrVal()</code> beispielsweise in einen
geschützten Bereich einschließen und als Sperr-Objekt das eigene Objekt (<code>this</code>) einsetzen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">incrVal</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">synchronized</span> (<span style="color:#66d9ef">this</span>) { <span style="color:#f92672">++</span>val; }
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/synchronised/ObjSync.java" target="_blank"><span class="title">Demo: synchronised.ObjSync</span></a></span></div>
<h2 id="synchronisierte-methoden">Synchronisierte Methoden</h2>
<div class='columns'>
<div class='column'>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">f</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">synchronized</span> (<span style="color:#66d9ef">this</span>) {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
<div class='column'>
<p>... ist äquivalent zu ...</p>
</div>
<div class='column'>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">f</span>() {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</div>
</div>
<p>Kurzschreibweise: Man spart das separate Wächter-Objekt und synchronisiert auf sich selbst ...</p>
<p>Die Methode <code>incrVal()</code> könnte entsprechend so umgeschrieben werden:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">incrVal</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">++</span>val;
</span></span><span style="display:flex;"><span>    }</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/synchronised/MethodSync.java" target="_blank"><span class="title">Demo: synchronised.MethodSync</span></a></span></div>
<h2 id="probleme-bei-der-mehrseitigen-synchronisierung-deadlocks">Probleme bei der (mehrseitigen) Synchronisierung: Deadlocks</h2>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Deadlock</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">final</span> String name;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">synchronized</span> String <span style="color:#a6e22e">getName</span>() { <span style="color:#66d9ef">return</span> name; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">foo</span>(Deadlock other) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">format</span>(<span style="color:#e6db74">&#34;%s: %s.foo() \n&#34;</span>, Thread.<span style="color:#a6e22e">currentThread</span>().<span style="color:#a6e22e">getName</span>(), name);
</span></span><span style="display:flex;"><span>        System.<span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">format</span>(<span style="color:#e6db74">&#34;%s: %s.name()\n&#34;</span>, Thread.<span style="color:#a6e22e">currentThread</span>().<span style="color:#a6e22e">getName</span>(), other.<span style="color:#a6e22e">getName</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String... args) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> Deadlock a <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Deadlock(<span style="color:#e6db74">&#34;a&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">final</span> Deadlock b <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Deadlock(<span style="color:#e6db74">&#34;b&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> Thread(() <span style="color:#f92672">-&gt;</span> a.<span style="color:#a6e22e">foo</span>(b)).<span style="color:#a6e22e">start</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> Thread(() <span style="color:#f92672">-&gt;</span> b.<span style="color:#a6e22e">foo</span>(a)).<span style="color:#a6e22e">start</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Viel hilft hier nicht viel! Durch zu großzügige mehrseitige Synchronisierung
kann es passieren, dass Threads gegenseitig aufeinander warten: Thread A belegt
eine Ressource, die ein anderer Thread B haben möchte und Thread B belegt eine
Ressource, die A gerne bekommen würde. Da es dann nicht weitergeht, nennt man
diese Situation auch &quot;Deadlock&quot; (&quot;Verklemmung&quot;).</p>
<p>Im Beispiel ruft der erste Thread für das Objekt <code>a</code> die <code>foo()</code>-Methode auf und
holt sich damit den Lock auf <code>a</code>. Um die Methode beenden zu können, muss noch die
<code>getName()</code>-Methode vom Objekt <code>b</code> durch diesen ersten Thread aufgerufen werden.
Dafür muss der erste Thread den Lock auf <code>b</code> bekommen.</p>
<p>Dummerweise hat parallel der zweite Thread auf dem Objekt <code>b</code> die <code>foo()</code>-Methode
aufgerufen und sich damit den Lock auf <code>b</code> geholt. Damit muss der erste Thread so
lange warten, bis der zweite Thread den Lock auf <code>b</code> freigibt.</p>
<p>Das wird allerdings nicht passieren, da der zweite Thread zur Beendigung der
<code>foo()</code>-Methode noch <code>getName()</code> auf <code>a</code> ausführen muss und dazu den Lock auf <code>b</code>
holen, den aber aktuell der erste Thread hält.</p>
<p>Und schon geht's nicht mehr weiter :-)</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/synchronised/Deadlock.java" target="_blank"><span class="title">Demo: synchronised.Deadlock</span></a></span></div>
<h2 id="warten-auf-andere-threads-einseitige-synchronisierung">Warten auf andere Threads: Einseitige Synchronisierung</h2>
<h3 id="problem">Problem</h3>
<ul>
<li>Thread T1 wartet auf Arbeitsergebnis von T2</li>
<li>T2 ist noch nicht fertig</li>
</ul>
<h3 id="mögliche-lösungen">Mögliche Lösungen</h3>
<ol>
<li>Aktives Warten (Polling): Permanente Abfrage
<ul>
<li>Kostet unnötig Rechenzeit</li>
</ul>
</li>
<li>Schlafen mit <code>Thread.sleep()</code>
<ul>
<li>Etwas besser; aber wie lange soll man idealerweise schlafen?</li>
</ul>
</li>
<li>Warten mit <code>T2.join()</code>
<ul>
<li>Macht nur Sinn, wenn T1 auf das <em>Ende</em> von T2 wartet</li>
</ul>
</li>
<li><strong>Einseitige Synchronisierung</strong> mit <code>wait()</code> und <code>notify()</code>
<ul>
<li>Das ist DIE Lösung für das Problem :)</li>
</ul>
</li>
</ol>
<h2 id="einseitige-synchronisierung-mit-wait-und-notify">Einseitige Synchronisierung mit <em>wait</em> und <em>notify</em></h2>
<ul>
<li>
<p><span class='alert'><strong>wait</strong></span>: Warten auf Erfüllung einer Bedingung (Thread blockiert):</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">synchronized</span> (obj) {    <span style="color:#75715e">// Geschützten Bereich betreten</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (<span style="color:#f92672">!</span>condition) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            obj.<span style="color:#a6e22e">wait</span>(); <span style="color:#75715e">// Thread wird blockiert</span>
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (InterruptedException e) {}
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    ...     <span style="color:#75715e">// Condition erfüllt: Tue Deine Arbeit</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>=&gt; Bedingung nach Rückkehr von <code>wait</code> erneut prüfen!</p>
</li>
</ul>
<h3 id="eigenschaften-von-wait">Eigenschaften von <em>wait</em></h3>
<ul>
<li>Thread ruft auf Synchronisations-Objekt die Methode <code>wait</code> auf</li>
<li>Prozessor wird entzogen, Thread blockiert</li>
<li>Thread wird in interne Warteschlange des Synchronisations-Objekts eingetragen</li>
<li>Sperre auf Synchronisations-Objekt wird freigegeben</li>
</ul>
<p>=&gt; Geht nur innerhalb der <code>synchronized</code>-Anweisung für das Synchronisations-Objekt!</p>
<h2 id="einseitige-synchronisierung-mit-wait-und-notify-cnt">Einseitige Synchronisierung mit <em>wait</em> und <em>notify</em> (cnt.)</h2>
<ul>
<li>
<p><span class='alert'><strong>notify</strong></span>: Aufwecken von wartenden (blockierten) Threads:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">synchronized</span> (obj) {
</span></span><span style="display:flex;"><span>    obj.<span style="color:#a6e22e">notify</span>();       <span style="color:#75715e">// einen Thread &#34;in&#34; obj aufwecken</span>
</span></span><span style="display:flex;"><span>    obj.<span style="color:#a6e22e">notifyAll</span>();    <span style="color:#75715e">// alle Threads &#34;in&#34; obj wecken</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
</ul>
<h3 id="eigenschaften-von-notify-bzw-notifyall">Eigenschaften von <em>notify</em> bzw. <em>notifyAll</em></h3>
<ul>
<li>Thread ruft auf einem Synchronisations-Objekt die Methode <code>notify</code>
oder <code>notifyAll</code> auf</li>
<li>Falls Thread(s) in Warteschlange des Objekts vorhanden, dann
<ul>
<li><code>notify</code>: Ein <em>zufälliger</em> Thread wird aus Warteschlange entfernt und
in den Zustand &quot;ausführungsbereit&quot; versetzt</li>
<li><code>notifyAll</code>: Alle Threads werden aus Warteschlange entfernt und in
den Zustand &quot;ausführungsbereit&quot; versetzt</li>
</ul>
</li>
</ul>
<p>=&gt; Geht nur innerhalb der <code>synchronized</code>-Anweisung für das Synchronisations-Objekt!</p>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/synchronised/Staffel.java" target="_blank"><span class="title">Demo: synchronised.Staffel</span></a></span></div>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Synchronisierungsbedarf bei verteiltem Zugriff auf gemeinsame Ressourcen:</p>
<ul>
<li>
<p>Vorsicht mit konkurrierendem Ressourcenzugriff:
Synchronisieren mit <code>synchronized</code> =&gt; <strong>Mehrseitige Synchronisierung</strong></p>
</li>
<li>
<p>Warten auf Ereignisse mit <code>wait</code> und <code>notify</code>/<code>notifyAll</code> =&gt; <strong>Einseitige Synchronisierung</strong></p>
</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106530&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz Threads Synchronisation (ILIAS)</a></li></ul>
  </div>
</div>



    



    

    <div class="box notices cstyle note">
  <div class="box-label">
    <i class="fas fa-puzzle-piece"></i> Challenges
  </div>
  <div class="box-content">
<p><strong>Hamster-Welt</strong></p>
<p>In den <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/threads/src/challenges/threads" rel="external" target="_blank">Vorgaben</a>
finden Sie eine Modellierung für eine Hamsterwelt.</p>
<p>Es gibt rote und blaue Hamster, die sich unabhängig von einander bewegen können. Es gibt einen Tunnel, den die Hamster betreten
und durchqueren können. In der Vorgabe ist ein kleines Hauptprogramm enthalten, welches einige Hamster anlegt und herumlaufen
lässt.</p>
<p><strong>Teil I: Stau im Tunnel</strong></p>
<p>Die Hamster sind sehr neugierig und wollen gern durch den Tunnel gehen, um die Höhle auf der anderen Seite zu erkunden. Leider
mussten sie feststellen, dass immer nur ein Hamster zu einem Zeitpunkt im Tunnel sein darf, sonst wird die Luft zu knapp.</p>
<p>Ergänzen Sie die Vorgaben, so dass sich immer nur ein paralleler Hamster (egal welcher Farbe) im Tunnel aufhalten kann. Wenn ein
Hamster in den Tunnel will, aber nicht hinein kann, dann soll er am Eingang warten, also nicht noch einmal in seiner Höhle
herumlaufen. (Das passiert eigentlich automatisch, wenn Sie alles richtig machen.)</p>
<p><strong>Teil II: Schlaue Hamster</strong></p>
<p>Die Hamster sind schlau und haben bemerkt, dass die Einschränkung aus der letzten Aufgabe zu stark war. Sie überleben auch, wenn
sich beliebig viele blaue Hamster oder nur genau ein roter Hamster im Tunnel aufhalten.</p>
<p>Erweitern Sie die Implementierung aus der letzten Aufgabe, so dass folgende Bedingungen eingehalten werden:</p>
<ul>
<li>
<p>Es dürfen sich beliebig viele blaue Hamster gleichzeitig im Tunnel befinden.</p>
<p>Das bedeutet, dass in diesem Fall zwar weitere blaue Hamster den Tunnel betreten dürfen, aber kein roter Hamster in den Tunnel
hinein darf.</p>
</li>
<li>
<p>Wenn sich ein roter Hamster im Tunnel aufhält, dürfen keine anderen Hamster (unabhängig von deren Farbe) den Tunnel betreten.</p>
</li>
</ul>
  </div>
</div>



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Boles2008'>[Boles2008] <a href='http://www.boles.de/hamster/band3.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Parallele Programmierung spielend gelernt mit dem Java-Hamster-Modell</strong></a><br>Boles, D., Vieweg+Teubne, 2008. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8351-0229-3' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8351-0229-3</a>.</li> <li id='id_Java-SE-Tutorial'>[Java-SE-Tutorial] <a href='https://docs.oracle.com/javase/tutorial/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>The Java Tutorials</strong></a><br>Oracle Corporation, 2022.<br><em>Trail: Essential Java Classes, Lesson: Concurrency</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

<article class="default">
<h1>High-Level Concurrency</h1>



    



    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-graduation-cap"></i> TL;DR
  </div>
  <div class="box-content">
<p>Das Erzeugen von Threads über die Klasse <code>Thread</code> oder das Interface <code>Runnable</code> und
das Hantieren mit <code>synchronized</code> und <code>wait()</code>/<code>notify()</code> zählt zu den grundlegenden
Dingen beim Multi-Threading mit Java. Auf diesen Konzepten bauen viele weitere
Konzepte auf, die ein flexibleres Arbeiten mit Threads in Java ermöglichen.</p>
<p>Dazu zählt unter anderem das Arbeiten mit <code>Lock</code>-Objekten und dazugehörigen <code>Conditions</code>,
was <code>synchronized</code> und <code>wait()</code>/<code>notify()</code> entspricht, aber feingranulareres und
flexibleres Locking bietet.</p>
<p>Statt Threads immer wieder neu anzulegen (das Anlegen von Objekten bedeutet einen
gewissen Aufwand zur Laufzeit), kann man Threads über sogenannte Thread-Pools
wiederverwenden und über das Executor-Interface benutzen.</p>
<p>Schließlich bietet sich das Fork/Join-Framework zum rekursiven Zerteilen von Aufgaben
und zur parallelen Bearbeitung der Teilaufgaben an.</p>
<p>Die in Swing integrierte Klasse <code>SwingWorker</code> ermöglicht es, in Swing Berechnungen
in einen parallel ausgeführten Thread auszulagern.</p>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (YouTube)
  </div>
  <div class="box-content">
<ul> <li><a href='https://youtu.be/bb_kuuhXC6A' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL High-Level Concurrency</a></li> <li><a href='https://youtu.be/1tJRUJddtlw' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Lock-Objekte</a></li> <li><a href='https://youtu.be/VvzlwZ6n3SI' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Executor</a></li> <li><a href='https://youtu.be/Wfq_MDFoWYY' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo Fork/Join</a></li> <li><a href='https://youtu.be/Hu3RbqiNy4M' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Demo SwingWorker</a></li></ul>
  </div>
</div>




    
    
    
    





    
    
        
        
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-podcast"></i> Videos (HSBI-Medienportal)
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/medienportal/m/1d46e6b75b7e2ebe8d15edbda2340505285d886160a3b03f489024b1075f0b5176c68d9993a145fdcdb5e65c17f6be80a7ef1f0c64a72c410536e69965275a59' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>VL High-Level Concurrency</a></li></ul>
  </div>
</div>




    
    
    
    






    
    





    

    

    
    
        
        
        
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-lightbulb"></i> Lernziele
  </div>
  <div class="box-content">
<ul> <li>(K3) Umgang mit High-Level-Abstraktionen: Lock-Objekten und Conditions, Executor-Interface und Thread-Pools, Fork/Join-Framework, SwingWorker</li></ul>
  </div>
</div>




    <h2 id="explizite-lock-objekte">Explizite Lock-Objekte</h2>
<p>Sie kennen bereits die Synchronisierung mit dem Schlüsselwort <code>synchronized</code>.</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Synchronisierung der gesamten Methode</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">incrVal</span>() {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Synchronisierung eines Blocks (eines Teils einer Methode)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">incrVal</span>() {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">synchronized</span> (someObj) {
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Dabei wird implizit ein Lock über ein Objekt (das eigene Objekt im ersten Fall,
das Sperrobjekt im zweiten Fall) benutzt.</p>
<p>Seit Java5 kann man alternativ auch explizite Lock-Objekte nutzen:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#75715e">// Synchronisierung eines Teils einer Methode über ein</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Lock-Objekt (seit Java 5)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Package `java.util.concurrent.locks`</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">incrVal</span>() {
</span></span><span style="display:flex;"><span>    Lock waechter <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ReentrantLock();
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>    waechter.<span style="color:#a6e22e">lock</span>();
</span></span><span style="display:flex;"><span>    ... <span style="color:#75715e">// Geschützter Bereich</span>
</span></span><span style="display:flex;"><span>    waechter.<span style="color:#a6e22e">unlock</span>();
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<p>Locks aus dem Paket <code>java.util.concurrent.locks</code> arbeiten analog zum
impliziten Locken über <code>synchronized</code>. Sie haben darüber hinaus aber einige
Vorteile:</p>
<ul>
<li>Methoden zum Abfragen, ob ein Lock möglich ist: <code>Lock#tryLock</code></li>
<li>Methoden zum Abfragen der aktuellen Warteschlangengröße: <code>Lock#getQueueLength</code></li>
<li>Verfeinerung <code>ReentrantReadWriteLock</code> mit Methoden <code>readLock</code> und <code>writeLock</code>
<ul>
<li>Locks nur zum Lesen bzw. nur zum Schreiben</li>
</ul>
</li>
<li><code>Lock#newCondition</code> liefert ein Condition-Objekt zur Benachrichtigung
ala <code>wait</code>/<code>notify</code>: <code>await</code>/<code>signal</code> =&gt; zusätzliches Timeout beim
Warten möglich</li>
</ul>
<p>Nachteile:</p>
<ul>
<li>Bei Exceptions werden implizite Locks durch <code>synchronized</code> automatisch
durch das Verlassen der Methode freigegeben. Explizite Locks müssen
<strong>durch den Programmierer</strong> freigegeben werden! =&gt; Nutzung des
<code>finally</code>-Block!</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/tree/master/lecture/threads/src/lock/" target="_blank"><span class="title">Demo: lock.*</span></a></span></div>
<h2 id="thread-management-executor-interface-und-thread-pools">Thread-Management: Executor-Interface und Thread-Pools</h2>
<h3 id="wiederverwendung-von-threads">Wiederverwendung von Threads</h3>
<ul>
<li>
<p>Normale Threads sind immer Einmal-Threads: Man kann sie nur <strong>einmal</strong> in
ihrem Leben starten (auch wenn das Objekt anschließend noch auf
Nachrichten bzw. Methodenaufrufe reagiert)</p>
</li>
<li>
<p>Zusätzliches Problem: Threads sind Objekte:</p>
<ul>
<li>Threads brauchen relativ viel Arbeitsspeicher</li>
<li>Erzeugen und Entsorgen von Threads kostet Ressourcen</li>
<li>Zu viele Threads: Gesamte Anwendung hält an</li>
</ul>
</li>
<li>
<p>Idee: Threads wiederverwenden und Thread-Management auslagern
=&gt; <strong>Executor-Interface</strong> und <strong>Thread-Pool</strong></p>
</li>
</ul>
<h3 id="executor-interface">Executor-Interface</h3>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Executor</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">execute</span>(Runnable command);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<ul>
<li>Neue Aufgaben als Runnable an einen Executor via <code>execute</code> übergeben</li>
<li>Executor könnte damit sofort neuen Thread starten (oder alten
wiederverwenden):
<code>e.execute(r);</code> =&gt; entspricht in der Wirkung <code>(new Thread(r)).start();</code></li>
</ul>
<h3 id="thread-pool-hält-menge-von-worker-threads">Thread-Pool hält Menge von &quot;Worker-Threads&quot;</h3>
<ul>
<li>
<p>Statische Methoden von <code>java.util.concurrent.Executors</code> erzeugen
Thread-Pools mit verschiedenen Eigenschaften:</p>
<ul>
<li><code>Executors#newFixedThreadPool</code> erzeugt ExecutorService mit
spezifizierter Anzahl von Worker-Threads</li>
<li><code>Executors#newCachedThreadPool</code> erzeugt Pool mit Threads, die nach
60 Sekunden Idle wieder entsorgt werden</li>
</ul>
</li>
<li>
<p>Rückgabe: <code>ExecutorService</code> (Thread-Pool)</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">ExecutorService</span> <span style="color:#66d9ef">extends</span> Executor { ... }</span></span></code></pre></div>
</li>
<li>
<p><code>Executor#execute</code> übergibt Runnable dem nächsten freien Worker-Thread
(oder erzeugt ggf. neuen Worker-Thread bzw. hängt Runnable in Warteschlange,
je nach erzeugtem Pool)</p>
</li>
<li>
<p>Methoden zum Beenden eines Thread-Pools (Freigabe): <code>shutdown()</code>, <code>isShutdown()</code>, ...</p>
</li>
</ul>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>MyThread x <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> MyThread();    <span style="color:#75715e">// Runnable oder Thread</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ExecutorService pool <span style="color:#f92672">=</span> Executors.<span style="color:#a6e22e">newCachedThreadPool</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pool.<span style="color:#a6e22e">execute</span>(x);    <span style="color:#75715e">// x.start()</span>
</span></span><span style="display:flex;"><span>pool.<span style="color:#a6e22e">execute</span>(x);    <span style="color:#75715e">// x.start()</span>
</span></span><span style="display:flex;"><span>pool.<span style="color:#a6e22e">execute</span>(x);    <span style="color:#75715e">// x.start()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pool.<span style="color:#a6e22e">shutdown</span>();    <span style="color:#f92672">//</span> Feierabend :)</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/executor/ExecutorDemo.java" target="_blank"><span class="title">Demo: executor.ExecutorDemo</span></a></span></div>
<h3 id="hintergrund-vereinfacht">Hintergrund (vereinfacht)</h3>
<p>Der Thread-Pool reserviert sich &quot;nackten&quot; Speicher, der der Größe von <span class="math align-center">$n$</span>
Threads entspricht, und &quot;prägt&quot; die Objektstruktur durch einen Cast direkt auf
(ohne wirkliche neue Objekte zu erzeugen). Dieses Vorgehen ist in der C-Welt
wohlbekannt und schnell (vgl. Thema Speicherverwaltung in der LV
&quot;Systemprogrammierung&quot;). In Java wird dies durch eine wohldefinierte
Schnittstelle vor dem Nutzer verborgen.</p>
<h3 id="ausblick">Ausblick</h3>
<p>Hier haben wir nur die absoluten Grundlagen angerissen. Wir können auch
<code>Callables</code> anstatt von <code>Runnables</code> übergeben, auf Ergebnisse aus der Zukunft
warten (<code>Futures</code>), Dinge zeitgesteuert (immer wieder) starten, ...</p>
<p>Schauen Sie sich bei Interesse die weiterführende Literatur an, beispielsweise die
Oracle-Dokumentation oder auch <a href="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/threads/threads-highlevel.html#id_Ullenboom2021">[Ullenboom2021]</a> (insbesondere den Abschnitt 16.4
<a href="https://openbook.rheinwerk-verlag.de/javainsel/16_004.html#u16.4" rel="external" target="_blank">&quot;Der Ausführer (Executor) kommt&quot;</a>).</p>
<h2 id="forkjoin-framework-teile-und-herrsche">Fork/Join-Framework: Teile und Herrsche</h2>
<p>Spezieller Thread-Pool zur rekursiven Bearbeitung parallelisierbarer Tasks</p>
<ul>
<li>
<p><code>java.util.concurrent.ForkJoinPool#invoke</code> startet Task</p>
</li>
<li>
<p>Task muss von <code>RecursiveTask&lt;V&gt;</code> erben:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RecursiveTask</span><span style="color:#f92672">&lt;</span>V<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">extends</span> ForkJoinTask<span style="color:#f92672">&lt;</span>V<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">abstract</span> V <span style="color:#a6e22e">compute</span>();
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
</li>
</ul>
<p>Prinzipieller Ablauf:</p>
<div class="highlight wrap-code"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RecursiveTask</span> <span style="color:#66d9ef">extends</span> ForkJoinTask<span style="color:#f92672">&lt;</span>V<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> V <span style="color:#a6e22e">compute</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (task klein genug) {
</span></span><span style="display:flex;"><span>            berechne task sequentiell
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            teile task in zwei subtasks:
</span></span><span style="display:flex;"><span>                left, right <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RecursiveTask(task)
</span></span><span style="display:flex;"><span>            rufe <span style="color:#a6e22e">compute</span>() auf beiden subtasks auf:
</span></span><span style="display:flex;"><span>                left.<span style="color:#a6e22e">fork</span>();          <span style="color:#75715e">// starte neuen Thread</span>
</span></span><span style="display:flex;"><span>                r <span style="color:#f92672">=</span> right.<span style="color:#a6e22e">compute</span>();  <span style="color:#75715e">// nutze aktuellen Thread</span>
</span></span><span style="display:flex;"><span>            warte auf ende der beiden subtasks: l <span style="color:#f92672">=</span> left.<span style="color:#a6e22e">join</span>()
</span></span><span style="display:flex;"><span>            kombiniere die ergebnisse der beiden subtasks: l<span style="color:#f92672">+</span>r
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/forkjoin/ForkJoin.java" target="_blank"><span class="title">Demo: forkjoin.ForkJoin</span></a></span></div>
<h2 id="swing-und-threads">Swing und Threads</h2>
<h3 id="lange-berechnungen-in-listenern-blockieren-swing-gui">Lange Berechnungen in Listenern blockieren Swing-GUI</h3>
<ul>
<li>Problem: Events werden durch <span class='alert'><strong>einen</strong></span> <em>Event Dispatch Thread</em> (EDT)
<span class='alert'><strong>sequentiell</strong></span> bearbeitet</li>
<li>Lösung: Berechnungen in neuen Thread auslagern</li>
<li><span class='alert'><strong>Achtung</strong></span>: Swing ist <strong>nicht Thread-safe</strong>! Komponenten nicht
durch verschiedene Threads manipulieren!</li>
</ul>
<h3 id="lösung">Lösung</h3>
<p>=&gt; <code>javax.swing.SwingWorker</code> ist eine spezielle Thread-Klasse, eng mit Swing/Event-Modell verzahnt.</p>
<ul>
<li>
<p>Implementieren:</p>
<ul>
<li><code>SwingWorker#doInBackground</code>: Für die langwierige Berechnung (muss man selbst implementieren)</li>
<li><code>SwingWorker#done</code>: Wird vom EDT aufgerufen, wenn <code>doInBackground</code> fertig ist</li>
</ul>
</li>
<li>
<p>Aufrufen:</p>
<ul>
<li><code>SwingWorker#execute</code>: Started neuen Thread nach Anlegen einer Instanz und führt dann automatisch <code>doInBackground</code> aus</li>
<li><code>SwingWorker#get</code>: Return-Wert von <code>doInBackground</code> abfragen</li>
</ul>
</li>
</ul>
<h3 id="anmerkungen">Anmerkungen</h3>
<ul>
<li><code>SwingWorker#done</code> ist optional: <em>kann</em> überschrieben werden
<ul>
<li>Beispielweise, wenn nach Beendigung der langwierigen Berechnung
GUI-Bestandteile mit dem Ergebnis aktualisiert werden sollen</li>
</ul>
</li>
<li><code>SwingWorker&lt;T, V&gt;</code> ist eine generische Klasse:
<ul>
<li><code>T</code> Typ für das Ergebnis der Berechnung, d.h. Rückgabetyp für
<code>doInBackground</code> und <code>get</code></li>
<li><code>V</code> Typ für Zwischenergebnisse</li>
</ul>
</li>
</ul>
<div style="text-align: right;"><span class="btn cstyle interactive default"><a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/lecture/threads/src/misc/SwingWorkerDemo.java" target="_blank"><span class="title">Demo: misc.SwingWorkerDemo</span></a></span></div>
<h2 id="letzte-worte--">Letzte Worte :-)</h2>
<ul>
<li>
<p>Viele weitere Konzepte</p>
<ul>
<li>Semaphoren, Monitore, ...</li>
<li>Leser-Schreiber-Probleme, Verklemmungen, ...</li>
</ul>
<p>=&gt; Verweis auf LV &quot;Betriebssysteme&quot; und &quot;Verteilte Systeme&quot;</p>
</li>
<li>
<p><span class='alert'><strong>Achtung</strong></span>: Viele Klassen sind nicht Thread-safe!</p>
<p>Es gibt aber meist ein &quot;Gegenstück&quot;, welches Thread-safe ist.</p>
<p>Beispiel Listen:</p>
<ul>
<li><code>java.util.ArrayList</code> ist <strong>nicht</strong> Thread-safe</li>
<li><code>java.util.Vector</code> ist Thread-sicher</li>
</ul>
<p>=&gt; Siehe Javadoc in den JDK-Klassen!</p>
</li>
<li>
<p>Thread-safe bedeutet <strong>Overhead</strong> (Synchronisierung)!</p>
</li>
</ul>
<h2 id="wrap-up">Wrap-Up</h2>
<p>Multi-Threading auf höherem Level: Thread-Pools und Fork/Join-Framework</p>
<ul>
<li>Feingranulareres und flexibleres Locking mit Lock-Objekten und Conditions</li>
<li>Wiederverwendung von Threads: Thread-Management mit Executor-Interface
und Thread-Pools</li>
<li>Fork/Join-Framework zum rekursiven Zerteilen von Aufgaben und zur
parallelen Bearbeitung der Teilaufgaben</li>
<li><code>SwingWorker</code> für die parallele Bearbeitung von Aufgaben in Swing</li>
</ul>


    



    
    
        
        
        
            
        
    
    

    <div class="box notices cstyle tip">
  <div class="box-label">
    <i class="fas fa-user-check"></i> Quizzes
  </div>
  <div class="box-content">
<ul> <li><a href='https://www.hsbi.de/elearning/goto.php?target=tst_1106531&client_id=FH-Bielefeld' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>Quiz High-Level Concurrency (ILIAS)</a></li></ul>
  </div>
</div>



    



    




    




    
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
        
        

        
            
            
            
            
            

            
            
                
                    
                
            
                
                    
                
            
                
                    
                
            
            
            
            
            
            

            
            
                
            
            
                
                
                    
                
                
            
            
                
            
            
        
    
    

    <div class="box notices cstyle info">
  <div class="box-label">
    <i class="fas fa-book-reader"></i> Quellen
  </div>
  <div class="box-content">
<ul> <li id='id_Java-SE-Tutorial'>[Java-SE-Tutorial] <a href='https://docs.oracle.com/javase/tutorial/' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>The Java Tutorials</strong></a><br>Oracle Corporation, 2022.<br><em>Trail: Essential Java Classes, Lesson: Concurrency</em></li> <li id='id_Ullenboom2021'>[Ullenboom2021] <a href='https://openbook.rheinwerk-verlag.de/javainsel/index.html' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'><strong>Java ist auch eine Insel</strong></a><br>Ullenboom, C., Rheinwerk-Verlag, 2021. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-3-8362-8745-6' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-3-8362-8745-6</a>.<br><em>Kap. 16: Einführung in die nebenläufige Programmierung</em></li> <li id='id_Urma2014'>[Urma2014] <strong>Java 8 in Action: Lambdas, Streams, and Functional-Style Programming</strong><br>Urma, R.-G. und Fusco, M. und Mycroft, A., Manning Publications, 2014. ISBN <a href='https://fhb-bielefeld.digibib.net/openurl?isbn=978-1-6172-9199-9' class='icon reading' target='_blank' rel='nofollow noopener noreferrer'>978-1-6172-9199-9</a>.<br><em>Abschnitt 7.2: The fork/join framework</em></li></ul>
  </div>
</div>






<footer class="footline"><div style="color: darkgray; font-size: small;">
<p style="margin-left: 4rem; margin-right: 4rem; margin-top: 6rem;">
<!-- https://creativecommons.org/choose/ -->
<a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0;margin:0;display:inline;" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a>
Unless otherwise noted, <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture">this work</a> by <a xmlns:cc="https://creativecommons.org/ns#" href="https://github.com/cagix" property="cc:attributionName" rel="cc:attributionURL">Carsten Gips</a> and <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/graphs/contributors">contributors</a> is licensed under <a rel="license" href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/LICENSE.md">CC BY-SA 4.0</a>.
See the <a href="https://github.com/Programmiermethoden-CampusMinden/Prog2-Lecture/blob/master/CREDITS.md">credits</a> for a detailed list of contributing projects.

</p>
</div>

</footer>
</article>

          </section>
          </section>
        </div>
      </main>
    </div>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/clipboard.min.js?1729954976" defer></script>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/perfect-scrollbar.min.js?1729954976" defer></script>
    <script>
      function useMathJax( config ){
        window.MathJax = Object.assign( window.MathJax || {}, {
          tex: {
            inlineMath:  [['\\(', '\\)'], ['$',  '$']],  
            displayMath: [['\\[', '\\]'], ['$$', '$$']], 
          },
          options: {
            enableMenu: false 
          }
        }, config );
      }
      useMathJax( JSON.parse("{}") );
    </script>
    <script id="MathJax-script" async src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/mathjax/tex-mml-chtml.js?1729954976"></script>
    <script src="/elearning/data/FH-Bielefeld/lm_data/lm_1661234/js/theme.js?1729954976" defer></script>
  </body>
</html>
